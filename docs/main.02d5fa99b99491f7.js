"use strict";(self.webpackChunkMirrorWalk=self.webpackChunkMirrorWalk||[]).push([[179],{318:(we,J,M)=>{M.d(J,{_T:()=>k,wL:()=>N,PS:()=>H});var H=function(n){return n.GREEN="rgb(124 131 116)",n.RED="rgb(255, 138, 138)",n.BLUE="rgb(105 123 226)",n.GRAY="rgb(182, 182, 182)",n}(H||{}),N=function(n){return n.DefaultItemIconBg="rgb(43, 16, 76)",n.DefaultItemIconClr="rgb(195, 214, 231)",n.DefautlDebuffBg="rgb(135, 20, 175)",n.DefautlDebuffClr="rgb(255,255,255)",n.DefautlBuffBg="rgb(93 155 93)",n.DefautlBuffClr="rgb(255, 255, 255)",n}(N||{});function q(n){return(B,$="png")=>`${n}${B}.${$}`}const W=q("units/"),Q=q("heroes/"),k={UnitMelee:W("common-melee"),UnitRanged:W("common-ranged"),FireBird:W("fire-bird"),Archer:W("archer"),Pikemen:W("pikemen"),HeroMelee:Q("hero-melee"),HeroMage:Q("hero-mage"),HeroKnight:Q("hero-knight"),HeroTaltir:Q("hero-taltir"),HeroHelvetica:Q("hero-helvetica"),HeroBlackbird:Q("hero-blackbird")}},284:(we,J,M)=>{M.d(J,{uB:()=>W,Lx:()=>k,fH:()=>Q});class N{static#e=this.allEntitiesMap=new Map;static#t=this.entitiesByPrefixMap=new Map;static resolve($){const I=this.allEntitiesMap.get($);if(!I)throw new Error(`Couldn't resolve entity ${$}`);return I}static resolveMany($){return $.map(I=>this.resolve(I))}static register($){if(this.allEntitiesMap.has($.id))return void console.error(`Entity ${$.id} is already registered, registering:`,$);const I=function q(B){return B.split("-")[0]}($.id),L=this.entitiesByPrefixMap.get(I);L?L.push($):this.entitiesByPrefixMap.set(I,[$]),this.allEntitiesMap.set($.id,$)}}function W(B){N.register(B)}function Q(B){return N.resolve(B)}function k(B){return N.resolveMany(B)}window.entities=N},683:(we,J,M)=>{M.d(J,{i:()=>q});var H=M(318),N=M(284);const q={factionsMap:new Map,getAllFactions(){return[...this.factionsMap.values()]},createFaction({id:W,icon:Q,title:k}){if(this.factionsMap.has(W))throw new Error(`Faction ${W} was already created.`);const n={id:W,unitTypes:{},heroes:[],title:k,icon:Q,townBase:null,setTownBase(B){this.townBase=B,(0,N.uB)(B)},getTownBase(){return this.townBase},defineUnitType(B){const $={defaultTurnsPerRound:1,...B,mainPortraitUrl:B.mainPortraitUrl??H._T.UnitMelee,faction:this};return(0,N.uB)($),$},findBaseUnitType(B){return Object.values(this.unitTypes).find($=>$.upgradeDetails?.target===B.id)},createHero(B){const{id:$,abilities:I,army:L,items:U,name:V,resources:te,stats:O,generalDescription:R,defaultModifiers:E,image:z}=B,ne={id:$,name:V,generalDescription:R,initialState:{abilities:I,army:L,items:U,resources:te,stats:O,defaultModifiers:E},image:z??H._T.HeroMage};return(0,N.uB)(ne),this.heroes.push(ne),ne},getAllHeroes(){return this.heroes}};return(0,N.uB)(n),this.factionsMap.set(W,n),n},getFaction(W){return this.factionsMap.get(W)}}},688:(we,J,M)=>{M.d(J,{W:()=>N});const N=M(683).i.createFaction({id:"#faction-castle",title:"Castle",icon:"castle-emblem"});window.mw={humansFaction:N}},249:(we,J,M)=>{M.d(J,{iz:()=>H.i,vn:()=>N,Wr:()=>q.W});var H=M(683);const N=H.i.createFaction({id:"#faction-fort",title:"Fort",icon:"spikeball"});var q=M(688)},785:(we,J,M)=>{M.d(J,{l:()=>N});var H=M(193);let N=(()=>{class q{static#e=this.categoryId="game-object";constructor(Q){this.id=Q}getState(){return console.info("Game object doens't have state getter:",this),null}listenState(){return console.info("Game object doens't have state listener:",this),(0,H.of)(null)}create(Q){}getApi(){return this.api}onDestroy(){}addCustomData(Q){this.api.gameObjects.addCustomData(this.id,Q)}getCustomData(){return this.api.gameObjects.getCustomData(this.id)}}return q})()},890:(we,J,M)=>{M.d(J,{l:()=>q});var H=M(809);const q=(0,M(434).f)({id:"#item-phoenix-shield",name:"Phoenix Shield",icon:"fire-shield",slot:H.A.Shield,cost:{gold:750,gems:1},sellingCost:{gold:400},stats:{heroBonusDefence:2,heroBonusAttack:1,resistFire:17},enemyStats:{resistFire:-12},abilityDescription:"Reduces enemy Fire Resistance by 12%"})},809:(we,J,M)=>{M.d(J,{A:()=>N,c:()=>q});var H=M(785),N=function(W){return W.Weapon="Weapon",W.Headgear="Headgear",W.Amulet="Amulet",W.Armor="Armor",W.Boots="Boots",W.Shield="Shield",W}(N||{});let q=(()=>{class W extends H.l{static#e=this.categoryId="item";create(k){this.baseType=k.itemBase,this.state=k.state}}return W})()},434:(we,J,M)=>{M.d(J,{f:()=>q});var H=M(284),N=M(231);function q({id:W,name:Q,icon:k,slot:n,stats:B,enemyStats:$,abilityDescription:I,cost:L,sellingCost:U,spells:V,description:te,config:O}){const R={id:W,name:Q,icon:{icon:k},staticMods:B,slotType:n,cost:L,sellingCost:U??{gold:100},bonusAbilities:V,staticEnemyMods:$,description:te??function({thisItemBase:E}){return{descriptions:[(0,N.A9)(E),...I?[(0,N.bk)(I)]:[]]}},config:O??{init(){}}};return(0,H.uB)(R),R}},536:(we,J,M)=>{function N(R){return E=>`${E>=0?"+":""}${E} ${R}`}function q(R){return E=>`${(R=>`${R>=0?"+":"-"}${R}`)(E)}% ${R}`}M.d(J,{Cc:()=>U,lX:()=>L,_k:()=>te,Xh:()=>k,j$:()=>W});const W={specialtyNecromancy:"Necromancy",specialtySpiritism:"Spiritism",specialtyMysticism:"Mysticism",specialtyMagic:"Magic",specialtyMagicRecovery:"Restoration",specialtyColdMastery:"Cold Mastery",specialtyFireMastery:"Fire Mastery",specialtyLightningMastery:"Lightning Mastery",specialtyPoisonMastery:"Poison Mastery",specialtyCombatTactics:"Combat Tactics",specialtyArchery:"Archery",specialtyOffence:"Offensive Tactics"},Q={heroBonusAttack:N("Attack Rating"),heroBonusDefence:N("Defence"),heroMaxMana:N("Max Mana"),lifesteal:q("Lifesteal"),resistAll:q("All Resists"),resistFire:q("Fire Resist"),resistCold:q("Cold Resist"),resistLightning:q("Lightning Resist"),resistPoison:q("Poison Resist"),cannotBeSlowed:()=>"Units Cannot be slowed"};function k(R,E){return R in W?`+${E} to ${W[R]}`:R in Q?Q[R](E):""}var n=M(125),B=M(429),$=M(497);class I{constructor(E){this.modsObjectRef=E}static fromObjectRef(E){return new I(E)}setValue(E,z){this.modsObjectRef[E]=z}addValue(E,z){"number"!=typeof z?this.setValue(E,z):this.addNumericModValue(E,z)}clearValue(E){delete this.modsObjectRef[E]}addNumericModValue(E,z){const ne=this.modsObjectRef[E];this.modsObjectRef[E]=typeof ne>"u"?z:Number((ne+z).toFixed(2))}}class L{constructor(){this.modsRefs=[],this.cachedModValues={},this.childGroups=new Set,this.parentGroups=new Set,this.namedParentGroupsMap=new Map,this.modValuesChange$=new n.X({}),this.valueUpdater=I.fromObjectRef(this.cachedModValues)}static empty(){return new L}static withRefs(E){const z=new L;return E.forEach(ne=>z.addModsRef(ne)),z}getCalcNumModValue(E){const z=this.modsRefs.filter(ne=>ne.hasMod(E));return z.length?z.reduce((ne,qe)=>ne+qe.getModValue(E),0):null}getCalcBoolNumModValue(E){const z=this.modsRefs.filter(ne=>ne.hasMod(E));return z.length?z.some(ne=>ne.getModValue(E)):null}addModsRef(E){this.modsRefs.push(E),this.processModsRef(E),this.childGroups.forEach(z=>z.addModsRef(E)),this.emitModValueChange()}removeModsRef(E){B.DN.removeItem(this.modsRefs,E),this.processModsRef(E,!0),this.childGroups.forEach(z=>z.removeModsRef(E)),this.emitModValueChange()}getMods(){return this.cachedModValues}clearOwnModRefs(){[...this.getAllRefs()].forEach(E=>this.removeModsRef(E)),this.emitModValueChange()}getAllRefs(){return this.modsRefs}removeRefByModInstance(E){const z=this.modsRefs.find(ne=>ne.getMods()===E);z&&this.removeModsRef(z)}getModValue(E){return this.cachedModValues[E]||null}getAllModValues(E){return this.modsRefs.filter(z=>z.hasMod(E)).map(z=>z.getModValue(E))}attachNamedParentGroup(E,z){this.namedParentGroupsMap.has(E)&&(console.warn(`ModGroup: reattaching '${E}' parent mod group, child group:`,this),this.detachNamedParentGroup(E)),this.attachParentGroup(z),this.namedParentGroupsMap.set(E,z)}detachNamedParentGroup(E){const z=this.namedParentGroupsMap.get(E);z&&(this.detachParentGroup(z),this.namedParentGroupsMap.delete(E))}getNamedGroup(E){return this.namedParentGroupsMap.get(E)}onValueChanges(){return this.modValuesChange$}attachParentGroup(E){E.childGroups.add(this),this.parentGroups.add(E),E.getAllRefs().forEach(z=>this.addModsRef(z)),this.emitModValueChange()}detachParentGroup(E){this.parentGroups.delete(E),E.childGroups.delete(this),E.getAllRefs().forEach(z=>this.removeModsRef(z)),this.emitModValueChange()}processModsRef(E,z){(0,$.Cg)(E.getMods()).forEach(([ne,qe])=>{"number"!=typeof qe?"boolean"==typeof qe&&(z?this.cachedModValues[ne]=this.getCalcBoolNumModValue(ne)||void 0:!this.cachedModValues[ne]&&qe&&(this.cachedModValues[ne]=!0)):this.valueUpdater.addValue(ne,z?-qe:qe)})}emitModValueChange(){this.modValuesChange$.next(this.cachedModValues)}}class U{constructor(E){this.mods=E,this.valuesUpdater=I.fromObjectRef(this.mods)}static fromMods(E){return new U(E||{})}getModValue(E){return this.mods[E]||null}setModValue(E,z){this.valuesUpdater.setValue(E,z)}addModValue(E,z){this.valuesUpdater.addValue(E,z)}hasMod(E){return(0,$.m2)(this.mods,E)}clearMod(E){this.valuesUpdater.clearValue(E)}getMods(){return this.mods}}const V="specialty";function te(R){const E={};for(const z of(0,$.RR)(R))z.startsWith(V)&&(E[z]=R[z]);return E}},231:(we,J,M)=>{M.d(J,{wX:()=>N,xL:()=>q,m8:()=>H,hJ:()=>V,Ym:()=>Q,A9:()=>U,bk:()=>k,EK:()=>$,QO:()=>W});var H=function(O){return O.SimpleMsg="simple-msg",O.RoundInfoMsg="round-info-msg",O.DealtDamageMsg="dealt-damage-msg",O.Html="html",O}(H||{}),N=function(O){return O.OnHoverEnemyCard="on-hover-enemy-card",O.OnTargetSpell="on-target-spell",O.CustomHtml="custom-html",O}(N||{}),q=function(O){return O[O.FreeHtml=0]="FreeHtml",O}(q||{});function W(O){return`${Math.floor(100*O)}%`}function Q(O){return{type:q.FreeHtml,htmlContent:O}}function k(O){return{type:q.FreeHtml,htmlContent:`<div class="spell-descr">${O}</div>`}}function $(O){return{descriptions:[k(O)]}}var I=M(536);function U(O){const E=Object.entries(O.staticMods).map(([z,ne])=>function L(O){return`<div class="item-mod">${O}</div>`}((0,I.Xh)(z,ne))).filter(Boolean).join("");return{type:q.FreeHtml,htmlContent:`\n      <div class="item-mods">\n        ${E}\n      </div>\n    `}}var V=function(O){return O[O.Vertical=0]="Vertical",O[O.Horizontal=1]="Horizontal",O}(V||{})},497:(we,J,M)=>{function H(n,B){return Object.prototype.hasOwnProperty.call(n,B)}M.d(J,{$L:()=>Q,Cg:()=>N,RR:()=>q,Rt:()=>W,lm:()=>k,m2:()=>H});const N=n=>Object.entries(n),q=n=>Object.keys(n);function W(n){return null!=n}function Q(n){return n===1/0?"\u221e":n}function k(n){return null!=n}},429:(we,J,M)=>{M.d(J,{DN:()=>q,CT:()=>W,xf:()=>N});var H=M(729);function N(){return(0,H.f3M)(H.SBq).nativeElement}const q={selectItems:(k,n,B=0)=>k.slice(B,B+n),randIndex:k=>Math.round((k.length-1)*Math.random()),randItem(k){return k[this.randIndex(k)]},randIntInRange:(k,n)=>Math.floor(k+(n-k+1)*Math.random()),randIntTo:k=>Math.floor((k+1)*Math.random()),removeItem(k,n){if(-1===k.indexOf(n))return;const B=k.indexOf(n);k.splice(B,1)},randBoolean:()=>Math.random()>.5,chanceRoll:k=>Math.random()<k,maxPercent:(k,n=1)=>k>n?n:k,nonNegative:k=>k<0?0:k,getRandomItems(k,n){const B=[...k],$=[];for(;n&&B.length;){const[I]=B.splice(q.randIndex(B),1);$.push(I),n--}return $}};function W(k){return k[k.length-1]}},843:(we,J,M)=>{var H={};M.r(H),M.d(H,{CombatAttackInteraction:()=>Qo,FightEnds:()=>Vi,FightNextRoundStarts:()=>Ko,GroupAttacked:()=>kr,GroupCounterAttacked:()=>xc,GroupDamagedByGroup:()=>Wo,GroupDies:()=>Rr,GroupModifiersChanged:()=>ed,GroupSpeedChanged:()=>Nr,GroupSpellsChanged:()=>Un,GroupTakesDamage:()=>$s,PlayerCastsInstantSpell:()=>Xu,PlayerTargetsSpell:()=>Tc,RoundGroupSpendsTurn:()=>Ic,RoundGroupTurnEnds:()=>td,RoundPlayerCountinuesAttacking:()=>Jo,RoundPlayerTurnStarts:()=>mi,UnitHealed:()=>Ec,UnitSummoned:()=>Fr});var N={};M.r(N),M.d(N,{AddCombatModifiersToUnit:()=>nd,DefendAction:()=>Zs,RegisterUnitLoss:()=>ph,RemoveCombatModifiersFromUnit:()=>dh});var q={};M.r(q),M.d(q,{BeforeBattleInit:()=>od,DisplayPopup:()=>Qs,DisplayReward:()=>Hr,FightStarts:()=>go,GameCreated:()=>Oc,GameStarted:()=>fh,NewDayStarted:()=>Rc,NewWeekStarted:()=>Ys,OpenGarrisonPopup:()=>Ws,OpenSplitUnitGroupPopup:()=>Lr,OpenUnitSlotsActionPopup:()=>qs,PlayerEntersTown:()=>id,PlayerEquipsItem:()=>vi,PlayerLeavesTown:()=>Gn,PlayerLevelsUp:()=>rd,PlayerLosesItem:()=>qi,PlayerOpensActionCards:()=>Nc,PlayerOpensHeroInfo:()=>kc,PlayerReceivesItem:()=>er,PlayerStartsFight:()=>zs,PlayerUnequipsItem:()=>dt,PlayersInitialized:()=>Ur,ScheduleAction:()=>Lc,ShowGameOverPopup:()=>Fc,StructCompleted:()=>Gr,StructFightConfirmed:()=>yi,StructSelected:()=>Xo,UnitGroupAddedToHero:()=>sd,UnitGroupRemovedFromHero:()=>Uc});var W={};M.r(W),M.d(W,{ActivateActionCard:()=>gt,AddActionCardsToPlayer:()=>jr,CleanUpHandlersOnFightEnd:()=>mo,DisplayPlayerRewardPopup:()=>hh,GameOpenMainScreen:()=>zi,GameOpenMapStructuresScreen:()=>Hc,InitBuilding:()=>vh,InitGameObjectApi:()=>gh,InitItem:()=>yh,InitSpell:()=>mh,InitStructure:()=>_h,MapPanCameraCenterTo:()=>_i,NavigateToView:()=>tr,OpenMainMenu:()=>Yi,OpenNewGameScreen:()=>Gc,OpenSettings:()=>Br,PushEventFeedMessage:()=>Ci,PushPlainEventFeedMessage:()=>nr,RemoveActionPoints:()=>yo});var Q={};M.r(Q),M.d(Q,{DisplayUnitGroupInfo:()=>jc,PlayerClicksAllyGroup:()=>$r,PlayerClicksEnemyGroup:()=>Bc,PlayerHoversGroupCard:()=>ni,PlayerRightClicksUnitGroup:()=>Ks});var k={};M.r(k),M.d(k,{GamePreparationFinished:()=>$0,PrepareGameEvent:()=>Zr});var n=M(729);let B=null;function $(){return B}class L{}const U=new n.OlP("DocumentToken"),bf=/\s+/,nv=[];let xr=(()=>{class r{constructor(o,a,u,h){this._iterableDiffers=o,this._keyValueDiffers=a,this._ngEl=u,this._renderer=h,this.initialClasses=nv,this.stateMap=new Map}set klass(o){this.initialClasses=null!=o?o.trim().split(bf):nv}set ngClass(o){this.rawClass="string"==typeof o?o.trim().split(bf):o}ngDoCheck(){for(const a of this.initialClasses)this._updateState(a,!0);const o=this.rawClass;if(Array.isArray(o)||o instanceof Set)for(const a of o)this._updateState(a,!0);else if(null!=o)for(const a of Object.keys(o))this._updateState(a,!!o[a]);this._applyStateDiff()}_updateState(o,a){const u=this.stateMap.get(o);void 0!==u?(u.enabled!==a&&(u.changed=!0,u.enabled=a),u.touched=!0):this.stateMap.set(o,{enabled:a,changed:!0,touched:!0})}_applyStateDiff(){for(const o of this.stateMap){const a=o[0],u=o[1];u.changed?(this._toggleClass(a,u.enabled),u.changed=!1):u.touched||(u.enabled&&this._toggleClass(a,!1),this.stateMap.delete(a)),u.touched=!1}}_toggleClass(o,a){(o=o.trim()).length>0&&o.split(bf).forEach(u=>{a?this._renderer.addClass(this._ngEl.nativeElement,u):this._renderer.removeClass(this._ngEl.nativeElement,u)})}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.ZZ4),n.Y36(n.aQg),n.Y36(n.SBq),n.Y36(n.Qsj))};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return r})(),et=(()=>{class r{constructor(o){this._viewContainerRef=o,this.ngComponentOutlet=null,this._inputsUsed=new Map}_needToReCreateNgModuleInstance(o){return void 0!==o.ngComponentOutletNgModule||void 0!==o.ngComponentOutletNgModuleFactory}_needToReCreateComponentInstance(o){return void 0!==o.ngComponentOutlet||void 0!==o.ngComponentOutletContent||void 0!==o.ngComponentOutletInjector||this._needToReCreateNgModuleInstance(o)}ngOnChanges(o){if(this._needToReCreateComponentInstance(o)&&(this._viewContainerRef.clear(),this._inputsUsed.clear(),this._componentRef=void 0,this.ngComponentOutlet)){const a=this.ngComponentOutletInjector||this._viewContainerRef.parentInjector;this._needToReCreateNgModuleInstance(o)&&(this._moduleRef?.destroy(),this._moduleRef=this.ngComponentOutletNgModule?(0,n.Lck)(this.ngComponentOutletNgModule,iv(a)):this.ngComponentOutletNgModuleFactory?this.ngComponentOutletNgModuleFactory.create(iv(a)):void 0),this._componentRef=this._viewContainerRef.createComponent(this.ngComponentOutlet,{injector:a,ngModuleRef:this._moduleRef,projectableNodes:this.ngComponentOutletContent})}}ngDoCheck(){if(this._componentRef){if(this.ngComponentOutletInputs)for(const o of Object.keys(this.ngComponentOutletInputs))this._inputsUsed.set(o,!0);this._applyInputStateDiff(this._componentRef)}}ngOnDestroy(){this._moduleRef?.destroy()}_applyInputStateDiff(o){for(const[a,u]of this._inputsUsed)u?(o.setInput(a,this.ngComponentOutletInputs[a]),this._inputsUsed.set(a,!1)):(o.setInput(a,void 0),this._inputsUsed.delete(a))}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.s_b))};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","ngComponentOutlet",""]],inputs:{ngComponentOutlet:"ngComponentOutlet",ngComponentOutletInputs:"ngComponentOutletInputs",ngComponentOutletInjector:"ngComponentOutletInjector",ngComponentOutletContent:"ngComponentOutletContent",ngComponentOutletNgModule:"ngComponentOutletNgModule",ngComponentOutletNgModuleFactory:"ngComponentOutletNgModuleFactory"},standalone:!0,features:[n.TTD]})}return r})();function iv(r){return r.get(n.h0i).injector}class rc{constructor(l,o,a,u){this.$implicit=l,this.ngForOf=o,this.index=a,this.count=u}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ie=(()=>{class r{set ngForOf(o){this._ngForOf=o,this._ngForOfDirty=!0}set ngForTrackBy(o){this._trackByFn=o}get ngForTrackBy(){return this._trackByFn}constructor(o,a,u){this._viewContainer=o,this._template=a,this._differs=u,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(o){o&&(this._template=o)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const o=this._ngForOf;!this._differ&&o&&(this._differ=this._differs.find(o).create(this.ngForTrackBy))}if(this._differ){const o=this._differ.diff(this._ngForOf);o&&this._applyChanges(o)}}_applyChanges(o){const a=this._viewContainer;o.forEachOperation((u,h,m)=>{if(null==u.previousIndex)a.createEmbeddedView(this._template,new rc(u.item,this._ngForOf,-1,-1),null===m?void 0:m);else if(null==m)a.remove(null===h?void 0:h);else if(null!==h){const _=a.get(h);a.move(_,m),ov(_,u)}});for(let u=0,h=a.length;u<h;u++){const _=a.get(u).context;_.index=u,_.count=h,_.ngForOf=this._ngForOf}o.forEachIdentityChange(u=>{ov(a.get(u.currentIndex),u)})}static ngTemplateContextGuard(o,a){return!0}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.s_b),n.Y36(n.Rgc),n.Y36(n.ZZ4))};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return r})();function ov(r,l){r.context.$implicit=l.item}let rt=(()=>{class r{constructor(o,a){this._viewContainer=o,this._context=new sc,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=a}set ngIf(o){this._context.$implicit=this._context.ngIf=o,this._updateView()}set ngIfThen(o){Ns("ngIfThen",o),this._thenTemplateRef=o,this._thenViewRef=null,this._updateView()}set ngIfElse(o){Ns("ngIfElse",o),this._elseTemplateRef=o,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(o,a){return!0}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.s_b),n.Y36(n.Rgc))};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return r})();class sc{constructor(){this.$implicit=null,this.ngIf=null}}function Ns(r,l){if(l&&!l.createEmbeddedView)throw new Error(`${r} must be a TemplateRef, but received '${(0,n.AaK)(l)}'.`)}class ac{constructor(l,o){this._viewContainerRef=l,this._templateRef=o,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(l){l&&!this._created?this.create():!l&&this._created&&this.destroy()}}let uo=(()=>{class r{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(o){this._ngSwitch=o,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(o){this._defaultViews.push(o)}_matchCase(o){const a=o===this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||a,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),a}_updateDefaultCases(o){if(this._defaultViews.length>0&&o!==this._defaultUsed){this._defaultUsed=o;for(const a of this._defaultViews)a.enforceState(o)}}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0})}return r})(),De=(()=>{class r{constructor(o,a,u){this.ngSwitch=u,u._addCase(),this._view=new ac(o,a)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.s_b),n.Y36(n.Rgc),n.Y36(uo,9))};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0})}return r})(),tt=(()=>{class r{constructor(o,a,u){this._ngEl=o,this._differs=a,this._renderer=u,this._ngStyle=null,this._differ=null}set ngStyle(o){this._ngStyle=o,!this._differ&&o&&(this._differ=this._differs.find(o).create())}ngDoCheck(){if(this._differ){const o=this._differ.diff(this._ngStyle);o&&this._applyChanges(o)}}_setStyle(o,a){const[u,h]=o.split("."),m=-1===u.indexOf("-")?void 0:n.JOm.DashCase;null!=a?this._renderer.setStyle(this._ngEl.nativeElement,u,h?`${a}${h}`:a,m):this._renderer.removeStyle(this._ngEl.nativeElement,u,m)}_applyChanges(o){o.forEachRemovedItem(a=>this._setStyle(a.key,null)),o.forEachAddedItem(a=>this._setStyle(a.key,a.currentValue)),o.forEachChangedItem(a=>this._setStyle(a.key,a.currentValue))}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.SBq),n.Y36(n.aQg),n.Y36(n.Qsj))};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return r})(),$o=(()=>{class r{constructor(o){this._viewContainerRef=o,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(o){if(this._shouldRecreateView(o)){const a=this._viewContainerRef;if(this._viewRef&&a.remove(a.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const u=this._createContextForwardProxy();this._viewRef=a.createEmbeddedView(this.ngTemplateOutlet,u,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(o){return!!o.ngTemplateOutlet||!!o.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(o,a,u)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,a,u),get:(o,a,u)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,a,u)}})}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.s_b))};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[n.TTD]})}return r})();class Eu{createSubscription(l,o){return(0,n.rg0)(()=>l.subscribe({next:o,error:a=>{throw a}}))}dispose(l){(0,n.rg0)(()=>l.unsubscribe())}}class Pu{createSubscription(l,o){return l.then(o,a=>{throw a})}dispose(l){}}const Mf=new Pu,Au=new Eu;let Zo=(()=>{class r{constructor(o){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=o}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(o){return this._obj?o!==this._obj?(this._dispose(),this.transform(o)):this._latestValue:(o&&this._subscribe(o),this._latestValue)}_subscribe(o){this._obj=o,this._strategy=this._selectStrategy(o),this._subscription=this._strategy.createSubscription(o,a=>this._updateLatestValue(o,a))}_selectStrategy(o){if((0,n.QGY)(o))return Mf;if((0,n.F4k)(o))return Au;throw function Ce(r,l){return new n.vHH(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(o,a){o===this._obj&&(this._latestValue=a,this._ref.markForCheck())}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.sBO,16))};static#t=this.\u0275pipe=n.Yjl({name:"async",type:r,pure:!1,standalone:!0})}return r})(),Fn=(()=>{class r{constructor(o){this.differs=o,this.keyValues=[],this.compareFn=Sf}transform(o,a=Sf){if(!o||!(o instanceof Map)&&"object"!=typeof o)return null;this.differ||(this.differ=this.differs.find(o).create());const u=this.differ.diff(o),h=a!==this.compareFn;return u&&(this.keyValues=[],u.forEachItem(m=>{this.keyValues.push(function Df(r,l){return{key:r,value:l}}(m.key,m.currentValue))})),(u||h)&&(this.keyValues.sort(a),this.compareFn=a),this.keyValues}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.aQg,16))};static#t=this.\u0275pipe=n.Yjl({name:"keyvalue",type:r,pure:!1,standalone:!0})}return r})();function Sf(r,l){const o=r.key,a=l.key;if(o===a)return 0;if(void 0===o)return 1;if(void 0===a)return-1;if(null===o)return 1;if(null===a)return-1;if("string"==typeof o&&"string"==typeof a)return o<a?-1:1;if("number"==typeof o&&"number"==typeof a)return o-a;if("boolean"==typeof o&&"boolean"==typeof a)return o<a?-1:1;const u=String(o),h=String(a);return u==h?0:u<h?-1:1}let Rn=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275mod=n.oAB({type:r});static#n=this.\u0275inj=n.cJS({})}return r})();function Bi(r){return"server"===r}class Bu extends L{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class vc extends Bu{static makeCurrent(){!function I(r){B||(B=r)}(new vc)}onAndCancel(l,o,a){return l.addEventListener(o,a),()=>{l.removeEventListener(o,a)}}dispatchEvent(l,o){l.dispatchEvent(o)}remove(l){l.parentNode&&l.parentNode.removeChild(l)}createElement(l,o){return(o=o||this.getDefaultDocument()).createElement(l)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(l){return l.nodeType===Node.ELEMENT_NODE}isShadowRoot(l){return l instanceof DocumentFragment}getGlobalEventTarget(l,o){return"window"===o?window:"document"===o?l:"body"===o?l.body:null}getBaseHref(l){const o=function ju(){return Ls=Ls||document.querySelector("base"),Ls?Ls.getAttribute("href"):null}();return null==o?null:function x0(r){$u=$u||document.createElement("a"),$u.setAttribute("href",r);const l=$u.pathname;return"/"===l.charAt(0)?l:`/${l}`}(o)}resetBaseElement(){Ls=null}getUserAgent(){return window.navigator.userAgent}getCookie(l){return function h0(r,l){l=encodeURIComponent(l);for(const o of r.split(";")){const a=o.indexOf("="),[u,h]=-1==a?[o,""]:[o.slice(0,a),o.slice(a+1)];if(u.trim()===l)return decodeURIComponent(h)}return null}(document.cookie,l)}}let $u,Ls=null,E0=(()=>{class r{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac})}return r})();const Lf=new n.OlP("EventManagerPlugins");let Ov=(()=>{class r{constructor(o,a){this._zone=a,this._eventNameToPlugin=new Map,o.forEach(u=>{u.manager=this}),this._plugins=o.slice().reverse()}addEventListener(o,a,u){return this._findPluginFor(a).addEventListener(o,a,u)}getZone(){return this._zone}_findPluginFor(o){let a=this._eventNameToPlugin.get(o);if(a)return a;if(a=this._plugins.find(h=>h.supports(o)),!a)throw new n.vHH(5101,!1);return this._eventNameToPlugin.set(o,a),a}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(Lf),n.LFG(n.R0b))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac})}return r})();class kv{constructor(l){this._doc=l}}const Gf="ng-app-id";let Nv=(()=>{class r{constructor(o,a,u,h={}){this.doc=o,this.appId=a,this.nonce=u,this.platformId=h,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Bi(h),this.resetHostNodes()}addStyles(o){for(const a of o)1===this.changeUsageCount(a,1)&&this.onStyleAdded(a)}removeStyles(o){for(const a of o)this.changeUsageCount(a,-1)<=0&&this.onStyleRemoved(a)}ngOnDestroy(){const o=this.styleNodesInDOM;o&&(o.forEach(a=>a.remove()),o.clear());for(const a of this.getAllStyles())this.onStyleRemoved(a);this.resetHostNodes()}addHost(o){this.hostNodes.add(o);for(const a of this.getAllStyles())this.addStyleToHost(o,a)}removeHost(o){this.hostNodes.delete(o)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(o){for(const a of this.hostNodes)this.addStyleToHost(a,o)}onStyleRemoved(o){const a=this.styleRef;a.get(o)?.elements?.forEach(u=>u.remove()),a.delete(o)}collectServerRenderedStyles(){const o=this.doc.head?.querySelectorAll(`style[${Gf}="${this.appId}"]`);if(o?.length){const a=new Map;return o.forEach(u=>{null!=u.textContent&&a.set(u.textContent,u)}),a}return null}changeUsageCount(o,a){const u=this.styleRef;if(u.has(o)){const h=u.get(o);return h.usage+=a,h.usage}return u.set(o,{usage:a,elements:[]}),a}getStyleElement(o,a){const u=this.styleNodesInDOM,h=u?.get(a);if(h?.parentNode===o)return u.delete(a),h.removeAttribute(Gf),h;{const m=this.doc.createElement("style");return this.nonce&&m.setAttribute("nonce",this.nonce),m.textContent=a,this.platformIsServer&&m.setAttribute(Gf,this.appId),o.appendChild(m),m}}addStyleToHost(o,a){const u=this.getStyleElement(o,a),h=this.styleRef,m=h.get(a)?.elements;m?m.push(u):h.set(a,{elements:[u],usage:1})}resetHostNodes(){const o=this.hostNodes;o.clear(),o.add(this.doc.head)}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(U),n.LFG(n.AFp),n.LFG(n.Ojb,8),n.LFG(n.Lbi))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac})}return r})();const Hf={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Bf=/%COMP%/g,A0=new n.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!0});function ho(r,l){return l.map(o=>o.replace(Bf,r))}let Zf=(()=>{class r{constructor(o,a,u,h,m,_,b,S=null){this.eventManager=o,this.sharedStylesHost=a,this.appId=u,this.removeStylesOnCompDestroy=h,this.doc=m,this.platformId=_,this.ngZone=b,this.nonce=S,this.rendererByCompId=new Map,this.platformIsServer=Bi(_),this.defaultRenderer=new Gs(o,m,b,this.platformIsServer)}createRenderer(o,a){if(!o||!a)return this.defaultRenderer;this.platformIsServer&&a.encapsulation===n.ifc.ShadowDom&&(a={...a,encapsulation:n.ifc.Emulated});const u=this.getOrCreateRenderer(o,a);return u instanceof Yf?u.applyToHost(o):u instanceof _c&&u.applyStyles(),u}getOrCreateRenderer(o,a){const u=this.rendererByCompId;let h=u.get(a.id);if(!h){const m=this.doc,_=this.ngZone,b=this.eventManager,S=this.sharedStylesHost,T=this.removeStylesOnCompDestroy,A=this.platformIsServer;switch(a.encapsulation){case n.ifc.Emulated:h=new Yf(b,S,a,this.appId,T,m,_,A);break;case n.ifc.ShadowDom:return new zf(b,S,o,a,m,_,this.nonce,A);default:h=new _c(b,S,a,T,m,_,A)}u.set(a.id,h)}return h}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(Ov),n.LFG(Nv),n.LFG(n.AFp),n.LFG(A0),n.LFG(U),n.LFG(n.Lbi),n.LFG(n.R0b),n.LFG(n.Ojb))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac})}return r})();class Gs{constructor(l,o,a,u){this.eventManager=l,this.doc=o,this.ngZone=a,this.platformIsServer=u,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(l,o){return o?this.doc.createElementNS(Hf[o]||o,l):this.doc.createElement(l)}createComment(l){return this.doc.createComment(l)}createText(l){return this.doc.createTextNode(l)}appendChild(l,o){(qf(l)?l.content:l).appendChild(o)}insertBefore(l,o,a){l&&(qf(l)?l.content:l).insertBefore(o,a)}removeChild(l,o){l&&l.removeChild(o)}selectRootElement(l,o){let a="string"==typeof l?this.doc.querySelector(l):l;if(!a)throw new n.vHH(-5104,!1);return o||(a.textContent=""),a}parentNode(l){return l.parentNode}nextSibling(l){return l.nextSibling}setAttribute(l,o,a,u){if(u){o=u+":"+o;const h=Hf[u];h?l.setAttributeNS(h,o,a):l.setAttribute(o,a)}else l.setAttribute(o,a)}removeAttribute(l,o,a){if(a){const u=Hf[a];u?l.removeAttributeNS(u,o):l.removeAttribute(`${a}:${o}`)}else l.removeAttribute(o)}addClass(l,o){l.classList.add(o)}removeClass(l,o){l.classList.remove(o)}setStyle(l,o,a,u){u&(n.JOm.DashCase|n.JOm.Important)?l.style.setProperty(o,a,u&n.JOm.Important?"important":""):l.style[o]=a}removeStyle(l,o,a){a&n.JOm.DashCase?l.style.removeProperty(o):l.style[o]=""}setProperty(l,o,a){l[o]=a}setValue(l,o){l.nodeValue=o}listen(l,o,a){if("string"==typeof l&&!(l=$().getGlobalEventTarget(this.doc,l)))throw new Error(`Unsupported event target ${l} for event ${o}`);return this.eventManager.addEventListener(l,o,this.decoratePreventDefault(a))}decoratePreventDefault(l){return o=>{if("__ngUnwrap__"===o)return l;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>l(o)):l(o))&&o.preventDefault()}}}function qf(r){return"TEMPLATE"===r.tagName&&void 0!==r.content}class zf extends Gs{constructor(l,o,a,u,h,m,_,b){super(l,h,m,b),this.sharedStylesHost=o,this.hostEl=a,this.shadowRoot=a.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const S=ho(u.id,u.styles);for(const T of S){const A=document.createElement("style");_&&A.setAttribute("nonce",_),A.textContent=T,this.shadowRoot.appendChild(A)}}nodeOrShadowRoot(l){return l===this.hostEl?this.shadowRoot:l}appendChild(l,o){return super.appendChild(this.nodeOrShadowRoot(l),o)}insertBefore(l,o,a){return super.insertBefore(this.nodeOrShadowRoot(l),o,a)}removeChild(l,o){return super.removeChild(this.nodeOrShadowRoot(l),o)}parentNode(l){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(l)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class _c extends Gs{constructor(l,o,a,u,h,m,_,b){super(l,h,m,_),this.sharedStylesHost=o,this.removeStylesOnCompDestroy=u,this.styles=b?ho(b,a.styles):a.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class Yf extends _c{constructor(l,o,a,u,h,m,_,b){const S=u+"-"+a.id;super(l,o,a,h,m,_,b,S),this.contentAttr=function O0(r){return"_ngcontent-%COMP%".replace(Bf,r)}(S),this.hostAttr=function k0(r){return"_nghost-%COMP%".replace(Bf,r)}(S)}applyToHost(l){this.applyStyles(),this.setAttribute(l,this.hostAttr,"")}createElement(l,o){const a=super.createElement(l,o);return super.setAttribute(a,this.contentAttr,""),a}}let Zu=(()=>{class r extends kv{constructor(o){super(o)}supports(o){return!0}addEventListener(o,a,u){return o.addEventListener(a,u,!1),()=>this.removeEventListener(o,a,u)}removeEventListener(o,a,u){return o.removeEventListener(a,u)}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(U))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac})}return r})();const Qf=["alt","control","meta","shift"],gi={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Wf={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey};let Jf=(()=>{class r extends kv{constructor(o){super(o)}supports(o){return null!=r.parseEventName(o)}addEventListener(o,a,u){const h=r.parseEventName(a),m=r.eventCallback(h.fullKey,u,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>$().onAndCancel(o,h.domEventName,m))}static parseEventName(o){const a=o.toLowerCase().split("."),u=a.shift();if(0===a.length||"keydown"!==u&&"keyup"!==u)return null;const h=r._normalizeKey(a.pop());let m="",_=a.indexOf("code");if(_>-1&&(a.splice(_,1),m="code."),Qf.forEach(S=>{const T=a.indexOf(S);T>-1&&(a.splice(T,1),m+=S+".")}),m+=h,0!=a.length||0===h.length)return null;const b={};return b.domEventName=u,b.fullKey=m,b}static matchEventFullKeyCode(o,a){let u=gi[o.key]||o.key,h="";return a.indexOf("code.")>-1&&(u=o.code,h="code."),!(null==u||!u)&&(u=u.toLowerCase()," "===u?u="space":"."===u&&(u="dot"),Qf.forEach(m=>{m!==u&&(0,Wf[m])(o)&&(h+=m+".")}),h+=u,h===a)}static eventCallback(o,a,u){return h=>{r.matchEventFullKeyCode(h,o)&&u.runGuarded(()=>a(h))}}static _normalizeKey(o){return"esc"===o?"escape":o}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(U))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac})}return r})();const Uv=(0,n.eFA)(n._c5,"browser",[{provide:n.Lbi,useValue:"browser"},{provide:n.g9A,useValue:function Rv(){vc.makeCurrent()},multi:!0},{provide:U,useFactory:function Or(){return(0,n.RDi)(document),document},deps:[]}]),Vu=new n.OlP(""),Xf=[{provide:n.rWj,useClass:class I0{addToWindow(l){n.dqk.getAngularTestability=(a,u=!0)=>{const h=l.findTestabilityInTree(a,u);if(null==h)throw new n.vHH(5103,!1);return h},n.dqk.getAllAngularTestabilities=()=>l.getAllTestabilities(),n.dqk.getAllAngularRootElements=()=>l.getAllRootElements(),n.dqk.frameworkStabilizers||(n.dqk.frameworkStabilizers=[]),n.dqk.frameworkStabilizers.push(a=>{const u=n.dqk.getAllAngularTestabilities();let h=u.length,m=!1;const _=function(b){m=m||b,h--,0==h&&a(m)};u.forEach(b=>{b.whenStable(_)})})}findTestabilityInTree(l,o,a){return null==o?null:l.getTestability(o)??(a?$().isShadowRoot(o)?this.findTestabilityInTree(l,o.host,!0):this.findTestabilityInTree(l,o.parentElement,!0):null)}},deps:[]},{provide:n.lri,useClass:n.dDg,deps:[n.R0b,n.eoX,n.rWj]},{provide:n.dDg,useClass:n.dDg,deps:[n.R0b,n.eoX,n.rWj]}],ei=[{provide:n.zSh,useValue:"root"},{provide:n.qLn,useFactory:function Hs(){return new n.qLn},deps:[]},{provide:Lf,useClass:Zu,multi:!0,deps:[U,n.R0b,n.Lbi]},{provide:Lf,useClass:Jf,multi:!0,deps:[U]},Zf,Nv,Ov,{provide:n.FYo,useExisting:Zf},{provide:class Pf{},useClass:E0,deps:[]},[]];let eh=(()=>{class r{constructor(o){}static withServerTransition(o){return{ngModule:r,providers:[{provide:n.AFp,useValue:o.appId}]}}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(Vu,12))};static#t=this.\u0275mod=n.oAB({type:r});static#n=this.\u0275inj=n.cJS({providers:[...ei,...Xf],imports:[Rn,n.hGG]})}return r})();typeof window<"u"&&window;let Yu=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275prov=n.Yz7({token:r,factory:function(a){let u=null;return u=a?new(a||r):n.LFG($e),u},providedIn:"root"})}return r})(),$e=(()=>{class r extends Yu{constructor(o){super(),this._doc=o}sanitize(o,a){if(null==a)return null;switch(o){case n.q3G.NONE:return a;case n.q3G.HTML:return(0,n.qzn)(a,"HTML")?(0,n.z3N)(a):(0,n.EiD)(this._doc,String(a)).toString();case n.q3G.STYLE:return(0,n.qzn)(a,"Style")?(0,n.z3N)(a):a;case n.q3G.SCRIPT:if((0,n.qzn)(a,"Script"))return(0,n.z3N)(a);throw new n.vHH(5200,!1);case n.q3G.URL:return(0,n.qzn)(a,"URL")?(0,n.z3N)(a):(0,n.mCW)(String(a));case n.q3G.RESOURCE_URL:if((0,n.qzn)(a,"ResourceURL"))return(0,n.z3N)(a);throw new n.vHH(5201,!1);default:throw new n.vHH(5202,!1)}}bypassSecurityTrustHtml(o){return(0,n.JVY)(o)}bypassSecurityTrustStyle(o){return(0,n.L6k)(o)}bypassSecurityTrustScript(o){return(0,n.eBb)(o)}bypassSecurityTrustUrl(o){return(0,n.LAX)(o)}bypassSecurityTrustResourceUrl(o){return(0,n.pB0)(o)}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(U))};static#t=this.\u0275prov=n.Yz7({token:r,factory:function(a){let u=null;return u=a?new a:function oh(r){return new $e(r.get(U))}(n.LFG(n.zs3)),u},providedIn:"root"})}return r})(),qt=0;function ct(r=""){const l={__id:qt,__name:r,__type:null},o=function(a={}){return{__eventType:l,...a}};return o.__typeInfo=l,l.__type=o,qt++,o}var Ft=M(152),_n=M(254);function Mc(r,l){return function(a){return a.lift(new ah(r,l))}}class ah{constructor(l,o){this.predicate=l,this.thisArg=o}call(l,o){return o.subscribe(new $v(l,this.predicate,this.thisArg))}}class $v extends _n.L{constructor(l,o,a){super(l),this.predicate=o,this.thisArg=a,this.count=0}_next(l){let o;try{o=this.predicate.call(this.thisArg,l,this.count++)}catch(a){return void this.destination.error(a)}o&&this.destination.next(l)}}let Ze=(()=>{class r{dispatch(o){this.eventStream$.next(o)}constructor(){this.eventStream$=new Ft.xQ}onEvent(o){return this.eventStream$.pipe(Mc(a=>a.__eventType.__id===o.__typeInfo.__id))}events(...o){const a=new Map;return o.forEach(u=>a.set(u.eventType.__typeInfo.__id,u.fn)),this.eventStream$.pipe(Mc(u=>{const h=a.get(u.__eventType.__id);return!!h&&(h(u),!0)}))}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function ti({events:r,prefix:l}){return Object.entries(r).forEach(([o,a])=>{const u=a.__typeInfo.__name;a.__typeInfo.__name=`${l}:${o}`+(u?`, ${u}`:"")}),{events:r,getEventByName:o=>r[o]}}const js=Symbol("Class members configs"),lh=Symbol("Class type marker");function Wu(r,l){const o=Object.getPrototypeOf(r);return o?o[lh]===l?o:Wu(o,l):null}function Sc(r,l,o,a,u,h){const m=o.value,_=r.constructor,b=Wu(_,"store");if(!b)throw new Error(`[Store Feature] ${u} Error. Class ${_.name} must extend StoreClient(). Method ${_.name}.${l}.`);if("function"!=typeof m)throw new Error(`[Store Feature] ${u} Error. ${u} in ${_.name}.${l} must be applied to method.`);b[js].push({type:h,method:m,event:a})}function Ee(r){return function(l,o,a){Sc(l,o,a,r,`@Notify(${r.name})`,"notify")}}function re(r){return function(l,o,a){Sc(l,o,a,r,`@WireEvent(${r.name})`,"wire")}}var Ju=M(902),Ku=M(846);function Xe(r){return l=>l.lift(new Yo(r))}class Yo{constructor(l){this.notifier=l}call(l,o){const a=new it(l),u=(0,Ku.ft)(this.notifier,new Ku.IY(a));return u&&!a.seenValue?(a.add(u),o.subscribe(a)):a}}class it extends Ku.Ds{constructor(l){super(l),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function bt(){var r,l;return class{static#e=(r=js,l=lh);static#t=this[r]=[];static#n=this[l]="store";constructor(){this.events=(0,n.f3M)(Ze),this.destroyed$=new Ft.xQ,this.plainSubscriptions=new Ju.w,this.untilDestroyed=u=>u.pipe(Xe(this.destroyed$));const o=this;Object.getPrototypeOf(this).constructor[js].forEach(u=>{const h=u.event;if("wire-prop"===u.type)return;const m=u.method;switch(u.type){case"wire":this.events.onEvent(h).pipe(this.untilDestroyed).subscribe(b=>{m.apply(this,[b])});break;case"notify":this.events.onEvent(h).pipe(this.untilDestroyed).subscribe(()=>{m.apply(this)});break;case"subscribeEvent":const _=m.apply(o,[this.events.onEvent(h)]);this.plainSubscriptions.add(_)}})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete(),this.plainSubscriptions.unsubscribe()}}}const Pt=ct,Tc=Pt(""),Xu=Pt(),kr=Pt(),Qo=Pt(),Nr=Pt(),Un=Pt(),ed=Pt(),Wo=Pt(),$s=Pt(),Fr=Pt(),xc=Pt(),Rr=Pt(),Ic=Pt(),td=Pt(),mi=Pt(),Jo=Pt(),Ko=Pt(),Vi=Pt("Fight Ends"),Ec=Pt(),Pc=ct,nd=Pc(),dh=Pc(),ph=Pc(),Zs=Pc();ti({prefix:"Battle",events:H}),ti({prefix:"BattleCommands",events:N});var Ln=function(r){return r.GroupAttacks="attacks",r.GroupCounterattacks="counterattacks",r.AttackInteractionCompleted="completed",r}(Ln||{});const Fe=ct,fh=Fe(),Oc=Fe(),Ur=Fe(),id=Fe(),Gn=Fe(),kc=Fe(),Lr=Fe(),qs=Fe(),Nc=Fe(),Xo=Fe(),zs=Fe(),od=Fe(),go=Fe(),Gr=Fe(),Fc=Fe(),Rc=Fe(),Ys=Fe(),Hr=Fe(),yi=Fe(),Qs=Fe(),Ws=Fe(),er=Fe(),qi=Fe(),vi=Fe(),dt=Fe(),rd=Fe(),sd=Fe(),Uc=Fe(),Lc=Fe();var Hn=function(r){return r.MainScreen="main-screen",r.NewGame="new-game",r.Structures="structures",r.Battleground="battleground",r.Town="town",r}(Hn||{});const Mt=ct,mo=Mt("Clear spells and items registries on fight end"),_i=Mt("Pan camera on the map"),zi=Mt("Open Main Screen"),Gc=Mt("Open New Game Screen"),Br=Mt("Open Game settings"),Yi=Mt("Open Main menu"),tr=Mt("Navigate To View"),Hc=Mt("Open map structures screen"),hh=Mt(),gh=Mt(),mh=Mt(),yh=Mt(),vh=Mt(),_h=Mt(),Ci=Mt(),nr=Mt(),yo=Mt(),gt=Mt(),jr=Mt(),wi=(ti({events:q,prefix:"GameEvents"}),ti({events:W,prefix:"GameCommands"}),ct),Bc=wi(),$r=wi(),ni=wi(),Ks=wi(),jc=wi();var fn=function(r){return r[r.EnemyCard=0]="EnemyCard",r[r.AllyCard=1]="AllyCard",r[r.Unhover=2]="Unhover",r}(fn||{});ti({events:Q,prefix:"UI"});const $c=ct,Zr=$c("Player started new game, waiting for GamePreparationFinished event to prepare the map."),$0=$c("Map is prepared, player can start the game"),Zc=ti({events:k,prefix:"Triggers"}).events;var ad=function(r){return r.Normal="normal",r}(ad||{}),ce=M(318),Qi=M(688),x=M(231),ir=M(785),se=function(r){return r.Target="target",r.Instant="instant",r.Passive="passive",r.Debuff="debuff",r.Buff="buff",r}(se||{});const Vc=[se.Buff,se.Debuff],Yv=[se.Buff,se.Debuff,se.Passive];let qc=(()=>{class r extends ir.l{constructor(){super(...arguments),this.currentLevel=1}static#e=this.categoryId="spell";create({spellBaseType:o,initialLevel:a,state:u}){this.baseType=o,this.currentLevel=a,this.name=this.baseType.name,this.state=u,this.sourceInfo={},this.updateCurrentManaCost()}updateCurrentManaCost(){this.currentManaCost=this.baseType.config.spellConfig.getManaCost?.(this)||0}setOwnerObjectId(o){this.sourceInfo.ownerUnitObjectId=o}setSourceGameObjectId(o){this.sourceInfo.gameObjectId=o}levelUp(){this.currentLevel+=1,this.updateCurrentManaCost();const o=this.sourceInfo.ownerUnitObjectId;o&&this.baseType.config.spellConfig.onAcquired?.({spellInstance:this,ownerUnit:this.getApi().gameObjects.getObjectByFullId(o)})}isEffect(){return function Qv(r){return Vc.includes(r.baseType.activationType)}(this)}isPassive(){return Yv.includes(this.baseType.activationType)}}return r})();var pt=M(284),vo=function(r){return r[r.Icon=0]="Icon",r[r.Html=1]="Html",r[r.Customizable=2]="Customizable",r}(vo||{}),_o=function(r){return r[r.VfxElement=0]="VfxElement",r}(_o||{});const Me=(r,l)=>({icon:r,id:l,type:vo.Icon}),cd=r=>({id:r,type:vo.Customizable}),zt=r=>{const l={config:{layout:"default"},elements:[],elemsKeyframes:{},elemsDefaultStyles:{}};return r.forEach(([o,a,u])=>{l.elements.push(o),l.elemsKeyframes[o.id]=a,l.elemsDefaultStyles[o.id]=u}),l},$n=(r=0,l=0)=>{const o="translate(-50%, -50%) scale(1)";return[{opacity:0+l,offset:.001+r},{opacity:.3+l,transform:o,offset:.3+r},{opacity:.3+l,transform:o,offset:.5+r},{opacity:.3+l,transform:o},{opacity:0+l,transform:o}]},Yc=(r,l="rgb(244 162 124)")=>zt([[Me(r,"fire-main"),[{opacity:"0"},{opacity:"1",offset:.25},{opacity:"1",offset:.35},{offset:.76,opacity:"0"},{opacity:"0"}],{fontSize:"64px",color:l,opacity:"1"}],[Me(r,"fire-blur"),[{filter:"blur(10px)"},{filter:"blur(0px)",offset:.4},{filter:"blur(0px)",opacity:0}],{fontSize:"64px",color:l,filter:"blur(6px)",opacity:"1",mixBlendMode:"hard-light"}],[Me(r,"fire-pulse"),[{opacity:"0"},{opacity:"0.2",transform:"translate(-50%, -50%) scale(1.2)",offset:.25},{opacity:"0.3",transform:"translate(-50%, -50%) scale(1.5)",offset:.35},{offset:.76,transform:"translate(-50%, -50%) scale(1.6)",opacity:"0"},{opacity:"0"}],{fontSize:"64px",color:l,opacity:"0.2",transform:"translate(-50%, -50%) scale(1)",mixBlendMode:"hard-light"}]]);function Qc(r,l){return zt([[Me(r,"bw-1"),$n(),{transform:"translate(-50%, -50%) scale(3)",fontSize:"64px",color:"rgb(213 197 223)",opacity:"0"}],[Me(r,"bw-2"),$n(.2),{transform:"translate(-50%, -50%) scale(3)",fontSize:"64px",color:"rgb(213 197 223)",opacity:"0"}],[Me(r,"bw-3"),$n(.4),{transform:"translate(-50%, -50%) scale(3)",fontSize:"64px",color:"rgb(213 197 223)",opacity:"0"}],[Me(r,"bw-blur"),[{filter:"blur(10px)"},{filter:"blur(10px)",offset:.4,opacity:1},{filter:"blur(0px)",opacity:0,transform:"translate(-50%, -50%) scale(1)"}],{transform:"translate(-50%, -50%) scale(1.5)",fontSize:"64px",color:l,filter:"blur(6px)",opacity:"0",mixBlendMode:"hard-light"}]])}const Wv=zt([[Me("focused-lightning","l-main"),[{opacity:"0"},{opacity:"1",offset:.05},{opacity:"1",offset:.15},{opacity:"0",offset:.16},{opacity:"0",offset:.2},{opacity:"1",offset:.23},{opacity:"0"}],{fontSize:"64px",color:"#eaefff",opacity:"1"}],[Me("focused-lightning","l-blur"),[{filter:"blur(10px)"},{filter:"blur(10px)",offset:.4},{filter:"blur(0px)",opacity:0,transform:"translate(-50%, -50%) scale(1)"}],{transform:"translate(-50%, -50%) scale(1.5)",fontSize:"64px",color:"#98abff",filter:"blur(6px)",opacity:"1",mixBlendMode:"hard-light"}]]),bh=Yc("fire"),Jv=Qc("batwings","rgba(218, 137, 204, 0.78)"),Xs=Qc("bat-sword","rgba(245, 10, 20, 0.8)"),Mh=zt([[Me("fire-ring","fr-main"),[{opacity:"0"},{opacity:"1",offset:.25},{opacity:"1",offset:.35},{offset:.76,opacity:"0"},{opacity:"0"}],{fontSize:"64px",color:"white",opacity:"1"}],[Me("fire-ring","fr-blur"),[{filter:"blur(10px)"},{filter:"blur(0px)",offset:.4},{filter:"blur(0px)",opacity:0}],{fontSize:"64px",color:"violet",filter:"blur(6px)",opacity:"1",mixBlendMode:"hard-light"}],[Me("fire-ring","fr-pulse"),[{opacity:"0"},{opacity:"0.2",transform:"translate(-50%, -50%) scale(1.2)",offset:.25},{opacity:"0.3",transform:"translate(-50%, -50%) scale(1.5)",offset:.35},{offset:.76,transform:"translate(-50%, -50%) scale(1.6)",opacity:"0"},{opacity:"0"}],{fontSize:"64px",color:"pink",opacity:"0.2",transform:"translate(-50%, -50%) scale(1)",mixBlendMode:"hard-light"}]]),ea={textShadow:"0px 0px 5px rgba(0, 0, 0, 1)"},Wc=zt([[cd("elem"),[],{fontSize:"24px",position:"relative",top:"17px",left:"10px",color:"white",...ea}]]),Dh=zt([[cd("elem"),[],{fontSize:"24px",color:"white",...ea}]]),Kv=zt([[Me("burning-book","bm"),[],{fontSize:"34px",color:"#bfcbff",opacity:.7,...ea}],[Me("burning-book","bm2"),$n(0,.2),{fontSize:"34px",color:"#bfcbff",mixBlendMode:"screen"}],[Me("burning-book","book-blur"),[{opacity:"0"},{opacity:"0.2",transform:"translate(-50%, -50%) scale(1.2)",offset:.25},{opacity:"0.3",transform:"translate(-50%, -50%) scale(1.5)",offset:.35},{offset:.76,transform:"translate(-50%, -50%) scale(1.6)",opacity:"0"},{opacity:"0"}],{fontSize:"36px",filter:"blur(6px)",color:"#98abff",mixBlendMode:"screen"}],[Me("burning-book","book-blur2"),[{opacity:"0"},{opacity:"0.2",transform:"translate(-50%, -50%) scale(1.2)",offset:.25},{opacity:"0.3",transform:"translate(-50%, -50%) scale(1.5)",offset:.35},{offset:.76,transform:"translate(-50%, -50%) scale(1.6)",opacity:"0"},{opacity:"0"}],{fontSize:"36px",filter:"blur(6px)",color:"#98abff"}]]),Sh=zt([[cd("msg"),[{fontSize:"13px"},{offset:.3,opacity:1,transform:"translate(10px, -50px) scale(1.5)"},{opacity:0,transform:"translate(20px, -100px) scale(0.8)"}],{opacity:.3,fontSize:"15px"}]]),Th=zt([[("msg",{id:"msg",type:vo.Html}),[{offset:0,opacity:0,transform:"translate(0, -50px)"},{offset:.2,opacity:1,transform:"translate(0, -10px)"},{offset:.8,opacity:1,transform:"translate(0, -10px)"},{opacity:0,transform:"translate(0, 0px)"}],{fontSize:"15px"}]]),Vr=({icon:r,iconColor:l="white",bgColor:o="transparent"})=>`<i class='ra ra-${r}' style="background: ${o}; color: ${l}"></i>`,or=r=>`${(({icon:r,iconColor:l,bgColor:o})=>`<i class='ra ra-${r}' style="background: ${o}; color: ${l}"></i>`)(r)} <span style="font-weight: 600;">${r.title}</span>`,xh=r=>`${Math.round(100*r)}`,Jc=r=>`${Math.round(100*r)}%`,Ih=(r,l)=>r===l?`${r} `:`${r}-${l} `,Eh=r=>0===r?r:r>0?`+${r}`:`-${r}`,Zn=(r,l,o=!1,a=0,u=!1)=>({parts:[{type:"plainPart",icon:o?"broadhead-arrow":"sword",text:`<span style="${u?"font-weight: 800;":""}">${r}</span>`,color:u?"#ff8100":"red"},...a?[{type:"plainPart",icon:"shield",color:"yellow",text:a}]:[],{type:"plainPart",icon:"skull",text:l,color:"white"}]}),Ph=(r,l)=>({parts:[{type:"plainPart",icon:"double-team",text:r,color:"white"},{type:"plainPart",icon:"health",text:l,color:"#5fc960"}]}),Wi=(r,{fontSize:l=15,width:o=100}={})=>`<div style="margin-top: 4px; text-align: center; width: ${o}px; font-size:${l}px; background:rgba(0,0,0,0.6); padding: 2px; border-radius: 5px;">${r}</div>`,Ah=(r,l=r.count)=>`<span style="color: ${r.ownerPlayer.color}; font-weight: 500">${l} ${r.type.name}</span>`,ve=r=>((0,pt.uB)(r),r),en=({isEnemy:r,unitGroup:l})=>r&&l.fightInfo.isAlive,Xc=({isEnemy:r})=>!r,qr={bgClr:ce.wL.DefautlDebuffBg,iconClr:ce.wL.DefautlDebuffClr},dd={bgClr:ce.wL.DefautlBuffBg,iconClr:ce.wL.DefautlBuffClr},el=(ve({id:"#spell-blindness",name:"Blindness",activationType:se.Instant,icon:{icon:"sunbeams"},getDescription:()=>({descriptions:[(0,x.bk)("Decreases damage of target enemy group by 15%.")]}),config:{spellConfig:{getManaCost:r=>0,init:()=>{}}}}),ve({id:"#spell-enchant-buff",name:"Enchanted",activationType:se.Debuff,icon:{icon:"fire-ring",...qr},getDescription:()=>({descriptions:[(0,x.bk)("Incoming damage from spells is increased by 17%.")]}),config:{spellConfig:{init:({events:r,actions:l,vfx:o})=>{const a=l.createModifiers({amplifiedTakenMagicDamagePercent:.17});r.on({SpellPlacedOnUnitGroup(u){o.createEffectForUnitGroup(u.target,Mh,{duration:1e3}),l.addModifiersToUnitGroup(u.target,a)}})}}}})),q0=ve({id:"#spell-enchant",name:"Enchant",activationType:se.Target,icon:{icon:"fire-ring"},getDescription:()=>({descriptions:[(0,x.bk)("Enchants an enemy to receive increased damage from spells by 17%")]}),config:{spellConfig:{targetCastConfig:{canActivate:en},getManaCost:r=>({1:2,2:2,3:3,4:3}[r.currentLevel]),init:({events:r,actions:l,ownerPlayer:o})=>{r.on({PlayerTargetsSpell(a){const u=l.createSpellInstance(el);l.addSpellToUnitGroup(a.target,u,o),l.historyLog("Enemy is enchanted")}})}}}}),zr="hospital-cross",tl={fontSize:"64px",color:"rgb(200 244 124)"},e_=zt([[Me(zr,"fire-main"),[{opacity:"0"},{opacity:"1",offset:.25},{opacity:"1",offset:.35},{offset:.76,opacity:"0"},{opacity:"0"}],{...tl,opacity:"1"}],[Me(zr,"fire-blur"),[{filter:"blur(10px)"},{filter:"blur(0px)",offset:.4},{filter:"blur(0px)",opacity:0}],{...tl,filter:"blur(6px)",opacity:"1",mixBlendMode:"hard-light"}],[Me(zr,"fire-pulse"),$n(),{...tl,opacity:"0.2",transform:"translate(-50%, -50%) scale(1)",mixBlendMode:"hard-light"}]]),hd=ve({id:"#spell-revitalize",name:"Revitalize",activationType:se.Target,icon:{icon:zr},getDescription:r=>({descriptions:[(0,x.bk)(`Heals friendly unit group by ${20*r.ownerUnit.count}. Heal increases by 20 per each Firebird in current group.`)]}),config:{spellConfig:{targetCastConfig:{canActivate:Xc},getManaCost:r=>2,init:({events:r,actions:l,ownerUnit:o,vfx:a})=>{r.on({PlayerTargetsSpell(u){const h=o,m=20*h.count,_=u.target,b=_.type.name,S=l.healUnit(_,m);a.createEffectForUnitGroup(_,e_,{duration:800});const T=S.revivedUnitsCount;l.historyLog(`${h.count} ${h.type.name} heal ${b} by ${m}.`),l.historyLog(`${T} of ${b} are brought back to life.`),a.createFloatingMessageForUnitGroup(u.target,Ph(T,m),{duration:1600})}})}}}}),Nh=ve({id:"#spell-fright-debuff",name:"Fright",activationType:se.Debuff,icon:{icon:"batwings",...qr},getDescription:()=>({descriptions:[(0,x.bk)("This unit group is frightened, dealing 25% less damage to the one who scared it.")]}),config:{spellConfig:{init({actions:r,events:l,spellInstance:o,vfx:a,ownerHero:u}){l.on({SpellPlacedOnUnitGroup({target:h}){const m=u.modGroup.getModValue("specialtyNecromancy")||0,_=r.createModifiers({__attackConditionalModifiers:b=>m||b.attacked!==o.state?.frighter?m>=1?b.attacked===o.state?.frighter?{baseDamagePercentModifier:-.25}:b.attacked.modGroup.getModValue("isGhost")?{baseDamagePercentModifier:-.17}:{baseDamagePercentModifier:-.12}:{}:{baseDamagePercentModifier:-.25}});a.createEffectForUnitGroup(h,Jv,{duration:1e3}),r.addModifiersToUnitGroup(h,_)}})}}}}),Fh=ve({id:"#spell-fright",name:"Fright",activationType:se.Passive,icon:{icon:"batwings"},getDescription:r=>({descriptions:[(0,x.bk)("Scares enemy group on attack, reducing damage against this group by 25%.  Ability Improves with Necromancy, reducing damage against all your units.")]}),config:{spellConfig:{init({actions:r,events:l,ownerPlayer:o,ownerUnit:a}){l.on({UnitGroupAttacks({attacked:u,attacker:h}){if(a!==h||u.spells.find(_=>_.baseType===Nh))return;const m=r.createSpellInstance(Nh,{state:{frighter:h}});r.addSpellToUnitGroup(u,m,o)}})}}}});var At=function(r){return r.PhysicalAttack="physAttack",r.Physical="physical",r.Magic="magic",r.Fire="fire",r.Cold="cold",r.Poison="poison",r.Lightning="lightning",r.Astral="astral",r}(At||{});const na="frost-emblem",nl={fontSize:"64px",color:"#a9bee2"},Vn=zt([[Me(na,"fire-main"),[{opacity:"0"},{opacity:"1",offset:.25},{opacity:"1",offset:.35},{offset:.76,opacity:"0"},{opacity:"0"}],{...nl,opacity:"1"}],[Me(na,"fire-blur"),[{filter:"blur(10px)"},{filter:"blur(0px)",offset:.4},{filter:"blur(0px)",opacity:0}],{...nl,filter:"blur(6px)",opacity:"1",mixBlendMode:"hard-light"}],[Me(na,"fire-pulse"),$n(),{...nl,opacity:"0.2",transform:"translate(-50%, -50%) scale(1)",mixBlendMode:"hard-light"}]]),Rh=ve({id:"#spell-frost-arrow-debuff",name:"Freeze",activationType:se.Debuff,icon:{icon:na,...qr,bgClr:"#a9bee2"},getDescription:r=>({descriptions:[(0,x.bk)("Unit group is slowed down by 4, attack rating reduced by 3.")]}),config:{spellConfig:{init:({events:r,actions:l,vfx:o,thisSpell:a})=>{const u=l.createModifiers({unitGroupSpeedBonus:-4,heroBonusAttack:-3});r.on({SpellPlacedOnUnitGroup({target:h}){o.createEffectForUnitGroup(h,Vn,{duration:800}),l.addModifiersToUnitGroup(h,u),l.historyLog(`${h.type.name} receives ${a.name} debuff, slowed by 4 and gains -3 attack rating penalty.`)}})}}}}),ia=ve({id:"#spell-frost-arrow",name:"Frost Arrow",activationType:se.Target,icon:{icon:"frozen-arrow"},getDescription:r=>({descriptions:[(0,x.bk)("Deals 40 magic damage, slows enemy by 4 and reduces attack rating by 3.")]}),config:{spellConfig:{targetCastConfig:{canActivate:en},getManaCost:r=>({1:2,2:2,3:3,4:3}[r.currentLevel]),init:({events:r,actions:l,ownerPlayer:o,ownerHero:a,thisSpell:u,vfx:h})=>{r.on({PlayerTargetsSpell:m=>{const _=l.createSpellInstance(Rh);l.addSpellToUnitGroup(m.target,_,o),l.dealDamageTo(m.target,40,At.Cold,({finalDamage:b,unitLoss:S})=>{const T=m.target.type.name;l.historyLog(`${a.name} deals ${b} damage to ${T} with ${u.name}, ${S} ${T} perishes`),h.createFloatingMessageForUnitGroup(m.target,Zn(b,S),{duration:1e3})})}})}}}}),oa="boot-stomp",md={fontSize:"64px",color:"rgb(200 244 124)"},yd=zt([[Me(oa,"fire-main"),[{opacity:"0"},{opacity:"1",offset:.25},{opacity:"1",offset:.35},{offset:.76,opacity:"0"},{opacity:"0"}],{...md,opacity:"1"}],[Me(oa,"fire-blur"),[{filter:"blur(10px)"},{filter:"blur(0px)",offset:.4},{filter:"blur(0px)",opacity:0}],{...md,filter:"blur(6px)",opacity:"1",mixBlendMode:"hard-light"}],[Me(oa,"fire-pulse"),$n(),{...md,opacity:"0.2",transform:"translate(-50%, -50%) scale(1)",mixBlendMode:"hard-light"}]]),Co=ve({id:"#spell-haste-buff",name:"Haste",activationType:se.Buff,icon:{icon:oa,...dd},getDescription:()=>({descriptions:[(0,x.bk)("Unit group is speeded up by 5.")]}),config:{spellConfig:{init:({events:r,actions:l,vfx:o})=>{const a=l.createModifiers({unitGroupSpeedBonus:5});r.on({SpellPlacedOnUnitGroup(u){o.createEffectForUnitGroup(u.target,yd,{duration:800}),l.addModifiersToUnitGroup(u.target,a)}})}}}}),Uh=ve({id:"#spell-haste",name:"Haste",activationType:se.Target,icon:{icon:oa},getDescription:()=>({descriptions:[(0,x.bk)("Target unit group is speeding up by 5."),(0,x.bk)("When upgraded, increases the speed bonus and starts to grant a chance to gain additional turn to units.")]}),config:{spellConfig:{targetCastConfig:{canActivate:Xc},getManaCost:r=>({1:2,2:2,3:3,4:3}[r.currentLevel]),init:({events:r,actions:l,ownerPlayer:o})=>{r.on({PlayerTargetsSpell(a){const u=l.createSpellInstance(Co);l.addSpellToUnitGroup(a.target,u,o)}})}}}}),ol="hospital-cross",rl={fontSize:"64px",color:"rgb(200 244 124)"},_d=zt([[Me(ol,"fire-main"),[{opacity:"0"},{opacity:"1",offset:.25},{opacity:"1",offset:.35},{offset:.76,opacity:"0"},{opacity:"0"}],{...rl,opacity:"1"}],[Me(ol,"fire-blur"),[{filter:"blur(10px)"},{filter:"blur(0px)",offset:.4},{filter:"blur(0px)",opacity:0}],{...rl,filter:"blur(6px)",opacity:"1",mixBlendMode:"hard-light"}],[Me(ol,"fire-pulse"),$n(),{...rl,opacity:"0.2",transform:"translate(-50%, -50%) scale(1)",mixBlendMode:"hard-light"}]]),Gh=(ve({id:"#spell-heal",name:"Heal",activationType:se.Target,icon:{icon:ol},getDescription:r=>({descriptions:[]}),config:{spellConfig:{targetCastConfig:{canActivate:Xc},getManaCost:r=>({1:2,2:2,3:3,4:3}[r.currentLevel]),init:({events:r,actions:l,ownerPlayer:o,vfx:u})=>{r.on({PlayerTargetsSpell(h){const _=h.target.count,b=h.target;l.healUnit(b,64),u.createEffectForUnitGroup(b,_d,{duration:800});const T=b.type.name,A=h.target.count-_;l.historyLog(`${o.hero.name} heals ${T} by 64.`),l.historyLog(`${A} of ${T} are brought back to life.`),u.createFloatingMessageForUnitGroup(h.target,Ph(A,64),{duration:1e3})}})}}}}),"player-despair"),t_=ve({id:"#spell-kneeling-light-debuff",name:"Slowed",activationType:se.Debuff,icon:{icon:Gh,...qr},getDescription:r=>({descriptions:[(0,x.bk)("Unit group is slowed down by 50%.")]}),config:{spellConfig:{init:({events:r,actions:l,vfx:o})=>{r.on({SpellPlacedOnUnitGroup(a){const h=l.createModifiers({unitGroupSpeedBonus:-.5*a.target.type.baseStats.speed});o.createEffectForUnitGroup(a.target,Qc("player-despair","rgb(227, 240, 113)"),{duration:1e3}),l.addModifiersToUnitGroup(a.target,h)}})}}}}),n_=ve({id:"#spell-kneeling-light",name:"Kneeling Light",icon:{icon:Gh},getDescription:r=>({descriptions:[(0,x.bk)("Makes light so heavy for the enemy target that it loses 50% of the speed.")]}),activationType:se.Target,config:{spellConfig:{targetCastConfig:{canActivate:en},getManaCost:r=>({1:2,2:2,3:3,4:3}[r.currentLevel]),init:({events:r,actions:l,ownerPlayer:o})=>{r.on({PlayerTargetsSpell(a){const u=l.createSpellInstance(t_);l.addSpellToUnitGroup(a.target,u,o)}})}}}});var Te=M(429);const hn=ve({id:"#spell-meteor",name:"Meteor",activationType:se.Instant,icon:{icon:"burning-meteor"},getDescription({spellInstance:r}){const l=31*r.currentLevel;return{descriptions:[(0,x.bk)(`Meteor deals ${82+l}-${124+l} fire damage to random enemy group, next 2 unit groups after current group in fight queue (enemies or allies) will be stunned and will lose their turns.`)]}},config:{spellConfig:{getManaCost:r=>({1:6,2:7,3:7,4:8}[r.currentLevel]),init({events:r,actions:l,thisSpell:o,ownerHero:a,vfx:u,spellInstance:h}){r.on({PlayerCastsInstantSpell(m){const _=l.getRandomEnemyPlayerGroup(),b=31*h.currentLevel;u.createEffectForUnitGroup(_,Yc("burning-meteor"),{duration:1e3}),l.dealDamageTo(_,Te.DN.randIntInRange(82+b,124+b),At.Fire,({unitLoss:A,initialUnitCount:ee,finalDamage:X})=>{l.historyLog(`${a.name} deals ${X} damage to ${ee} ${_.type.name} with ${o.name}, ${A} units perish`),u.createFloatingMessageForUnitGroup(_,Zn(X,A),{duration:1e3})});const S=l.getUnitsFromFightQueue(),T=Te.DN.selectItems(S,2,1);console.log(S,T),T.forEach(A=>{l.removeTurnsFromUnitGroup(A),u.createDroppingMessageForUnitGroup(A.id,{html:Wi("Stunned!")})})}})}}}}),Bh="bomb-explosion",Yr={fontSize:"64px",color:"rgb(172 202 120)"},bd=zt([[Me(Bh,"fire-main"),[{opacity:"0",transform:"translate(-50%, -50%) scale(0.8)"},{opacity:"1",offset:.25,transform:"translate(-50%, -50%)  scale(1.2)"},{opacity:"1",offset:.35,transform:"translate(-50%, -50%)  scale(1.6)"},{offset:.76,opacity:"0",transform:"translate(-50%, -50%)  scale(1.9)"},{opacity:"0",transform:"translate(-50%, -50%)  scale(2.1)"}],{...Yr,opacity:"1"}],[Me(Bh,"fire-blur"),[{filter:"blur(10px)"},{filter:"blur(0px)",offset:.4},{filter:"blur(0px)",opacity:0}],{...Yr,filter:"blur(6px)",opacity:"1",mixBlendMode:"hard-light"}],[Me(Bh,"fire-pulse"),$n(),{...Yr,opacity:"0.2",transform:"translate(-50%, -50%) scale(1)",mixBlendMode:"hard-light"}]]),i_=ve({id:"#spell-poison-cloud-debuff",name:"Poisoned",activationType:se.Debuff,icon:{icon:"poison-cloud",...qr},getDescription:r=>({descriptions:[(0,x.bk)(`Takes 34-46 damage at the beginning of round, attack rating is lowered by 5. Rounds left: ${r.spellInstance.state?.debuffRoundsLeft}.`)]}),config:{spellConfig:{init({events:r,actions:l,thisSpell:o,spellInstance:a,vfx:u}){r.on({SpellPlacedOnUnitGroup({target:h}){const m={debuffRoundsLeft:2};a.state=m;const _=l.createModifiers({heroBonusAttack:-5});u.createEffectForUnitGroup(h,bd),l.addModifiersToUnitGroup(h,_),l.historyLog(`${h.type.name} gets negative effect "${o.name}"`),r.on({NewRoundBegins(b){l.dealDamageTo(h,Te.DN.randIntInRange(34,46),At.Poison,S=>{l.historyLog(`Poison deals ${S.finalDamage} damage to ${h.type.name}, ${S.unitLoss} units perish`),u.createEffectForUnitGroup(h,bd),u.createFloatingMessageForUnitGroup(h,Zn(S.finalDamage,S.unitLoss),{duration:1e3})}),m.debuffRoundsLeft--,m.debuffRoundsLeft||(l.removeSpellFromUnitGroup(h,a),l.removeModifiresFromUnitGroup(h,_))}})}})}}}}),jh=ve({id:"#spell-poison-cloud",name:"Poison Cloud",activationType:se.Target,icon:{icon:"poison-cloud"},getDescription:r=>({descriptions:[(0,x.bk)("Poisons target, lowering attack rating by 5 and dealing 34-46 damage at the beginning of each round. Lasts 2 rounds.")]}),config:{spellConfig:{targetCastConfig:{canActivate:en},getManaCost:r=>({1:2,2:3,3:4,4:5}[r.currentLevel]),init({events:r,actions:l,ownerPlayer:o,ownerHero:a,thisSpell:u}){r.on({PlayerTargetsSpell(h){l.historyLog(`${a.name} casts "${u.name}" against ${h.target.type.name}`);const m=l.createSpellInstance(i_);l.addSpellToUnitGroup(h.target,m,o)}})}}}}),r_=o=>65+25*(o-1),$h=[{targets:1,damage:[.3]},{targets:1,damage:[.6]},{targets:2,damage:[.65,.25]}],al=ve({id:"#spell-rain-of-fire",name:"Rain of Fire",activationType:se.Target,icon:{icon:"fire"},getDescription({ownerHero:r,spellInstance:l}){const o=r.specialtiesModGroup.getModValue("specialtyFireMastery")||0,a=[(0,x.bk)(`Deals 65 +25 damage per level (${r_(l.currentLevel)}) to the target.`),(0,x.bk)("<br>Improves with Fire Mastery: gains additional targets.")];if(o){const u=$h[o-1];a.push((0,x.bk)(`<hr/>Fire Mastery ${o}:<br>Additional targets: ${u.targets}<br>Damage: ${u.damage.map(Jc).join(", ")}`))}return{descriptions:a}},config:{spellConfig:{targetCastConfig:{canActivate:en},init:({events:r,actions:l,thisSpell:o,ownerHero:a,vfx:u,spellInstance:h})=>{r.on({PlayerTargetsSpell(m){const _=r_(h.currentLevel);function b(T,A,ee){l.dealDamageTo(T,A,At.Fire,X=>{l.historyLog(`${a.name} deals ${X.finalDamage} damage to ${X.initialUnitCount} ${T.type.name} with ${o.name}, ${X.unitLoss} units perish.`),setTimeout(()=>{u.createEffectForUnitGroup(T,bh,{duration:850}),u.createFloatingMessageForUnitGroup(T,Zn(X.finalDamage,X.unitLoss),{duration:1200})},250*ee)})}b(m.target,_,0);const S=a.specialtiesModGroup.getModValue("specialtyFireMastery")||0;if(S){const T=$h[S-1],A=l.getAliveUnitGroupsOfPlayer(m.target.ownerPlayer);Te.DN.removeItem(A,m.target),A.length&&Te.DN.getRandomItems(A,T.targets).forEach((X,de)=>{b(X,_*T.damage[de],de+1)})}}})},getManaCost:r=>({1:3,2:3,3:4,4:4,5:5,6:5,7:5}[r.currentLevel])}}}),Dd=ve({id:"#spell-wind-bless-buff",name:"Wind Bless",icon:{icon:"feather-wing",bgClr:ce.wL.DefautlBuffBg,iconClr:ce.wL.DefautlBuffClr},activationType:se.Buff,getDescription:()=>(0,x.EK)(`Attack of ranged units increased by 2 and Block-Piercing by ${Jc(.17)}.`),config:{spellConfig:{init:({events:r,actions:l,spellInstance:o})=>{r.on({SpellPlacedOnUnitGroup(a){const u=l.createModifiers({heroBonusAttack:2,blockPiercingPercent:.17});o.state={roundsLeft:1,target:a.target,mods:u},l.addModifiersToUnitGroup(a.target,u)},NewRoundBegins(a){const u=o.state;--u.roundsLeft||(l.removeSpellFromUnitGroup(u.target,o),l.removeModifiresFromUnitGroup(u.target,u.mods))}})}}}}),z0=Yc("dragon-breath"),Y0=ve({id:"#spell-fire-breath",name:"Fire Breath",activationType:se.Passive,icon:{icon:"dragon-breath"},getDescription:({ownerUnit:r})=>({descriptions:[(0,x.bk)(`${r?.type.name} covers ground with fire breath at the beginning of each round, dealing 20-30 fire damage to 2 random enemy groups.`)]}),config:{spellConfig:{init({actions:r,vfx:l,ownerPlayer:o,ownerUnit:a,events:u,thisSpell:h}){u.on({NewRoundBegins(){const m=r.getAliveUnitGroupsOfPlayer(r.getEnemyOfPlayer(o)),_=Te.DN.getRandomItems(m,2);r.historyLog(`${a?.type.name} casts ${h.name}.`),_.forEach(b=>{const S=Te.DN.randIntInRange(20,30);l.createEffectForUnitGroup(b,z0,{duration:1300}),r.dealDamageTo(b,S,At.Fire,T=>{r.historyLog(`${a?.type.name} deals ${T.finalDamage} damage to ${T.initialUnitCount} ${b.type.name} with ${h.name}, ${T.unitLoss} units perish`),l.createFloatingMessageForUnitGroup(b,Zn(T.finalDamage,T.unitLoss),{duration:1800})})})}})}}}}),cl=(r,l)=>r!==l?` (${l}% against ranged units)`:"",cr=r=>{const{icon:l,name:o,blockConfig:a,description:u}=r;return ve({id:r.id,name:o,activationType:se.Passive,icon:{icon:l},getDescription({spellInstance:m}){const _=m.currentLevel-1,b=a.minDamage[_],S=a.maxDamage[_],T=xh(a.chance[_]),A=xh(a.chanceAgainstRange[_]);return{descriptions:[(0,x.bk)(u({meleeChance:T,rangedChance:A,blockValue:Ih(b,S)}))]}},config:{spellConfig:{onAcquired({ownerUnit:h,spellInstance:m}){console.log("Aquired",m),m.state?.damageBlockMod&&h.removeSpellMods(m.state.damageBlockMod),m.state={damageBlockMod:{__attackConditionalModifiers({attacker:_}){const b=m.currentLevel-1,S=a.minDamage[b],T=a.maxDamage[b];return _?.modGroup.getModValue("isRanged")?{damageBlockMin:S,damageBlockMax:T,chanceToBlock:a.chanceAgainstRange[b]}:{damageBlockMin:S,damageBlockMax:T,chanceToBlock:a.chance[b]}}}},h.addSpellMods(m.state.damageBlockMod)},init(){}}}})},ll=cr({id:"#spell-knight-block",name:"Damage Block",icon:"heavy-shield",blockConfig:{minDamage:[14,22,34,45,120],maxDamage:[20,28,42,58,160],chance:[.6,.65,.7,.77,.68],chanceAgainstRange:[.6,.65,.72,.8,.7]},description:({blockValue:r,meleeChance:l,rangedChance:o})=>`Knights can block ${r} damage with ${l}% chance${cl(l,o)}.`}),Sd=cr({id:"#spell-tower-shields-block",name:"Tower Shields",icon:"heavy-shield",blockConfig:{minDamage:[14,22,34,45,120],maxDamage:[20,28,42,58,160],chance:[.6,.65,.7,.77,.68],chanceAgainstRange:[.6,.65,.72,.8,.7]},description:({blockValue:r,meleeChance:l,rangedChance:o})=>`Tower shields can block ${r} damage with ${l}% chance${cl(l,o)}.`}),Zh=(ve({id:"#spell-protection-aura",name:"Protected",activationType:se.Buff,icon:{icon:"spear-head"},getDescription:()=>({descriptions:["Unit is being protected"]}),config:{spellConfig:{onAcquired({}){},init({}){}}}}),ve({id:"#spell-protection",name:"Protection",icon:{icon:"spear-head"},activationType:se.Passive,getDescription:()=>({descriptions:["An aura that affects allies in range of 1 and gives damage block plus bonus armor."]}),config:{flags:{isAura:!0},spellConfig:{onAcquired({}){},init({events:l}){l.on({AuraCheck({}){}})}}}})),tn=([[r,l],o,a,u,h])=>({damageInfo:{minDamage:r,maxDamage:l},attackRating:o,defence:a,health:u,speed:h});function Di(r){return(0,pt.fH)(r)}const Td={createRandomArmy(r){const l=Te.DN.randIntInRange(r.minUnitGroups,r.maxUnitGroups),o=[],a=[...r.units],u=a.reduce((h,m)=>{const[_,b,S,T=1/0]=m;return h.set(m,{unitType:_,min:b,max:S,maxGroupsOfThisType:T,createdTimes:0}),h},new Map);console.log("options ->>",r),console.log("Units Map ->>",u);for(let h=0;h<l;h++){const m=Te.DN.randItem(a),_=u.get(m),b=_.unitType,T={count:Te.DN.randIntInRange(_.min,_.max),unitType:b};o.push(T),_.createdTimes++,_.createdTimes>=_.maxGroupsOfThisType&&(console.log("this unit was generated max times"),u.delete(m),Te.DN.removeItem(a,m))}return console.log("generated groups",o),o}},xt=r=>()=>({descriptions:r}),sa={experience:0,gold:0};Qi.W.defineUnitType({id:"#unit-h00",name:"Pikemen",level:1,mainPortraitUrl:ce._T.Pikemen,baseRequirements:{gold:55},getDescription:xt([(0,x.Ym)("Tier 1 Castle unit. Can be upgraded into Halberdier."),(0,x.Ym)("<br>While possessing good average stats, Pikemen also strikes back at any attacker."),(0,x.Ym)("<br>Receives bonuses from Combat Tactics speciality.")]),defaultSpells:[Zh],defaultModifiers:{counterattacks:!0,retaliationDamagePercent:.7},baseStats:{damageInfo:{minDamage:2,maxDamage:3},attackRating:2,defence:2,health:8,speed:13},upgradeDetails:{target:"#unit-h01",upgradeCost:{gold:15}},neutralReward:sa}),Qi.W.defineUnitType({id:"#unit-h01",mainPortraitUrl:ce._T.Pikemen,name:"Halberdier",level:1,baseStats:tn([[3,3],2,3,8,14]),getDescription:xt([(0,x.Ym)("Tier 1 Castle unit. Upgraded version of Pikemen."),(0,x.Ym)("<br>More durable and strong version of Pikemen, also retains ability to counterattack any attacker."),(0,x.Ym)("<br>Receives bonuses from Combat Tactics speciality.")]),defaultModifiers:{counterattacks:!0,retaliationDamagePercent:.85,__auraModifiers({remoteness:r,thisUnit:o}){if(1===r){const a=.8*o.count;return{chanceToBlock:1,damageBlockMin:a,damageBlockMax:a}}return null}},baseRequirements:{gold:70,redCrystals:0},upgraded:!0,neutralReward:sa}),Qi.W.defineUnitType({id:"#unit-h10",mainPortraitUrl:ce._T.Archer,name:"Archers",level:2,getDescription:xt([(0,x.Ym)("Tier 2 Castle ranged unit. Can be upgraded into Crossbowmen."),(0,x.Ym)("<br>Archers are one of the fastest units, allowing hero to have an early turn against most early foes. Attacks twice per turn."),(0,x.Ym)("<br>In return to their advantages, they are also costly and relatively fragile."),(0,x.Ym)("<br>Receives bonuses from Archery specialty, granting bonus Attack Rating and Block-piercing.")]),baseStats:{damageInfo:{minDamage:3,maxDamage:4},attackRating:1,defence:2,health:9,speed:21},upgradeDetails:{target:"#unit-h11",upgradeCost:{gold:25}},getUnitTypeSpecialtyModifiers:r=>1===r.specialtyArchery?{heroBonusAttack:1,blockPiercingPercent:.15}:r.specialtyArchery>=2?{heroBonusAttack:2,blockPiercingPercent:.25}:{},defaultModifiers:{isRanged:!0},minQuantityPerStack:12,defaultTurnsPerRound:2,baseRequirements:{gold:95},neutralReward:{experience:3,gold:5}}),Qi.W.defineUnitType({id:"#unit-h11",mainPortraitUrl:ce._T.Archer,name:"Crossbowmen",level:2,getDescription:xt([(0,x.Ym)("Tier 2 Castle ranged unit. Upgraded version of Archers."),(0,x.Ym)("<br>Crossbowmen are one of the fastest units, allowing hero to have an early turn against most early foes. Attacks twice per turn."),(0,x.Ym)("<br>Crossbowmen have higher base stats and less fragile than Archers, but also have 35% block-piercing attack."),(0,x.Ym)("<br>Receives bonuses from Archery specialty, granting bonus Attack Rating and Block-piercing.")]),baseStats:{damageInfo:{minDamage:3,maxDamage:4},attackRating:4,defence:3,health:14,speed:21},defaultTurnsPerRound:2,getUnitTypeSpecialtyModifiers:r=>1===r.specialtyArchery?{heroBonusAttack:1,blockPiercingPercent:.2}:r.specialtyArchery>=2?{heroBonusAttack:2,blockPiercingPercent:.3}:{},defaultModifiers:{isRanged:!0,blockPiercingPercent:.35},upgraded:!0,baseRequirements:{gold:120},neutralReward:{experience:4.5,gold:7}}),Qi.W.defineUnitType({id:"#unit-h20",mainPortraitUrl:ce._T.UnitMelee,name:"Knights",level:3,getDescription:xt([(0,x.Ym)("Tier 3 Castle unit."),(0,x.Ym)("<br>Knights are possessing high armor and attack. "),(0,x.Ym)("<br>Chance-based ability to block damage along with +12% to Fire, Cold and Lightning resistances makes them durable fighters.")]),baseStats:tn([[6,9],6,5,17,11]),baseRequirements:{gold:120},defaultSpells:[ll],defaultModifiers:{resistFire:12,resistCold:12,resistLightning:12},neutralReward:{experience:10,gold:7}}),Qi.W.defineUnitType({id:"#unit-h30",name:"Cavalry",mainPortraitUrl:ce._T.UnitMelee,getDescription:xt([(0,x.Ym)("Tier 4 Castle cavalry unit, can be upgraded into Heavy Cavalry."),(0,x.Ym)("<br>Cavalry is armored unit type that also deals heavy damage with 55% block-piercing attack.")]),level:4,baseStats:{damageInfo:{minDamage:14,maxDamage:19},attackRating:9,defence:10,health:33,speed:16},defaultModifiers:{blockPiercingPercent:.55,isCavalry:!0},baseRequirements:{gold:225,wood:1},neutralReward:{experience:20,gold:25},upgradeDetails:{target:"#unit-h31",upgradeCost:{gold:85}}}),Qi.W.defineUnitType({id:"#unit-h31",name:"Heavy Cavalry",mainPortraitUrl:ce._T.UnitMelee,getDescription:xt([(0,x.Ym)("Tier 4 Castle cavalry unit, upgraded version of Cavalry."),(0,x.Ym)("<br>Cavalry is armored unit type that also deals heavy damage with 55% block-piercing attack.")]),level:4,baseStats:{damageInfo:{minDamage:14,maxDamage:19},attackRating:9,defence:10,health:33,speed:16},defaultModifiers:{blockPiercingPercent:.55,isCavalry:!0},baseRequirements:{gold:310,wood:1},neutralReward:{experience:25,gold:35},upgraded:!0}),Qi.W.defineUnitType({id:"#unit-h40",name:"Mystic Birds",mainPortraitUrl:ce._T.FireBird,level:5,getDescription:xt([(0,x.Ym)("Tier 5 Castle magical creatures of fire. Can be upgraded to Firebirds."),(0,x.Ym)("<br>Majestic and powerful creatures of fire that can heal and resurrect allied units, also has 10% resist against fire."),(0,x.Ym)("<br>Deal 20% more damage against magical creatures.")]),baseStats:tn([[18,26],8,10,46,16]),defaultSpells:[hd],defaultModifiers:{resistFire:10,isMagical:!0,__attackConditionalModifiers:({attacked:r})=>r.modGroup.getModValue("isMagical")?{baseDamagePercentModifier:.2}:{}},baseRequirements:{gold:350,wood:1},upgradeDetails:{target:"#unit-h41",upgradeCost:{gold:125}},neutralReward:{experience:40,gold:60}}),Qi.W.defineUnitType({id:"#unit-h41",name:"Firebirds",mainPortraitUrl:ce._T.FireBird,level:5,getDescription:xt([(0,x.Ym)("Tier 5 Castle magical creatures of fire, an upgraded version of Mystic Birds."),(0,x.Ym)("<br>Majestic and powerful of fire that can heal and resurrect allied units, has better stats than Mystical Birds and +17% fire resistance."),(0,x.Ym)("<br>Deal 30% more damage against magical creatures.")]),baseStats:tn([[23,29],12,14,57,17]),defaultModifiers:{resistFire:17,isMagical:!0,__attackConditionalModifiers:({attacked:r})=>r.modGroup.getModValue("isMagical")?{baseDamagePercentModifier:.3}:{}},defaultSpells:[hd],baseRequirements:{gold:475,wood:1},neutralReward:{experience:45,gold:60}});var Rt=M(249);const aa=ti({prefix:"Spells",events:{PlayerTargetsSpell:ct(),SpellPlacedOnUnitGroup:ct(),NewRoundBegins:ct(),PlayerCastsInstantSpell:ct(),UnitGroupAttacks:ct(""),AuraCheck:ct()}}),ca=aa.events,Vh=ve({id:"#spell-unit-poison-arrows-debuff",name:"Poisoned",icon:{icon:"chemical-arrow",bgClr:"green"},activationType:se.Passive,getDescription:({})=>({descriptions:[(0,x.bk)("This group is poisoned, receiving poison damage.")]}),config:{spellConfig:{init({events:r,actions:l,vfx:o,spellInstance:a}){r.on({SpellPlacedOnUnitGroup({target:u}){o.createDroppingMessageForUnitGroup(u.id,{html:Wi("Poisoned!")}),l.dealDamageTo(u,a.state?.poisonDamage||0,At.Poison)}})}}}}),qh=ve({id:"#spell-unit-poison-arrows",name:"Poison Arrows",icon:{icon:"chemical-arrow"},activationType:se.Passive,getDescription:({ownerUnit:r})=>({descriptions:[(0,x.bk)(`Poisons enemy on attack, dealing ${2*r.count} poison damage (2 damage per unit).`)]}),config:{spellConfig:{init({events:r,actions:l,ownerUnit:a,ownerPlayer:u}){r.on({UnitGroupAttacks({attacker:h,attacked:m}){if(h!==a)return;const _=l.createSpellInstance(Vh);_.state={poisonDamage:2*h.count},!m.spells.some(b=>b.baseType===Vh)&&l.addSpellToUnitGroup(m,_,u)}})}}}}),la={experience:0,gold:0};Rt.vn.defineUnitType({id:"#unit-f00",mainPortraitUrl:ce._T.UnitMelee,name:"Raiders",level:1,baseStats:{damageInfo:{minDamage:1,maxDamage:2},attackRating:1,speed:16,defence:2,health:9},getDescription:xt([(0,x.Ym)("Tier 1 Fort unit. Can be upgraded into Clan."),(0,x.Ym)("<br>The main attacking mass of the Fort, the goblins with long sharp spears. They are cheap and fragile, but swift, allowing to get an earlier turn and can be dangerous due to the chance of dealing critical damage.")]),defaultModifiers:{counterattacks:!0,criticalDamageChance:.35,criticalDamageMul:1},baseRequirements:{gold:35,redCrystals:0},upgradeDetails:{target:"#unit-f01",upgradeCost:{gold:20}},neutralReward:la}),Rt.vn.defineUnitType({id:"#unit-f01",mainPortraitUrl:ce._T.UnitMelee,name:"Clan",level:1,baseStats:{damageInfo:{minDamage:2,maxDamage:2},attackRating:3,speed:17,defence:3,health:9},getDescription:xt([(0,x.Ym)("Tier 1 Fort unit, upgraded version of Raiders."),(0,x.Ym)("<br>The main attacking mass of the Fort, the goblins with long sharp spears. They are cheap and fragile, but swift, allowing to get an earlier turn and can be dangerous due to the chance of dealing critical damage.")]),defaultModifiers:{counterattacks:!0,criticalDamageChance:.35,criticalDamageMul:1},baseRequirements:{gold:55,redCrystals:0},upgraded:!0,neutralReward:la}),Rt.vn.defineUnitType({id:"#unit-f10",mainPortraitUrl:ce._T.UnitRanged,name:"Goblin Archers",level:2,baseStats:{damageInfo:{minDamage:1,maxDamage:1},attackRating:1,speed:14,defence:3,health:14},getDescription:xt([(0,x.Ym)("Tier 2 ranged unit of the Fort. Can be upgraded into Goblin Shooters."),(0,x.Ym)("<br>Basic archers that deal very low damage due to poor technologies, but mitigate that weakness by adding poison to their arrows. Attacks twice per turn.")]),defaultTurnsPerRound:2,defaultModifiers:{isRanged:!0},defaultSpells:[qh],baseRequirements:{gold:60,redCrystals:0},upgradeDetails:{target:"#unit-f11",upgradeCost:{gold:20}},neutralReward:la}),Rt.vn.defineUnitType({id:"#unit-f11",mainPortraitUrl:ce._T.UnitRanged,name:"Goblin Shooters",level:2,baseStats:{damageInfo:{minDamage:1,maxDamage:1},attackRating:1,speed:14,defence:4,health:18},getDescription:xt([(0,x.Ym)("Tier 2 ranged unit of the Fort. Upgraded version of Goblin Archers."),(0,x.Ym)("<br>Basic archers that deal very low damage due to poor technologies, but mitigate that weakness by adding poison to their arrows."),(0,x.Ym)("<br>As an improved version of Goblin Archers they are equipped with primitive but fast-reloading crossbows, allowing them to attack 3 times per round.")]),defaultModifiers:{isRanged:!0},defaultTurnsPerRound:3,defaultSpells:[qh],baseRequirements:{gold:60,redCrystals:0},upgraded:!0,neutralReward:la});var ul=M(683);const Ki=ul.i.createFaction({id:"#faction-constellation",title:"Constellation",icon:"arrow-cluster"}),p_=ve({id:"#spell-dream-aura",name:"Dream Aura",icon:{icon:"overmind"},getDescription:()=>({descriptions:["Damage dealt to nearby allies becomes part of Star Dragon's dream. Increases All Resist (+17%) and Defence(6) for closest allies."]}),activationType:se.Passive,config:{spellConfig:{init(){}}}}),f_=ve({id:"#spell-essence-leak-debuff",activationType:se.Debuff,icon:{icon:"implosion"},getDescription:()=>({descriptions:[(0,x.bk)("Attacker will heal himself.")]}),name:"Life loss",config:{spellConfig:{getManaCost:()=>0,init(){},targetCastConfig:{}}}}),zh=ve({id:"#spell-essence-leak",name:"Essence Leak",icon:{icon:"implosion"},activationType:se.Target,getDescription:()=>({descriptions:[(0,x.bk)("Places a curse on enemy. Any time target is attacked, the attacker will be healed by 1 point per each Sprite in the current group")]}),config:{spellConfig:{getManaCost:()=>2,init({events:r,actions:l,vfx:a}){r.on({PlayerTargetsSpell({target:u}){const h=l.createSpellInstance(f_,{initialLevel:1});u.addSpell(h),a.createEffectForUnitGroup(u,Qc("implosion","rgb(223 165 255)"),{duration:1e3})}})},targetCastConfig:{canActivate:en}}}});Ki.defineUnitType({id:"#unit-c00",name:"Sprite",level:1,mainPortraitUrl:ce._T.UnitMelee,baseRequirements:{gold:75},getDescription:()=>({descriptions:[(0,x.bk)("Tier 1 units of the Constellation."),(0,x.bk)("<br>One of the strongest tier 1 unit types due to high-value abilities. Sprites can curse specific enemy to heal allied attackers.")]}),defaultSpells:[zh],baseStats:{damageInfo:{minDamage:2,maxDamage:3},speed:8,defence:4,health:14,attackRating:4},neutralReward:{experience:12,gold:8}}),Ki.defineUnitType({id:"#unit-c10",name:"Fencer",level:2,mainPortraitUrl:ce._T.UnitMelee,baseRequirements:{gold:75},baseStats:{damageInfo:{minDamage:2,maxDamage:4},speed:7,defence:2,health:13,attackRating:5},neutralReward:{experience:12,gold:8}}),Ki.defineUnitType({id:"#unit-c20",name:"Saggitar",level:3,mainPortraitUrl:ce._T.UnitRanged,baseRequirements:{gold:95},defaultModifiers:{isRanged:!0},baseStats:{damageInfo:{minDamage:6,maxDamage:8},speed:17,defence:4,health:17,attackRating:5},neutralReward:{experience:18,gold:14}}),Ki.defineUnitType({id:"#unit-c30",name:"Chariot",level:4,mainPortraitUrl:ce._T.UnitMelee,baseRequirements:{gold:185},baseStats:{damageInfo:{minDamage:15,maxDamage:24},speed:24,defence:8,health:35,attackRating:9},neutralReward:{experience:18,gold:14}}),Ki.defineUnitType({id:"#unit-c60",name:"Star Dragon",level:7,mainPortraitUrl:ce._T.UnitMelee,baseRequirements:{gold:1e3,gems:1,redCrystals:1},upgradeDetails:{target:"#unit-c61",upgradeCost:{gold:500,gems:1}},baseStats:{damageInfo:{minDamage:40,maxDamage:60},speed:20,defence:18,health:175,attackRating:16},neutralReward:{experience:180,gold:150}}),Ki.defineUnitType({id:"#unit-c61",name:"Night Wyvern",level:7,mainPortraitUrl:ce._T.UnitMelee,baseRequirements:{gold:1500,gems:2,redCrystals:1},baseStats:{damageInfo:{minDamage:47,maxDamage:64},speed:22,defence:21,health:245,attackRating:17},defaultModifiers:{counterattacks:!0,retaliationDamagePercent:.5},defaultSpells:[p_],neutralReward:{experience:180,gold:150},upgraded:!0});const gn=ul.i.createFaction({id:"#faction-neutrals",title:"Neutrals",icon:"monster-skull"});gn.defineUnitType({id:"#unit-neut-gnoll-0",mainPortraitUrl:ce._T.UnitMelee,name:"Gnolls",level:1,baseStats:tn([[3,4],1,1,10,12]),getDescription:xt([(0,x.Ym)("Gnolls are tier 1 forest dwellers with average stats."),(0,x.Ym)("Mostly known for being bandits, they possess a fire resistant fur, giving them +10% to Fire Resist.")]),defaultModifiers:{resistFire:10,isForest:!0},baseRequirements:{gold:100},neutralReward:{experience:3.3,gold:3.2}}),gn.defineUnitType({id:"#unit-neut-poison-ivy-0",mainPortraitUrl:ce._T.UnitMelee,name:"Poison Ivy",level:2,baseStats:tn([[3,4],1,1,10,10]),getDescription:xt([(0,x.Ym)("Tier 2 forest dweller."),(0,x.Ym)("A mutated plant, a sturdy enemy with venomous attack, but vulnerable to any magic damage.")]),defaultModifiers:{resistAll:-20,isForest:!0},baseRequirements:{gold:10},neutralReward:{experience:4.5,gold:3.2}}),gn.defineUnitType({id:"#unit-neut-thief-0",mainPortraitUrl:ce._T.UnitMelee,name:"Thieves",level:2,getDescription:xt([(0,x.Ym)("Tier 2 forest dweller."),(0,x.Ym)("<br>Thieves are very dangerous despite being fragile. Their high speed allows them to have their turn earlier, and ability to attack twice, along with high damage, can result in heavy losses.")]),baseStats:tn([[6,7],2,1,9,16]),defaultTurnsPerRound:2,defaultModifiers:{isForest:!0},baseRequirements:{},neutralReward:{experience:4.55,gold:4.7}}),gn.defineUnitType({id:"#unit-neut-forest-troll-0",mainPortraitUrl:ce._T.UnitMelee,name:"Forest Trolls",level:3,getDescription:xt([(0,x.Ym)("Tier 3 forest dweller."),(0,x.Ym)("<br>Durable and strong, groups of Forest Trolls can absorb big damage, but their slowness usually makes them use their move last.")]),baseStats:tn([[5,7],3,4,17,10]),defaultModifiers:{isForest:!0},baseRequirements:{},neutralReward:{experience:6,gold:6}}),gn.defineUnitType({id:"#unit-neut-fire-spirit-0",name:"Fire Spirits",mainPortraitUrl:ce._T.UnitMelee,baseRequirements:{},level:3,baseStats:tn([[9,13],3,3,17,18]),defaultModifiers:{resistFire:20,resistCold:15,isMagical:!0},getDescription:xt([(0,x.Ym)("Tier 3 Neutral magical creature of fire."),(0,x.Ym)("<br>Tenacious and strong. Have increased resists against Fire (+20%) and Ice (+15%).")]),neutralReward:{experience:20,gold:20},defaultSpells:[]});const mn=cr({id:"#spell-skeleton-block",name:"Damage Block",icon:"heavy-shield",blockConfig:{minDamage:[8,24,45,86,120],maxDamage:[16,36,55,96,160],chance:[.2,.3,.35,.4,.45],chanceAgainstRange:[.55,.65,.7,.75,.8]},description:({blockValue:r,meleeChance:l,rangedChance:o})=>`Skeletons can block ${r} damage with ${l}% chance${cl(l,o)}.`});gn.defineUnitType({id:"#unit-neut-ghost-0",mainPortraitUrl:ce._T.UnitMelee,name:"Ghosts",level:1,baseRequirements:{gold:30},getDescription:r=>({descriptions:[(0,x.Ym)("Undead unit."),(0,x.Ym)("<br>Possesses no outstanding qualities outside of low price and passive ability Fright. Gains improvements from Necromancy."),(0,x.Ym)("<br>Can be upgraded into Wraiths, faster unit with better stats, inheriting Fright ability.")]}),getUnitTypeSpecialtyModifiers:r=>r.specialtyNecromancy>1?{unitGroupSpeedBonus:4,heroBonusDefence:1}:null,baseStats:tn([[2,3],1,2,6,8]),defaultSpells:[Fh],neutralReward:{experience:2.3,gold:3},upgradeDetails:{target:"#unit-neut-ghost-1",upgradeCost:{gold:25}},defaultModifiers:{isGhost:!0}}),gn.defineUnitType({id:"#unit-neut-ghost-1",mainPortraitUrl:ce._T.UnitMelee,name:"Wraiths",level:1,baseRequirements:{gold:55},baseStats:tn([[3,3],2,4,12,12]),getDescription:r=>({descriptions:[(0,x.Ym)("Undead unit. Upgraded and faster version of Ghosts."),(0,x.Ym)("<br>While having increased stats, inherits passive ability Fright."),(0,x.Ym)("<br>Gains improvements from Necromancy.")]}),getUnitTypeSpecialtyModifiers:r=>1===r.specialtyNecromancy?{unitGroupSpeedBonus:4,heroBonusDefence:2}:r.specialtyNecromancy>=2?{unitGroupSpeedBonus:4,heroBonusDefence:2,resistCold:10,resistFire:10}:null,defaultSpells:[Fh],defaultModifiers:{isGhost:!0},neutralReward:{experience:2.3,gold:2.4},upgraded:!0}),gn.defineUnitType({id:"#unit-neut-skeleton-0",name:"Skeletons",mainPortraitUrl:ce._T.UnitMelee,level:1,getDescription:()=>({descriptions:[(0,x.Ym)("Undead unit."),(0,x.Ym)("Usually found in big numbers, Skeletons also have ability to block damage with some chance.")]}),baseStats:{damageInfo:{minDamage:1,maxDamage:2},attackRating:1,defence:2,health:9,speed:11},defaultSpells:[mn],baseRequirements:{gold:55},neutralReward:{experience:3,gold:2}}),gn.defineUnitType({id:"#unit-neut-lich-0",name:"Liches",mainPortraitUrl:ce._T.UnitMelee,level:4,getDescription:()=>({descriptions:[(0,x.Ym)("Tier 4 Undead unit. Can be upgraded into Master Liches."),(0,x.Ym)("<br>Powerful undead creatures, standing in the head of undead armies. Masterful wielders of long swords, they also possess 25% lifesteal and cannot be slowed down.")]}),baseStats:{damageInfo:{minDamage:13,maxDamage:17},attackRating:6,defence:5,health:32,speed:14},defaultModifiers:{lifesteal:25,isGhost:!0,cannotBeSlowed:!0},baseRequirements:{gold:400},neutralReward:{experience:30,gold:2},upgradeDetails:{target:"#unit-neut-lich-1",upgradeCost:{gold:100}}}),gn.defineUnitType({id:"#unit-neut-lich-1",name:"Master Liches",mainPortraitUrl:ce._T.UnitMelee,level:4,getDescription:()=>({descriptions:[(0,x.Ym)("Tier 4 Undead unit, an upgraded version of Liches."),(0,x.Ym)("<br>Powerful undead creatures, standing in the head of undead armies. Masterful wielders of long swords, they possess improved 45% lifesteal and cannot be slowed down.")]}),baseStats:{damageInfo:{minDamage:14,maxDamage:19},attackRating:7,defence:7,health:35,speed:15},defaultModifiers:{lifesteal:45,isGhost:!0,cannotBeSlowed:!0},baseRequirements:{gold:400},neutralReward:{experience:40,gold:2}}),gn.defineUnitType({id:"#unit-neut-imperial-guard",name:"Imperial Guard",level:3,neutralReward:{experience:10,gold:0},baseStats:{attackRating:3,defence:3,damageInfo:{maxDamage:3,minDamage:3},health:14,speed:12},defaultModifiers:{retaliationDamagePercent:.5,counterattacks:!0},defaultSpells:[Sd],getDescription:()=>({descriptions:[(0,x.bk)("Imperial Guards, a part of the imperial army, well trained with combat tactics. They can block damage and retaliate.")]}),baseRequirements:{}});const Qh=cr({id:"#spell-devastator-block",name:"Scale Armor",icon:"dragon-wing",blockConfig:{minDamage:[16],maxDamage:[24],chance:[.35],chanceAgainstRange:[.65]},description:({blockValue:r,meleeChance:l,rangedChance:o})=>`Sturdy scales of Devastator give a ${l}% chance to block ${r} damage${cl(l,o)}.`});gn.defineUnitType({id:"#unit-neut-boss-devastator",name:"Devastator",mainPortraitUrl:ce._T.UnitMelee,level:8,getDescription:xt([(0,x.Ym)("An evil dragon of fire."),(0,x.Ym)("<br>Dangerous boss unit with large health pool. Resistant to magic, has +50% to Fire Resist and +20% to All Other Resists, also posseses Fire Breath ability that damages random enemies with fire."),(0,x.Ym)("<br>His scales allow him to block some damage. Cannot be slowed.")]),baseStats:{damageInfo:{minDamage:32,maxDamage:47},attackRating:9,defence:9,health:820,speed:14},defaultSpells:[Y0,Qh],defaultModifiers:{isBoss:!0,resistAll:20,resistFire:30,cannotBeSlowed:!0},baseRequirements:{},neutralReward:{experience:120,gold:340},upgraded:!1}),gn.defineUnitType({id:"#unit-neut-ranger-0",name:"Rangers",level:2,baseStats:{attackRating:4,damageInfo:{maxDamage:8,minDamage:6},defence:4,health:14,speed:16},defaultModifiers:{__attackConditionalModifiers:({attacked:r})=>r.modGroup.getModValue("isForest")?{baseDamagePercentModifier:.75}:{}},defaultSpells:[],getDescription:r=>({descriptions:[(0,x.bk)("Tier 2 Neutral unit."),(0,x.bk)("Efficient against forest dwellers, dealing 75% more damage to them.")]}),neutralReward:{experience:1,gold:1},baseRequirements:{gold:100}});var xe=M(809),Be=M(434);const Wh=(0,Be.f)({id:"#item-blacklich-swords",name:"Black Lich Sword",icon:"bat-sword",slot:xe.A.Weapon,stats:{heroBonusAttack:3,specialtyNecromancy:1,__unitConditionalMods:r=>r.type.level<=4&&!r.modGroup.getModValue("isRanged")?{lifesteal:18}:null},cost:{gold:1e3,gems:1},description:({thisItemBase:r})=>({descriptions:[(0,x.A9)(r),(0,x.bk)("Grants 18% Lifesteal to non-ranged units up to level 4.")]})}),g_=((0,Be.f)({id:"#item-doomstring",name:"Doomstring",slot:xe.A.Weapon,icon:"crossbow",stats:{heroBonusAttack:8,specialtyOffence:3,specialtyArchery:2,specialtyFireMastery:1},cost:{gold:5e3,redCrystals:2,gems:1},description:({thisItemBase:r})=>({descriptions:[(0,x.A9)(r),(0,x.bk)("An ancient ballista made in infernal abyss."),(0,x.bk)("Grants ability: Doom. Doomed target looses 50% of armor and receives 50% increased physical damage.")]})}),(0,Be.f)({id:"#item-eclipse-wand",name:"Eclipse Wand",slot:xe.A.Weapon,stats:{specialtyMagic:1,specialtyMagicRecovery:1,heroMaxMana:5},icon:"crystal-wand",cost:{gold:550},sellingCost:{gold:300},description:({thisItemBase:r})=>({descriptions:[(0,x.A9)(r),(0,x.bk)("At the beginning of the battle, applies level 1 Enchant to all enemy groups.")]}),config:{init:({actions:r,events:l,ownerPlayer:o})=>{l.on({NewRoundBegins(a){if(0===a.round){const u=r.getEnemyOfPlayer(o);r.getUnitGroupsOfPlayer(u).forEach(m=>{const _=r.createSpellInstance(el,{initialLevel:1});r.addSpellToUnitGroup(m,_,o)})}}})}}})),xd=ti({prefix:"Items",events:{NewRoundBegins:ct("")}}),Jh=xd.events;class wo{static#e=this.slotTypes=[xe.A.Headgear,xe.A.Amulet,xe.A.Weapon,xe.A.Armor,xe.A.Shield,xe.A.Boots];static#t=this.extendedSlotsMap=new Map([[xe.A.Headgear,{slotType:xe.A.Headgear,name:"Headgear",icon:"knight-helmet"}],[xe.A.Amulet,{slotType:xe.A.Amulet,name:"Amulet",icon:"gem-pendant"}],[xe.A.Weapon,{slotType:xe.A.Weapon,name:"Weapon",icon:"sword"}],[xe.A.Armor,{slotType:xe.A.Armor,name:"Armor",icon:"vest"}],[xe.A.Shield,{slotType:xe.A.Shield,name:"Shield",icon:"shield"}],[xe.A.Boots,{slotType:xe.A.Boots,name:"Boots",icon:"boot-stomp"}]]);constructor(){this.inventoryItemsMap=new Map,this.equipedItemsSet=new Set}static getSlotTypes(){return this.slotTypes}static getExtendedSlotTypes(){return[...this.extendedSlotsMap.values()]}static getSlotExtendedInfo(l){return this.extendedSlotsMap.get(l)}static filterItemsForSlot(l,o){return o.filter(a=>a.baseType.slotType===l)}equipItem(l){const o=l.baseType.slotType,a=this.inventoryItemsMap.get(o);this.inventoryItemsMap.set(o,l),a&&this.equipedItemsSet.delete(a),this.equipedItemsSet.add(l)}unequipItem(l){this.inventoryItemsMap.delete(this.getItemSlotType(l)),this.equipedItemsSet.delete(l)}unequipSlot(l){const o=this.inventoryItemsMap.get(l);o&&(this.inventoryItemsMap.delete(l),this.equipedItemsSet.delete(o))}getItemInSlot(l){return this.inventoryItemsMap.get(l)||null}isSlotEquipped(l){return this.inventoryItemsMap.has(l)}isItemEquipped(l){return this.equipedItemsSet.has(l)}getEquippedItems(){return[...this.equipedItemsSet]}getItemSlotType(l){return l.baseType.slotType}}const m_=(0,Be.f)({id:"#item-ice-bow",name:"Ice Bow",slot:xe.A.Weapon,icon:"frozen-arrow",stats:{heroBonusAttack:1,specialtyArchery:1},cost:{gold:500},sellingCost:{gold:400},description:({thisItemBase:r})=>({descriptions:[(0,x.A9)(r),(0,x.bk)("Bow which radiates cold, grants level 1 Frost Arrow")]}),spells:[{level:1,spell:ia}]}),Id=(0,Be.f)({id:"#item-irton-plate",name:"Irton Plate",slot:xe.A.Armor,icon:"vest",cost:{gold:300},sellingCost:{gold:175},stats:{heroBonusDefence:3}}),Ed=((0,Be.f)({id:"#item-lifeform",name:"Lifeform",slot:xe.A.Armor,icon:"vest",stats:{heroBonusDefence:7,resistFire:25,resistPoison:20,resistLightning:15,resistCold:15},description:({thisItemBase:r})=>({descriptions:[(0,x.A9)(r),(0,x.bk)("An incredible artifact that shimmers with bright colors and emits life aura. Heals all units by 50 in the beginning of each round.")]}),config:{init({events:r,actions:l,ownerPlayer:o}){r.on({NewRoundBegins:()=>{l.getUnitGroupsOfPlayer(o).forEach(u=>{l.healUnit(u,50)})}})}}}),(0,Be.f)({id:"#item-meteor-sword",name:"Meteor Swords",slot:xe.A.Weapon,icon:"dervish-swords",stats:{heroBonusAttack:2,specialtyFireMastery:1},cost:{gold:1100},sellingCost:{gold:450},spells:[{spell:hn,level:1}],description:({thisItemBase:r})=>({descriptions:[(0,x.A9)(r),(0,x.bk)("Two large black swords with an astronomical map depicted in gold on the blade. Grants Level 1 Meteor ability.")]})})),ua=(0,Be.f)({id:"#item-wind-crest",name:"Wind Crest",slot:xe.A.Headgear,stats:{heroBonusDefence:1},icon:"feather-wing",cost:{gold:500},sellingCost:{gold:250},description:({thisItemBase:l})=>({descriptions:[(0,x.A9)(l),(0,x.bk)("At the beginning of the fight, grants Wind Blessing (level 1) effect to your ranged units for 1 round.")]}),config:{init:({actions:r,events:l,ownerPlayer:o})=>{l.on({NewRoundBegins(a){0===a.round&&r.getUnitGroupsOfPlayer(o).filter(u=>u.type.defaultModifiers?.isRanged).forEach(u=>{const h=r.createSpellInstance(Dd);r.addSpellToUnitGroup(u,h,o)})}})}}}),y_=(0,Be.f)({id:"#item-wishmaster",name:"Wishmaster",slot:xe.A.Headgear,stats:{heroBonusAttack:5,heroBonusDefence:4,resistAll:13},icon:"feather-wing",description:({thisItemBase:l})=>({descriptions:[(0,x.A9)(l),(0,x.bk)("An artefact of incredible strength.")]})}),Xh=((0,Be.f)({id:"#item-rising-sun",name:"Rising Sun",icon:"gem-pendant",slot:xe.A.Amulet,stats:{heroBonusDefence:2},description:({thisItemBase:r})=>({descriptions:[(0,x.A9)(r),(0,x.bk)("Each round heals your units by 50")]}),config:{init({events:r,actions:l,ownerPlayer:o}){r.on({NewRoundBegins:()=>{l.getUnitGroupsOfPlayer(o).forEach(u=>{l.healUnit(u,50)})}})}}}),(0,Be.f)({id:"#item-iron-pike",name:"Iron Pike",icon:"spear-head",slot:xe.A.Weapon,cost:{gold:420},sellingCost:{gold:250},stats:{specialtyCombatTactics:1,heroBonusAttack:1}}),ve({id:"#spell-charged-strike",name:"Charged Strike",activationType:se.Target,icon:{icon:"lightning"},getDescription:()=>({descriptions:[(0,x.bk)("Makes current unit group attack enemy with additional lightning damage."),(0,x.bk)("If current unit group is cavalry type, damage is doubled, as well as critical damage is added"),(0,x.bk)("Consumes Turn.")]}),config:{spellConfig:{init({actions:r,events:l,vfx:o}){l.on({PlayerTargetsSpell({target:a}){const u=r.getCurrentUnitGroup(),h=u.modGroup.getModValue("isCavalry"),m=r.createModifiers({criticalDamageMul:h?.2:.35,criticalDamageChance:1});r.addModifiersToUnitGroup(u,m),r.dealDamageTo(a,40,At.Lightning),o.createEffectForUnitGroup(a,Wv),r.unitGroupAttack(u,a),r.removeModifiresFromUnitGroup(u,m)}})},getManaCost:()=>2}}})),pa=((0,Be.f)({id:"#item-storm-pike",name:"Storm Pike",icon:"spear-head",slot:xe.A.Weapon,cost:{gold:750},abilityDescription:"Grants ability Charged Strike that supplements unit attacks with lightning damage with additional effectiveness for any cavalry.",sellingCost:{gold:340},stats:{heroBonusAttack:3},spells:[{level:1,spell:Xh}]}),(0,Be.f)({id:"#item-battlemage-sword",name:"Sword of the Battle Mage",slot:xe.A.Weapon,icon:"sword",stats:{heroBonusAttack:3,heroMaxMana:8,specialtyMagicRecovery:2,specialtyFireMastery:1,specialtyColdMastery:1,specialtyLightningMastery:1},cost:{gold:1e3,redCrystals:1},sellingCost:{gold:600},description:({thisItemBase:l})=>({descriptions:[(0,x.A9)(l)]})}),(0,Be.f)({id:"#item-kite-shield",name:"Kite Shield",icon:"shield",slot:xe.A.Shield,cost:{gold:450},sellingCost:{gold:400},stats:{__attackConditionalModifiers:()=>({damageBlockMax:14,damageBlockMin:10,chanceToBlock:1}),heroBonusDefence:1},abilityDescription:"100% chance to block 10-14 damage"}),Rt.Wr.createHero({id:"#hero-helvetica",name:"Helvetica",generalDescription:(0,x.Ym)("Helvetica is the mage who supports her own army with offensive fire spells as well as increasing their speed."),image:ce._T.HeroHelvetica,abilities:[al,Uh],army:[{maxUnitGroups:2,minUnitGroups:2,units:[["#unit-h00",20,32,1],["#unit-h10",12,18,1],["#unit-h20",6,11,1]]}],items:[ua],resources:{gems:0,gold:750,redCrystals:0,wood:4},stats:{mana:12,baseAttack:1,baseDefence:0},defaultModifiers:{}}),(0,Be.f)({id:"#item-light-boots",name:"Light Boots",icon:"boot-stomp",slot:xe.A.Boots,cost:{gold:425},sellingCost:{gold:200},stats:{heroBonusDefence:1,__unitConditionalMods:r=>1===r.type.level?r.type.upgraded?{unitGroupSpeedBonus:5}:{unitGroupSpeedBonus:2}:null},abilityDescription:"Increases speed of tier 1 units by 2 (5 if unit is upgraded)."})),fa="fire-shield",Ad={fontSize:"64px",color:"#ffbc6c"},C_=zt([[Me(fa,"fire-main"),[{opacity:"0"},{opacity:"1",offset:.25},{opacity:"1",offset:.35},{offset:.76,opacity:"0"},{opacity:"0"}],{...Ad,opacity:"1"}],[Me(fa,"fire-blur"),[{filter:"blur(10px)"},{filter:"blur(0px)",offset:.4},{filter:"blur(0px)",opacity:0}],{...Ad,filter:"blur(6px)",opacity:"1",mixBlendMode:"hard-light"}],[Me(fa,"fire-pulse"),$n(),{...Ad,opacity:"0.2",transform:"translate(-50%, -50%) scale(1)",mixBlendMode:"hard-light"}]]),w_=ve({id:"#spell-fire-shield-buff",name:"Fire Shield",activationType:se.Buff,icon:{icon:fa,...dd},getDescription:()=>({descriptions:[(0,x.bk)("Unit is protected by Fire Shield, blocking 14-18 damage with 100% and receiving 15% Fire Resist.")]}),config:{spellConfig:{init:({events:r,actions:l,vfx:o})=>{const a=l.createModifiers({__attackConditionalModifiers:()=>({chanceToBlock:1,damageBlockMax:18,damageBlockMin:14,resistFire:15})});r.on({SpellPlacedOnUnitGroup(u){o.createEffectForUnitGroup(u.target,C_,{duration:800}),l.addModifiersToUnitGroup(u.target,a)}})}}}}),b_=ve({id:"#spell-fire-shield",name:"Fire Shield",activationType:se.Target,icon:{icon:fa},getDescription:()=>({descriptions:[(0,x.bk)("Protects allied unit with a fire shield that blocks damage.")]}),config:{spellConfig:{targetCastConfig:{canActivate:Xc},getManaCost:r=>({1:2,2:2,3:3,4:3}[r.currentLevel]),init:({events:r,actions:l,ownerPlayer:o})=>{r.on({PlayerTargetsSpell(u){const h=l.createSpellInstance(w_);l.addSpellToUnitGroup(u.target,h,o)}})}}}}),fl=ve({id:"#spell-summon-fire-spirits",name:"Fire Spirits",activationType:se.Instant,icon:{icon:"aura"},getDescription:({spellInstance:r})=>({descriptions:[(0,x.bk)(`Summon ${3+2*r.currentLevel} Fire Spirits that fight on your side.`),(0,x.bk)("<br>Spirits have active ability Fire Shield and disappear when the fight is over.")]}),config:{spellConfig:{getManaCost:r=>2+r.currentLevel,init({actions:r,spellInstance:l,ownerPlayer:o,events:a,vfx:u}){a.on({PlayerCastsInstantSpell(){const h=r.summonUnitsForPlayer(o,"#unit-neut-fire-spirit-0",3+2*l.currentLevel),m=r.createSpellInstance(b_,{initialLevel:1});r.addSpellToUnitGroup(h,m,o),u.createEffectForUnitGroup(h,bh,{duration:1e3}),r.getAliveUnitGroupsOfPlayer(r.getEnemyOfPlayer(o))}})}}}}),lr={gems:0,gold:1250,redCrystals:0,wood:2},kd=(Rt.Wr.createHero({id:"#hero-taltir",name:"Taltir",generalDescription:(0,x.Ym)("Taltir specializes at utilizing Fire Spells, summoning Fire Spirits and devastating Meteors. Knowledge in magic defenses makes him start with +12% to all resists."),image:ce._T.HeroTaltir,abilities:[fl,hn],army:[{maxUnitGroups:2,minUnitGroups:2,units:[["#unit-h20",6,11,2],["#unit-h30",3,6,2],["#unit-h00",25,30,1]]}],items:[Id,pa],resources:lr,stats:{mana:14,baseAttack:2,baseDefence:2},defaultModifiers:{resistAll:12}}),(0,x.QO)(.14)),tg="cracked-shield",Kr={fontSize:"64px",color:"rgb(220 145 129)"},T_=zt([[Me(tg,"fire-main"),[{opacity:"0",transform:"translate(-50%, -50%) scale(0.8)"},{opacity:"1",offset:.25,transform:"translate(-50%, -50%)  scale(1.2)"},{opacity:"1",offset:.35,transform:"translate(-50%, -50%)  scale(1.6)"},{offset:.76,opacity:"0",transform:"translate(-50%, -50%)  scale(1.9)"},{opacity:"0",transform:"translate(-50%, -50%)  scale(2.1)"}],{...Kr,opacity:"1"}],[Me(tg,"fire-blur"),[{filter:"blur(10px)"},{filter:"blur(0px)",offset:.4},{filter:"blur(0px)",opacity:0}],{...Kr,filter:"blur(6px)",opacity:"1",mixBlendMode:"hard-light"}],[Me(tg,"fire-pulse"),$n(),{...Kr,opacity:"0.2",transform:"translate(-50%, -50%) scale(1)",mixBlendMode:"hard-light"}]]),ng=ve({id:"#spell-corrosive-fog-debuff",name:"Corrosion",activationType:se.Debuff,icon:{icon:"cracked-shield",...qr},getDescription:r=>({descriptions:[(0,x.bk)(`Defence is lowered by 5, damage by ${kd}. Rounds left: ${r.spellInstance.state?.debuffRoundsLeft}.`)]}),config:{spellConfig:{init({events:r,actions:l,thisSpell:o,spellInstance:a,vfx:u}){r.on({SpellPlacedOnUnitGroup({target:h}){const m={debuffRoundsLeft:2};a.state=m;const _=l.createModifiers({baseDamagePercentModifier:-.14,heroBonusDefence:-5});u.createEffectForUnitGroup(h,T_),l.addModifiersToUnitGroup(h,_),l.historyLog(`${h.type.name} gets negative effect "${o.name}"`),r.on({NewRoundBegins(b){m.debuffRoundsLeft--,m.debuffRoundsLeft||(l.removeSpellFromUnitGroup(h,a),l.removeModifiresFromUnitGroup(h,_))}})}})}}}}),ig={id:"#spell-corrosive-fog",name:"Corrosive Fog",activationType:se.Target,icon:{icon:"cracked-shield"},getDescription:r=>({descriptions:[(0,x.bk)(`Surrounds an enemy with corrosive fog, reducing defence by 5 and outgoing damage by ${kd}. Lasts 2 rounds.`)]}),config:{spellConfig:{targetCastConfig:{canActivate:en},getManaCost:r=>({1:2,2:2,3:3,4:4}[r.currentLevel]),init({events:r,actions:l,ownerPlayer:o,ownerHero:a,thisSpell:u}){r.on({PlayerTargetsSpell(h){l.historyLog(`${a.name} casts "${u.name}" against ${h.target.type.name}`);const m=l.createSpellInstance(ng);l.addSpellToUnitGroup(h.target,m,o)}})}}}},Nd=(Rt.Wr.createHero({id:"#hero-veasin",name:"Veasin",generalDescription:(0,x.Ym)("Veasin makes use of her poison abilities, weakening enemies and dealing damage over time."),image:ce._T.HeroMage,abilities:[jh,ig],army:[{maxUnitGroups:2,minUnitGroups:2,units:[["#unit-h01",10,18,2],["#unit-h20",6,11,1],["#unit-h30",3,5,1]]}],items:[ua],resources:{gold:1100,wood:2,gems:0,redCrystals:0},stats:{mana:14,baseAttack:4,baseDefence:2}}),ve({id:"#spell-onslaught-buff",name:"Onslaught",icon:{icon:"spear-head",bgClr:"orange",iconClr:"#f10c0c"},activationType:se.Buff,getDescription:()=>({descriptions:[(0,x.bk)("This group of Raiders has increased stats and 40% lifesteal.")]}),config:{spellConfig:{getManaCost:()=>3,init({events:r,actions:l}){const a=l.createModifiers({lifesteal:40,heroBonusAttack:3,heroBonusDefence:2});r.on({SpellPlacedOnUnitGroup({target:u}){l.addModifiersToUnitGroup(u,a)}})}}}})),og=ve({id:"#spell-onslaught",name:"Onslaught",icon:{icon:"spear-head"},activationType:se.Target,getDescription:()=>({descriptions:[(0,x.bk)("Can only be casted on Raiders. Increases their stats and grants lifesteal.")]}),config:{spellConfig:{getManaCost:()=>1,init({events:r,actions:l,vfx:o,ownerPlayer:a}){r.on({PlayerTargetsSpell({target:u}){o.createEffectForUnitGroup(u,Qc("spear-head","orange"));const h=l.createSpellInstance(Nd,{initialLevel:1});l.addSpellToUnitGroup(u,h,a)}})},targetCastConfig:{canActivate:({isEnemy:r,unitGroup:l})=>!r&&"Raiders"===l.type.name}}}}),ha=(Rt.vn.createHero({id:"#hero-toothpick",name:"Toothpick",generalDescription:(0,x.Ym)("Toothpick is a famous captain of Raiders, their effectiveness excels under his command."),image:ce._T.HeroKnight,abilities:[og],army:[{maxUnitGroups:2,minUnitGroups:2,units:[["#unit-f00",16,18,1],["#unit-f10",10,10,1]]}],items:[],resources:lr,stats:{mana:10,baseAttack:2,baseDefence:2},defaultModifiers:{}}),ve({id:"#spell-life-transfer",name:"Life Transfer",icon:{icon:"health-decrease"},activationType:se.Instant,getDescription:()=>({descriptions:[(0,x.bk)("Reallocates health from enemies, dealing 20 damage to all enemies and equally distributing the dealt damage as healing among your army.")]}),config:{spellConfig:{getManaCost:()=>3,init({events:r,actions:l,ownerPlayer:a}){r.on({PlayerCastsInstantSpell(){const u=l.getEnemyOfPlayer(a),h=l.getAliveUnitGroupsOfPlayer(u),m=h.length;h.forEach(T=>{l.dealDamageTo(T,20,At.Magic)});const _=20*m,b=l.getUnitGroupsOfPlayer(a),S=Math.round(_/b.length);b.forEach(T=>l.healUnit(T,S))}})}}}})),rg=ve({id:"#spell-obelisk",name:"Life Obelisk",icon:{icon:"arena"},activationType:se.Target,getDescription:()=>({descriptions:[(0,x.bk)("Stuns selected target and summons an Obelisk with 100 health. Obelisk possesses aura that increases the armor by 4."),(0,x.bk)("Obelisk cannot attack, but can be attacked and destroyed."),(0,x.bk)("Some of Blight's abilities interact with obelisk."),(0,x.bk)("Cannot be casted while there is another obelisk.")]}),config:{spellConfig:{getManaCost:()=>3,init({events:r,actions:l,vfx:o}){r.on({PlayerTargetsSpell({target:a}){o.createDroppingMessageForUnitGroup(a.id,{html:Wi("Stunned!")}),l.removeTurnsFromUnitGroup(a,2)}})},targetCastConfig:{canActivate:en}}}}),ml=(Rt.vn.createHero({id:"#hero-blight",name:"Blight",generalDescription:(0,x.Ym)("A rotting ent called Blight. His army is weakened by -10% All Resist and -5 Defence, but compensating it with abilities and providing many ways to heal."),image:ce._T.HeroKnight,abilities:[rg,ha],army:[{maxUnitGroups:2,minUnitGroups:2,units:[["#unit-f00",13,16,2],["#unit-f10",10,14,1]]}],items:[],resources:lr,stats:{mana:16,baseAttack:2,baseDefence:0},defaultModifiers:{heroBonusDefence:-5,resistAll:-10}}),ve({id:"#spell-firestorm",name:"Firestorm",icon:{icon:"flaming-claw"},activationType:se.Target,getDescription:()=>({descriptions:[(0,x.bk)("Deals 100 damage to the target as fire damage while converting 30% of it to pure damage. Your current unit is going to suffer 25% of that damage as fire damage.")]}),config:{spellConfig:{getManaCost:()=>3,init({events:r,actions:l}){r.on({PlayerTargetsSpell({target:a}){l.dealDamageTo(a,70,At.Fire),l.dealDamageTo(a,30,At.Magic),l.dealDamageTo(l.getCurrentUnitGroup(),25,At.Fire)}})},targetCastConfig:{canActivate:en}}}})),ga=(Rt.vn.createHero({id:"#hero-firebrand",name:"Firebrand",generalDescription:(0,x.Ym)("A half-troll who harnessed the chaotic nature of fire magic, which ends up unfortunately both for his enemies and allies. All Fort units will start with -15% Fire Resist."),image:ce._T.HeroKnight,abilities:[ml],army:[{maxUnitGroups:2,minUnitGroups:2,units:[["#unit-f00",16,18,1],["#unit-f10",10,10,1]]}],items:[],resources:lr,stats:{mana:10,baseAttack:2,baseDefence:2},defaultModifiers:{__unitConditionalMods:r=>r.type.faction===Rt.vn?{resistFire:-15}:null}}),ve({id:"#spell-summon-sagittar",name:"Summon Sagittar",activationType:se.Instant,icon:{icon:"arrow-cluster"},getDescription:r=>({descriptions:[(0,x.bk)("Summons 4 Sagittars that fight on your side.")]}),config:{spellConfig:{getManaCost:()=>2,init({actions:r,ownerPlayer:o,events:a,vfx:u}){a.on({PlayerCastsInstantSpell(){const m=r.summonUnitsForPlayer(o,"#unit-c00",4);u.createEffectForUnitGroup(m,Yc("arrow-cluster","rgb(190, 190, 231)"),{duration:1e3})}})}}}}));Ki.createHero({id:"#hero-blackbird",name:"Blackbird",image:ce._T.HeroBlackbird,abilities:[al,ga,n_],army:[{maxUnitGroups:3,minUnitGroups:3,units:[["#unit-c00",6,11,2],["#unit-c10",3,5,1]]},{maxUnitGroups:2,minUnitGroups:2,units:[["#unit-c00",12,18,1],["#unit-c10",7,12,1]]},{maxUnitGroups:3,minUnitGroups:3,units:[["#unit-c00",6,10,1],["#unit-c10",4,6,2]]}],generalDescription:(0,x.Ym)("Blackbird is a hero who specializes at Astral and Fire magic, as well as Summoning."),items:[y_],stats:{baseAttack:2,baseDefence:4,mana:15},resources:{gems:1,gold:1e3,redCrystals:1,wood:1}});var nn=function(r){return r[r.Event=0]="Event",r[r.LocationAction=1]="LocationAction",r[r.PlayerAction=2]="PlayerAction",r}(nn||{});const Rd=r=>`<i class="ra ra-${r}"></i>`,vl=r=>r+Rd("crystal-ball");function bn(r){return(0,pt.uB)(r),r}const Ud=bn({id:"#acard-setup-camp",title:"Set up Camp",icon:"campfire",type:nn.PlayerAction,bgColor:"gray",iconColor:"#ffae66",description:"You set up camp, skipping this day.",config:{onUsedInstantly({events:r,actions:l}){r.dispatch(yo({points:l.getActionPointsLeft()}))}}}),_l=bn({id:"#acard-skip-the-day",title:"Skip the day",icon:"moon-sun",type:nn.PlayerAction,bgColor:"#283761",iconColor:"rgb(255 198 90)",borderColor:"rgb(255 198 90)",description:"You will immediately skip this day and receive 200 gold for each remaining action point left.",config:{onUsedInstantly({events:r,players:l,actions:o}){const a=l.getCurrentPlayer(),u=o.getActionPointsLeft(),h=200*u;r.dispatch(yo({points:u})),l.giveResourcesToPlayer(a,{gold:h}),r.dispatch(Ci({message:[{type:x.xL.FreeHtml,htmlContent:`${or(_l)}:<hr/>+${h} Gold`}]}))}}}),Mo=bn({id:"#acard-meditate",title:"Meditate",icon:"barrier",bgColor:"rgb(39 57 89)",iconColor:"#d9f2fd",type:nn.PlayerAction,description:`You restore ${vl(3)} mana (+${vl(2)} per point of Restoration specialty), consumes ${2+Rd("feather-wing")} action points. Action restored every week.`,actionPoints:2,config:{onUsedInstantly({events:r,players:l}){const o=l.getCurrentPlayer(),h=3+2*(o.hero.specialtiesModGroup.getModValue("specialtyMagicRecovery")||0);l.addManaToPlayer(o,h),r.dispatch(Ci({message:[{type:x.xL.FreeHtml,htmlContent:`${or(Mo)}: Restored ${vl(h)} Mana.`}]}))}}}),Ld=bn({id:"#acard-restore-mana",title:"Restore Mana",icon:"barrier",bgColor:"rgb(39 57 89)",iconColor:"#d9f2fd",type:nn.PlayerAction,description:"You restore 3 points of mana (+2 per point of Restoration specialty), consumes 1 action point.",actionPoints:1,config:{onUsedInstantly({events:r,players:l}){const o=l.getCurrentPlayer(),h=3+2*(o.hero.specialtiesModGroup.getModValue("specialtyMagicRecovery")||0);l.addManaToPlayer(o,h),r.dispatch(Ci({message:[{type:x.xL.FreeHtml,htmlContent:`${or(Ld)}: Restored ${vl(h)} Mana.`}]}))}}}),P_=(bn({id:"#acard-recruit",title:"Recruit",icon:"knight-helmet",bgColor:"rgb(39 57 89)",iconColor:"#d9f2fd",type:nn.PlayerAction,description:"Gives you additional units below tier 3, consumes 2 action points."}),bn({id:"#acard-rangers-horn",title:"Ranger's Horn",description:"8 Rangers will join your army for 3 days. Rangers are effective against forest dwellers.",bgColor:"#3c843c",icon:"hood",type:nn.PlayerAction,config:{onUsedInstantly({actions:r,players:l,events:o}){const a="#unit-neut-ranger-0",u=l.getCurrentPlayer();l.addUnitGroupToPlayer(u,a,8),o.dispatch(nr({message:"8 Rangers joined your army."})),r.scheduleAction(()=>{l.removeUnitTypeFromPlayer(u,a,8),o.dispatch(nr({message:"Summoned Rangers have left your army."}))},2)}}}));var Mn=function(r){return r[r.Hiring=0]="Hiring",r[r.Garrison=1]="Garrison",r[r.ItemsSelling=2]="ItemsSelling",r}(Mn||{});let e1=(()=>{class r extends ir.l{constructor(){super(...arguments),this.currentLevel=0,this.built=!1}static#e=this.categoryId="building";create(o){this.base=o.base,this.currentBuilding=o.base.levels[0].building}}return r})();function He(r){return(0,pt.uB)(r),r}function ur(r,l,o,a=!1){return{type:Mn.Hiring,hiring:{unitTypeId:r,growth:l,refillDaysInterval:7},unitGrowthGroup:o,growth:l,growthIntervalDays:7,upgrade:a}}function Si(r,l,o,a=!1){return{type:Mn.Hiring,hiring:{unitTypeId:r,growth:l,refillDaysInterval:7},unitGrowthGroup:o,growth:l,growthIntervalDays:7,upgrade:a}}const ag=He({id:"#build-castle-town-center",name:"Town Center",description:"Earns 500 gold each day.",config:{init({players:r,localEvents:l}){l.on({NewDayBegins(){r.giveResourcesToPlayer(r.getCurrentPlayer(),{gold:500})}})}}}),cg=He({id:"#build-castle-market",name:"Market"}),lg=He({id:"#build-castle-high-tower",name:"High Tower",description:"Gives 1 Meditation action card instantly and at the beginning of each week.",config:{init({localEvents:r,players:l,globalEvents:o}){o.dispatch(jr({actionCardStacks:[{card:Mo,count:1}],player:l.getCurrentPlayer()})),r.on({NewWeekStarts(){o.dispatch(jr({actionCardStacks:[{card:Mo,count:1}],player:l.getCurrentPlayer()}))}})}}}),dr=He({id:"#build-castle-tavern",activity:{type:Mn.Garrison},name:"Tavern",description:"Allows to hire more units, including neutral ones, from your garrison",config:{init({globalEvents:r,players:l,localEvents:o}){r.dispatch(jr({actionCardStacks:[{card:P_,count:1}],player:l.getCurrentPlayer()})),o.on({Built(){l.getCurrentPlayer().garrisons.set("castle-tavern",{groups:[{cost:{gold:200},count:8,type:(0,pt.fH)("#unit-neut-ranger-0")}],name:"Castle Tavern"})},NewWeekStarts(){l.getCurrentPlayer().garrisons.set("castle-tavern",{groups:[{cost:{gold:200},count:8,type:(0,pt.fH)("#unit-neut-ranger-0")}],name:"Castle Tavern"})}})}}}),A_=He({id:"#build-castle-taining-camp-1",name:"Training Camp",description:"Allows to train Pikemans that can be upgraded.",activity:Si("#unit-h00",18,"pikeman")}),O_=He({id:"#build-castle-taining-camp-2",name:"Upg. Training Camp",description:"Allows to hire and upgrade Halberdiers",activity:Si("#unit-h00",18,"pikeman",!0)}),k_=He({id:"#build-castle-archers-1",name:"Archers Outpost",description:"Allows to train Archers",activity:Si("#unit-h10",12,"archers")}),N_=He({id:"#build-castle-archers-2",name:"Upg. Archers Outpost",description:"Allows to train Archers and Crossbowmen",activity:Si("#unit-h10",12,"archers",!0)}),F_=He({id:"#build-castle-knights-1",name:"Halls of Knights",description:"Allows to train Knights",activity:Si("#unit-h20",4,"knights")}),Xi=He({id:"#build-castle-cavalry-1",name:"Cavalry Stalls",description:"Allows to train Cavalry",activity:Si("#unit-h30",2,"cavalry")}),Xr=He({id:"#build-castle-magic-tower-1",name:"Magic Tower",description:"Allows to train Mystical Birds",activity:Si("#unit-h40",2,"firebirds")}),R_=He({id:"#build-castle-magic-tower-2",name:"Upg. Magic Tower",description:"Allows to train Mystical Birds and Firebirds",activity:Si("#unit-h40",2,"firebirds",!0)}),U_=He({id:"#build-castle-items-market",name:"Item market",activity:{type:Mn.ItemsSelling},description:"Sells items",config:{init({localEvents:r,thisBuilding:l}){r.on({Built(){l.addCustomData({items:["#item-iron-pike","#item-irton-plate","#item-kite-shield","#item-storm-pike","#item-battlemage-sword"],selling:!0})}})}}}),L_=He({id:"#build-castle-halls-of-fate",name:"Halls of Fate"}),G_=He({id:"#build-castle-garrison",name:"Garrison",description:"Allows to hire groups of units temporarily for reduced cost.",activity:{type:Mn.Garrison},config:{init({localEvents:r,players:l}){r.on({Built(){l.getCurrentPlayer().garrisons.set("castle-garrison",{groups:[{cost:{gold:200},type:(0,pt.fH)("#unit-h00"),count:16},{cost:{gold:340},type:(0,pt.fH)("#unit-h20"),count:6}],name:"Castle Garrison"})},NewWeekStarts(){l.getCurrentPlayer().garrisons.set("castle-garrison",{groups:[{cost:{gold:200},type:(0,pt.fH)("#unit-h00"),count:16},{cost:{gold:340},type:(0,pt.fH)("#unit-h20"),count:6}],name:"Castle Garrison"})}})}}});Rt.Wr.setTownBase({id:"#town-castle",name:"Castle",availableBuildings:{"town-center":{baseName:"Town Center",description:"Grants you daily income",levels:[{building:ag,cost:{gold:1e3}}],icon:"capitol",tier:1},"items-market":{baseName:"Items Market",description:"Sells items",icon:"key-basic",levels:[{building:U_,cost:{gold:500}}],tier:1},market:{baseName:"Market",description:"Allows to trade resources",levels:[{building:cg,cost:{gold:1500,wood:2}}],icon:"gavel",tier:2},"magic-school":{baseName:"Magic School",description:"Allows you to learn spells for your hero",levels:[{building:lg,cost:{gold:1e3,gems:2}}],icon:"burning-book",tier:2},tavern:{baseName:"Tavern",description:"Allows to hire neutral units",levels:[{building:dr,cost:{gold:850,wood:1}}],icon:"hood",tier:2},garrison:{baseName:"Garrison",description:"Allows to hire units temorary",icon:"guarded-tower",tier:1,levels:[{building:G_,cost:{wood:2,gold:500}}]},"fate-halls":{baseName:"Halls of Fate",description:"Allows to develop your hero",levels:[{building:L_,cost:{gold:1e3}}],icon:"barrier",tier:3},"training-camp":{baseName:"Training Camp",description:"Trains Pikemans",levels:[{building:A_,cost:{gold:450}},{building:O_,cost:{gold:150,wood:2}}],icon:"spear-head",tier:1},"archers-outpost":{baseName:"Archers Outpost",description:"Trains Archers",levels:[{building:k_,cost:{gold:500,wood:2}},{building:N_,cost:{gold:400,wood:2}}],icon:"arrow-cluster",tier:1},"halls-of-knights":{baseName:"Halls of Knights",description:"Trains Knights",levels:[{building:F_,cost:{gold:1e3,wood:5}}],icon:"crossed-swords",tier:2},"cavalry-halls":{baseName:"Cavalry Halls",description:"Trains Cavalry",levels:[{building:Xi,cost:{gold:1e3,wood:5}}],icon:"horseshoe",tier:3},"magic-tower":{baseName:"Magic Tower",description:"Trains Firebirds and Mystical Birds",levels:[{building:Xr,cost:{gold:1500,wood:5}},{building:R_,cost:{gold:600,wood:5}}],icon:"tower",tier:4}}});const B_=He({id:"#build-fort-town-hall-1",name:"Town Hall",description:"Earns 400 gold each day and gives 1 additional reserve slot.",config:{init({players:r,localEvents:l}){l.on({NewDayBegins(){r.giveResourcesToPlayer(r.getCurrentPlayer(),{gold:400})},Built(){r.getCurrentPlayer().hero.addReserveSlots(1)}})}}}),ug=He({id:"#build-fort-market",name:"Market"}),j_=He({id:"#build-fort-tavern",name:"Tavern"}),$_=He({id:"#build-fort-rocky-caves",name:"Rocky Caves",description:"Allows to hire units temporarily",activity:{type:Mn.Garrison},config:{init({localEvents:r,players:l}){r.on({Built(){l.getCurrentPlayer().garrisons.set("rocky-caves",{groups:[{cost:{gold:100},count:8,type:(0,pt.fH)("#unit-f00")},{cost:{gold:100},count:8,type:(0,pt.fH)("#unit-f00")},{cost:{gold:100},count:8,type:(0,pt.fH)("#unit-f00")}],name:"Rocky Caves"})},NewWeekStarts(){l.getCurrentPlayer().garrisons.set("rocky-caves",{groups:[{cost:{gold:100},count:8,type:(0,pt.fH)("#unit-f00")},{cost:{gold:100},count:8,type:(0,pt.fH)("#unit-f00")},{cost:{gold:100},count:8,type:(0,pt.fH)("#unit-f00")}],name:"Rocky Caves"})}})}}}),Z_=He({id:"#build-fort-goblin-huts-1",name:"Goblin Huts",description:"Allows to train Raiders that can be upgraded.",activity:ur("#unit-f00",18,"raiders")}),V_=He({id:"#build-fort-goblin-huts-2",name:"Upg. Goblin Huts",description:"Allows to train Raiders and Clan.",activity:ur("#unit-f00",18,"raiders",!0)}),Cl=He({id:"#build-fort-stockade-1",name:"Stockade",description:"Allows to train Goblin Archers that can be upgraded.",activity:ur("#unit-f10",18,"goblinArcher")}),eo=He({id:"#build-fort-stockade-2",name:"Upg. Stockade",description:"Allows to train Goblin Archers and Goblin Shooters.",activity:ur("#unit-f10",18,"goblinArcher",!0)});function Gd(r,l,o,a=!1){return{type:Mn.Hiring,hiring:{unitTypeId:r,growth:l,refillDaysInterval:7},unitGrowthGroup:o,growth:l,growthIntervalDays:7,upgrade:a}}Rt.vn.setTownBase({id:"#town-fort",name:"Castle",availableBuildings:{"town-hall":{baseName:"Town Hall",description:"Grants you daily income",levels:[{building:B_,cost:{gold:1e3}}],icon:"capitol",tier:1},market:{baseName:"Market",description:"Allows to trade resources",levels:[{building:ug,cost:{gold:1500,wood:2}}],icon:"gavel",tier:1},"rocky-caves":{baseName:"Rocky Caves",description:"Allows to hire units temporarily",icon:"guarded-tower",levels:[{building:$_,cost:{gold:200,wood:2}}],tier:1},tavern:{baseName:"Tavern",description:"Allows to hire neutral units",levels:[{building:j_,cost:{gold:1250,wood:3}}],icon:"hood",tier:2},"goblin-huts":{baseName:"Golbin Huts",description:"Trains Goblin Huts",levels:[{building:Z_,cost:{gold:475}},{building:V_,cost:{gold:150,wood:2}}],icon:"spear-head",tier:1},stockade:{baseName:"Stockade",description:"Trains Goblin Archers",levels:[{building:Cl,cost:{gold:700}},{building:eo,cost:{gold:150,wood:2}}],icon:"spear-head",tier:1}}});const dg=He({id:"#build-stellar-town-center-1",name:"Town Center"}),pg=He({id:"#build-stellar-market",name:"Market"}),t1=He({id:"#build-stellar-high-tower",name:"High Tower"}),n1=He({id:"#build-stellar-tavern",name:"Tavern"}),i1=He({id:"#build-stellar-solar-gate",name:"Solar Gate",description:"Allows to hire units temporarily",activity:{type:Mn.Garrison},config:{init({localEvents:r,players:l}){r.on({Built(){l.getCurrentPlayer().garrisons.set("solar-gate",{name:"Solar Gate",groups:[{cost:{gold:130},count:8,type:(0,pt.fH)("#unit-c00")},{cost:{gold:130},count:8,type:(0,pt.fH)("#unit-c00")},{cost:{gold:180},count:8,type:(0,pt.fH)("#unit-c20")}]})}})}}}),Hd=He({id:"#build-stellar-spirit-towers",name:"Spirit Towers",description:"Allows to train Sprites.",activity:Gd("#unit-c00",10,"sprite")}),Bd=He({id:"#build-stellar-moon-arch-1",name:"Moon Arch",activity:Gd("#unit-c00",8,"saggitar")}),o1=He({id:"#build-stellar-fate-halls",name:"Halls of Fate"});Ki.setTownBase({id:"#town-constellation",name:"Constellation",availableBuildings:{"town-center":{baseName:"Town Center",description:"Grants you daily income",levels:[{building:dg,cost:{gold:2e3}}],icon:"capitol",tier:1},market:{baseName:"Market",description:"Allows to trade resources",levels:[{building:pg,cost:{gold:1350}}],icon:"gavel",tier:1},"star-gate":{baseName:"Solar Gate",description:"Allows to temporarily summon units for reduced cost",icon:"heavy-fall",tier:1,levels:[{building:i1,cost:{gold:500,wood:1}}]},"magic-school":{baseName:"Magic School",description:"Allows you to learn spells for your hero",levels:[{building:t1,cost:{gold:1500,gems:1}}],icon:"burning-book",tier:2},tavern:{baseName:"Tavern",description:"Allows to hire neutral units",levels:[{building:n1,cost:{gold:1250}}],icon:"hood",tier:2},"fate-halls":{baseName:"Halls of Fate",description:"Allows to develop your hero",levels:[{building:o1,cost:{gold:1500}}],icon:"barrier",tier:2},"spirit-towers":{baseName:"Spirit Towers",description:"Trains Sprites",levels:[{building:Hd,cost:{gold:450}}],icon:"spear-head",tier:1},"moon-arch":{baseName:"Moon Arch",description:"Trains Sagittars",levels:[{building:Bd,cost:{gold:500,wood:1}}],icon:"arrow-cluster",tier:1}}});class fg{constructor(l){this.mapSize={...l.mapDimensions},this.structures=l.structures,this.startingLocId=l.startLocId}}var Bt=function(r){return r.Neutral="neutral",r.EnemyPlayer="enemy",r}(Bt||{}),Do=function(r){return r[r.Scripted=0]="Scripted",r}(Do||{}),on=function(r){return r.SingleResource="resource",r.Resources="resources",r.Item="item",r.UnitsHire="hire",r.Mines="mines",r.UnitsUpgrade="upgrading",r.Scripted="scripted",r.NoReward="no-reward",r}(on||{});function rn(r){return(0,pt.uB)(r),r}function jd({id:r,name:l,guard:o,unitsForHire:a}){return{id:r,name:l,actionPoints:1,control:Bt.Neutral,generateGuard:()=>o,generateReward:()=>({type:on.UnitsHire,units:a})}}function Ti(r,l){return l.map(o=>({...o,id:`${r}.${o.id}`,pathTo:o.pathTo?o.toOuterBranch?o.pathTo:`${r}.${o.pathTo}`:void 0}))}let es=(()=>{class r extends ir.l{constructor(){super(...arguments),this.name="",this.x=0,this.y=0,this.parentStructs=new Set,this.icon="",this.isInactive=!1,this.isCompleted=!1,this.actionPoints=0}static#e=this.categoryId="structure";create({iconName:o,x:a,y:u,isRoot:h,generator:m,guardingPlayer:_,pathTo:b,actionPoints:S,structParams:T}){this.x=a,this.y=u,this.icon=o,this.isRoot=h,this.generator=m,this.structParams=T,m&&(this.name=m.description?.({thisStruct:this}).name??m.name),this.actionPoints=S||m?.actionPoints||0,this.guardingPlayer=_,this.pathTo=b}setControls(o){this.controls=this.controls?{...this.controls,...o}:o}getStructParams(){return this.structParams}}return r})();const pr=jd({id:"#struct-archers-outpost",name:"Archers Outpost",guard:{maxUnitGroups:3,minUnitGroups:3,units:[["#unit-h10",8,11,3]]},unitsForHire:[{unitTypeId:"#unit-h10",maxCount:12}]});var Je=function(r){return r.Gold="gold",r.Wood="wood",r.RedCrystals="redCrystals",r.Gems="gems",r}(Je||{});const $d={[Je.Gems]:"Gems",[Je.Gold]:"Gold",[Je.RedCrystals]:"Red Crystals",[Je.Wood]:"Wood"};function bl(r){return Object.entries(r).map(([l,o])=>({resName:$d[l],type:l,count:o}))}function gg(r){return function hg(r){return Object.entries(r).map(([l,o])=>`+${o} ${$d[l]}`)}(r).join("\n")}const fr=rn({id:"#struct-bandit-camp",name:"Bandit Camp",actionPoints:1,control:Bt.Neutral,generateGuard:()=>({maxUnitGroups:2,minUnitGroups:1,units:[["#unit-neut-thief-0",14,24,1],["#unit-neut-gnoll-0",14,24,3]]}),generateReward:()=>Te.DN.randBoolean()?{type:on.Resources,resourceGroups:[[{type:Je.Gold,count:450},{type:Je.Gems,count:1}],[{type:Je.Gold,count:800},{type:Je.Wood,count:2}]]}:{type:on.Item,itemGroups:[[Te.DN.randBoolean()?ua:pa],[g_],[Ed],[m_]]}}),q_=rn({id:"#struct-big-camp",name:"Big Camp",actionPoints:1,generateGuard:()=>({maxUnitGroups:3,minUnitGroups:3,units:[["#unit-neut-forest-troll-0",23,25,1],["#unit-neut-gnoll-0",28,36,1],["#unit-neut-thief-0",15,18,1]]}),control:Bt.Neutral,generateReward:()=>({type:on.Scripted,description:"Big camp is defeated! \n\n +450 Experience",onAccept({playersApi:r}){const l=r.getCurrentPlayer();r.addExperienceToPlayer(l,450)}})}),z_=jd({id:"#struct-cavalry-stalls",name:"Cavalry Stalls",guard:{maxUnitGroups:2,minUnitGroups:2,units:[["#unit-h30",3,3,2]]},unitsForHire:[{unitTypeId:"#unit-h30",maxCount:4}]}),Y_=rn({id:"#struct-graveyard",name:"Graveyard",actionPoints:1,control:Bt.Neutral,generateGuard:()=>({maxUnitGroups:2,minUnitGroups:3,units:[["#unit-neut-ghost-0",14,18,3]]}),generateReward:()=>({type:on.UnitsHire,units:[{unitTypeId:"#unit-neut-ghost-0",maxCount:24}]})}),a1=rn({id:"#struct-undead-beacon",name:"Beacon of the Undead",control:Bt.Neutral,description:()=>({descriptions:["Allows to upgrade your ghost units below level 4."]}),generateReward:()=>({type:on.UnitsUpgrade,getUnits:r=>r.getCurrentPlayerUnitGroups().filter(l=>{const o=l.type;return!o.upgraded&&o.level<=4&&o.defaultModifiers?.isGhost})})}),c1=rn({id:"#struct-magic-river",control:Bt.Neutral,actionPoints:1,name:"Magic River",description:()=>({descriptions:["Walking near magic river, you feel your magical powers restored.\n\n+4 to mana and +2 to max mana"]}),type:Do.Scripted,config:{init({localEvents:r,players:l,thisStruct:o}){r.on({StructVisited({visitingPlayer:a}){l.addMaxManaToPlayer(a,2),l.addManaToPlayer(a,4),o.visited=!0}})}}}),va=rn({id:"#struct-mountain-nest",control:Bt.Neutral,actionPoints:2,name:"Mountain Nest",description:({thisStruct:r})=>{const l=[(0,x.bk)("Walking through mountains, you find a very bright birdnest... \n\n1-2 Firebirds join your army.")];return!1===r.controls?.accept&&l.push((0,x.bk)("You have no free slots.")),{descriptions:l}},type:Do.Scripted,config:{init({localEvents:r,players:l,thisStruct:o}){r.on({StructVisited({visitingPlayer:a}){l.addUnitGroupToPlayer(a,"#unit-h40",Te.DN.randIntInRange(1,2)),o.visited=!0},StructInspected(){o.setControls({accept:l.getCurrentPlayer().hero.hasFreeUnitSlots()})}})}}}),l1=rn({id:"#struct-witch-hut",control:Bt.Neutral,actionPoints:1,name:"Witch Hut",description:()=>({descriptions:['Walking trough the woods, you find an abandoned Witch Hut.\n\nLearn "Enchant" level 2']}),type:Do.Scripted,config:{init({localEvents:r,players:l,thisStruct:o,spells:a}){r.on({StructVisited({visitingPlayer:u}){const h=a.createSpellInstance(q0,{initialLevel:2});l.addSpellToPlayerHero(u,h),o.visited=!0}})}}});var u1=M(890);const Ml=rn({id:"#struct-thief-lair",name:"Thieves' Lair",actionPoints:2,control:Bt.Neutral,generateGuard:()=>({maxUnitGroups:3,minUnitGroups:3,units:[["#unit-neut-thief-0",12,14,2],["#unit-neut-gnoll-0",14,24,3]]}),generateReward:()=>({type:on.Item,itemGroups:[[Id],[Wh],[u1.l]]})}),Q_=rn({id:"#struct-rocky-passage",name:"Rocky Passage",actionPoints:2,description:()=>({descriptions:["A rocky passage held by a powerful dragon."]}),disableWeeklyGuardRise:!0,generateGuard:()=>({minUnitGroups:1,maxUnitGroups:1,units:[["#unit-neut-boss-devastator",1,1,1]]}),control:Bt.Neutral,generateReward:()=>({type:on.NoReward})}),Zd=rn({id:"#struct-dark-arts-school",control:Bt.Neutral,actionPoints:2,name:"School of Dark Arts",description:()=>({descriptions:["You are visiting the school of dark arts.\n\n+1 to Necromancy specialty"]}),type:Do.Scripted,config:{init({localEvents:r,thisStruct:o}){r.on({StructVisited({visitingPlayer:a}){a.hero.addStatsMods({specialtyNecromancy:1}),o.visited=!0}})}}}),Vd=rn({id:"#struct-fire-ring",name:"Fire Ring",actionPoints:2,generateGuard:()=>({maxUnitGroups:3,minUnitGroups:3,units:[["#unit-neut-fire-spirit-0",7,9,3]]}),control:Bt.Neutral,generateReward:()=>({type:on.NoReward})}),ts=rn({id:"#struct-guard-lock",name:"Fire Ring",actionPoints:2,description:({thisStruct:r})=>{const{name:l}=r.getStructParams();return{name:l,descriptions:[]}},generateGuard({thisStruct:r}){const{guards:l}=r.getStructParams();return l},control:Bt.Neutral,generateReward:()=>({type:on.NoReward})}),qd=rn({id:"#struct-mausoleum",name:"Mausoleum",actionPoints:1,control:Bt.Neutral,generateGuard:()=>({minUnitGroups:3,maxUnitGroups:3,units:[["#unit-neut-skeleton-0",22,34,2],["#unit-neut-lich-0",3,4,1]]})}),Dl=rn({id:"#struct-daily-res-mine",name:"Mine with Resources",control:Bt.Neutral,description:({thisStruct:r})=>({descriptions:["You found a mine with resources, each day it will bring you:\n\n"+gg(r.structParams)]}),type:Do.Scripted,config:{init({localEvents:r,players:l,thisStruct:o}){r.on({StructVisited(){o.visited=!0,l.giveResourcesToPlayer(l.getCurrentPlayer(),o.structParams),r.on({NewDayBegins(){l.giveResourcesToPlayer(l.getCurrentPlayer(),o.structParams)}})}})}}}),So=rn({id:"#struct-res-pile",name:"Pile of Resources",control:Bt.Neutral,description:({thisStruct:r})=>{const l=r.structParams,o=bl(l);return{name:o.length>1?"Pile of Resources":`Pile of ${o[0].resName}`,descriptions:["You found a pile of resources \n\n"+gg(l)]}},type:Do.Scripted,config:{init({localEvents:r,players:l,thisStruct:o}){r.on({StructVisited({visitingPlayer:a}){o.visited=!0,l.giveResourcesToPlayer(a,o.structParams)}})}}}),To=(r,l)=>({x:r+1700,y:l+1500}),zd=Ti("const-start",[{id:"start",...To(0,0),icon:"campfire"},{id:"1",pathTo:"start",...To(90,-60),icon:"gold-bar",actionPoints:2,struct:So,structParams:{gold:650}},{id:"2",pathTo:"start",...To(10,-70),icon:"sword",struct:fr}]),xi="start";function ue(r){return r+476}const Qd=Ti("start-bottom-right",[{id:"entry",x:ue(60),y:ue(30),icon:"tombstone",pathTo:xi,toOuterBranch:!0,struct:Y_,tags:[""]},{id:"1",x:ue(120),y:ue(40),icon:"sword",pathTo:"entry",struct:fr},{id:"1-1",x:ue(140),y:ue(-10),icon:"hand-saw",pathTo:"1",actionPoints:1,struct:So,structParams:{wood:4}},{id:"witch",x:ue(180),y:ue(60),icon:"book",pathTo:"1",struct:l1},{id:"5",x:ue(120),y:ue(90),icon:"sword",pathTo:"1",struct:fr},{id:"pre-boss",x:ue(40),y:ue(80),icon:"sword",pathTo:"5",struct:fr},{id:"7",x:ue(170),y:ue(141),icon:"horseshoe",pathTo:"5",struct:z_},{id:"7-1",pathTo:"7",x:ue(165),y:ue(201),icon:"scroll-unfurled",struct:Zd},{id:"7-2",actionPoints:2,x:ue(240),y:ue(148),icon:"hand-saw",pathTo:"7",struct:Dl,structParams:{wood:1}},{id:"boss",x:ue(45),y:ue(145),icon:"monster-skull",pathTo:"pre-boss",actionPoints:2,struct:q_}]),_a=Ti("five",[{id:"1",pathTo:xi,toOuterBranch:!0,x:ue(-30),y:ue(70),icon:"gold-bar",actionPoints:1,struct:So,structParams:{gold:650}}]),W_=Ti("start-bottom-left",[{id:"entry",x:ue(-70),y:ue(10),icon:"sword",pathTo:xi,toOuterBranch:!0,struct:fr},{id:"1",x:ue(-120),y:ue(-100),icon:"mountains",pathTo:"entry",struct:va},{id:"2",x:ue(-130),y:ue(55),icon:"sword",pathTo:"entry",struct:fr},{id:"3",x:ue(-120),y:ue(-10),icon:"campfire",pathTo:"2",struct:Ml},{id:"4",actionPoints:4,x:ue(-180),y:ue(-80),icon:"crystals",pathTo:"3",struct:Dl,structParams:{redCrystals:1}},{id:"pre-boss",x:ue(-190),y:ue(20),icon:"fire-ring",pathTo:"2",struct:Vd,actionPoints:2},{id:"boss",x:ue(-250),y:ue(-50),icon:"monster-skull",pathTo:"pre-boss",struct:Q_,actionPoints:2},{id:"post-boss",pathTo:"boss",icon:"capitol",x:ue(-300),y:ue(-80),actionPoints:2,struct:qd},{id:"wagon",x:ue(-190),y:ue(90),icon:"mine-wagon",pathTo:"2",struct:So,structParams:{gold:450,redCrystals:1,gems:1}}]),mg=Ti("start-top-left",[{id:"entry",x:ue(-60),y:ue(-60),icon:"sword",pathTo:xi,toOuterBranch:!0,struct:fr},{id:"river",x:ue(-40),y:ue(-120),icon:"incense",pathTo:"entry",struct:c1,actionPoints:1},{id:"1",x:ue(50),y:ue(-110),icon:"tower",pathTo:"entry",struct:pr,actionPoints:1},{id:"gems",x:ue(70),y:ue(-170),icon:"emerald",pathTo:"1",struct:So,structParams:{gems:3}}]),J_=Ti("post-boss-1",[{id:"entry",x:194,y:338,actionPoints:1,icon:"sword",pathTo:"start-bottom-left.post-boss",toOuterBranch:!0,struct:ts,structParams:{name:"Swamp",guards:{units:[["#unit-neut-poison-ivy-0",20,20,3]],maxUnitGroups:3,minUnitGroups:3}}}]),K_=Ti("start-top-right",[{id:"beacon",x:ue(35),y:ue(-50),icon:"lighthouse",pathTo:xi,toOuterBranch:!0,struct:a1}]),Wd=[{id:xi,x:ue(0),y:ue(0),icon:"campfire"},..._a,...Qd,...W_,...mg,...K_,...zd,...J_],ns={registryMap:new Map,register(r,l){this.registryMap.has(r)?this.registryMap.get(r).push(l):this.registryMap.set(r,[l])}};ns.register(Zc.PrepareGameEvent,{fn:(r,{events:l})=>{if(r.gameMode!==ad.Normal)return;let o=xi;console.log("Structures are prepared.");const a=new fg({mapDimensions:{heightInCells:27,widthInCells:34,cellSize:86},structures:Wd,startLocId:o});l.dispatch(Zc.GamePreparationFinished({map:a}))}}),ns.register(Ur,{fn:(r,l)=>{const o=[{card:Ud,count:1/0},{card:Mo,count:1},{card:_l,count:1}],a=l.players.getCurrentPlayer();l.events.dispatch(jr({player:a,actionCardStacks:o}))}}),ns.register(Ys,{fn:(r,l)=>{l.actions.getMapStructures().filter(a=>!a.visited&&a.guard?.length&&!a.generator?.disableWeeklyGuardRise).forEach(a=>{a.guard?.forEach(u=>u.addUnitsCount(Math.round(.4*u.count)))}),l.events.dispatch(nr({message:"Guards in locations raised by 40%"}))}}),ns.register(rd,{fn:(r,{events:l,players:o})=>{l.dispatch(hh({title:`You reached level ${r.newLevel}`,subTitle:"Choose your reward",rewards:[...r.hero.spells.filter(a=>r.hero.base.initialState.abilities.includes(a.baseType)).map(a=>({display:{icon:a.baseType.icon.icon,title:`Level ${a.currentLevel+1} ${a.name}`},onSumbit:()=>{a&&a.levelUp()}})),{display:{icon:"crystal-ball",title:"+4 to Max/Current Mana"},onSumbit:()=>{const a=o.getCurrentPlayer();o.addMaxManaToPlayer(a,4),o.addManaToPlayer(a,4)}}]}))}});let Ca=(()=>{class r{constructor(){this.history=[],this.historyEvent$=new Ft.xQ}logHtmlMessage(o){this.pushMessage({type:x.m8.Html,message:o})}logSimpleMessage(o){this.pushMessage({type:x.m8.SimpleMsg,message:o})}logRoundInfoMessage(o){this.pushMessage({type:x.m8.RoundInfoMsg,message:o})}logDealtDamageMessage(o){const a={type:x.m8.DealtDamageMsg,...o};this.pushMessage(a)}pushMessage(o){this.history.push(o),this.historyEvent$.next()}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var xo=M(125),ot=M(536);function yg(r){r.next(),r.complete()}var sn=function(r){return r.HeroMods="hMods",r.CombatMods="cMods",r.AuraMods="aMods",r.SpecialtyAndConditionalMods="scMods",r.SpellMods="sMods",r}(sn||{});let vg=(()=>{class r extends ir.l{constructor(){super(...arguments),this.modGroup=ot.lX.empty(),this.unitStats$=new xo.X({baseAttack:0,bonusAttack:0,finalAttack:0,baseDefence:0,bonusDefence:0,finalDefence:0,defends:!1,baseSpeed:0,speedBonus:0,finalSpeed:0,fireResist:0,coldResist:0,lightningResist:0,poisonResist:0,totalHealth:0,totalMinDamage:0,totalMaxDamage:0,avgTotalDamage:0,position:0}),this.destroyed$=new Ft.xQ}static#e=this.categoryId="unit-group";get count(){return this._count}get tailUnitHp(){return this._tailUnitHp}get ownerHero(){return this._ownerHero}get ownerPlayer(){return this._ownerPlayer}get spells(){return this._spells}create({count:o,unitBase:a,ownerHero:u}){(o<=0||!o)&&(console.warn(`Cannot create unit group with ${o} units. Setting count to 1.`,this),o=1),this.type=a,u&&(this.assignOwnerHero(u),this.assignOwnerPlayer(u.ownerPlayer)),this.turnsLeft=a.defaultTurnsPerRound||1,this._tailUnitHp=a.baseStats.health,this.type.defaultModifiers&&this.modGroup.addModsRef(ot.Cc.fromMods(this.type.defaultModifiers)),this.fightInfo={initialCount:o,isAlive:!0,spellsOnCooldown:!1},this.setUnitsCount(o),this.modGroup.attachNamedParentGroup(sn.CombatMods,ot.lX.empty()),this.modGroup.attachNamedParentGroup(sn.SpecialtyAndConditionalMods,ot.lX.empty()),this.modGroup.attachNamedParentGroup(sn.SpellMods,ot.lX.empty()),this._spells=[],this.type.defaultSpells&&this.type.defaultSpells.map(h=>this.getApi().spells.createSpellInstance(h)).forEach(h=>this.addSpell(h)),this.setupStatsUpdating()}setPosition(o){const a=this.getStats();a.position!==o&&(a.position=o,this.unitStats$.next(a))}assignOwnerHero(o){this._ownerHero=o,this._ownerPlayer=o.ownerPlayer,this.modGroup.detachNamedParentGroup(sn.HeroMods),this.modGroup.attachNamedParentGroup(sn.HeroMods,this._ownerHero.modGroup)}onDestroy(){yg(this.destroyed$),this.spells.forEach(o=>this.getApi().gameObjects.destroyObject(o))}assignOwnerPlayer(o){this._ownerPlayer=o}addUnitsCount(o){this.setUnitsCount(this._count+o)}setUnitsCount(o){this._count=o>=0?o:0,this.recalcHealthBasedStats()}addTailUnitHp(o){this.setTailUnitHp((this._tailUnitHp??0)+o)}setTailUnitHp(o){this._tailUnitHp=o,this.recalcHealthBasedStats()}listenStats(){return this.unitStats$.pipe(Xe(this.destroyed$))}addSpell(o){this._spells.push(o),o.setOwnerObjectId(this.id),o.baseType.config.spellConfig.onAcquired?.({spellInstance:o,ownerUnit:this}),this.getApi().events.dispatch(Un({unitGroup:this}))}removeSpell(o){Te.DN.removeItem(this._spells,o)}removeDefendingMod(){const o=this.modGroup.getNamedGroup(sn.CombatMods);if(!o)return;const a=o?.getAllRefs().find(u=>u.getModValue("defending"));a&&o?.removeModsRef(a)}getStats(){return this.unitStats$.getValue()}attachSpecialtyMods(o){this.getSpecialtyAndConditionalModsGroup().addModsRef(ot.Cc.fromMods(o))}clearSpecialtyAndConditionalMods(){this.getSpecialtyAndConditionalModsGroup().clearOwnModRefs()}clearCombatMods(){this.modGroup.getNamedGroup(sn.CombatMods).clearOwnModRefs()}addCombatMods(o){this.modGroup.getNamedGroup(sn.CombatMods).addModsRef(ot.Cc.fromMods(o))}removeCombatMods(o){this.modGroup.getNamedGroup(sn.CombatMods).removeRefByModInstance(o)}addSpellMods(o){this.modGroup.getNamedGroup(sn.SpellMods).addModsRef(ot.Cc.fromMods(o))}removeSpellMods(o){this.modGroup.getNamedGroup(sn.SpellMods).removeRefByModInstance(o)}recalcHealthBasedStats(){const o=this.unitStats$.getValue(),a=this.type.baseStats,u=this._count;o.totalHealth=a.health*(u-1)+(this.tailUnitHp??0),o.totalMinDamage=u*a.damageInfo.minDamage,o.totalMaxDamage=u*a.damageInfo.maxDamage,o.avgTotalDamage=(o.totalMinDamage+o.totalMaxDamage)/2,this.unitStats$.next(o)}getSpecialtyAndConditionalModsGroup(){return this.modGroup.getNamedGroup(sn.SpecialtyAndConditionalMods)}setupStatsUpdating(){this.modGroup.onValueChanges().pipe(Xe(this.destroyed$)).subscribe(o=>{const a=this.type.baseStats,u=this.ownerPlayer?.hero.base.initialState.stats,h=a.attackRating,m=(o.heroBonusAttack||0)+(u?.baseAttack||0),_=a.defence,b=(o.heroBonusDefence||0)+(u?.baseDefence||0);let S=a.speed,T=o.unitGroupSpeedBonus||0;T<0&&o.cannotBeSlowed&&(T=0),o.fixedSpeed&&(T=0,S=o.fixedSpeed||5);const A=o.resistAll||0,ee=this.unitStats$.getValue();this.unitStats$.next({baseAttack:h,bonusAttack:m,finalAttack:h+m,defends:o.defending,baseDefence:_,bonusDefence:b,finalDefence:_+b,baseSpeed:S,speedBonus:T,finalSpeed:S+T,fireResist:(o.resistFire||0)+A,coldResist:(o.resistCold||0)+A,lightningResist:(o.resistLightning||0)+A,poisonResist:(o.resistPoison||0)+A,totalHealth:ee.totalHealth,totalMinDamage:ee.totalMinDamage,totalMaxDamage:ee.totalMaxDamage,avgTotalDamage:ee.avgTotalDamage,position:ee.position})})}}return r})();function is(r,l){return`${r}:${l}`}let an=(()=>{class r{constructor(o){this.events=o,this.internalRegistries=new Map,this.allObjects=new Map,this.objectsCustomData=new Map,window.gameObjects=this}createNewGameObject(o,a,u){const h=o.categoryId,m=this.getOrCreateCategoryRegistry(h);let _;if(u){const S=is(h,u);if(this.allObjects.has(S))throw console.error(`Game object with id '${S}' already exists! New params/old object:`,a,this.allObjects.get(S)),new Error(`Game object with id '${S}' already exists!`);_=S}else _=is(h,m.latestId++);const b=new o(_);return this.events.dispatch(gh({gameObject:b})),b.create(a),m.objects.add(b),this.allObjects.set(_,b),console.log(b),b}getObjectById(o,a){return this.getObjectByFullId(is(o.categoryId,a))}getObjectByFullId(o){if(2!==function Il(r){return r.split(":")}(o).length)throw new Error(`Getting object by id '${o}' failed, id doesn't follow format 'CategoryId:ObjectId'`);const u=this.allObjects.get(o);if(!u)throw new Error(`Failed to get object by '${o}' id: Object doens't exist`);return u}destroyObject(o){const u=Object.getPrototypeOf(o).categoryId;this.internalRegistries.get(u)?.objects.delete(o),o.onDestroy(),this.objectsCustomData.delete(o.id),this.allObjects.delete(o.id)}getObjectId(o,a){const u=a.split(":");return 2===u.length&&u[0]===o.categoryId?a:is(o.categoryId,a)}addCustomData(o,a){const u="object"==typeof o?o.id:o,h=this.objectsCustomData.get(u);this.objectsCustomData.set(u,{...h,...a})}getCustomData(o){const a=this.objectsCustomData.get("string"==typeof o?o:o.id);return console.log("Getting custom data:",a),a}getOrCreateCategoryRegistry(o){return this.internalRegistries.get(o)||(this.initializeRegistryForCategory(o),this.internalRegistries.get(o))}initializeRegistryForCategory(o){this.internalRegistries.set(o,{latestId:0,objects:new Set})}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(Ze))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),wa=(()=>{class r{constructor(o){this.gameObjectManager=o}createSpellInstance(o,a={}){const u=a.initialLevel??1,h=o.icon;return h.bgClr||(h.bgClr=ce.wL.DefaultItemIconBg),h.iconClr||(h.iconClr=ce.wL.DefaultItemIconClr),this.gameObjectManager.createNewGameObject(qc,{spellBaseType:o,initialLevel:u,state:a.state})}createModifiers(o){return o}canSpellBeCastOnUnit(o,a,u){const m=o.baseType.config.spellConfig.targetCastConfig?.canActivate;return!m||m({unitGroup:a,isEnemy:u})}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(an))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Dn=(()=>{class r{constructor(o,a,u){this.spells=o,this.gameObjectsManager=a,this.events=u}createUnitGroup(o,a,u){return this.gameObjectsManager.createNewGameObject(vg,{count:a.count,ownerHero:u,unitBase:Di(o)})}createUnitGroupFromGenModel(o){return Td.createRandomArmy(o).map(a=>this.createUnitGroup(a.unitType,{count:a.count}))}createUnitGroupFromGenModelForPlayer(o,a){return Td.createRandomArmy(o).map(u=>this.createUnitGroup(u.unitType,{count:u.count},a))}addModifierToUnitGroup(o,a){this.events.dispatch(nd({mods:a,unit:o}))}removeModifiers(o,a){this.events.dispatch(dh({mods:a,unit:o}))}clearUnitModifiers(o){o.clearCombatMods()}getUnitGroupSpeed(o){return o.getStats().finalSpeed}healUnit(o,a){const u=o.type.baseStats.health;let h=Math.floor(a/u),_=a-h*u;const b=o.fightInfo.initialCount,T=b-o.count,A=o.tailUnitHp||u,ee=u-A,X=T*u+ee;if(0===X||a<=0)return{revivedUnitsCount:0,totalHealedHp:0};if(o.fightInfo.isAlive=!0,a>X)return o.setTailUnitHp(u),o.setUnitsCount(b),{revivedUnitsCount:T,totalHealedHp:X};let de=h;return _>ee?(de+=1,o.setTailUnitHp(A+_-u)):0===o.tailUnitHp&&0===_&&de>0?o.setTailUnitHp(u):o.addTailUnitHp(_),o.addUnitsCount(de),{revivedUnitsCount:de,totalHealedHp:a}}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(wa),n.LFG(an),n.LFG(Ze))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),to=(()=>{class r{constructor(o,a){this.units=o,this.events=a,this.battleEvent$=new xo.X(void 0),this.heroesUnitGroupsMap=new Map,this.currentGroupTurnsLeft=0,this.round=1,this.playerLosses={},this.playersRivalryMap=new Map,this.currentUnitGroup$=new xo.X(null)}resetCurrentPlayer(){this.currentPlayer=null}initBattleState(o,a){this.initialUnitGroups=o,this.players=a,this.playersRivalryMap.set(a[0],a[1]),this.playersRivalryMap.set(a[1],a[0]),this.initPlayerLossesMap(),this.initPlayerUnitGroupsMap(o),this.resetFightQueue(),this.updateGroupsTailHpAndCombatInfo(),this.refreshUnitGroups()}initNextTurnByQueue(o=!1){if(o&&this.currentUnitGroup.count&&this.fightQueue.shift(),!this.fightQueue.length)return this.getAllUnits().forEach(h=>{h.modGroup.getModValue("defending")&&h.removeDefendingMod()}),this.resetFightQueue(),this.resetGroupsTurnsLeft(),this.round++,void this.events.dispatch(Ko({round:this.round}));const a=this.fightQueue[0],u=this.currentPlayer;this.currentPlayer=a.ownerPlayer,this.currentUnitGroup=a,this.currentUnitGroup$.next(a),this.currentGroupTurnsLeft=this.currentUnitGroup.modGroup.getModValue("defending")?this.currentUnitGroup.turnsLeft:this.currentUnitGroup.turnsLeft||1,this.events.dispatch(this.currentPlayer!==u?mi({currentPlayer:this.currentPlayer,previousPlayer:u}):Jo())}getFightQueue(){return this.fightQueue}handleDefeatedUnitGroup(o){const a=o.ownerPlayer,u=this.heroesUnitGroupsMap.get(a);u?.indexOf(o),o.fightInfo.isAlive=!1,this.heroesUnitGroupsMap.set(a,u);const m=this.fightQueue.indexOf(o);-1!==m&&this.fightQueue.splice(m,1)}getEnemyOfPlayer(o){return this.playersRivalryMap.get(o)}processAiPlayer(){setTimeout(()=>{const o=this.getAliveUnitsOfPlayer(this.getEnemyOfPlayer(this.currentPlayer)),a=Math.round(Math.random()*(o.length-1));this.events.dispatch(kr({attackedGroup:o[a],attackingGroup:this.currentUnitGroup}))},1e3)}getUnitGroupTotalDamage(o){return o.count*o.type.baseStats.damageInfo.maxDamage}resortFightQueue(o=!1){this.fightQueue=o?this.getUnitsSortedBySpeed(this.fightQueue):[this.fightQueue[0],...this.getUnitsSortedBySpeed(this.fightQueue.slice(1))]}removeUnitsWithoutTurnsFromFightQueue(){this.fightQueue=this.fightQueue.filter(o=>o.turnsLeft)}getAliveUnitsOfPlayer(o){return this.heroesUnitGroupsMap.get(o).filter(a=>a.fightInfo.isAlive)}getDeadUnitsOfPlayer(o){return this.heroesUnitGroupsMap.get(o).filter(a=>!a.fightInfo.isAlive)}getSummonsOfPlayer(o){return this.heroesUnitGroupsMap.get(o).filter(a=>a.modGroup.getModValue("isSummon"))}playerHasAnyAliveUnits(o){return 0!==this.getAliveUnitsOfPlayer(o).length}summonUnitForPlayer(o,a,u){const h=this.units.createUnitGroup(a,{count:u},o.hero),m=this.heroesUnitGroupsMap.get(o),_=m.length;return m.push(h),h.setPosition(_),this.units.addModifierToUnitGroup(h,{isSummon:!0}),this.resortFigthQueueWithNewUnits(),h}registerPlayerUnitLoss(o,a){const u=this.playerLosses[o.ownerPlayer.id],h=o.type,m=u.get(h);if(m){const _=m+a;_>0?u.set(h,_):u.delete(h)}else u.set(h,a)}initPlayerLossesMap(){this.players.forEach(o=>{this.playerLosses[o.id]=new Map})}resetGroupsTurnsLeft(){this.fightQueue.forEach(o=>o.turnsLeft=o.type.defaultTurnsPerRound||1)}getUnitsSortedBySpeed(o){return[...o].sort((a,u)=>this.units.getUnitGroupSpeed(u)-this.units.getUnitGroupSpeed(a))}resetFightQueue(){this.fightQueue=this.getUnitsSortedBySpeed([...this.getAliveUnitsOfPlayer(this.players[0]),...this.getAliveUnitsOfPlayer(this.players[1])])}getAllUnits(){return[...this.getAliveUnitsOfPlayer(this.players[0]),...this.getAliveUnitsOfPlayer(this.players[1])]}initPlayerUnitGroupsMap(o){this.heroesUnitGroupsMap.clear(),o.forEach(a=>{const u=a.ownerPlayer,h=this.heroesUnitGroupsMap.get(u);h?h.push(a):this.heroesUnitGroupsMap.set(u,[a])}),this.heroesUnitGroupsMap.forEach(a=>{a.forEach((u,h)=>{u.setPosition(h)})})}updateGroupsTailHpAndCombatInfo(){this.players.forEach(o=>{o.hero.unitGroups.forEach(a=>{a.tailUnitHp||a.setTailUnitHp(a.type.baseStats.health),a.fightInfo.initialCount=a.count})})}refreshUnitGroups(){this.players.forEach(o=>{o.hero.unitGroups.forEach(a=>{a.turnsLeft=a.type.defaultTurnsPerRound||1})})}resortFigthQueueWithNewUnits(){this.fightQueue=[this.fightQueue[0],...this.getUnitsSortedBySpeed(this.getAllAliveUnitsWithTurnsExcept(this.fightQueue[0]))]}getAllAliveUnitsWithTurnsExcept(o){return this.getAllAliveUnitsExcept(this.fightQueue[0]).filter(a=>a.turnsLeft)}getAllAliveUnitsExcept(o){return[...this.heroesUnitGroupsMap.values()].flat().filter(a=>a.fightInfo.isAlive&&a!==o)}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(Dn),n.LFG(Ze))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),_g=(()=>{class r{constructor(){this.mapping=new Map}register(o,a){this.mapping.set(o,a)}unregister(o){this.mapping.delete(o)}get(o){return this.mapping.get(o)}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const Cg={[At.Cold]:"coldResist",[At.Fire]:"fireResist",[At.Lightning]:"lightningResist",[At.Poison]:"poisonResist"};var os=M(497);let no=(()=>{class r{constructor(){this.hintMessage$=new xo.X(null),this.disableActionHint$=new xo.X(!1)}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();class Io{constructor(){this.triggerMapsByRefsMap=new Map}registerHandlerByRef(l,o,a){const u=this.triggerMapsByRefsMap.get(l);if(u){const h=u.get(o);h?h.push(a):u.set(o,[a])}else this.triggerMapsByRefsMap.set(l,new Map([[o,[a]]]))}triggerAllHandlersByEvent(l){this.triggerMapsByRefsMap.forEach(o=>{o.forEach((a,u)=>a.forEach(h=>{u===l.__eventType.__type&&h(l)}))})}triggerRefEventHandlers(l,o){const a=this.triggerMapsByRefsMap.get(l);a&&a.forEach((u,h)=>{u.forEach(m=>{h===o.__eventType.__type&&m(o)})})}removeAllHandlersForRef(l){this.triggerMapsByRefsMap.delete(l)}removeAllHandlers(){this.triggerMapsByRefsMap.clear()}}let ft=(()=>{class r{constructor(){this.currentGame={day:1,globalDay:1,week:1,actionPoints:4},this.settings={orientation:x.hJ.Vertical,mapDebug:!0},this.mainMenu={},this.mapCamera={cameraInitialized:!1,x:0,y:0},this.eventHandlers={spells:new Io,items:new Io,buildings:new Io,structures:new Io},this.unitsAppliedModifiers=new Map}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),lt=(()=>{class r{constructor(){}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-ra-icon"]],inputs:{icon:"icon"},decls:1,vars:2,consts:[[1,"ra"]],template:function(a,u){1&a&&n._UZ(0,"i",0),2&a&&n.Tol("ra-"+u.icon)}})}return r})(),hr=(()=>{class r{constructor(o){this.domSanitizer=o}transform(o){return this.domSanitizer.bypassSecurityTrustHtml(o)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(Yu,16))};static#t=this.\u0275pipe=n.Yjl({name:"safeHtml",type:r,pure:!0})}return r})(),Jd=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-action-card"]],inputs:{actionCard:"actionCard"},decls:7,vars:11,consts:[[1,"icon"],[3,"icon"],[1,"content"],[1,"title"],[1,"description",3,"innerHtml"]],template:function(a,u){1&a&&(n.TgZ(0,"div",0),n._UZ(1,"mw-ra-icon",1),n.qZA(),n.TgZ(2,"div",2)(3,"div",3),n._uU(4),n.qZA(),n._UZ(5,"div",4),n.ALo(6,"safeHtml"),n.qZA()),2&a&&(n.xp6(1),n.Udp("color",u.actionCard.iconColor)("background",u.actionCard.bgColor)("border-color",u.actionCard.borderColor),n.Q6J("icon",u.actionCard.icon),n.xp6(3),n.hij(" ",u.actionCard.title," "),n.xp6(1),n.Q6J("innerHtml",n.lcZ(6,9,u.actionCard.description),n.oJD))},dependencies:[lt,hr],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;cursor:pointer}.icon[_ngcontent-%COMP%]{width:84px;height:84px;position:relative;bottom:-14px;display:flex}.icon[_ngcontent-%COMP%]   mw-ra-icon[_ngcontent-%COMP%]{width:74px;height:74px;display:flex;background-color:gray;font-size:74px;border-radius:50%;border:4px solid rgb(82,82,82);color:#fff;margin:auto}.content[_ngcontent-%COMP%]{border:3px solid gray;border-radius:5px;padding:14px 8px 8px;display:flex;flex-direction:column;align-items:center;color:#fff;width:135px;min-height:74px;text-align:center;background-color:#636363;-webkit-user-select:none;user-select:none}.content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:20px;margin-bottom:6px;padding-bottom:4px;border-bottom:2px solid #8d8d8d;width:100%}.content[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:13px}"]})}return r})();const wg=new n.OlP("Popup Reference");class mt{constructor(){this.popup=(0,n.f3M)(wg),this.data=this.popup.data}close(){this.popup.close()}}var El=M(46),Pl=M(280),X_=M(594),rs=M(124);function Ii(r,l,o,a){return(0,X_.m)(o)&&(a=o,o=void 0),a?Ii(r,l,o).pipe((0,rs.U)(u=>(0,Pl.k)(u)?a(...u):a(u))):new El.y(u=>{bg(r,l,function h(m){u.next(arguments.length>1?Array.prototype.slice.call(arguments):m)},u,o)})}function bg(r,l,o,a,u){let h;if(function eC(r){return r&&"function"==typeof r.addEventListener&&"function"==typeof r.removeEventListener}(r)){const m=r;r.addEventListener(l,o,u),h=()=>m.removeEventListener(l,o,u)}else if(function Al(r){return r&&"function"==typeof r.on&&"function"==typeof r.off}(r)){const m=r;r.on(l,o),h=()=>m.off(l,o)}else if(function p1(r){return r&&"function"==typeof r.addListener&&"function"==typeof r.removeListener}(r)){const m=r;r.addListener(l,o),h=()=>m.removeListener(l,o)}else{if(!r||!r.length)throw new TypeError("Invalid event target");for(let m=0,_=r.length;m<_;m++)bg(r[m],l,o,a,u)}a.add(h)}let Kd=(()=>{class r{constructor(){this.keyPress$=Ii(document,"keyup"),this.escape$=this.keyPress$.pipe(Mc(o=>"Escape"===o.key))}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Eo=(()=>{class r{constructor(){this.popups=[],(0,n.f3M)(Kd).escape$.subscribe(o=>{if(!this.popups.length)return;const a=this.popups[this.popups.length-1];(a.isCloseable||a.escape)&&this.removePopup(a)})}createPopup(o){this.popups.push(o)}createBasicPopup(o){this.createPopup(o)}removePopup(o){Te.DN.removeItem(this.popups,o)}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Mg(r,l){1&r&&n.GkF(0)}function tC(r,l){1&r&&n._UZ(0,"div",2)}let Dg=(()=>{class r{constructor(o,a,u){this.popups=o,this.hostElemRef=a,this.renderer=u,this.isInactive=!1}ngOnInit(){this.popupData.class&&this.renderer.addClass(this.hostElemRef.nativeElement,this.popupData.class),this.injector=n.zs3.create({providers:[{provide:wg,useValue:{data:this.popupData.data,close:()=>{this.popups.removePopup(this.popupData)}}}]})}preventClick(o){o.stopPropagation()}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(Eo),n.Y36(n.SBq),n.Y36(n.Qsj))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-popup-wrapper"]],hostBindings:function(a,u){1&a&&n.NdJ("click",function(m){return u.preventClick(m)})},inputs:{popupData:"popupData",isInactive:"isInactive"},decls:2,vars:3,consts:[[4,"ngComponentOutlet","ngComponentOutletInjector"],["class","inactive-overlay",4,"ngIf"],[1,"inactive-overlay"]],template:function(a,u){1&a&&n.YNc(0,Mg,1,0,"ng-container",0)(1,tC,1,0,"div",1),2&a&&(n.Q6J("ngComponentOutlet",u.popupData.component)("ngComponentOutletInjector",u.injector),n.xp6(1),n.Q6J("ngIf",u.isInactive))},dependencies:[et,rt],styles:[".inactive-overlay[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;left:0;top:0;background-color:#48484846}.small-padding[_nghost-%COMP%]{padding:12px}.transparent[_nghost-%COMP%]{background:transparent;width:100%;pointer-events:none;padding:0}"]})}return r})(),ss=(()=>{class r{constructor(){this.mwNoContextMenu=new n.vpe}preventContextMenu(o){return o.stopPropagation(),o.preventDefault(),this.mwNoContextMenu.emit(),!1}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","mwNoContextMenu",""],["","mwUnitGroupCombatAction",""]],hostBindings:function(a,u){1&a&&n.NdJ("contextmenu",function(m){return u.preventContextMenu(m)})},outputs:{mwNoContextMenu:"mwNoContextMenu"}})}return r})();function nC(r,l){1&r&&n._UZ(0,"div",2)}function Sg(r,l){if(1&r&&n._UZ(0,"mw-popup-wrapper",5),2&r){const o=l.$implicit,a=l.last;n.Q6J("ngClass",o.class)("popupData",o)("isInactive",!a)}}function Tg(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",3),n.NdJ("click",function(u){n.CHM(o);const h=n.oxw();return n.KtG(h.handleOverlayClick(u))}),n.YNc(1,Sg,1,3,"mw-popup-wrapper",4),n.qZA()}if(2&r){const o=n.oxw();n.xp6(1),n.Q6J("ngForOf",o.popupsService.popups)}}let Xd=(()=>{class r{constructor(o){this.popupsService=o}handleOverlayClick(o){o.preventDefault();const u=(0,Te.CT)(this.popupsService.popups);u.isCloseable&&this.popupsService.removePopup(u)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(Eo))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-popup-container"]],decls:2,vars:2,consts:[["class","overlay",4,"ngIf"],["mwNoContextMenu","","class","popups-container",3,"click",4,"ngIf"],[1,"overlay"],["mwNoContextMenu","",1,"popups-container",3,"click"],["class","popup",3,"ngClass","popupData","isInactive",4,"ngFor","ngForOf"],[1,"popup",3,"ngClass","popupData","isInactive"]],template:function(a,u){1&a&&n.YNc(0,nC,1,0,"div",0)(1,Tg,2,1,"div",1),2&a&&(n.Q6J("ngIf",u.popupsService.popups.length),n.xp6(1),n.Q6J("ngIf",u.popupsService.popups.length))},dependencies:[xr,Ie,rt,ss,Dg],styles:["@keyframes _ngcontent-%COMP%_overlay-appear{0%{background-color:#0000000d}to{background-color:#000000a7}}.popups-container[_ngcontent-%COMP%]{left:0;z-index:9200;top:0;position:fixed;height:100%;width:100%}.overlay[_ngcontent-%COMP%]{left:0;top:0;z-index:4000;position:fixed;height:100%;width:100%;background-color:#0000;animation:_ngcontent-%COMP%_overlay-appear 1s;animation-fill-mode:forwards}.popup[_ngcontent-%COMP%]{position:absolute;display:block;min-width:400px;left:50%;z-index:9500;top:50%;transform:translate(-50%,-50%);background-color:#fff}.dark[_ngcontent-%COMP%]{background-color:#484852}"]})}return r})();function iC(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",6)(1,"mw-action-card",7),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw();return n.KtG(m.handleCardClick(h))}),n.qZA(),n.TgZ(2,"div",8),n._uU(3),n.ALo(4,"infNum"),n.qZA()()}if(2&r){const o=l.$implicit;n.xp6(1),n.Q6J("actionCard",o.card)("mwActionHint","Use "+o.card.title),n.xp6(2),n.hij("Left: ",n.lcZ(4,3,o.count),"")}}let ep=(()=>{class r extends mt{constructor(){super(...arguments),this.state=(0,n.f3M)(ft),this.playersService=(0,n.f3M)(be),this.events=(0,n.f3M)(Ze),this.cards=this.playersService.getCurrentPlayer().actionCards,this.actionPointsLeft=this.state.currentGame.actionPoints}handleCardClick(o){this.events.dispatch(gt({player:this.playersService.getCurrentPlayer(),cardStack:o})),this.close()}static#e=this.\u0275fac=(()=>{let o;return function(u){return(o||(o=n.n5z(r)))(u||r)}})();static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-action-cards-popup"]],features:[n.qOj],decls:11,vars:2,consts:[[1,"header"],[1,"action-points"],[1,"points"],["icon","feather-wing"],[1,"cards"],["class","card-stack",4,"ngFor","ngForOf"],[1,"card-stack"],[3,"actionCard","mwActionHint","click"],[1,"cards-left"]],template:function(a,u){1&a&&(n.TgZ(0,"div",0),n._uU(1," Available action cards "),n.TgZ(2,"div",1),n._uU(3," Remaining action points for this day: "),n._UZ(4,"br"),n.TgZ(5,"span",2),n._UZ(6,"mw-ra-icon",3),n._uU(7),n.qZA()(),n._UZ(8,"hr"),n.qZA(),n.TgZ(9,"div",4),n.YNc(10,iC,5,5,"div",5),n.qZA()),2&a&&(n.xp6(7),n.hij(" ",u.actionPointsLeft," "),n.xp6(3),n.Q6J("ngForOf",u.cards))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;background-color:#0000009c;padding:40px 0}.header[_ngcontent-%COMP%]{color:#fff;text-align:center;font-size:24px}.header[_ngcontent-%COMP%]   .action-points[_ngcontent-%COMP%]{font-size:16px;font-weight:100;line-height:32px}.header[_ngcontent-%COMP%]   .action-points[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]{font-size:32px}.cards[_ngcontent-%COMP%]{display:flex;pointer-events:all;gap:14px;padding-top:15px}.card-stack[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;padding:0 16px 8px;border-radius:6px;background-color:#fff0;transform:translateY(0);transition:.2s}.card-stack[_ngcontent-%COMP%]:hover{background-color:#ffffff31;transform:translateY(-20px)}.cards-left[_ngcontent-%COMP%]{color:#fff;text-align:center;font-size:15px;padding-top:4px}"]})}return r})(),tp=(()=>{class r{constructor(){}registerCursorComponent(o){this.cursorComponent=o}setCustomCursor(o,a,u){this.cursorComponent.showCustomCursor=!0,this.updateCursorComponent(),this.cursorComponent.customCursorRef.clearAnimation(),this.cursorComponent.customCursorRef.playAnimation(o,a,u)}setCustomCursorPos(o,a){this.cursorComponent.customCursorPos.x=o,this.cursorComponent.customCursorPos.y=a,this.updateCursorComponent()}clearCustomCursor(){this.updateCursorComponent(),this.cursorComponent.customCursorRef&&(this.cursorComponent.customCursorRef.clearAnimation(),this.cursorComponent.showCustomCursor=!1)}updateCursorComponent(){this.cursorComponent.cdr.detectChanges()}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const np=["customCursorRef"];function f1(r,l){if(1&r&&n._UZ(0,"mw-vfx-element",1,2),2&r){const o=n.oxw();n.Udp("top",o.customCursorPos.y-5,"px")("left",o.customCursorPos.x-2,"px")}}let Ol=(()=>{class r{constructor(o,a){this.cursor=o,this.cdr=a,this.showCustomCursor=!1,this.customCursorPos={x:0,y:0},this.cursor.registerCursorComponent(this)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(tp),n.Y36(n.sBO))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-custom-cursor"]],viewQuery:function(a,u){if(1&a&&n.Gf(np,5),2&a){let h;n.iGM(h=n.CRH())&&(u.customCursorRef=h.first)}},decls:1,vars:1,consts:[["class","custom-cursor",3,"top","left",4,"ngIf"],[1,"custom-cursor"],["customCursorRef",""]],template:function(a,u){1&a&&n.YNc(0,f1,2,4,"mw-vfx-element",0),2&a&&n.Q6J("ngIf",u.showCustomCursor)},styles:["[_nghost-%COMP%]{position:fixed;left:0;top:0;width:0;height:0}.custom-cursor[_ngcontent-%COMP%]{pointer-events:none;position:absolute;z-index:100000;font-size:24px;color:#fff;transform:scaleX(-1)}"]})}return r})();function ip(r,l){1&r&&n.GkF(0)}const oC=r=>({$implicit:r});function Ma(r,l){if(1&r&&(n.ynx(0),n.YNc(1,ip,1,0,"ng-container",2),n.BQk()),2&r){const o=l.$implicit;n.oxw();const a=n.MAs(2);n.xp6(1),n.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",n.VKq(2,oC,o))}}function xg(r,l){1&r&&(n._UZ(0,"div",3),n.ALo(1,"safeHtml")),2&r&&n.Q6J("innerHTML",n.lcZ(1,1,l.$implicit.htmlContent),n.oJD)}let Po=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-description"]],inputs:{descriptions:["descriptions","descriptions",o=>(r=>r.map(l=>"string"==typeof l?{htmlContent:l}:l))(o)]},features:[n.Xq5],decls:3,vars:1,consts:[[4,"ngFor","ngForOf"],["freeHtml",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"innerHTML"]],template:function(a,u){1&a&&n.YNc(0,Ma,2,4,"ng-container",0)(1,xg,2,3,"ng-template",null,1,n.W1O),2&a&&n.Q6J("ngForOf",u.descriptions)},dependencies:[Ie,$o,hr],styles:["mw-description>.spell-descr{font-size:13px}mw-description .spell-stats{padding:7px 3px 3px;font-size:12px;line-height:18px;color:#434040}mw-description .spell-stats>.stat>.value{font-weight:600}mw-description .item-mods{padding:0 5px 5px}mw-description .item-mods>.item-mod{font-size:12px}\n"],encapsulation:2,changeDetection:0})}return r})();function rC(r,l){if(1&r&&(n.ynx(0,1),n._UZ(1,"div",2),n.ALo(2,"safeHtml"),n.BQk()),2&r){const o=l.$implicit;n.Q6J("ngSwitch",o.type),n.xp6(1),n.Q6J("innerHTML",n.lcZ(2,2,o.htmlContent),n.oJD)}}let Pg=(()=>{class r{constructor(o,a){this.elementRef=o,this.renderer=a,this.messageExpired=new n.vpe,this.type=x.xL}ngOnInit(){setTimeout(()=>{this.renderer.addClass(this.elementRef.nativeElement,"visible")},0),setTimeout(()=>{this.renderer.addClass(this.elementRef.nativeElement,"hidden")},(this.message.delay||2e3)-400),setTimeout(()=>{this.messageExpired.emit()},this.message.delay||2e3)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.SBq),n.Y36(n.Qsj))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-event-feed-message"]],inputs:{message:"message"},outputs:{messageExpired:"messageExpired"},decls:1,vars:1,consts:[[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],[3,"innerHTML"]],template:function(a,u){1&a&&n.YNc(0,rC,3,4,"ng-container",0),2&a&&n.Q6J("ngForOf",u.message.message)},dependencies:[Ie,uo,hr],styles:["[_nghost-%COMP%]{background:rgb(65,65,65);display:inline-block;color:#fff;font-size:13px;border-radius:4px;display:block;padding:3px 10px 3px 5px;overflow:hidden;height:0;opacity:0;position:relative;translate:50% -20px;transition:.4s;text-align:center}.visible[_nghost-%COMP%]{height:100%;translate:50% 0px;opacity:1}.hidden[_nghost-%COMP%]{height:0;opacity:0}"]})}return r})(),as=(()=>{class r{constructor(){this.visibleMessages=[],this.allMessages=[]}pushEventFeedMessage(o){this.allMessages.push(o),this.visibleMessages.push(o)}pushPlainMessage(o){this.pushEventFeedMessage({message:[{htmlContent:o,type:x.xL.FreeHtml}],delay:2600})}pushSystemError(o){this.pushEventFeedMessage({message:[{htmlContent:`<div style="background: red; font-size: 15px; font-weight: 500">${o}</div>`,type:x.xL.FreeHtml}],delay:5e3})}removeMessage(o){Te.DN.removeItem(this.visibleMessages,o)}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function h1(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"mw-event-feed-message",1),n.NdJ("messageExpired",function(){const h=n.CHM(o).$implicit,m=n.oxw();return n.KtG(m.removeMessage(h))}),n.qZA()}2&r&&n.Q6J("message",l.$implicit)}let Da=(()=>{class r{constructor(o){this.eventFeed=o}removeMessage(o){this.eventFeed.removeMessage(o)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(as))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-event-feed"]],decls:1,vars:1,consts:[[3,"message","messageExpired",4,"ngFor","ngForOf"],[3,"message","messageExpired"]],template:function(a,u){1&a&&n.YNc(0,h1,1,1,"mw-event-feed-message",0),2&a&&n.Q6J("ngForOf",u.eventFeed.visibleMessages)},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;pointer-events:none;-webkit-user-select:none;user-select:none}mw-event-feed-message[_ngcontent-%COMP%]{margin-bottom:3px}"]})}return r})();const Ao=["mw-main-button",""],kl=["*"];let yt=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["button","mw-main-button",""]],attrs:Ao,ngContentSelectors:kl,decls:1,vars:0,template:function(a,u){1&a&&(n.F$t(),n.Hsn(0))},styles:["[_nghost-%COMP%]{display:block;max-width:100%;padding:10px;background:rgb(100,120,187);color:#fff;text-align:center;margin:4px;cursor:pointer;-webkit-user-select:none;user-select:none;border:none;font-family:segoe ui;font-size:15px}[_nghost-%COMP%]:hover{background:rgb(90,103,147)}[_nghost-%COMP%]:active{background:rgb(79,90,126)}[_nghost-%COMP%]:disabled{background:rgb(147,158,196);color:#cfcfcf}"]})}return r})();const Ag=[[["","popupHeader",""]],[["","popupContent",""]],"*"],sC=["[popupHeader]","[popupContent]","*"];let Ot=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-popup-base-content"]],ngContentSelectors:sC,decls:3,vars:0,template:function(a,u){1&a&&(n.F$t(Ag),n.Hsn(0),n.Hsn(1,1),n.Hsn(2,2,["ngProjectAs","[popupButtons]",5,["","popupButtons",""]]))},styles:["mw-popup-base-content{display:block;padding:16px}mw-popup-base-content [popupHeader]{text-align:center;margin-bottom:4px}mw-popup-base-content [popupContent]{text-align:center}mw-popup-base-content [popupContent] .sub-info p{margin:0;font-size:12px}mw-popup-base-content [popupButtons]{display:flex;justify-content:center;gap:4px;margin-top:4px}\n"],encapsulation:2})}return r})(),Og=(()=>{class r extends mt{constructor(){super()}goToMainScreen(){location.reload()}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-game-over-popup"]],features:[n.qOj],decls:8,vars:0,consts:[["popupHeader",""],["popupContent",""],["popupButtons",""],["mw-main-button","",2,"margin","auto",3,"click"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0),n._uU(2,"Game Over"),n.qZA(),n.TgZ(3,"div",1),n._uU(4,"Go to main menu?"),n.qZA(),n.TgZ(5,"div",2)(6,"button",3),n.NdJ("click",function(){return u.goToMainScreen()}),n._uU(7,"Accept"),n.qZA()()())},dependencies:[yt,Ot],styles:["[_nghost-%COMP%]{text-align:center}"]})}return r})();function aC(r,l){1&r&&n.GkF(0)}function kg(r,l){if(1&r&&(n.TgZ(0,"div",1),n.YNc(1,aC,1,0,"ng-container",2),n.qZA()),2&r){const o=l.$implicit;n.Akn(o.style),n.Udp("top",o.offsetTop,"px")("right",o.offsetRight,"px")("left",o.offsetLeft,"px")("bottom",o.offsetBottom,"px"),n.xp6(1),n.Q6J("ngTemplateOutlet",o.template)}}let cC=(()=>{class r{constructor(){this.hints=[]}createHint(o,a,u){const h=o.nativeElement,{left:m,top:_,bottom:b}=h.getBoundingClientRect();let S=null,T=_+h.clientHeight/2,A=null,ee="transform: translateY(-50%)",X=null;switch(u){case"after":S=m+h.clientWidth;break;case"before":A=window.innerWidth-m;break;case"above":T=null,ee="transform: translateX(-50%)",X=window.innerHeight-b+h.clientHeight,S=m+h.clientWidth/2;break;case"below":T=b,ee="transform: translateX(-50%)",S=m+h.clientWidth/2}const de={targetElement:o,template:a,offsetLeft:S,offsetBottom:X,offsetTop:T,offsetRight:A,style:ee};return this.hints.push(de),de}removeHint(o){const a=this.hints.indexOf(o);this.hints.splice(a,1)}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-hints-container"]],decls:1,vars:1,consts:[["class","hint",3,"top","right","left","bottom","style",4,"ngFor","ngForOf"],[1,"hint"],[4,"ngTemplateOutlet"]],template:function(a,u){1&a&&n.YNc(0,kg,2,11,"div",0),2&a&&n.Q6J("ngForOf",u.hints)},dependencies:[Ie,$o],styles:[".container[_ngcontent-%COMP%]{width:0}.hint[_ngcontent-%COMP%]{position:absolute;z-index:10000}"]})}return r})(),op=(()=>{class r{constructor(){this.activeMenusCount=0,this.activeMenus=new Set,this.clickOutsideMenu$=Ii(window,"click").pipe(Mc(()=>this.activeMenusCount>0)),this.clickOutsideMenu$.subscribe(o=>{const a=o.target,u=a.closest(".menu-hint"),h=a.closest("mw-menu");!u&&!h&&this.closeAllActiveMenus(),h||this.closeClosableMenus()})}closeAllActiveMenus(){this.activeMenus.forEach(o=>this.containerRef.removeHint(o.currentHintRef)),this.activeMenus.clear()}closeClosableMenus(){this.activeMenus.forEach(o=>{o.closeOnClick&&this.containerRef.removeHint(o.currentHintRef),this.activeMenus.delete(o)})}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const g1=["elem"],m1=["generalHint"];function Ng(r,l){1&r&&n.GkF(0)}function Fg(r,l){if(1&r&&(n.TgZ(0,"div",3),n.YNc(1,Ng,1,0,"ng-container",4),n.qZA()),2&r){const o=n.oxw();n.Udp("transition",o.transition,"s"),n.Q6J("ngClass",o.showHintAnimation?"show-hint":"hide-hint"),n.xp6(1),n.Q6J("ngTemplateOutlet",o.hintBody)}}const y1=["*"];let ge=(()=>{class r{constructor(o){this.hintsService=o,this.transition=.15,this.hintPos="after",this.showHintAnimation=!1,this.showTimeoutId=null,this.currentHintRef=null}ngOnDestroy(){this.onMouseLeave()}onMouseEnter(){this.currentHintRef=this.hintsService.containerRef.createHint(this.elem,this.generalHint,this.hintPos),this.showTimeoutId=window.setTimeout(()=>{this.clearShowTimeout(),this.showHintAnimation=!0},0)}onMouseLeave(){this.clearShowTimeout(),this.showHintAnimation=!1;const o=this.currentHintRef;this.currentHintRef=null,window.setTimeout(()=>{this.hintsService.containerRef.removeHint(o)},1e3*this.transition)}clearShowTimeout(){this.showTimeoutId&&window.clearTimeout(this.showTimeoutId),this.showTimeoutId=null}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(op))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-hover-hint"]],viewQuery:function(a,u){if(1&a&&(n.Gf(g1,7),n.Gf(m1,7)),2&a){let h;n.iGM(h=n.CRH())&&(u.elem=h.first),n.iGM(h=n.CRH())&&(u.generalHint=h.first)}},inputs:{hintBody:"hintBody",transition:"transition",hintPos:"hintPos"},ngContentSelectors:y1,decls:5,vars:0,consts:[[3,"mouseenter","mouseleave"],["elem",""],["generalHint",""],[1,"hint",3,"ngClass"],[4,"ngTemplateOutlet"]],template:function(a,u){1&a&&(n.F$t(),n.TgZ(0,"div",0,1),n.NdJ("mouseenter",function(){return u.onMouseEnter()})("mouseleave",function(){return u.onMouseLeave()}),n.Hsn(2),n.qZA(),n.YNc(3,Fg,2,4,"ng-template",null,2,n.W1O))},dependencies:[xr,$o],styles:["[_nghost-%COMP%]{position:relative}.hint[_ngcontent-%COMP%]{background:white;box-shadow:4px 4px 8px #223c504e;display:inline-block;opacity:0}.show-hint[_ngcontent-%COMP%]{opacity:1}.hide-hint[_ngcontent-%COMP%]{opacity:0}"]})}return r})();function Rg(r,l){if(1&r&&n._UZ(0,"i",1),2&r){const o=n.oxw();n.Tol("ra-"+o.icon)}}const Ug=["*"];let io=(()=>{class r{constructor(){this.disabled=!1}click(){return!this.disabled}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-icon-btn"]],hostVars:2,hostBindings:function(a,u){1&a&&n.NdJ("click",function(){return u.click()}),2&a&&n.ekj("disabled",u.disabled)},inputs:{icon:"icon",disabled:"disabled"},ngContentSelectors:Ug,decls:2,vars:1,consts:[["class","ra",3,"class",4,"ngIf"],[1,"ra"]],template:function(a,u){1&a&&(n.F$t(),n.YNc(0,Rg,1,2,"i",0),n.Hsn(1)),2&a&&n.Q6J("ngIf",u.icon)},dependencies:[rt],styles:["[_nghost-%COMP%]{display:inline-block;font-size:30px;color:#fff;background:rgb(85,87,90);cursor:pointer;border-radius:5px}.disabled[_nghost-%COMP%]{filter:brightness(.7);pointer-events:none}"]})}return r})(),rp=(()=>{class r{constructor(){}ngOnInit(){const o=this.item?.baseType||this.itemBase;this.descriptions=o.description({thisItem:this.item,thisItemBase:o}).descriptions}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-item-description"]],inputs:{item:"item",itemBase:"itemBase"},decls:1,vars:1,consts:[[3,"descriptions"]],template:function(a,u){1&a&&n._UZ(0,"mw-description",0),2&a&&n.Q6J("descriptions",u.descriptions)},changeDetection:0})}return r})();const lC=(r,l)=>({color:r,background:l});let cs=(()=>{class r{constructor(){}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-item-icon-base"]],inputs:{icon:"icon",itemColor:"itemColor",bgColor:"bgColor"},decls:2,vars:5,consts:[[1,"player-item","item-icon",3,"ngStyle"],[3,"icon"]],template:function(a,u){1&a&&(n.TgZ(0,"div",0),n._UZ(1,"mw-ra-icon",1),n.qZA()),2&a&&(n.Q6J("ngStyle",n.WLB(2,lC,u.itemColor,u.bgColor)),n.xp6(1),n.Q6J("icon",u.icon))},dependencies:[tt,lt],styles:[".player-item[_ngcontent-%COMP%]{width:64px;height:32px;padding:6px 0;box-sizing:border-box;border:1px solid gray;border-radius:6px;margin:1px}.item-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:32px;overflow:hidden}"]})}return r})();const ls=(r,l)=>({color:r,background:l});function sp(r,l){if(1&r&&(n.TgZ(0,"div",3)(1,"div",4)(2,"div",5),n._UZ(3,"mw-ra-icon",6),n.qZA(),n.TgZ(4,"div",7),n._uU(5),n.TgZ(6,"div",8),n._uU(7),n.qZA()()(),n.TgZ(8,"div",9),n._UZ(9,"mw-item-description",10),n.qZA()()),2&r){const o=n.oxw();n.xp6(2),n.Q6J("ngStyle",n.WLB(6,ls,o._itemBase.icon.iconClr,o._itemBase.icon.bgClr)),n.xp6(1),n.Q6J("icon",o._itemBase.icon.icon),n.xp6(2),n.hij(" ",o._itemBase.name," "),n.xp6(2),n.Oqu(o._itemBase.slotType),n.xp6(2),n.Q6J("item",o._item)("itemBase",o._itemBase)}}let Ei=(()=>{class r{constructor(){this.hintPos="above"}set item(o){this._itemBase=o.baseType,this._item=o}set itemBase(o){this._itemBase=o}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-item-icon"]],inputs:{item:"item",itemBase:"itemBase",hintPos:"hintPos"},decls:4,vars:5,consts:[[3,"hintBody","hintPos"],[3,"icon","itemColor","bgColor"],["hint",""],[2,"max-width","200px"],[2,"display","flex"],[1,"tooltip-icon",3,"ngStyle"],[3,"icon"],[2,"padding","4px 8px 8px","font-size","14px"],[2,"font-size","9px","color","gray"],[2,"padding","0 8px 8px","font-size","13px"],[3,"item","itemBase"]],template:function(a,u){if(1&a&&(n.TgZ(0,"mw-hover-hint",0),n._UZ(1,"mw-item-icon-base",1),n.YNc(2,sp,10,9,"ng-template",null,2,n.W1O),n.qZA()),2&a){const h=n.MAs(3);n.Q6J("hintBody",h)("hintPos",u.hintPos),n.xp6(1),n.Q6J("icon",u._itemBase.icon.icon)("itemColor",u._itemBase.icon.iconClr)("bgColor",u._itemBase.icon.bgClr)}},styles:[".tooltip-icon[_ngcontent-%COMP%]{height:32px;width:32px;overflow:hidden;font-size:28px;display:flex;align-items:center;justify-content:center}"]})}return r})();function Z(r,l,o,a){var m,u=arguments.length,h=u<3?l:null===a?a=Object.getOwnPropertyDescriptor(l,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(r,l,o,a);else for(var _=r.length-1;_>=0;_--)(m=r[_])&&(h=(u<3?m(h):u>3?m(l,o,h):m(l,o))||h);return u>3&&h&&Object.defineProperty(l,o,h),h}function DC(r,l){if(1&r&&(n.TgZ(0,"div"),n._UZ(1,"mw-item-icon",5),n.qZA()),2&r){const o=n.oxw();n.xp6(1),n.Q6J("item",o.equippedItem)("itemBase",o.equippedItem.baseType)("hintPos",o.hintPos)}}function Pi(r,l){if(1&r&&n._UZ(0,"mw-item-icon-base",6),2&r){const o=n.oxw();n.Q6J("icon",o.slotInfo.icon)}}function fp(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"mw-item-icon",10),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw(3);return n.KtG(m.equipItem(h))}),n.qZA()}if(2&r){const o=l.$implicit;n.Q6J("item",o)("itemBase",o.baseType)}}function SC(r,l){if(1&r){const o=n.EpF();n.ynx(0),n.TgZ(1,"div",7)(2,"mw-item-icon-base",8),n.NdJ("click",function(){n.CHM(o);const u=n.oxw(2);return n.KtG(u.unequipSlot())}),n.qZA(),n.YNc(3,fp,1,2,"mw-item-icon",9),n.qZA(),n.BQk()}if(2&r){const o=n.oxw(2);n.xp6(3),n.Q6J("ngForOf",o.availableItemsForSlot)}}function jg(r,l){if(1&r&&n.YNc(0,SC,4,1,"ng-container",1),2&r){const o=n.oxw(),a=n.MAs(7);n.Q6J("ngIf",o.availableItemsForSlot.length)("ngIfElse",a)}}function TC(r,l){if(1&r&&(n.TgZ(0,"div",11),n._uU(1),n.qZA()),2&r){const o=n.oxw();n.xp6(1),n.hij(' No items For "',o.slotInfo.name,'" slot ')}}"function"==typeof SuppressedError&&SuppressedError;class qn extends(bt()){constructor(l){super(),this.playersService=l,this.hintPos="after",this.isEquipped=!1,this.equippedItem=null,this.availableItemsForSlot=[],this.hero=this.playersService.getCurrentPlayer().hero}ngOnChanges(l){const o=l.itemSlot;if(o){const a=o.currentValue;this.slotInfo=wo.getSlotExtendedInfo(a);const u=this.hero.inventory;this.isEquipped=u.isSlotEquipped(a),this.equippedItem=u.getItemInSlot(a),this.availableItemsForSlot=wo.filterItemsForSlot(a,this.hero.itemsBackpack)}}updateItems(l){l.item.baseType.slotType===this.itemSlot&&(this.availableItemsForSlot=wo.filterItemsForSlot(this.itemSlot,this.hero.itemsBackpack))}removeItem(l){l.item.baseType.slotType===this.itemSlot&&(this.availableItemsForSlot=wo.filterItemsForSlot(this.itemSlot,this.hero.itemsBackpack),this.equippedItem=null,this.isEquipped=!1)}updateSlotOnEquip(l){l.item.baseType.slotType===this.itemSlot&&(this.equippedItem=l.item,this.isEquipped=!0)}updateSlotOnUnequip(l){l.item.baseType.slotType===this.itemSlot&&(this.equippedItem=null,this.isEquipped=!1)}equipItem(l){this.equippedItem!==l&&(this.equippedItem&&this.unequipSlot(),this.events.dispatch(vi({item:l,player:this.playersService.getCurrentPlayer()})))}unequipSlot(){this.isEquipped&&this.equippedItem&&this.events.dispatch(dt({item:this.equippedItem,player:this.playersService.getCurrentPlayer()}))}static#e=this.\u0275fac=function(o){return new(o||qn)(n.Y36(be))};static#t=this.\u0275cmp=n.Xpm({type:qn,selectors:[["mw-item-slot"]],inputs:{itemSlot:"itemSlot",hintPos:"hintPos"},features:[n.qOj,n.TTD],decls:8,vars:3,consts:[["pos","below",3,"menuBody"],[4,"ngIf","ngIfElse"],["isUnequipped",""],["itemsMenuBody",""],["noItemsForSlot",""],[1,"hoverable",3,"item","itemBase","hintPos"],["bgColor","white","itemColor","gray",1,"hoverable",3,"icon"],[1,"items-menu"],["bgColor","white","itemColor","gray","icon","cancel",1,"hoverable",3,"click"],["class","hoverable","hintPos","above",3,"item","itemBase","click",4,"ngFor","ngForOf"],["hintPos","above",1,"hoverable",3,"item","itemBase","click"],[1,"no-items"]],template:function(o,a){if(1&o&&(n.TgZ(0,"mw-menu",0),n.YNc(1,DC,2,3,"div",1)(2,Pi,1,1,"ng-template",null,2,n.W1O),n.qZA(),n.YNc(4,jg,1,2,"ng-template",null,3,n.W1O)(6,TC,2,1,"ng-template",null,4,n.W1O)),2&o){const u=n.MAs(3),h=n.MAs(5);n.Q6J("menuBody",h),n.xp6(1),n.Q6J("ngIf",a.isEquipped)("ngIfElse",u)}},styles:["mw-item-icon-base[_ngcontent-%COMP%]{cursor:pointer}.items-menu[_ngcontent-%COMP%]{max-width:233px;width:200px;display:flex;flex-wrap:wrap;padding:6px;justify-content:center}.no-items[_ngcontent-%COMP%]{text-align:center;width:150px;font-size:12px;color:gray;padding:10px}.hoverable[_ngcontent-%COMP%]{cursor:pointer}"]})}function hp(r){const l=(0,n.f3M)(Kd).escape$.subscribe(()=>r());(0,n.f3M)(n.ktI).onDestroy(()=>l.unsubscribe())}Z([re(er)],qn.prototype,"updateItems",null),Z([re(qi)],qn.prototype,"removeItem",null),Z([re(vi)],qn.prototype,"updateSlotOnEquip",null),Z([re(dt)],qn.prototype,"updateSlotOnUnequip",null);let xa=(()=>{class r extends mt{constructor(){super(),this.events=(0,n.f3M)(Ze),this.state=(0,n.f3M)(ft),this.state.mainMenu.isOpen=!0,hp(()=>this.close())}ngOnDestroy(){this.state.mainMenu.isOpen=!1}openSettings(){this.events.dispatch(Br())}quitTheGame(){location.reload()}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-main-menu-popup"]],features:[n.qOj],decls:9,vars:0,consts:[[2,"text-align","center"],[2,"display","flex","flex-direction","column"],["mw-main-button","",3,"click"]],template:function(a,u){1&a&&(n.TgZ(0,"div",0),n._uU(1,"Main Menu"),n.qZA(),n.TgZ(2,"div",1)(3,"button",2),n.NdJ("click",function(){return u.close()}),n._uU(4,"Return to the Game"),n.qZA(),n.TgZ(5,"button",2),n.NdJ("click",function(){return u.openSettings()}),n._uU(6,"Settings"),n.qZA(),n.TgZ(7,"button",2),n.NdJ("click",function(){return u.quitTheGame()}),n._uU(8,"Quit"),n.qZA()())},dependencies:[yt],styles:["[_nghost-%COMP%]{padding:10px;display:block}button[_ngcontent-%COMP%]{min-width:165px;font-weight:600}"]})}return r})();const gp=["elem"],M1=["generalHint"];function $g(r,l){1&r&&n.GkF(0)}function Zg(r,l){if(1&r&&(n.TgZ(0,"div",3),n.YNc(1,$g,1,0,"ng-container",4),n.qZA()),2&r){const o=n.oxw();n.Udp("transition",o.transition,"s"),n.Q6J("ngClass",o.showHintAnimation?"show-hint":"hide-hint"),n.xp6(1),n.Q6J("ngTemplateOutlet",o.menuBody)}}const Vg=["*"];let us=(()=>{class r{constructor(o,a){this.host=o,this.hintsService=a,this.transition=.15,this.pos="after",this.closeOnClick=!0,this.disabled=!1,this.showHintAnimation=!1,this.currentHintRef=null}onClick(){this.disabled||(this.hintsService.closeAllActiveMenus(),this.showHintAnimation=!0,this.hintsService.activeMenusCount+=1,this.hintsService.activeMenus.add(this),this.currentHintRef=this.hintsService.containerRef.createHint(this.elem,this.generalHint,this.pos))}clearHint(){this.currentHintRef=null}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.SBq),n.Y36(op))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-menu"]],viewQuery:function(a,u){if(1&a&&(n.Gf(gp,7),n.Gf(M1,7)),2&a){let h;n.iGM(h=n.CRH())&&(u.elem=h.first),n.iGM(h=n.CRH())&&(u.generalHint=h.first)}},inputs:{menuBody:"menuBody",transition:"transition",pos:"pos",closeOnClick:"closeOnClick",disabled:"disabled"},ngContentSelectors:Vg,decls:5,vars:0,consts:[[3,"click"],["elem",""],["generalHint",""],[1,"hint","menu-hint",3,"ngClass"],[4,"ngTemplateOutlet"]],template:function(a,u){1&a&&(n.F$t(),n.TgZ(0,"div",0,1),n.NdJ("click",function(){return u.onClick()}),n.Hsn(2),n.qZA(),n.YNc(3,Zg,2,4,"ng-template",null,2,n.W1O))},dependencies:[xr,$o],styles:["[_nghost-%COMP%]{position:relative}.hint[_ngcontent-%COMP%]{background:white;box-shadow:4px 4px 8px #223c504e;display:inline-block;opacity:0}.show-hint[_ngcontent-%COMP%]{opacity:1}.hide-hint[_ngcontent-%COMP%]{opacity:0}"]})}return r})();var mp=M(759);class oo extends _n.L{notifyNext(l,o,a,u,h){this.destination.next(o)}notifyError(l,o){this.destination.error(l)}notifyComplete(l){this.destination.complete()}}class xC extends _n.L{constructor(l,o,a){super(),this.parent=l,this.outerValue=o,this.outerIndex=a,this.index=0}_next(l){this.parent.notifyNext(this.outerValue,l,this.outerIndex,this.index++,this)}_error(l){this.parent.notifyError(l,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}var Rl=M(372);function D1(r,l,o,a,u=new xC(r,o,a)){if(!u.closed)return l instanceof El.y?l.subscribe(u):(0,Rl.s)(l)(u)}var IC=M(816);const yp={};function vp(...r){let l,o;return(0,mp.K)(r[r.length-1])&&(o=r.pop()),"function"==typeof r[r.length-1]&&(l=r.pop()),1===r.length&&(0,Pl.k)(r[0])&&(r=r[0]),(0,IC.n)(r,o).lift(new qg(l))}class qg{constructor(l){this.resultSelector=l}call(l,o){return o.subscribe(new EC(l,this.resultSelector))}}class EC extends oo{constructor(l,o){super(l),this.resultSelector=o,this.active=0,this.values=[],this.observables=[]}_next(l){this.values.push(yp),this.observables.push(l)}_complete(){const l=this.observables,o=l.length;if(0===o)this.destination.complete();else{this.active=o,this.toRespond=o;for(let a=0;a<o;a++)this.add(D1(this,l[a],void 0,a))}}notifyComplete(l){0==(this.active-=1)&&this.destination.complete()}notifyNext(l,o,a){const u=this.values,m=this.toRespond?u[a]===yp?--this.toRespond:this.toRespond:0;u[a]=o,0===m&&(this.resultSelector?this._tryResultSelector(u):this.destination.next(u.slice()))}_tryResultSelector(l){let o;try{o=this.resultSelector.apply(this,l)}catch(a){return void this.destination.error(a)}this.destination.next(o)}}function Oo(){}class Yg{constructor(l,o,a){this.nextOrObserver=l,this.error=o,this.complete=a}call(l,o){return o.subscribe(new Qg(l,this.nextOrObserver,this.error,this.complete))}}class Qg extends _n.L{constructor(l,o,a,u){super(l),this._tapNext=Oo,this._tapError=Oo,this._tapComplete=Oo,this._tapError=a||Oo,this._tapComplete=u||Oo,(0,X_.m)(o)?(this._context=this,this._tapNext=o):o&&(this._context=o,this._tapNext=o.next||Oo,this._tapError=o.error||Oo,this._tapComplete=o.complete||Oo)}_next(l){try{this._tapNext.call(this._context,l)}catch(o){return void this.destination.error(o)}this.destination.next(l)}_error(l){try{this._tapError.call(this._context,l)}catch(o){return void this.destination.error(o)}this.destination.error(l)}_complete(){try{this._tapComplete.call(this._context)}catch(l){return void this.destination.error(l)}return this.destination.complete()}}function Ia(r,l){1&r&&n.GkF(0)}const gr=r=>({hint:r});function PC(r,l){if(1&r&&(n.ynx(0),n.YNc(1,Ia,1,0,"ng-container",7),n.BQk()),2&r){const o=n.oxw().ngIf;n.oxw();const a=n.MAs(5);n.xp6(1),n.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",n.VKq(2,gr,o))}}function Wg(r,l){1&r&&n.GkF(0)}function AC(r,l){if(1&r&&(n.ynx(0),n.YNc(1,Wg,1,0,"ng-container",7),n.BQk()),2&r){const o=n.oxw().ngIf;n.oxw();const a=n.MAs(7);n.xp6(1),n.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",n.VKq(2,gr,o))}}function OC(r,l){1&r&&n.GkF(0)}function kC(r,l){if(1&r&&(n.ynx(0),n.YNc(1,OC,1,0,"ng-container",7),n.BQk()),2&r){const o=n.oxw().ngIf;n.oxw();const a=n.MAs(3);n.xp6(1),n.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",n.VKq(2,gr,o))}}function NC(r,l){if(1&r&&(n.TgZ(0,"div",4),n.ynx(1,5),n.YNc(2,PC,2,4,"ng-container",6)(3,AC,2,4,"ng-container",6)(4,kC,2,4,"ng-container",6),n.BQk(),n.qZA()),2&r){const o=l.ngIf,a=n.oxw();n.xp6(1),n.Q6J("ngSwitch",o.type),n.xp6(1),n.Q6J("ngSwitchCase",a.hintActionTypes.OnHoverEnemyCard),n.xp6(1),n.Q6J("ngSwitchCase",a.hintActionTypes.OnTargetSpell),n.xp6(1),n.Q6J("ngSwitchCase",a.hintActionTypes.CustomHtml)}}function S1(r,l){1&r&&(n._UZ(0,"div",8),n.ALo(1,"safeHtml")),2&r&&n.Q6J("innerHTML",n.lcZ(1,1,l.hint.html),n.oJD)}function T1(r,l){if(1&r&&(n.ynx(0),n._uU(1),n.BQk()),2&r){const o=n.oxw().hint;n.xp6(1),n.hij("-",o.maxDamage,"")}}function Ea(r,l){if(1&r&&(n.ynx(0),n._uU(1),n.BQk()),2&r){const o=n.oxw().hint;n.xp6(1),n.hij("-",o.maxCountLoss,"")}}function FC(r,l){if(1&r&&(n.TgZ(0,"span"),n._uU(1,"Attack"),n.qZA(),n.TgZ(2,"span"),n._uU(3),n.qZA(),n.TgZ(4,"span"),n._uU(5," dealing "),n.qZA(),n.TgZ(6,"span"),n._uU(7),n.YNc(8,T1,2,1,"ng-container",9),n.qZA(),n.TgZ(9,"span"),n._uU(10," damage, killing "),n.qZA(),n.TgZ(11,"span"),n._uU(12),n.YNc(13,Ea,2,1,"ng-container",9),n.qZA(),n.TgZ(14,"span"),n._uU(15," units "),n.qZA()),2&r){const o=l.hint;n.xp6(2),n.Udp("color",o.attackedGroup.ownerPlayer.color),n.xp6(1),n.hij(" ",o.attackedGroup.type.name," "),n.xp6(4),n.hij(" ",o.minDamage,""),n.xp6(1),n.Q6J("ngIf",!o.noDamageSpread),n.xp6(4),n.hij(" ",o.minCountLoss,""),n.xp6(1),n.Q6J("ngIf",!o.noLossSpread)}}function RC(r,l){if(1&r&&(n.TgZ(0,"div")(1,"span"),n._uU(2," Cast "),n.qZA(),n.TgZ(3,"span"),n._uU(4),n.qZA(),n.TgZ(5,"span"),n._uU(6," on "),n.qZA(),n.TgZ(7,"span"),n._uU(8),n.qZA()(),n.TgZ(9,"div"),n._uU(10," Press RMB to cancel "),n.qZA()),2&r){const o=l.hint;n.xp6(4),n.hij(" ",o.spell.name," "),n.xp6(4),n.hij(" ",o.target.type.name," ")}}let _p=(()=>{class r{constructor(o,a,u){this.players=o,this.events=a,this.actionHintService=u,this.hintActionTypes=x.wX,this.hint$=new xo.X(null),this.destroyed$=new Ft.xQ,vp([this.actionHintService.disableActionHint$,this.actionHintService.hintMessage$]).pipe((0,rs.U)(([h,m])=>h?null:m),function zg(r,l,o){return function(u){return u.lift(new Yg(r,l,o))}}(h=>this.hint$.next(h)),Xe(this.destroyed$)).subscribe()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be),n.Y36(Ze),n.Y36(no))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-action-hint"]],decls:8,vars:3,consts:[["style","text-align: center;",4,"ngIf"],["customHtml",""],["simple",""],["onTargetSpell",""],[2,"text-align","center"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"innerHTML"],[4,"ngIf"]],template:function(a,u){1&a&&(n.YNc(0,NC,5,4,"div",0),n.ALo(1,"async"),n.YNc(2,S1,2,3,"ng-template",null,1,n.W1O)(4,FC,16,7,"ng-template",null,2,n.W1O)(6,RC,11,2,"ng-template",null,3,n.W1O)),2&a&&n.Q6J("ngIf",n.lcZ(1,1,u.hint$))},dependencies:[rt,$o,uo,De,Zo,hr],styles:["[_nghost-%COMP%]{pointer-events:none;width:-moz-fit-content;width:fit-content;margin:auto}"]})}return r})();var ko=function(r){return r.HeroStatMods="hsMods",r.HeroItemMods="hiMods",r.CommonCombatMods="ccMods",r}(ko||{});function Jg(r,l){const o=r.unitGroup;r.unitGroup=l.unitGroup,l.unitGroup=o}function Kg(r){return r.filter(l=>!l.unitGroup).length}let UC=(()=>{class r extends ir.l{constructor(){super(...arguments),this.experience=0,this.level=1,this.freeSkillpoints=0,this.spells=[],this.modGroup=ot.lX.empty(),this.unitAurasModGroup=ot.lX.empty(),this.specialtiesModGroup=ot.lX.empty(),this.itemsBackpack=[],this.inventory=new wo,this._unitGroups=[],this.heroStats$=new xo.X({baseAttack:0,bonusAttack:0,finalAttack:0,baseDefence:0,bonusDefence:0,finalDefence:0,fireResist:0,coldResist:0,lightningResist:0,poisonResist:0,currentMana:0,maxMana:0}),this.destroyed$=new Ft.xQ,this.mainUnitSlots=[{unitGroup:null},{unitGroup:null},{unitGroup:null},{unitGroup:null}],this.reserveUnitSlots=[{unitGroup:null,isReserve:!0},{unitGroup:null,isReserve:!0}]}static#e=this.categoryId="hero";get ownerPlayer(){return this._ownerPlayer}get unitGroups(){return this._unitGroups}create({heroBase:o,unitGroups:a,ownerPlayer:u}){this.base=o,this.name=o.name;const h=o.initialState.stats;u&&(this._ownerPlayer=u),this.stats={currentMana:h.mana},a&&this.setUnitGroups(a),o.initialState.defaultModifiers&&this.modGroup.addModsRef(ot.Cc.fromMods(o.initialState.defaultModifiers))}addReserveSlots(o){for(let a=0;a<o;a++)this.reserveUnitSlots.push({unitGroup:null,isReserve:!0})}hasFreeUnitSlots(){return this.hasFreeMainSlots()||this.hasFreeReserveSlots()}hasFreeMainSlots(){return 0!==this.getFreeMainSlotsCount()}hasFreeReserveSlots(){return 0!==this.getFreeReserveSlotsCount()}getFreeUnitSlotsCount(){return this.getFreeMainSlotsCount()+this.getFreeReserveSlotsCount()}getFreeMainSlotsCount(){return Kg(this.mainUnitSlots)}getFreeReserveSlotsCount(){return Kg(this.reserveUnitSlots)}getMainFilledUnitSlots(){return this.mainUnitSlots.filter(o=>o.unitGroup)}updateUnitGroupPositions(){this.getMainFilledUnitSlots().forEach((o,a)=>{o?.unitGroup?.setPosition(a)})}getAllSlots(){return[...this.mainUnitSlots,...this.reserveUnitSlots]}getAllUnitsFromSlots(){return this.getAllSlots().map(o=>o.unitGroup).filter(os.lm)}setUnitGroups(o,a=!0){this._unitGroups=o,this._unitGroups.forEach((u,h)=>{a&&(this.mainUnitSlots[h].unitGroup=u),this.updateUnitGroup(u)}),this.updateUnitGroupPositions()}addUnitGroup(o){const a=this.unitGroups.includes(o);if(this._unitGroups.push(o),this.updateUnitGroup(o),a)return;const u=this.mainUnitSlots.find(m=>!m.unitGroup);if(u)return u.unitGroup=o,void this.refreshUnitGroupsOrderBySlots();const h=this.reserveUnitSlots.find(m=>!m.unitGroup);h&&(h.unitGroup=o),this.refreshUnitGroupsOrderBySlots(),this.getApi().events.dispatch(sd({hero:this,unitGroup:o})),this.updateUnitGroupPositions()}removeUnitGroup(o){Te.DN.removeItem(this.unitGroups,o),this.getApi().events.dispatch(Uc({hero:this,unitGroup:o})),this.updateUnitGroupPositions()}refreshUnitGroupsOrderBySlots(){this._unitGroups=this.mainUnitSlots.map(o=>o.unitGroup).filter(Boolean)}assignOwnerPlayer(o){this._ownerPlayer=o;const a=this.base;this.spells=a.initialState.abilities.map(h=>this.getApi().spells.createSpellInstance(h)),this.initParentModGroups(),this.setupStatsUpdating(a),this.updateUnitGroupPositions()}onDestroy(){yg(this.destroyed$)}getStats(){return this.heroStats$.getValue()}listenHeroStats(){return this.heroStats$.pipe(Xe(this.destroyed$))}addItem(o){this.itemsBackpack.push(o)}removeItem(o){Te.DN.removeItem(this.itemsBackpack,o),this.inventory.isItemEquipped(o)&&this.unequipItem(o)}equipItem(o){this.inventory.equipItem(o);const a=this.getItemModsGroup(),u=o.baseType;if(u.staticMods){const h=ot.Cc.fromMods(u.staticMods);a?.addModsRef(h)}u.bonusAbilities&&u.bonusAbilities.forEach(h=>{const m=this.getApi().spells.createSpellInstance(h.spell,{initialLevel:h.level});m.setSourceGameObjectId(o.id),this.spells.push(m)})}unequipItem(o){this.inventory.unequipItem(o);const a=this.getItemModsGroup();o.baseType.staticMods&&a&&a.removeRefByModInstance(o.baseType.staticMods),this.spells=this.spells.filter(u=>u.sourceInfo.gameObjectId!==o.id)}addCommonCombatMods(o){this.modGroup.getNamedGroup(ko.CommonCombatMods)?.addModsRef(o)}clearCommonCombatMods(){this.modGroup.getNamedGroup(ko.CommonCombatMods)?.clearOwnModRefs()}updateUnitsSpecialtyAndConditionalMods(){this.unitGroups.forEach(o=>this.updateUnitSpecialtyAndConditionalMods(o))}updateUnitSpecialtyAndConditionalMods(o){o.clearSpecialtyAndConditionalMods(),this.modGroup.getAllModValues("__unitConditionalMods").map(m=>m(o)).filter(Boolean).forEach(m=>o.attachSpecialtyMods(m));const u=o.type.getUnitTypeSpecialtyModifiers;if(!u)return;const h=u?.(this.specialtiesModGroup.getMods());h&&o.attachSpecialtyMods(h)}addStatsMods(o){this.modGroup.getNamedGroup(ko.HeroStatMods)?.addModsRef(ot.Cc.fromMods(o))}addMana(o){this.stats.currentMana+=o;const a=this.getStats().maxMana;this.stats.currentMana>a&&(this.stats.currentMana=a);const u=this.heroStats$.getValue();this.heroStats$.next({...u,currentMana:this.stats.currentMana})}updateUnitGroup(o){o.assignOwnerPlayer(this.ownerPlayer),o.assignOwnerHero(this),this.updateUnitSpecialtyAndConditionalMods(o)}getItemModsGroup(){return this.modGroup.getNamedGroup(ko.HeroItemMods)}initParentModGroups(){this.modGroup.attachNamedParentGroup(ko.HeroItemMods,ot.lX.empty()),this.modGroup.attachNamedParentGroup(ko.HeroStatMods,ot.lX.empty()),this.modGroup.attachNamedParentGroup(ko.CommonCombatMods,ot.lX.empty())}setupStatsUpdating(o){this.modGroup.onValueChanges().pipe(Xe(this.destroyed$)).subscribe(a=>{this.specialtiesModGroup.clearOwnModRefs(),this.specialtiesModGroup.addModsRef(ot.Cc.fromMods((0,ot._k)(a))),this.updateUnitsSpecialtyAndConditionalMods();const{baseAttack:u,baseDefence:h,mana:m}=o.initialState.stats,_=a.heroBonusAttack||0,b=a.heroBonusDefence||0,S=a.resistAll||0,T=(a.heroMaxMana||0)+m;this.stats.currentMana>T&&(this.stats.currentMana=T),this.heroStats$.next({baseAttack:u,bonusAttack:_,finalAttack:u+_,baseDefence:h,bonusDefence:b,finalDefence:h+b,fireResist:(a.resistFire||0)+S,coldResist:(a.resistCold||0)+S,lightningResist:(a.resistLightning||0)+S,poisonResist:(a.resistPoison||0)+S,currentMana:this.stats.currentMana,maxMana:T})})}}return r})();const Ul={1:0,2:285,3:400,4:475,5:545,6:600,7:650,8:700};let Cp=(()=>{class r{constructor(o){this.players=o,this.currentPlayer=this.players.getCurrentPlayer(),this.xpToNextLevel=Ul[this.currentPlayer.hero.level+1]}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-experience-bar"]],decls:2,vars:2,consts:[[1,"experience-bar"],[1,"experience-progress"]],template:function(a,u){1&a&&(n.TgZ(0,"div",0),n._UZ(1,"div",1),n.qZA()),2&a&&(n.xp6(1),n.Udp("width",u.currentPlayer.hero.experience/u.xpToNextLevel*100,"%"))},styles:["[_nghost-%COMP%]{display:block}.experience-bar[_ngcontent-%COMP%]{background:rgba(128,128,128,.455)}.experience-progress[_ngcontent-%COMP%]{background:rgb(76,31,94);height:3px}"]})}return r})();function mr(r,l){if(1&r&&n._UZ(0,"mw-item-slot",7),2&r){const o=l.$implicit;n.Q6J("mwActionHint",o.name)("itemSlot",o.slotType)}}function LC(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",9),n.NdJ("click",function(){n.CHM(o);const u=n.oxw().$implicit,h=n.oxw();return n.KtG(h.displayUnitGroupInfo(u.unitGroup))})("mwNoContextMenu",function(){n.CHM(o);const u=n.oxw().$implicit,h=n.oxw();return n.KtG(h.displayUnitGroupInfo(u.unitGroup))}),n.TgZ(1,"div",10),n._uU(2),n.qZA(),n.TgZ(3,"div"),n._uU(4),n.qZA()()}if(2&r){const o=n.oxw().$implicit,a=n.oxw();n.Udp("background",a.player.color),n.Q6J("mwActionHint","Inspect group of "+o.unitGroup.count+" "+o.unitGroup.type.name),n.xp6(2),n.Oqu(o.unitGroup.type.name),n.xp6(2),n.Oqu(o.unitGroup.count)}}function wp(r,l){1&r&&n.YNc(0,LC,5,5,"div",8),2&r&&n.um2(0,l.$implicit.unitGroup?0:-1)}function Ai(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",12),n.NdJ("click",function(){n.CHM(o);const u=n.oxw().$implicit,h=n.oxw();return n.KtG(h.displayUnitGroupInfo(u.unitGroup))})("mwNoContextMenu",function(){n.CHM(o);const u=n.oxw().$implicit,h=n.oxw();return n.KtG(h.displayUnitGroupInfo(u.unitGroup))}),n.TgZ(1,"div",10),n._uU(2),n.qZA(),n.TgZ(3,"div"),n._uU(4),n.qZA()()}if(2&r){const o=n.oxw().$implicit,a=n.oxw();n.Udp("background",a.player.color),n.Q6J("mwActionHint","Inspect group of "+o.unitGroup.count+" "+o.unitGroup.type.name),n.xp6(2),n.Oqu(o.unitGroup.type.name),n.xp6(2),n.Oqu(o.unitGroup.count)}}function Xg(r,l){1&r&&n.YNc(0,Ai,5,5,"div",11),2&r&&n.um2(0,l.$implicit.unitGroup?0:-1)}let Ll=(()=>{class r{constructor(o,a,u){this.players=o,this.state=a,this.events=u,this.player=this.players.getCurrentPlayer(),this.itemSlots=wo.getExtendedSlotTypes()}openPlayerInfo(){this.events.dispatch(kc())}getHeroActionHint(){const o=this.player.hero,a=o.level+1;return`\n    <div>${Ul[a]-o.experience}xp is required to reach Level ${a}</div>\n    <div>(${o.experience}/${Ul[a]})</div>\n    `}displayUnitGroupInfo(o){this.events.dispatch(jc({unitGroup:o}))}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be),n.Y36(ft),n.Y36(Ze))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-player-info-panel"]],decls:13,vars:6,consts:[["mwActionHint","Inspect Hero",1,"hero-image",2,"cursor","pointer",3,"click","mwNoContextMenu"],[1,"hero-info"],[2,"display","flex","flex-direction","row"],["class","info-small-icons","hintPos","above",3,"mwActionHint","itemSlot",4,"ngFor","ngForOf"],[3,"mwActionHint"],[2,"width","270px"],[1,"groups-container"],["hintPos","above",1,"info-small-icons",3,"mwActionHint","itemSlot"],["class","player-group-card",3,"background","mwActionHint"],[1,"player-group-card",3,"mwActionHint","click","mwNoContextMenu"],[1,"group-name"],["class","player-group-card reserve",3,"background","mwActionHint"],[1,"player-group-card","reserve",3,"mwActionHint","click","mwNoContextMenu"]],template:function(a,u){1&a&&(n.TgZ(0,"div",0),n.NdJ("click",function(){return u.openPlayerInfo()})("mwNoContextMenu",function(){return u.openPlayerInfo()}),n.qZA(),n.TgZ(1,"div",1)(2,"div")(3,"div",2),n.YNc(4,mr,1,2,"mw-item-slot",3),n.qZA()(),n.TgZ(5,"div",4),n._uU(6),n._UZ(7,"mw-experience-bar",5),n.qZA(),n.TgZ(8,"div",6),n.SjG(9,wp,1,1,null,null,n.x6l),n.SjG(11,Xg,1,1,null,null,n.x6l),n.qZA()()),2&a&&(n.Udp("background-image","url('assets/"+u.player.hero.base.image+"')"),n.xp6(4),n.Q6J("ngForOf",u.itemSlots),n.xp6(1),n.Q6J("mwActionHint",u.getHeroActionHint()),n.xp6(1),n.AsE(" ",u.player.hero.name,", Level: ",u.player.hero.level," "),n.wJu(9,u.player.hero.mainUnitSlots),n.wJu(11,u.player.hero.reserveUnitSlots))},styles:["[_nghost-%COMP%]{display:flex}.groups-container[_ngcontent-%COMP%]{display:flex}.hero-info[_ngcontent-%COMP%]{align-self:end;margin-bottom:6px}.hero-image[_ngcontent-%COMP%]{background-size:cover;width:100px;height:100px;border-radius:50%;border:4px solid gray;margin:8px;align-self:end}.player-group-card[_ngcontent-%COMP%]{height:48px;width:48px;color:#fff;display:flex;flex-direction:column;justify-content:center;text-align:center;border-radius:4px;font-size:11px;margin:3px;cursor:pointer}.player-group-card.reserve[_ngcontent-%COMP%]{height:40px;width:40px;font-size:10px;filter:brightness(.7)}.group-name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.skillpoints[_ngcontent-%COMP%]{border:1px solid gold;padding:3px;font-size:12px;cursor:pointer;margin:3px;max-width:200px}"]})}return r})();function x1(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",2),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw();return n.KtG(m.displayUnitGroupInfo(h))})("mwNoContextMenu",function(){const h=n.CHM(o).$implicit,m=n.oxw();return n.KtG(m.displayUnitGroupInfo(h))}),n.TgZ(1,"div"),n._uU(2),n.qZA(),n.TgZ(3,"div"),n._uU(4),n.qZA()()}if(2&r){const o=l.$implicit;n.Udp("background",o.ownerPlayer.color),n.Q6J("mwActionHint","Inspect "+o.count+" "+o.type.name),n.xp6(2),n.Oqu(o.type.name),n.xp6(2),n.Oqu(o.count)}}let vt=(()=>{class r{constructor(o){this.events=o}displayUnitGroupInfo(o){this.events.dispatch(jc({unitGroup:o}))}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(Ze))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-unit-groups-list"]],inputs:{unitGroups:"unitGroups"},decls:2,vars:1,consts:[[1,"list"],["class","group",3,"mwActionHint","background","click","mwNoContextMenu",4,"ngFor","ngForOf"],[1,"group",3,"mwActionHint","click","mwNoContextMenu"]],template:function(a,u){1&a&&(n.TgZ(0,"div",0),n.YNc(1,x1,5,5,"div",1),n.qZA()),2&a&&(n.xp6(1),n.Q6J("ngForOf",u.unitGroups))},styles:[".list[_ngcontent-%COMP%]{display:flex;justify-content:center}.group[_ngcontent-%COMP%]{height:64px;width:64px;font-size:13px;display:flex;justify-content:center;flex-direction:column;align-items:center;text-align:center;color:#fff;margin:3px;border-radius:5px;cursor:pointer}"]})}return r})(),bp=(()=>{class r{constructor(){this.state=(0,n.f3M)(ft),this.events=(0,n.f3M)(Ze),this.players=(0,n.f3M)(be),this.currentPlayer=this.players.getCurrentPlayer()}goToTown(){this.events.dispatch(id())}openPlayerInfo(){this.events.dispatch(kc())}openActionCards(){this.events.dispatch(Nc())}openGarrison(){this.events.dispatch(Ws())}setupCampAction(){const o=this.players.getCurrentPlayer();this.events.dispatch(gt({player:o,cardStack:o.actionCards.find(a=>a.card===Ud)}))}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-player-map-actions-panel"]],decls:13,vars:7,consts:[["icon","castle-emblem",3,"mwActionHint","click"],["mwActionHint","Inspect Hero","icon","aura",3,"click"],[1,"action-points",3,"mwActionHint","click"],[1,"action-info"],["icon","feather-wing"],["mwActionHint","Learn new abilities"],["icon","barrier",3,"disabled"],[3,"mwActionHint"],["icon","guarded-tower",3,"disabled","click"],[1,"camp-action",3,"mwActionHint","click"],["icon","campfire"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-icon-btn",0),n.NdJ("click",function(){return u.goToTown()}),n.qZA(),n.TgZ(1,"mw-icon-btn",1),n.NdJ("click",function(){return u.openPlayerInfo()}),n.qZA(),n.TgZ(2,"mw-icon-btn",2),n.NdJ("click",function(){return u.openActionCards()}),n.TgZ(3,"div",3),n._UZ(4,"mw-ra-icon",4),n.TgZ(5,"span"),n._uU(6),n.qZA()()(),n.TgZ(7,"div",5),n._UZ(8,"mw-icon-btn",6),n.qZA(),n.TgZ(9,"div",7)(10,"mw-icon-btn",8),n.NdJ("click",function(){return u.openGarrison()}),n.qZA()(),n.TgZ(11,"mw-icon-btn",9),n.NdJ("click",function(){return u.setupCampAction()}),n._UZ(12,"mw-ra-icon",10),n.qZA()),2&a&&(n.MGl("mwActionHint","Go to ",u.state.createdGame.faction.title,""),n.xp6(2),n.Q6J("mwActionHint","Action Cards<hr>"+u.state.currentGame.actionPoints+" action points left"),n.xp6(4),n.Oqu(u.state.currentGame.actionPoints),n.xp6(2),n.Q6J("disabled",!0),n.xp6(1),n.Q6J("mwActionHint",0!==u.currentPlayer.garrisons.size?"Garrison":"Garrison <hr> No garrisons to hire"),n.xp6(1),n.Q6J("disabled",0===u.currentPlayer.garrisons.size),n.xp6(1),n.Q6J("mwActionHint","Set up Camp<hr>Skips current day"))},styles:["mw-icon-btn[_ngcontent-%COMP%]{text-align:center;min-width:70px;max-width:70px;min-height:40px;margin-bottom:4px}mw-icon-btn.action-points[_ngcontent-%COMP%]{font-weight:100;font-size:23px;padding-top:4px;box-sizing:border-box}mw-icon-btn[_ngcontent-%COMP%] > .action-info[_ngcontent-%COMP%]{margin-left:-2px}"]})}return r})();function Mp(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",7),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw();return n.KtG(m.setActiveReward(h))}),n._UZ(1,"mw-ra-icon",8),n.TgZ(2,"div",9),n._uU(3),n.qZA()()}if(2&r){const o=l.$implicit,a=n.oxw();n.ekj("active",o===a.activeReward),n.xp6(1),n.Q6J("icon",o.display.icon),n.xp6(2),n.Oqu(o.display.title)}}let em=(()=>{class r extends mt{setActiveReward(o){this.activeReward=o}acceptReward(){this.activeReward.onSumbit(),this.close()}static#e=this.\u0275fac=(()=>{let o;return function(u){return(o||(o=n.n5z(r)))(u||r)}})();static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-reward-popup"]],features:[n.qOj],decls:12,vars:4,consts:[["popupHeader",""],["popupContent",""],[1,"sub-info"],[1,"rewards"],["class","reward",3,"active","click",4,"ngFor","ngForOf"],["popupButtons",""],["mw-main-button","",3,"disabled","click"],[1,"reward",3,"click"],[3,"icon"],[1,"reward-title"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0),n._uU(2),n.qZA(),n.TgZ(3,"div",1)(4,"div",2)(5,"p"),n._uU(6),n.qZA()(),n.TgZ(7,"div",3),n.YNc(8,Mp,4,4,"div",4),n.qZA()(),n.TgZ(9,"div",5)(10,"button",6),n.NdJ("click",function(){return u.acceptReward()}),n._uU(11," Accept "),n.qZA()()()),2&a&&(n.xp6(2),n.hij(" ",u.data.title," "),n.xp6(4),n.Oqu(u.data.subTitle),n.xp6(2),n.Q6J("ngForOf",u.data.rewards),n.xp6(2),n.Q6J("disabled",!u.activeReward))},dependencies:[Ie,lt,yt,Ot],styles:[".title[_ngcontent-%COMP%]{font-size:16px;text-align:center}.sub-title[_ngcontent-%COMP%]{font-size:13px;text-align:center}.rewards[_ngcontent-%COMP%]{display:flex;padding-top:10px;width:100%;justify-content:center}.reward[_ngcontent-%COMP%]{display:flex;width:120px;height:80px;align-items:center;justify-content:center;border:1px solid gray;flex-direction:column;margin:10px;cursor:pointer;-webkit-user-select:none;user-select:none}.reward.active[_ngcontent-%COMP%]{border:1px solid gold}.reward[_ngcontent-%COMP%]   mw-ra-icon[_ngcontent-%COMP%]{font-size:30px}.reward[_ngcontent-%COMP%]   .reward-title[_ngcontent-%COMP%]{font-size:13px;text-align:center}"]})}return r})(),tm=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-round-icon"]],inputs:{icon:"icon"},decls:1,vars:1,consts:[[3,"icon"]],template:function(a,u){1&a&&n._UZ(0,"mw-ra-icon",0),2&a&&n.Q6J("icon",u.icon)},dependencies:[lt],styles:["[_nghost-%COMP%]{border:5px solid rgb(105,105,105);border-radius:50%;width:28px;height:28px;background-color:gray;color:#fff;display:flex;font-size:20px;justify-content:center;align-items:center}"]})}return r})(),Gl=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-round-icon-btn"]],inputs:{icon:"icon"},decls:1,vars:1,consts:[[3,"icon"]],template:function(a,u){1&a&&n._UZ(0,"mw-round-icon",0),2&a&&n.Q6J("icon",u.icon)},dependencies:[tm],styles:["mw-round-icon[_ngcontent-%COMP%]:hover{filter:brightness(1.1)}mw-round-icon[_ngcontent-%COMP%]:active{filter:brightness(.7)}"]})}return r})(),Dp=(()=>{class r{constructor(o){this.template=o}ngOnInit(){console.log("-------\x3e>",this.templateName)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.Rgc))};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","mwSharedTemplate",""]],inputs:{templateName:["mwSharedTemplate","templateName"]}})}return r})();function nm(r,l){1&r&&n._UZ(0,"mw-ra-icon",2),2&r&&n.Q6J("icon",l.data.icon)}function GC(r,l){1&r&&n._UZ(0,"mw-vfx-element")}let Hl=(()=>{class r{constructor(){}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-shared-templates"]],decls:2,vars:0,consts:[["mwSharedTemplate","icon"],["mwSharedTemplate","animation"],[3,"icon"]],template:function(a,u){1&a&&n.YNc(0,nm,1,1,"ng-template",0)(1,GC,1,0,"ng-template",1)}})}return r})(),ds=(()=>{class r{constructor(){}ngOnInit(){this.descriptions=this.spell.baseType.getDescription({thisSpell:this.spell.baseType,spellInstance:this.spell,ownerHero:this.hero,ownerPlayer:this.player,ownerUnit:this.ownerUnit}).descriptions}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-spell-description"]],inputs:{spell:"spell",hero:"hero",player:"player",ownerUnit:"ownerUnit"},decls:1,vars:1,consts:[[3,"descriptions"]],template:function(a,u){1&a&&n._UZ(0,"mw-description",0),2&a&&n.Q6J("descriptions",u.descriptions)},changeDetection:0})}return r})(),im=(()=>{class r extends mt{constructor(){super(...arguments),this.players=(0,n.f3M)(be),this.gameObjects=(0,n.f3M)(an),this.toSplit=0}upgadeValue(o){this.toSplit=Number(o.target.value)}split(){if(0===this.toSplit)return void this.close();const o=this.data.unitGroup,a=this.players.getCurrentPlayer().hero,u=this.gameObjects.createNewGameObject(vg,{count:this.toSplit,unitBase:o.type,ownerHero:a});a.addUnitGroup(u),o.addUnitsCount(-this.toSplit),this.close()}closePopup(){this.close()}static#e=this.\u0275fac=(()=>{let o;return function(u){return(o||(o=n.n5z(r)))(u||r)}})();static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-split-units-popup"]],features:[n.qOj],decls:15,vars:5,consts:[["popupHeader",""],["popupContent",""],["type","range","min","0",3,"max","value","input"],["popupButtons",""],["mw-main-button","",3,"click"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0),n._uU(2," Splitting Group "),n.qZA(),n.TgZ(3,"div",1)(4,"div"),n._uU(5),n.qZA(),n.TgZ(6,"div")(7,"input",2),n.NdJ("input",function(m){return u.upgadeValue(m)}),n.qZA(),n.TgZ(8,"div"),n._uU(9),n.qZA()()(),n.TgZ(10,"div",3)(11,"button",4),n.NdJ("click",function(){return u.split()}),n._uU(12," Split "),n.qZA(),n.TgZ(13,"button",4),n.NdJ("click",function(){return u.closePopup()}),n._uU(14," Close "),n.qZA()()()),2&a&&(n.xp6(5),n.AsE(" ",u.popup.data.unitGroup.type.name," ",u.popup.data.unitGroup.count," "),n.xp6(2),n.Q6J("max",u.popup.data.unitGroup.count-1)("value",u.toSplit),n.xp6(2),n.hij(" To split: ",u.toSplit," "))},dependencies:[yt,Ot],encapsulation:2})}return r})(),ro=(()=>{class r extends mt{static#e=this.\u0275fac=(()=>{let o;return function(u){return(o||(o=n.n5z(r)))(u||r)}})();static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-unit-group-info-popup"]],features:[n.qOj],decls:1,vars:1,consts:[[3,"unitGroup"]],template:function(a,u){1&a&&n._UZ(0,"mw-unit-group-info",0),2&a&&n.Q6J("unitGroup",u.data.unitGroup)},encapsulation:2})}return r})();function om(r,l){if(1&r&&n._UZ(0,"mw-description",20),2&r){const o=n.oxw(2);n.Q6J("descriptions",o.description.descriptions)}}function rm(r,l){1&r&&n._uU(0," No Description. ")}function HC(r,l){if(1&r&&n._UZ(0,"mw-unit-group-spell-icon",24),2&r){const o=l.$implicit,a=n.oxw(3);n.Q6J("hero",a.unitGroup.ownerPlayer.hero)("spell",o)("hintPos","above")("owner",a.unitGroup)}}function BC(r,l){if(1&r&&(n.TgZ(0,"div",21),n._UZ(1,"hr"),n.TgZ(2,"div",4),n._uU(3," Abilities: "),n.qZA(),n.TgZ(4,"div",22),n.YNc(5,HC,1,4,"mw-unit-group-spell-icon",23),n.qZA()()),2&r){const o=n.oxw(2);n.xp6(5),n.Q6J("ngForOf",o.spells)}}function sm(r,l){if(1&r&&n._UZ(0,"mw-unit-group-spell-icon",24),2&r){const o=l.$implicit,a=n.oxw(3);n.Q6J("hero",a.unitGroup.ownerPlayer.hero)("spell",o)("hintPos","above")("owner",a.unitGroup)}}function am(r,l){if(1&r&&(n.TgZ(0,"div",21),n._UZ(1,"hr"),n.TgZ(2,"div",4),n._uU(3," Effects: "),n.qZA(),n.TgZ(4,"div",22),n.YNc(5,sm,1,4,"mw-unit-group-spell-icon",23),n.qZA()()),2&r){const o=n.oxw(2);n.xp6(5),n.Q6J("ngForOf",o.effects)}}function Bl(r,l){if(1&r&&(n.ynx(0),n._UZ(1,"mw-unit-group-portrait",1),n.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),n._uU(6),n.qZA(),n.TgZ(7,"div",6),n._uU(8),n.qZA()(),n.TgZ(9,"div",7)(10,"div",8)(11,"div",9),n._UZ(12,"mw-ra-icon",10),n._uU(13),n.qZA(),n.TgZ(14,"div",9),n._UZ(15,"mw-ra-icon",11),n._uU(16),n.qZA()(),n.TgZ(17,"div",8)(18,"div",9),n._UZ(19,"mw-ra-icon",12),n._uU(20),n.qZA()()()(),n.TgZ(21,"div",13),n._UZ(22,"hr"),n.YNc(23,om,1,1,"mw-description",14)(24,rm,1,0,"ng-template",null,15,n.W1O),n.qZA()(),n.TgZ(26,"div",16)(27,"div",4),n._uU(28,"Group Stats"),n.qZA(),n._UZ(29,"hr"),n.TgZ(30,"div",7)(31,"div",8)(32,"div",9),n._UZ(33,"mw-ra-icon",10),n._uU(34),n.qZA(),n.TgZ(35,"div",9),n._UZ(36,"mw-ra-icon",11),n._uU(37),n.qZA(),n._UZ(38,"hr"),n.TgZ(39,"div",17)(40,"div",9)(41,"div"),n._uU(42,"Attack:"),n.qZA(),n.TgZ(43,"div"),n._uU(44),n._UZ(45,"span",18),n.qZA()(),n.TgZ(46,"div",9)(47,"div"),n._uU(48,"Defence:"),n.qZA(),n.TgZ(49,"div"),n._uU(50),n._UZ(51,"span",18),n.qZA()(),n.TgZ(52,"div",9)(53,"div"),n._uU(54,"Speed"),n.qZA(),n.TgZ(55,"div"),n._uU(56),n._UZ(57,"span",18),n.qZA()()(),n.YNc(58,BC,6,1,"div",19)(59,am,6,1,"div",19),n.qZA()()(),n.BQk()),2&r){const o=l.ngIf,a=n.MAs(25),u=n.oxw();n.xp6(1),n.Q6J("unitGroup",u.unitGroup),n.xp6(5),n.AsE(" ",u.unitGroup.count," ",u.unitGroup.type.name," "),n.xp6(2),n.hij(" Tier ",u.unitGroup.type.level," "),n.xp6(5),n.AsE(" ",u.baseStats.damageInfo.minDamage,"-",u.baseStats.damageInfo.maxDamage," "),n.xp6(3),n.hij(" ",u.baseStats.health," "),n.xp6(4),n.hij(" Turns per round: ",u.unitGroup.type.defaultTurnsPerRound," "),n.xp6(3),n.Q6J("ngIf",u.description.descriptions.length)("ngIfElse",a),n.xp6(11),n.lnq(" ",o.totalMinDamage,"-",o.totalMaxDamage," (avg. ",o.avgTotalDamage,") "),n.xp6(3),n.hij(" ",o.totalHealth," "),n.xp6(7),n.hij(" ",o.baseAttack," "),n.xp6(1),n.Q6J("mwNumberModifier",o.bonusAttack),n.xp6(5),n.hij(" ",o.baseDefence," "),n.xp6(1),n.Q6J("mwNumberModifier",o.bonusDefence),n.xp6(5),n.hij(" ",o.baseSpeed," "),n.xp6(1),n.Q6J("mwNumberModifier",o.speedBonus),n.xp6(1),n.Q6J("ngIf",u.spells.length),n.xp6(1),n.Q6J("ngIf",u.effects.length)}}let Sp=(()=>{class r{ngOnChanges(o){this.unitStats$=this.unitGroup.listenStats(),this.baseStats=this.unitGroup.type.baseStats;const a=this.unitGroup.spells;this.effects=a.filter(u=>u.isEffect()),this.spells=a.filter(u=>!u.isEffect()),this.description=this.unitGroup.type.getDescription?.({unit:this.unitGroup,unitBase:this.unitGroup.type})||{descriptions:[]}}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-unit-group-info"]],inputs:{unitGroup:"unitGroup"},features:[n.TTD],decls:2,vars:3,consts:[[4,"ngIf"],["size","big",1,"unit-portrait",3,"unitGroup"],[1,"main-group"],[1,"info-header"],[1,"title"],[1,"group"],[1,"tier"],[1,"stats"],[1,"col"],[1,"stat"],["icon","sword"],["icon","health"],["icon","spinning-sword"],[1,"description"],[3,"descriptions",4,"ngIf","ngIfElse"],["noDescription",""],[1,"secondary-group"],[1,"hor-stats"],[3,"mwNumberModifier"],["class","abilities",4,"ngIf"],[3,"descriptions"],[1,"abilities"],[1,"abilities-list"],[3,"hero","spell","hintPos","owner",4,"ngFor","ngForOf"],[3,"hero","spell","hintPos","owner"]],template:function(a,u){1&a&&(n.YNc(0,Bl,60,22,"ng-container",0),n.ALo(1,"async")),2&a&&n.Q6J("ngIf",n.lcZ(1,1,u.unitStats$))},styles:["[_nghost-%COMP%]{display:flex;width:570px}.unit-portrait[_ngcontent-%COMP%]{position:absolute;left:-60px;top:-42px}.info-header[_ngcontent-%COMP%]{display:flex;margin-left:64px;flex-direction:column;height:92px}.stats[_ngcontent-%COMP%]{margin-top:12px;font-size:13px;display:flex}.col[_ngcontent-%COMP%]{margin-left:8px}.tier[_ngcontent-%COMP%]{font-size:13px}.description[_ngcontent-%COMP%]{font-size:12px;max-width:360px}.secondary-group[_ngcontent-%COMP%]{width:202px;flex-grow:1;margin-left:8px}.secondary-group[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{text-align:center}.secondary-group[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{width:100%}.secondary-group[_ngcontent-%COMP%]   .abilities-list[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:4px}.secondary-group[_ngcontent-%COMP%]   .hor-stats[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.secondary-group[_ngcontent-%COMP%]   .hor-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{display:flex;flex-direction:column}.secondary-group[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{display:flex;justify-content:center;text-align:center}.secondary-group[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{padding-bottom:2px}"]})}return r})(),Tp=(()=>{class r{constructor(){this.toRight=!0}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-unit-group-portrait"]],hostVars:4,hostBindings:function(a,u){2&a&&(n.Tol(u.size),n.ekj("to-right",u.toRight))},inputs:{unitGroup:"unitGroup",toRight:"toRight",size:"size"},decls:2,vars:1,consts:[[1,"portrait",3,"src"],["src","../assets/common/common-unit-frame.png",1,"portrait-frame"]],template:function(a,u){1&a&&n._UZ(0,"img",0)(1,"img",1),2&a&&n.MGl("src","../assets/",u.unitGroup.type.mainPortraitUrl,"",n.LSH)},styles:["[_nghost-%COMP%]{position:relative;-webkit-user-select:none;user-select:none;display:inline-block}.to-right[_nghost-%COMP%]{scale:-1 1}[_nghost-%COMP%]   .portrait-frame[_ngcontent-%COMP%]{height:130px;width:121px}[_nghost-%COMP%]   .portrait[_ngcontent-%COMP%]{position:absolute;z-index:-1;left:30px;width:64px;height:83px;top:20px}.big[_nghost-%COMP%]   .portrait-frame[_ngcontent-%COMP%]{height:170px;width:144px}.big[_nghost-%COMP%]   .portrait[_ngcontent-%COMP%]{width:78px;height:102px;top:26px}"]})}return r})();function xp(r,l){if(1&r&&(n.TgZ(0,"div",7),n._uU(1),n.qZA()),2&r){const o=n.oxw(2);n.xp6(1),n.hij(" Mana Cost: ",o.spell.currentManaCost," ")}}const cm=(r,l)=>({color:r,background:l});function jl(r,l){if(1&r&&(n.TgZ(0,"div",4),n._UZ(1,"mw-ra-icon",5),n.TgZ(2,"div",6)(3,"div"),n._uU(4),n.qZA(),n.TgZ(5,"div",7),n._uU(6),n.qZA(),n.YNc(7,xp,2,1,"div",8),n.qZA()(),n.TgZ(8,"div",9),n._UZ(9,"mw-spell-description",10),n.qZA()),2&r){const o=n.oxw();n.xp6(1),n.Q6J("icon",o.icon.icon)("ngStyle",n.WLB(9,cm,o.icon.iconClr,o.icon.bgClr)),n.xp6(3),n.Oqu(o.baseType.name),n.xp6(2),n.hij("Level ",o.spell.currentLevel,""),n.xp6(1),n.Q6J("ngIf",!o.isPassive),n.xp6(2),n.Q6J("spell",o.spell)("player",o.owner.ownerPlayer)("ownerUnit",o.owner)("hero",o.hero)}}const lm=r=>({disabled:r});let Pa=(()=>{class r{constructor(){this.onCooldown=!1,this.hintPos="above",this.disabled=!1,this.isPassive=!1}ngOnChanges(o){o.spell&&(this.isPassive=this.spell.isPassive(),this.baseType=this.spell.baseType,this.icon=this.baseType.icon)}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-unit-group-spell-icon"]],inputs:{onCooldown:"onCooldown",hintPos:"hintPos",owner:"owner",spell:"spell",hero:"hero",disabled:"disabled"},features:[n.TTD],decls:5,vars:10,consts:[[3,"hintBody","hintPos"],[3,"ngClass"],[1,"spell-icon",3,"icon","ngStyle"],["buffHint",""],[2,"display","flex"],[1,"hint-icon",3,"icon","ngStyle"],[2,"padding","4px","font-size","14px"],[2,"font-size","12px"],["style","font-size: 12px;",4,"ngIf"],[2,"padding","4px","font-size","13px","max-width","240px"],[3,"spell","player","ownerUnit","hero"]],template:function(a,u){if(1&a&&(n.TgZ(0,"mw-hover-hint",0)(1,"div",1),n._UZ(2,"mw-ra-icon",2),n.qZA()(),n.YNc(3,jl,10,12,"ng-template",null,3,n.W1O)),2&a){const h=n.MAs(4);n.Q6J("hintBody",h)("hintPos",u.hintPos),n.xp6(1),n.Q6J("ngClass",n.VKq(5,lm,u.onCooldown||u.disabled)),n.xp6(1),n.Q6J("icon",u.spell.baseType.icon.icon)("ngStyle",n.WLB(7,cm,u.spell.baseType.icon.iconClr,u.spell.baseType.icon.bgClr))}},styles:[".spell-icon[_ngcontent-%COMP%]{font-size:26px;margin:3px;display:block;height:30px;width:28px;text-align:center}.hint-icon[_ngcontent-%COMP%]{width:38px;height:38px;font-size:26px;text-align:center;padding-top:5px}.disabled[_ngcontent-%COMP%]{filter:brightness(.5)}"]})}return r})(),um=(()=>{class r extends mt{constructor(){super(...arguments),this.players=(0,n.f3M)(be),this.gameObjects=(0,n.f3M)(an)}swap(){Jg(this.data.sourceSlot,this.data.targetSlot),this.data.postAction(),this.close()}merge(){const o=this.players.getCurrentPlayer().hero;this.data.targetSlot.unitGroup.addUnitsCount(this.data.sourceSlot.unitGroup.count),this.gameObjects.destroyObject(this.data.sourceSlot.unitGroup),this.data.sourceSlot.unitGroup=null,o.removeUnitGroup(this.data.sourceSlot.unitGroup),this.data.postAction(),this.close()}static#e=this.\u0275fac=(()=>{let o;return function(u){return(o||(o=n.n5z(r)))(u||r)}})();static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-unit-slots-action-popup"]],features:[n.qOj],decls:14,vars:0,consts:[["popupHeader",""],["popupContent",""],["popupButtons",""],["mw-main-button","",3,"click"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0)(2,"div"),n._uU(3," These groups are of the same type "),n.qZA()(),n.TgZ(4,"div",1)(5,"div"),n._uU(6," What do you want to do? "),n.qZA()(),n.TgZ(7,"div",2)(8,"button",3),n.NdJ("click",function(){return u.merge()}),n._uU(9," Merge "),n.qZA(),n.TgZ(10,"button",3),n.NdJ("click",function(){return u.swap()}),n._uU(11," Swap "),n.qZA(),n.TgZ(12,"button",3),n.NdJ("click",function(){return u.popup.close()}),n._uU(13," Cancel "),n.qZA()()())},dependencies:[yt,Ot],encapsulation:2})}return r})();function jC(r,l){if(1&r&&(n.ynx(0),n._UZ(1,"div",4)(2,"div",5),n.BQk()),2&r){const o=n.oxw();n.xp6(1),n.Udp("width",o.currentValue/o.maxValue*100,"%")("height",o.barHeight,"px"),n.xp6(1),n.Udp("background",o.color)("width",o.currentValue/o.maxValue*100,"%")("height",o.barHeight,"px")}}function Aa(r,l){if(1&r&&(n.ynx(0),n._UZ(1,"div",6),n.BQk()),2&r){const o=n.oxw();n.xp6(1),n.Udp("background",o.color)("height",o.barHeight,"px")}}function $C(r,l){if(1&r&&(n.ynx(0),n._uU(1),n.BQk()),2&r){const o=n.oxw();n.xp6(1),n.hij("/",o.maxValue,"")}}let dm=(()=>{class r{constructor(o,a){this.host=o,this.renderer=a,this.maxValue=0,this.barStyle="normal",this.showMax=!1,this.currentValue=0,this.color="red",this.barHeight=3,this.side="right"}ngOnChanges(o){o.barHeight&&this.renderer.setStyle(this.host.nativeElement,"height",`${this.barHeight}px`)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.SBq),n.Y36(n.Qsj))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-value-bar"]],inputs:{maxValue:"maxValue",barStyle:"barStyle",showMax:"showMax",currentValue:"currentValue",color:"color",barHeight:"barHeight",side:"side"},features:[n.TTD],decls:6,vars:7,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"values"],[4,"ngIf"],[1,"diff-bar"],[1,"main-bar"],[1,"main-bar",2,"width","100%"]],template:function(a,u){1&a&&(n.ynx(0,0),n.YNc(1,jC,3,10,"ng-container",1)(2,Aa,2,4,"ng-container",1),n.BQk(),n.TgZ(3,"span",2),n._uU(4),n.YNc(5,$C,2,1,"ng-container",3),n.qZA()),2&a&&(n.Q6J("ngSwitch",u.barStyle),n.xp6(1),n.Q6J("ngSwitchCase","normal"),n.xp6(1),n.Q6J("ngSwitchCase","static"),n.xp6(1),n.ekj("left","left"===u.side),n.xp6(1),n.hij(" ",u.currentValue,""),n.xp6(1),n.Q6J("ngIf",u.showMax))},dependencies:[rt,uo,De],styles:["[_nghost-%COMP%]{position:relative;display:block;background:rgb(55,55,55);width:100%}.diff-bar[_ngcontent-%COMP%]{transition:1.1s;background:rgba(255,255,255,.615);position:absolute;transition-timing-function:ease-in-out}.main-bar[_ngcontent-%COMP%]{transition:.4s;position:absolute}.values[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(-50%,-2px);text-shadow:1px 2px black;font-size:11px;color:#fff}"],changeDetection:0})}return r})();const ZC=(()=>{function r(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return r.prototype=Object.create(Error.prototype),r})(),VC=new El.y(r=>r.complete());function Ip(r){return l=>0===r?function qC(r){return r?function zC(r){return new El.y(l=>r.schedule(()=>l.complete()))}(r):VC}():l.lift(new pm(r))}class pm{constructor(l){if(this.total=l,this.total<0)throw new ZC}call(l,o){return o.subscribe(new Ep(l,this.total))}}class Ep extends _n.L{constructor(l,o){super(l),this.total=o,this.count=0}_next(l){const o=this.total,a=++this.count;a<=o&&(this.destination.next(l),a===o&&(this.destination.complete(),this.unsubscribe()))}}const YC=["container"],$l=["iconSfx"],QC=["customizableVfx"],WC=["htmlSfx"];function JC(r,l){1&r&&n._UZ(0,"mw-ra-icon",6),2&r&&n.Q6J("icon",l.icon)}function KC(r,l){1&r&&(n._UZ(0,"div",7),n.ALo(1,"safeHtml")),2&r&&n.Q6J("innerHTML",n.lcZ(1,1,l.html),n.oJD)}function XC(r,l){1&r&&n.GkF(0)}const ew=r=>({part:r});function tw(r,l){if(1&r&&(n.ynx(0),n.YNc(1,XC,1,0,"ng-container",12),n.BQk()),2&r){const o=n.oxw().$implicit;n.oxw(2);const a=n.MAs(10);n.xp6(1),n.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",n.VKq(2,ew,o))}}function fm(r,l){if(1&r&&(n.TgZ(0,"div",10),n.YNc(1,tw,2,4,"ng-container",11),n.qZA()),2&r){const o=l.$implicit;n.Udp("color",o.color),n.Q6J("ngSwitch",o.type),n.xp6(1),n.Q6J("ngSwitchCase","plainPart")}}function hm(r,l){if(1&r&&(n.TgZ(0,"div",8),n.YNc(1,fm,2,4,"div",9),n.qZA()),2&r){const o=l.data;n.xp6(1),n.Q6J("ngForOf",o.parts)}}function nw(r,l){if(1&r&&(n._UZ(0,"mw-ra-icon",6)(1,"span",13),n.ALo(2,"safeHtml")),2&r){const o=l.part;n.Q6J("icon",o.icon),n.xp6(1),n.Q6J("innerHTML",n.lcZ(2,2,o.text),n.oJD)}}let Oa=(()=>{class r{constructor(o,a){this.renderer=o,this.hostElem=a,this.createdViews={},this.animationEnded=new n.vpe,this.created=new n.vpe}ngOnInit(){this.created.emit(this)}playAnimation(o,a={duration:1e3},u={}){"default"===o.config.layout&&this.renderer.addClass(this.hostElem.nativeElement,"default-layout");const h=[];return o.elements.forEach(m=>{let _=null;switch(m.type){case vo.Icon:_=this.viewContainerRef.createEmbeddedView(this.iconSfx,{icon:m.icon});break;case vo.Customizable:_=this.viewContainerRef.createEmbeddedView(this.customizableVfx,{data:u.custom});break;case vo.Html:_=this.viewContainerRef.createEmbeddedView(this.htmlSfx,{html:u.custom?.html})}this.createdViews[m.id]=_;const b=_.rootNodes[0];Object.entries(o.elemsDefaultStyles[m.id]).forEach(([A,ee])=>{this.renderer.setStyle(b,A,ee)}),a.skipDlClass||this.renderer.addClass(b,"dl-sfx");const T=b.animate(o.elemsKeyframes[m.id],{duration:a.duration??1e3,fill:a.type??"forwards",iterations:a.iterations??1});h.push(T)}),{elem:this,animationsList:h}}clearAnimation(){this.viewContainerRef.clear()}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.Qsj),n.Y36(n.SBq))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-vfx-element"]],viewQuery:function(a,u){if(1&a&&(n.Gf(YC,7,n.s_b),n.Gf($l,7),n.Gf(QC,7),n.Gf(WC,7)),2&a){let h;n.iGM(h=n.CRH())&&(u.viewContainerRef=h.first),n.iGM(h=n.CRH())&&(u.iconSfx=h.first),n.iGM(h=n.CRH())&&(u.customizableVfx=h.first),n.iGM(h=n.CRH())&&(u.htmlSfx=h.first)}},outputs:{animationEnded:"animationEnded",created:"created"},decls:11,vars:0,consts:[[1,"effect"],["container",""],["iconSfx",""],["htmlSfx",""],["customizableVfx",""],["plainDamagePart",""],[3,"icon"],[2,"text-shadow","1px 1px 2px #202020","color","white",3,"innerHTML"],[2,"text-shadow","1px 1px #4e4e4e","z-index","10000"],[3,"ngSwitch","color",4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"innerHTML"]],template:function(a,u){1&a&&(n.TgZ(0,"div",0),n.GkF(1,null,1),n.qZA(),n.YNc(3,JC,1,1,"ng-template",null,2,n.W1O)(5,KC,2,3,"ng-template",null,3,n.W1O)(7,hm,2,1,"ng-template",null,4,n.W1O)(9,nw,3,4,"ng-template",null,5,n.W1O))},dependencies:[Ie,$o,uo,De,lt,hr],styles:[".default-layout[_ngcontent-%COMP%] > .effect[_ngcontent-%COMP%]{pointer-events:none}.dl-sfx[_ngcontent-%COMP%]{position:absolute;transform:translate(-50%,-50%)}"]})}return r})();const Zl={darkOverlay:!0,duration:1e3};let yr=(()=>{class r{constructor(){this.latestVfxId=0,this.containersSet=new Map}registerLayerComponent(o){this.layerComponent=o}registerVfxContainer(o,a){this.containersSet.set(o,a)}unregisterVfxContainer(o){this.containersSet.delete(o)}getNewId(){return this.latestVfxId++}createXyVfx(o,a,u,h={}){this.layerComponent.createXyVfx(o,a,u,{...Zl,...h})}createVfxForUnitGroup(o,a,u={}){this.layerComponent.createVfxForUnitGroup(o,a,{...Zl,...u})}createEffectAnimationForUnitGroup(o,a,u={}){this.layerComponent.createVfxForUnitGroup(o,{type:_o.VfxElement,animation:a},{...Zl,...u})}createEffectAnimationForContainer(o,a,u={}){this.containersSet.get(o)?.addAnimation(a)}createFloatingMessageForUnitGroup(o,a,u={}){this.layerComponent.createFloatingMessageForUnitGroup(o,{custom:a},u)}createDroppingMessageForContainer(o,a,u={}){this.containersSet.get(o)?.addAnimation(Th,{skipDlClass:!0,...u},{custom:a})}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const Oi=["effectsContainer"],ka=["vfxElement"];function It(r,l){1&r&&n._UZ(0,"mw-vfx-element")}let so=(()=>{class r{constructor(o,a,u,h){this.vfxService=o,this.renderer=a,this.unitsCardsMapping=u,this.cdr=h,this.activeEffects=new Map,this.EffectTypes=_o,this.effectsWithOverlay=0}ngOnInit(){this.vfxService.registerLayerComponent(this)}createXyVfx(o,a,u,h){const m=this.createNewEffect({bottom:0,left:o,right:0,top:a},u);this.instantiateEffect(u,h,m)}createVfxForUnitGroup(o,a,u){const m=this.unitsCardsMapping.get(o).hostElem.nativeElement,{left:_,top:b}=m.getBoundingClientRect(),S=this.createNewEffect({bottom:0,left:_+m.clientWidth/2,right:0,top:b+m.clientHeight/2},a);this.instantiateEffect(a,u,S)}createFloatingMessageForUnitGroup(o,a,u={}){const m=this.unitsCardsMapping.get(o).hostElem.nativeElement,{left:_,top:b}=m.getBoundingClientRect(),S={type:_o.VfxElement,animation:Sh},T=this.createNewEffect({bottom:0,left:_+m.clientWidth/2,right:0,top:b+m.clientHeight/2},S);this.instantiateEffect(S,{darkOverlay:!1,duration:1e3,...u},T,a)}createNewEffect(o,a){return{id:this.vfxService.getNewId(),offset:o,vfx:a}}instantiateEffect(o,a,u,h={}){if(a.darkOverlay&&this.effectsWithOverlay++,this.activeEffects.set(u.id,u),o.type===_o.VfxElement){const m=o,_=this.effectsContainerRef.createComponent(Oa),b=_.instance;vp(b.playAnimation(m.animation,{duration:a.duration},h).animationsList.map(T=>Ii(T,"finish"))).pipe(Ip(1)).subscribe(()=>{this.activeEffects.delete(u.id),a.darkOverlay&&this.effectsWithOverlay--,_.destroy()}),this.updateEffectElementPosition(b.hostElem.nativeElement,u)}}updateEffectElementPosition(o,a){this.renderer.setStyle(o,"position","fixed"),this.renderer.setStyle(o,"left",`${a.offset.left}px`),this.renderer.setStyle(o,"top",`${a.offset.top}px`)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(yr),n.Y36(n.Qsj),n.Y36(_g),n.Y36(n.sBO))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-vfx-layer"]],viewQuery:function(a,u){if(1&a&&(n.Gf(Oi,7,n.s_b),n.Gf(ka,7)),2&a){let h;n.iGM(h=n.CRH())&&(u.effectsContainerRef=h.first),n.iGM(h=n.CRH())&&(u.vfxElementRef=h.first)}},decls:5,vars:2,consts:[[1,"basic-overlay"],["effectsContainer",""],["vfxElement",""]],template:function(a,u){1&a&&(n._UZ(0,"div",0),n.GkF(1,null,1),n.YNc(3,It,1,0,"ng-template",null,2,n.W1O)),2&a&&n.ekj("visible",u.effectsWithOverlay)},styles:["[_nghost-%COMP%]{position:fixed;pointer-events:none;inset:0}.vfx[_ngcontent-%COMP%]{position:fixed;pointer-events:none}.basic-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;opacity:0;background:rgba(0,0,0,.418);transition:.3s;pointer-events:none}.basic-overlay.visible[_ngcontent-%COMP%]{opacity:1}"]})}return r})();function Vl(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"mw-vfx-element",2),n.NdJ("created",function(u){const m=n.CHM(o).$implicit,_=n.oxw();return n.KtG(_.playAnimation(u,m))}),n.qZA()}}const zn=["*"];let Na=(()=>{class r{constructor(){this.vfxService=(0,n.f3M)(yr),this.animations=[]}ngOnInit(){this.vfxService.registerVfxContainer(this.containerId,this)}ngOnDestroy(){this.vfxService.unregisterVfxContainer(this.containerId)}playAnimation(o,a){vp(o.playAnimation(a.anim,a.options,a.data).animationsList.map(h=>Ii(h,"finish"))).pipe(Ip(1)).subscribe(()=>{Te.DN.removeItem(this.animations,a)})}addAnimation(o,a,u){this.animations.push({anim:o,options:a,data:u})}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-vfx-container"]],inputs:{containerId:"containerId"},ngContentSelectors:zn,decls:3,vars:1,consts:[[2,"position","absolute","z-index","200","left","50%","top","20%"],[3,"created",4,"ngFor","ngForOf"],[3,"created"]],template:function(a,u){1&a&&(n.F$t(),n.TgZ(0,"div",0),n.YNc(1,Vl,1,0,"mw-vfx-element",1),n.qZA(),n.Hsn(2)),2&a&&(n.xp6(1),n.Q6J("ngForOf",u.animations))},styles:["[_nghost-%COMP%]{display:block;position:relative}"]})}return r})(),vr=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-unit-group-preview"]],inputs:{unitType:"unitType",count:"count"},decls:4,vars:3,consts:[[2,"display","flex","flex-direction","column"],[3,"src"]],template:function(a,u){1&a&&(n.TgZ(0,"div",0),n._UZ(1,"img",1),n.TgZ(2,"div"),n._uU(3),n.qZA()()),2&a&&(n.xp6(1),n.MGl("src","../assets/",u.unitType.mainPortraitUrl,"",n.LSH),n.xp6(2),n.AsE(" ",u.unitType.name," (",u.count,") "))},encapsulation:2,changeDetection:0})}return r})(),ao=(()=>{class r extends(bt()){constructor(o,a,u,h,m,_,b,S){super(),this.battleState=o,this.actionHint=a,this.players=u,this.unitState=h,this.units=m,this.history=_,this.state=b,this.vfx=S}onBattleBegins(){this.initPlayersSpells()}dealDamageTo(o,a,u=At.PhysicalAttack,h,m={}){let _=a,b=0,S=0,T=0,A=!1;if(u===At.PhysicalAttack){if(m.attackerUnit){console.log("attacker?",m.attackerUnit);const de={attacked:o,attacker:m.attackerUnit},je=m.attackerUnit.modGroup,Qe=je.getAllModValues("__attackConditionalModifiers").map(En=>En(de)),yn=je.getAllModValues("__unitConditionalMods").map(En=>En(m.attackerUnit)),xn=o.modGroup.getAllModValues("__attackConditionalModifiers").map(En=>En(de)),In=ot.lX.withRefs([...Qe.map(ot.Cc.fromMods),...yn.filter(os.Rt).map(ot.Cc.fromMods),...je.getAllRefs()]),Ri=In.getModValue("criticalDamageChance");Ri&&Te.DN.chanceRoll(Ri)&&(A=!0,_+=_*(In.getModValue("criticalDamageMul")||0));const ci=ot.lX.withRefs(xn.map(ot.Cc.fromMods)),du=ci.getModValue("chanceToBlock"),Ho=ci.getModValue("damageBlockMin"),my=ci.getModValue("damageBlockMax");if(du){const En=Te.DN.chanceRoll(du);if(console.log("blocking -> chance to block",du,En),En){const pu=Te.DN.randIntInRange(Ho,my),Ss=Te.DN.maxPercent(je.getModValue("blockPiercingPercent")||0);b=Math.round(pu-pu*Ss)}}const yy=In.getModValue("baseDamagePercentModifier")||0,zp=In.getModValue("lifesteal")||0;console.log(`damage reduced by ${yy}%`),_=Te.DN.nonNegative(Math.round(_+_*yy)-b);const Yp=In.getModValue("retaliationDamagePercent");m.isCounterattack&&Yp&&(_*=Yp),zp&&(S=Math.round(_*(zp/100)),console.log("Lifesteal: ",S))}}else if(Cg[u]){_+=a*(o.modGroup.getModValue("amplifiedTakenMagicDamagePercent")||0),_=Math.round(_);let Qe=o.getStats()[Cg[u]];Qe>60&&(Qe=60),console.log(a,u,"resist:",Qe),_-=_*(Qe/100)}const ee=o.count;if(_=Math.round(_),S&&m.attackerUnit){const de=this.units.healUnit(m.attackerUnit,S);T=de.revivedUnitsCount,this.events.dispatch(Ec({healedUnitsCount:de.revivedUnitsCount,target:m.attackerUnit}))}const X=this.unitState.dealPureDamageToUnitGroup(o,_);return X.finalUnitLoss&&this.events.dispatch(ph({unit:o,loss:X.finalUnitLoss})),h&&h({unitLoss:X.finalUnitLoss,finalDamage:X.finalDamage,initialUnitCount:ee}),u===At.PhysicalAttack||(X.isDamageFatal&&(this.battleState.handleDefeatedUnitGroup(o),this.events.dispatch(Rr({target:o,targetPlayer:o.ownerPlayer,loss:X.finalUnitLoss}))),X.finalUnitLoss&&this.events.dispatch($s({unitLoss:X.finalUnitLoss,group:o}))),{...X,blockedDamage:b,stolenLife:S,stolenLifeUnitsRestored:T,isCritical:A}}handleAttackInteraction(o){const{attackingGroup:a,attackedGroup:u,action:h}=o,m=h===Ln.GroupCounterattacks,_=m?u:a,b=m?a:u;this.triggerEventForAllSpellsHandler(ca.UnitGroupAttacks({attacked:b,attacker:_}));const S=this.unitState.getDetailedAttackInfo(_,b),T=this.unitState.getFinalDamageInfoFromDamageDetailedInfo(S),A=this.dealDamageTo(b,T.finalDamage,At.PhysicalAttack,void 0,{attackerUnit:_,isCounterattack:m});return m&&(this.vfx.createDroppingMessageForContainer(b.id,{html:Wi(`\n          <div style="font-size: 14px">Retaliated! ${Vr({icon:"skull"})} ${A.finalUnitLoss}</div>\n        `,{width:130})},{duration:1500}),this.history.logHtmlMessage((({attacker:r,attacked:l,originalNumber:o,damage:a,unitLoss:u})=>`${Ah(r)} retaliated! Dealing ${a} damage to ${Ah(l,o)}, ${u} units perish.`)({attacked:b,attacker:_,damage:A.finalDamage,originalNumber:S.originalAttackersCount,unitLoss:A.finalUnitLoss}))),m?this.events.dispatch(xc({attackingGroup:_,attackedGroup:b,loss:A.finalUnitLoss,damage:A.finalDamage})):(this.battleState.currentGroupTurnsLeft--,_.turnsLeft=this.battleState.currentGroupTurnsLeft,this.events.dispatch(Wo({attackingGroup:_,attackedGroup:b,attackedCount:S.originalAttackedCount,attackersCount:S.originalAttackersCount,loss:A.finalUnitLoss,damage:A.finalDamage,damageBlocked:A.blockedDamage,lifeStolen:A.stolenLife,lifeStolenUnitsRestored:A.stolenLifeUnitsRestored,isCritical:A.isCritical}))),A.isDamageFatal?(this.battleState.handleDefeatedUnitGroup(b),this.events.dispatch(Rr({target:b,targetPlayer:b.ownerPlayer,loss:A.finalUnitLoss})),o.action=Ln.AttackInteractionCompleted,void this.events.dispatch(Qo(o))):m?(m&&(o.action=Ln.AttackInteractionCompleted),void this.events.dispatch(Qo(o))):(o.action=S.enemyCanCounterattack?Ln.GroupCounterattacks:Ln.AttackInteractionCompleted,void this.events.dispatch(Qo(o)))}setDamageHintMessageOnCardHover(o){const a=this.getTargetAttackActionInfo(o.hoveredCard);this.actionHint.hintMessage$.next(a)}getTargetAttackActionInfo(o){const u=this.unitState.getDetailedAttackInfo(this.battleState.currentUnitGroup,o);return{type:x.wX.OnHoverEnemyCard,attackedGroup:u.attacked,minDamage:u.multipliedMinDamage,maxDamage:u.multipliedMaxDamage,noDamageSpread:u.multipliedMinDamage===u.multipliedMaxDamage,minCountLoss:u.minUnitCountLoss,maxCountLoss:u.maxUnitCountLoss,noLossSpread:u.minUnitCountLoss===u.maxUnitCountLoss,attackSuperiority:u.attackSuperiority}}forEachUnitGroup(o){this.battleState.heroesUnitGroupsMap.forEach((a,u)=>{a.forEach(h=>{o(h,u)})})}applyDispellToUnitGroup(o){const a=[se.Buff,se.Debuff];o.spells.forEach(u=>{a.includes(u.baseType.activationType)&&this.removeSpellFromUnitGroup(o,u)}),this.units.clearUnitModifiers(o)}triggerEventForAllSpellsHandler(o){this.state.eventHandlers.spells.triggerAllHandlersByEvent(o)}triggerEventForSpellHandler(o,a){this.state.eventHandlers.spells.triggerRefEventHandlers(o,a)}initAllUnitGroupSpells(){this.forEachUnitGroup((o,a)=>{o.spells&&o.spells.forEach(u=>this.initSpell(u,a,o))})}resetAllUnitGroupsCooldowns(){this.forEachUnitGroup(o=>o.fightInfo.spellsOnCooldown=!1)}getRandomEnemyUnitGroup(){const o=this.players.getEnemyPlayer(),a=this.battleState.heroesUnitGroupsMap.get(o);return Te.DN.randItem(a.filter(u=>u.fightInfo.isAlive))}addSpellToUnitGroup(o,a,u){o.addSpell(a),this.events.dispatch(Un({unitGroup:o})),this.initSpell(a,u),this.triggerEventForSpellHandler(a,ca.SpellPlacedOnUnitGroup({target:o}))}removeSpellFromUnitGroup(o,a){o.removeSpell(a),this.state.eventHandlers.spells.removeAllHandlersForRef(a),this.events.dispatch(Un({unitGroup:o}))}initSpell(o,a,u){this.events.dispatch(mh({spell:o,player:a,ownerUnit:u}))}initPlayersSpells(){[this.players.getCurrentPlayer(),this.players.getEnemyPlayer()].forEach(o=>{o.hero.spells.forEach(a=>{this.initSpell(a,o)})})}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(to),n.LFG(no),n.LFG(be),n.LFG(Pp),n.LFG(Dn),n.LFG(Ca),n.LFG(ft),n.LFG(yr))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var ii=function(r){return r.Player="Player",r.AI="AI",r}(ii||{}),Ye=function(r){return r.Normal="normal",r.SpellTargeting="spell-targeting",r.WaitsForTurn="waits-for-turn",r}(Ye||{});let ki=(()=>{class r extends ir.l{constructor(){super(...arguments),this.garrisons=new Map,this.actionCards=[]}static#e=this.categoryId="player";create({color:o,hero:a,resources:u,type:h}){this.color=o,this.resources=u,this.type=h,this.hero=a,this.hero.assignOwnerPlayer(this),this.hero.updateUnitsSpecialtyAndConditionalMods()}addActionCards(o,a){const u=this.actionCards.find(h=>h.card===o);u?u.count+=a:this.actionCards.push({card:o,count:a})}}return r})();const ps=ve({id:"#spell-null",activationType:se.Instant,name:"",icon:{icon:""},getDescription:r=>({descriptions:[]}),config:{spellConfig:{getManaCost:r=>0,init:()=>{}}}});class Ut extends(bt()){constructor(l,o){super(),this.players=l,this.gameObjectsManager=o,this.NULL_SPELL_INSTANCE=this.gameObjectsManager.createNewGameObject(qc,{initialLevel:0,spellBaseType:ps,state:{}},"null-spell"),this.currentSpell=this.NULL_SPELL_INSTANCE,this.playerCurrentState=Ye.Normal,this.playerStateChanged$=new xo.X(Ye.Normal),this.spellsAreOnCooldown=!1}playersInit(){this.currentPlayer=this.players.getCurrentPlayer()}resetSpellsCooldowns(){this.spellsAreOnCooldown=!1}setSpellsOnCooldown(){this.currentCasterUnit?(this.currentCasterUnit.fightInfo.spellsOnCooldown=!0,this.currentCasterUnit=void 0):this.spellsAreOnCooldown=!0}onSpellClick(l,o){switch(this.currentSpell=l,this.currentCasterUnit=o,l.baseType.activationType){case"instant":this.onCurrentSpellCast(),this.events.dispatch(Xu({player:this.currentPlayer,spell:l})),this.setSpellsOnCooldown();break;case"target":this.setPlayerState(Ye.SpellTargeting)}}isSpellBeingCasted(){return this.currentSpell!==this.NULL_SPELL_INSTANCE}resetCurrentSpell(){this.currentSpell=this.NULL_SPELL_INSTANCE}cancelCurrentSpell(){this.resetCurrentSpell(),this.setPlayerState(Ye.Normal),this.currentCasterUnit=void 0}onCurrentSpellCast(){this.currentPlayer.hero.addMana(-this.currentSpell.currentManaCost)}setPlayerState(l){this.playerCurrentState=l,this.playerStateChanged$.next(l)}static#e=this.\u0275fac=function(o){return new(o||Ut)(n.LFG(be),n.LFG(an))};static#t=this.\u0275prov=n.Yz7({token:Ut,factory:Ut.\u0275fac,providedIn:"root"})}Z([Ee(Ur)],Ut.prototype,"playersInit",null);const fs=(r=>{const{id:l,abilities:o,army:a,items:u,name:h,resources:m,stats:_,generalDescription:b,image:S}=r,T={id:l,name:h,generalDescription:b,initialState:{abilities:o,army:a,items:u,resources:m,stats:_},image:S??ce._T.HeroMage};return(0,pt.uB)(T),T})({id:"#hero-non-player-neutral",name:"neutral-hero",generalDescription:(0,x.Ym)(""),abilities:[],army:[],items:[],resources:{gems:0,gold:0,redCrystals:0,wood:0},stats:{mana:0,baseAttack:0,baseDefence:0}});let No=(()=>{class r{constructor(o,a){this.gameObjectsManager=o,this.unitGroups=a}addManaToHero(o,a){o.addMana(a)}addSpellToHero(o,a){o.spells.push(a)}createHero(o){return this.gameObjectsManager.createNewGameObject(UC,{heroBase:o,unitGroups:o.initialState.army.length?this.unitGroups.createUnitGroupFromGenModel(o.initialState.army[0]):[]})}createNeutralHero(){return this.createHero(fs)}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(an),n.LFG(Dn))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),hs=(()=>{class r{constructor(o,a,u){this.events=o,this.state=a,this.gameObjectsManager=u}createItem(o){const a=o.icon;return a.bgClr||(a.bgClr=ce.wL.DefaultItemIconBg),a.iconClr||(a.iconClr=ce.wL.DefaultItemIconClr),this.gameObjectsManager.createNewGameObject(xe.c,{itemBase:o,state:o.defaultState})}registerItemsEventHandlers(o,a){this.events.dispatch(yh({item:o,ownerPlayer:a}))}triggerEventForAllItemsHandlers(o){this.state.eventHandlers.items.triggerAllHandlersByEvent(o)}triggerEventForItemHandlers(o,a){this.state.eventHandlers.items.triggerRefEventHandlers(o,a)}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(Ze),n.LFG(ft),n.LFG(an))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var Fo=function(r){return r.Main="main",r.Neutral="neutral",r}(Fo||{});let be=(()=>{class r extends(bt()){get playersMap(){return this.state.gameState.playersMap}constructor(o,a,u,h){super(),this.heroesService=o,this.unitGroups=a,this.state=u,this.gameObjectsManager=h,this.currentPlayerId=this.gameObjectsManager.getObjectId(ki,Fo.Main)}createPlayer(o,a){return this.gameObjectsManager.createNewGameObject(ki,a,o)}getCurrentPlayer(){return this.playersMap.get(this.currentPlayerId)}addResourceToPlayer(o,a,u){o.resources[a]+=u}addResourcesToPlayer(o,a){Object.entries(a).forEach(([u,h])=>o.resources[u]+=h)}removeResourcesFromPlayer(o,a){Object.entries(a).forEach(([u,h])=>o.resources[u]-=h)}playerHasResources(o,a){const u=o.resources;return Object.entries(a).every(([h,m])=>u[h]>=m)}getMissingResources(o,a){const u=o.resources;return Object.entries(a).reduce((h,[m,_])=>{const b=u[m]-_;return b<0&&(h[m]=Math.abs(b)),h},{})}getCurrentPlayerId(){return this.currentPlayerId}isEnemyUnitGroup(o){return this.getUnitGroupsOfPlayer(this.getEnemyPlayer().id).includes(o)}getPlayerUnitsCountOfType(o,a){return o.hero.unitGroups.reduce((u,h)=>u+(h.type.id===a?h.count:0),0)}addExperienceToPlayer(o,a){const h=this.getPlayerById(o).hero;h.experience+=a;const m=Ul[h.level+1];m<=h.experience&&(h.level++,h.freeSkillpoints++,h.experience=h.experience-m,this.events.dispatch(rd({newLevel:h.level,hero:h})))}getPlayerById(o){return this.playersMap.get(this.gameObjectsManager.getObjectId(ki,o))}getNeutralPlayer(){return this.playersMap.get(this.gameObjectsManager.getObjectId(ki,Fo.Neutral))}getEnemyPlayer(){return this.getNeutralPlayer()}getUnitGroupsOfPlayer(o){return this.playersMap.get(this.gameObjectsManager.getObjectId(ki,o)).hero.unitGroups}addUnitGroupToTypeStack(o,a){const u=o.hero.unitGroups.find(h=>h.type===a.type);u?u.addUnitsCount(a.count):o.hero.addUnitGroup(a)}removeNUnitsFromGroup(o,a,u){if(a.addUnitsCount(-u),a.count<=0){o.hero.removeUnitGroup(a),this.gameObjectsManager.destroyObject(a);const h=a.ownerHero.getAllSlots().find(m=>m.unitGroup===a);h&&(h.unitGroup=null)}}removeUnitTypeCountFromPlayer(o,a,u){const h=o.hero.getAllUnitsFromSlots().filter(T=>T.type.id===a),m=h.reduce((T,A)=>A.count+T,0),_=m<u?m:u;let b=_,S=0;for(;b>0;){const T=h[S++],A=T.count,ee=b>A?A:b;this.removeNUnitsFromGroup(o,T,ee),b-=ee}return _}addManaToPlayer(o,a){o.hero.addMana(a)}addItemToPlayer(o,a){this.events.dispatch(er({player:o,item:a}))}removeItemFromPlayer(o,a){this.events.dispatch(dt({player:o,item:a}))}createPlayerWithHero(o,a,u){return{color:o,hero:this.heroesService.createHero(a),resources:a.initialState.resources,type:u}}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(No),n.LFG(Dn),n.LFG(ft),n.LFG(an))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),gm=(()=>{class r{constructor(o){this.playersService=o}getPlayerInfo(){return this.playersService.getEnemyPlayer()}getUnitGroups(){return this.playersService.getUnitGroupsOfPlayer(Fo.Neutral)}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(be))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),mm=(()=>{class r{constructor(o){this.playersService=o}getPlayerInfo(){return this.playersService.getCurrentPlayer()}getUnitGroups(){return this.playersService.getUnitGroupsOfPlayer(Fo.Main)}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(be))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),_r=(()=>{class r{constructor(o,a,u,h){this.playersService=o,this.unitGroups=a,this.gameObjectsManager=u,this.events=h,this.initialStructs=[],this.availableStructuresMap={}}initStructures(o){this.neutralPlayer=this.playersService.getNeutralPlayer(),this.initialStructs=o.map.structures,this.startingLocationId=o.map.startingLocId,this.playerCurrentLocId=this.gameObjectsManager.getObjectId(es,this.startingLocationId),this.viewStructures=this.createViewStructures(this.initialStructs),this.updateParentLinks(),this.updateAvailableStructures()}updateParentLinks(){this.viewStructures.forEach(o=>{this.viewStructures.filter(u=>o.pathTo===u.id).forEach(u=>o.parentStructs.add(u.id))})}updateAvailableStructures(){Object.keys(this.availableStructuresMap).forEach(o=>{this.viewStructures.filter(u=>[...u.parentStructs].find(h=>this.gameObjectsManager.getObjectByFullId(this.gameObjectsManager.getObjectId(es,h))?.visited)&&u.parentStructs.has(o)).forEach(u=>this.availableStructuresMap[u.id]=!0)})}createViewStructures(o){const a=o.map(u=>this.gameObjectsManager.createNewGameObject(es,{iconName:u.icon,x:u.x,y:u.y,generator:u.struct,guardingPlayer:void 0,isRoot:u.id===this.startingLocationId,pathTo:u.pathTo?this.gameObjectsManager.getObjectId(es,u.pathTo):void 0,actionPoints:u.actionPoints,structParams:u.structParams},u.id));return a.map(u=>{this.events.dispatch(_h({structure:u}));const h=u.pathTo;if(u.isRoot&&(u.isRoot=!0,u.visited=!0,this.availableStructuresMap[u.id]=!0),h){const m=a.find(Qe=>Qe.id===u.pathTo);u.pathTo=h;const{x:_,y:b}=u,S=Math.min(_,m.x),T=Math.min(b,m.y),A=Math.max(_,m.x),X=Math.max(b,m.y)-T,de=A-S;u.svg={x:S,y:T,height:X,width:de,ox:m.x>_?de:0,oy:m.y>b?X:0,tx:_<m.x?0:de,ty:b<m.y?0:X};const je=u.generator;je?.generateGuard&&(u.guard=this.unitGroups.createUnitGroupFromGenModel(je.generateGuard({thisStruct:u})),u.guard.forEach(Qe=>Qe.assignOwnerPlayer(this.playersService.getNeutralPlayer())),u.guardingPlayer=this.playersService.getNeutralPlayer()),je?.generateReward&&(u.reward=je.generateReward())}return u})}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(be),n.LFG(Dn),n.LFG(an),n.LFG(Ze))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Pp=(()=>{class r{constructor(o){this.units=o}getTailUnitHealth(o){const{tailUnitHp:a}=o;return 0===a?0:void 0===a?o.type.baseStats.health:a}getUnitGroupTotalHp(o){return(o.count-1)*o.type.baseStats.health+this.getTailUnitHealth(o)}getUnitGroupDamage(o,a=0){const h=o.type.baseStats.damageInfo,_=h.minDamage*o.count,b=h.maxDamage*o.count,S=a*(a>=0?.05:.035),A=b+b*S;return{attacker:o,attackingUnitsCount:o.count,minDamage:_,maxDamage:b,attackSuperiority:a,damageMultiplier:S,multipliedMinDamage:Math.round(_+_*S),multipliedMaxDamage:Math.round(A)}}getDetailedAttackInfo(o,a){const h=a.type.baseStats,m=o.getStats(),_=a.getStats(),A=this.getUnitGroupDamage(o,m.finalAttack-_.finalDefence),ee=this.calcUnitCountLoss(A.multipliedMinDamage,h.health,a.count),X=this.calcUnitCountLoss(A.multipliedMaxDamage,h.health,a.count),de=this.canGroupCounterattack(a);return{...A,attacked:a,originalAttackedCount:a.count,originalAttackersCount:o.count,enemyCanCounterattack:de,minUnitCountLoss:ee,maxUnitCountLoss:X}}getFinalDamageInfoFromDamageDetailedInfo(o){const a=Te.DN.randIntInRange(o.multipliedMinDamage,o.multipliedMaxDamage);return this.getFinalDamageInfo(o.attacked,a)}getFinalDamageInfo(o,a){const h=o.type.baseStats,m=o.count,_=this.getUnitGroupTotalHp(o),b=_-a,T=b%h.health,A=a>=_?0:0===T?h.health:T,X=m-Math.ceil(b/h.health);return{finalDamage:a,finalUnitLoss:X>o.count?o.count:X,finalTotalUnitLoss:X,tailHpLeft:A,isDamageFatal:a>=_}}dealPureDamageToUnitGroup(o,a){const u=this.getFinalDamageInfo(o,a);return o.addUnitsCount(-u.finalTotalUnitLoss),o.setTailUnitHp(u.tailHpLeft),u}calcUnitCountLoss(o,a,u){const h=Math.floor(o/a);return h>u?u:h}canGroupCounterattack(o){return!!o.type.defaultModifiers?.counterattacks}isUnitGroupRanged(o){return!!o.type.defaultModifiers?.isRanged}rollDamage(o){return Te.DN.randIntInRange(o.multipliedMinDamage,o.multipliedMaxDamage)}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(Dn))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Cr=(()=>{class r{constructor(o,a,u,h,m,_,b,S){this.playersService=o,this.heroes=a,this.unitGroups=u,this.players=h,this.spells=m,this.events=_,this.state=b,this.structures=S}getPlayerApi(){return{removeUnitTypeFromPlayer:(o,a,u)=>this.players.removeUnitTypeCountFromPlayer(o,a,u),playerHasResources:(o,a)=>this.players.playerHasResources(o,a),removeResourcesFromPlayer:(o,a)=>this.players.removeResourcesFromPlayer(o,a),addExperienceToPlayer:(o,a)=>{this.players.addExperienceToPlayer(o.id,a)},addUnitGroupToPlayer:(o,a,u)=>{const h=this.unitGroups.createUnitGroup(a,{count:u},o.hero);this.players.addUnitGroupToTypeStack(o,h)},addManaToPlayer:(o,a)=>{this.heroes.addManaToHero(o.hero,a)},addMaxManaToPlayer:(o,a)=>{o.hero.addStatsMods({heroMaxMana:a})},giveResourceToPlayer:(o,a,u)=>this.playersService.addResourceToPlayer(o,a,u),addSpellToPlayerHero:(o,a)=>{this.heroes.addSpellToHero(o.hero,a)},getCurrentPlayer:()=>this.playersService.getCurrentPlayer(),getCurrentPlayerUnitGroups:()=>this.playersService.getUnitGroupsOfPlayer(this.playersService.getCurrentPlayer().id),giveResourcesToPlayer:(o,a)=>this.playersService.addResourcesToPlayer(o,a)}}getSpellsApi(){return{createSpellInstance:(o,a)=>this.spells.createSpellInstance(o,a)}}getGameApi(){return{events:{dispatch:o=>{this.events.dispatch(o)}},players:this.getPlayerApi(),actions:{getMapStructures:()=>this.structures.viewStructures,getActionPointsLeft:()=>this.state.currentGame.actionPoints,scheduleAction:(o,a)=>{this.events.dispatch(Lc({action:o,dayOffset:a}))}}}}getGlobalEventsApi(){return{dispatch:o=>this.events.dispatch(o)}}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(be),n.LFG(No),n.LFG(Dn),n.LFG(be),n.LFG(wa),n.LFG(Ze),n.LFG(ft),n.LFG(_r))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),ql=(()=>{class r extends(bt()){constructor(o){super(),this.apiProvider=o,this.initTriggersFromTriggersRegistry()}initTriggersFromTriggersRegistry(){ns.registryMap.forEach((o,a)=>{o.forEach(u=>{this.events.onEvent(a).subscribe(h=>{u.fn(h,this.apiProvider.getGameApi())})})})}static#e=this.\u0275fac=function(a){return new(a||r)(n.LFG(Cr))};static#t=this.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();class jt extends(bt()){constructor(l){super(),this.battleLog=l}clearLogOnFightStart(){this.battleLog.history=[]}logGroupDamagedByGroup({attackingGroup:l,attackedGroup:o,damage:a,loss:u,attackedCount:h,attackersCount:m,damageBlocked:_,lifeStolen:b,lifeStolenUnitsRestored:S,isCritical:T}){this.battleLog.logDealtDamageMessage({attacked:o.type,attackedPlayer:o.ownerPlayer,attackersNumber:m,attackedNumber:h,attacker:l.type,attackingPlayer:l.ownerPlayer,damage:a,damageBlocked:_,losses:u,stolenLife:b,stolenLifeUnitsRestored:S,isCritical:T})}logPlayerStartsTurn(l){this.battleLog.logRoundInfoMessage(`Player ${l.currentPlayer.type} starts his turn`)}logFightEnds(l){this.battleLog.logRoundInfoMessage(l.win?"Win!":"Defeat")}logNextRoundStarts(l){this.battleLog.logRoundInfoMessage(`Round ${l.round} starts`)}static#e=this.\u0275fac=function(o){return new(o||jt)(n.LFG(Ca))};static#t=this.\u0275prov=n.Yz7({token:jt,factory:jt.\u0275fac})}Z([Ee(go)],jt.prototype,"clearLogOnFightStart",null),Z([re(Wo)],jt.prototype,"logGroupDamagedByGroup",null),Z([re(mi)],jt.prototype,"logPlayerStartsTurn",null),Z([re(Vi)],jt.prototype,"logFightEnds",null),Z([re(Ko)],jt.prototype,"logNextRoundStarts",null);class kt extends(bt()){constructor(l,o,a,u,h,m,_,b){super(),this.battleState=l,this.curPlayerState=o,this.strucuresService=a,this.playersService=u,this.vfx=h,this.state=m,this.historyLog=_,this.gameObjectsManager=b}beforeBattleInit(){this.applyStaticModsFromEquippedItems()}prepareFightState(){this.battleState.resetCurrentPlayer(),this.battleState.initNextTurnByQueue()}defendAction(){const l=this.battleState.currentUnitGroup;l.addCombatMods({fixedSpeed:5,heroBonusDefence:5,defending:!0}),this.battleState.resortFightQueue(!0),this.vfx.createDroppingMessageForContainer(l.id,{html:Wi("Defending!",{width:80})},{duration:1e3}),this.historyLog.logSimpleMessage(`${l.count} ${l.type.name} choose to defend. Their speed is fixed to 5, and armor is increased by 5.`),this.battleState.initNextTurnByQueue()}recalcTurnQueue(){this.battleState.initNextTurnByQueue()}updatePlayerState({currentPlayer:l}){l.type===ii.AI?(this.curPlayerState.setPlayerState(Ye.WaitsForTurn),this.battleState.processAiPlayer()):this.curPlayerState.setPlayerState(Ye.Normal)}updateQueueOnGroupTurnEnd(){this.battleState.initNextTurnByQueue(!0)}registerHealedUnits(l){l.healedUnitsCount&&this.battleState.registerPlayerUnitLoss(l.target,-l.healedUnitsCount)}registerUnitLossOnAnyOtherDamageSources({loss:l,unit:o}){this.battleState.registerPlayerUnitLoss(o,l)}checkIfFightEndedOnUnitGroupDeath(){const l=this.strucuresService.currentStruct,o=this.playersService.getCurrentPlayer(),a=this.battleState.getAliveUnitsOfPlayer(o);if(!a.length)return this.playersService.getCurrentPlayer().hero.setUnitGroups(a),void this.events.dispatch(Vi({struct:l,win:!1}));const u=this.battleState.getEnemyOfPlayer(o);if(!this.battleState.getAliveUnitsOfPlayer(u).length){const h=this.battleState.getDeadUnitsOfPlayer(o),m=this.battleState.getSummonsOfPlayer(o);[...h,...this.battleState.getDeadUnitsOfPlayer(u),...m].forEach(T=>{this.gameObjectsManager.destroyObject(T)});const b=a.filter(T=>!T.modGroup.getModValue("isSummon")),S=this.playersService.getCurrentPlayer().hero;return S.unitGroups.filter(T=>!T.fightInfo.isAlive).forEach(T=>{const A=S.getAllSlots().find(ee=>ee.unitGroup===T);A&&(A.unitGroup=null)}),S.setUnitGroups(b,!1),l.isInactive=!0,void this.events.dispatch(Vi({struct:l,win:!0}))}}processAiPlayer(){this.battleState.currentPlayer.type===ii.AI&&this.enemyHasAnyLivingUnits()&&this.battleState.processAiPlayer()}checkControlWhenGroupRunsOutOfTurns({groupHasMoreTurns:l,groupPlayer:o,groupStillAlive:a}){o.type===ii.AI&&l&&a&&this.enemyHasAnyLivingUnits()&&this.battleState.processAiPlayer(),(!l||!a)&&this.events.dispatch(td({playerEndsTurn:o}))}updateFightQueryDueToSpeedChange(){this.battleState.resortFightQueue()}cleanUpHandlersOnFightEnd(){this.cleanupStaticModsFromEquippedItems(),this.events.dispatch(mo())}cleanUpHandlers(){this.state.eventHandlers.spells.removeAllHandlers()}enemyHasAnyLivingUnits(){return this.battleState.playerHasAnyAliveUnits(this.battleState.getEnemyOfPlayer(this.battleState.currentPlayer))}applyStaticModsFromEquippedItems(){this.playersService.getCurrentPlayer().hero.inventory.getEquippedItems().forEach(l=>{console.log(l);const o=l.baseType.staticEnemyMods;o&&this.playersService.getEnemyPlayer().hero.addCommonCombatMods(ot.Cc.fromMods(o))})}cleanupStaticModsFromEquippedItems(){this.playersService.getCurrentPlayer().hero.clearCommonCombatMods(),this.playersService.getEnemyPlayer().hero.clearCommonCombatMods()}static#e=this.\u0275fac=function(o){return new(o||kt)(n.LFG(to),n.LFG(Ut),n.LFG(_r),n.LFG(be),n.LFG(yr),n.LFG(ft),n.LFG(Ca),n.LFG(an))};static#t=this.\u0275prov=n.Yz7({token:kt,factory:kt.\u0275fac})}Z([Ee(od)],kt.prototype,"beforeBattleInit",null),Z([Ee(go)],kt.prototype,"prepareFightState",null),Z([Ee(Zs)],kt.prototype,"defendAction",null),Z([Ee(Ko)],kt.prototype,"recalcTurnQueue",null),Z([re(mi)],kt.prototype,"updatePlayerState",null),Z([Ee(td)],kt.prototype,"updateQueueOnGroupTurnEnd",null),Z([re(Ec)],kt.prototype,"registerHealedUnits",null),Z([re(ph)],kt.prototype,"registerUnitLossOnAnyOtherDamageSources",null),Z([Ee(Rr)],kt.prototype,"checkIfFightEndedOnUnitGroupDeath",null),Z([Ee(Jo)],kt.prototype,"processAiPlayer",null),Z([re(Ic)],kt.prototype,"checkControlWhenGroupRunsOutOfTurns",null),Z([Ee(Nr)],kt.prototype,"updateFightQueryDueToSpeedChange",null),Z([Ee(Vi)],kt.prototype,"cleanUpHandlersOnFightEnd",null),Z([Ee(mo)],kt.prototype,"cleanUpHandlers",null);class Tn extends(bt()){constructor(l){super(),this.combatInteractor=l}dispellAllUnitsOnStructCompleted(){this.combatInteractor.forEachUnitGroup(l=>this.combatInteractor.applyDispellToUnitGroup(l))}prepareSpellsOnFightStart(){this.combatInteractor.initAllUnitGroupSpells(),this.combatInteractor.resetAllUnitGroupsCooldowns()}startCombatInteraction(l){this.events.dispatch(Qo({action:Ln.GroupAttacks,attackedGroup:l.attackedGroup,attackingGroup:l.attackingGroup}))}processCombatInteraction(l){switch(l.action){case Ln.GroupAttacks:case Ln.GroupCounterattacks:this.combatInteractor.handleAttackInteraction(l);break;case Ln.AttackInteractionCompleted:const o=l.attackingGroup;this.events.dispatch(Ic({group:o,groupPlayer:o.ownerPlayer,groupStillAlive:!!o.count,groupHasMoreTurns:!!o.turnsLeft}))}}resetCooldownsAndEmitNewRoundEventToSpells(l){this.combatInteractor.triggerEventForAllSpellsHandler(ca.NewRoundBegins({round:l.round})),this.combatInteractor.resetAllUnitGroupsCooldowns()}dispelUnitOnDeath(l){this.combatInteractor.applyDispellToUnitGroup(l.target)}addCombatModsToUnit({mods:l,unit:o}){o.addCombatMods(l)}removeCombatModsToUnit({mods:l,unit:o}){o.removeCombatMods(l)}static#e=this.\u0275fac=function(o){return new(o||Tn)(n.LFG(ao))};static#t=this.\u0275prov=n.Yz7({token:Tn,factory:Tn.\u0275fac})}Z([Ee(Gr)],Tn.prototype,"dispellAllUnitsOnStructCompleted",null),Z([Ee(go)],Tn.prototype,"prepareSpellsOnFightStart",null),Z([re(kr)],Tn.prototype,"startCombatInteraction",null),Z([re(Qo)],Tn.prototype,"processCombatInteraction",null),Z([re(Ko)],Tn.prototype,"resetCooldownsAndEmitNewRoundEventToSpells",null),Z([re(Rr)],Tn.prototype,"dispelUnitOnDeath",null),Z([re(nd)],Tn.prototype,"addCombatModsToUnit",null),Z([re(dh)],Tn.prototype,"removeCombatModsToUnit",null);const gs=ct,Ro=ti({prefix:"Structure",events:{NewDayBegins:gs(),NewWeekBegins:gs(),StructVisited:gs(),StructInspected:gs()}}),ms=Ro.events;let ow=(()=>{class r extends ir.l{static#e=this.categoryId="town";create({townBase:o}){this.base=o,this.initTownBuildings(),this.initUnitGrowthAndAvailability(),this.getApi().events.on(Ys).subscribe(a=>{this.updateAvailableUnitsByWeeklyGrowth(),this.getApi().eventFeed.pushPlainMessage(`The army of ${this.base.name} has grown`)})}updateAvailableUnitsByWeeklyGrowth(){this.getHiringBuildings().forEach(o=>{const a=o.currentBuilding.activity;this.unitsAvailableMap[a.unitGrowthGroup]+=a.growth})}initTownBuildings(){this.buildings=Object.keys(this.base.availableBuildings).reduce((o,a)=>({...o,[a]:this.getApi().gameObjects.createNewGameObject(e1,{base:this.base.availableBuildings[a]})}),{})}initUnitGrowthAndAvailability(){const o=this.getHiringBuildings();this.growthMap=o.reduce((a,u)=>{const h=u.currentBuilding.activity;return a[h.unitGrowthGroup]=h.growth,a},{}),this.unitsAvailableMap=o.reduce((a,u)=>{const h=u.currentBuilding.activity;return a[h.unitGrowthGroup]=h.growth,a},{})}getHiringBuildings(){return Object.values(this.buildings).filter(o=>o.currentBuilding.activity?.type===Mn.Hiring)}}return r})();const Fa=ct,rw=ti({prefix:"Building",events:{NewDayBegins:Fa(),NewWeekStarts:Fa(),Built:Fa()}}),ym=rw.events;class Nt extends(bt()){constructor(l,o,a,u,h,m,_,b){super(),this.battleState=l,this.structuresService=o,this.players=a,this.heroesService=u,this.state=h,this.eventFeedUiService=m,this.gameApiProvider=_,this.eventFeed=b,this.scheduledActions=[]}openMainScreenOnGameStart(){this.events.dispatch(zi())}initializeGameMap(l){this.state.mapsState={currentMap:l.map,maps:[l.map]},this.structuresService.initStructures(l)}initPlayersOnGameStart(){const l=this.players.createPlayer(Fo.Main,this.players.createPlayerWithHero(this.state.createdGame.selectedColor,this.state.createdGame.selectedHero,ii.Player)),o=this.players.createPlayer(Fo.Neutral,{color:ce.PS.GRAY,type:ii.AI,hero:this.heroesService.createNeutralHero(),resources:{...lr}});l.hero.assignOwnerPlayer(l),o.hero.assignOwnerPlayer(o),l.hero.unitGroups.forEach(a=>a.assignOwnerHero(l.hero)),o.hero.unitGroups.forEach(a=>a.assignOwnerHero(o.hero)),this.state.gameState={players:[l,o],currentPlayer:l,playersMap:new Map([[l.id,l],[o.id,o]])},this.events.dispatch(Ur({})),this.events.dispatch(Zc.PrepareGameEvent({gameMode:ad.Normal,selectedFaction:this.state.createdGame.faction})),this.events.dispatch(Hc())}notifyBuildingsNewDayStarted(){this.state.eventHandlers.buildings.triggerAllHandlersByEvent(ym.NewDayBegins()),this.state.eventHandlers.structures.triggerAllHandlersByEvent(ms.NewDayBegins());const l=this.state.currentGame.globalDay;this.scheduledActions.filter(a=>a.day===l).forEach(a=>a.action()),this.scheduledActions=this.scheduledActions.filter(a=>a.day!==l)}pushEventFeedMessage(l){this.eventFeedUiService.pushEventFeedMessage(l)}pushPlainEventFeedMessage(l){this.eventFeedUiService.pushEventFeedMessage({message:[{type:x.xL.FreeHtml,htmlContent:l.message}],delay:l.delay})}addActionCardsToPlayer(l){this.eventFeedUiService.pushPlainMessage(`Received action cards:<hr> ${l.actionCardStacks.map(({card:o,count:a})=>`x${(0,os.$L)(a)} ${or(o)}`).join("<br>")}`),l.actionCardStacks.forEach(({card:o,count:a})=>{l.player.addActionCards(o,a)})}activateActionCard({player:l,cardStack:o}){console.log(o);const a=o.card;o.count--,a.actionPoints&&this.events.dispatch(yo({points:a.actionPoints})),o.count||Te.DN.removeItem(l.actionCards,o),this.eventFeed.pushPlainMessage(`${or(a)} is used. Left: ${(0,os.$L)(o.count)}`),a.type===nn.PlayerAction&&a.config?.onUsedInstantly?.(this.gameApiProvider.getGameApi())}notifyBuildignsNewWeekStarted(l){this.eventFeedUiService.pushPlainMessage(`Week ${l.week} started`),this.state.eventHandlers.buildings.triggerAllHandlersByEvent(ym.NewWeekStarts()),this.state.eventHandlers.structures.triggerAllHandlersByEvent(ms.NewWeekBegins())}scheduleAction(l){this.scheduledActions.push({action:l.action,day:this.state.currentGame.globalDay+l.dayOffset})}openMapScreenWhenPlayerLeavesTown(){this.events.dispatch(Hc())}initFight(l){this.state.currentBattleState={currentPlayer:this.state.gameState.currentPlayer,enemyPlayer:l.struct.guardingPlayer}}fightStartInitQueue({players:l,unitGroups:o}){this.events.dispatch(od()),this.battleState.initBattleState(o,l),this.events.dispatch(go({}))}onStructSelected(l){this.structuresService.currentStruct=l.struct}static#e=this.\u0275fac=function(o){return new(o||Nt)(n.LFG(to),n.LFG(_r),n.LFG(be),n.LFG(No),n.LFG(ft),n.LFG(as),n.LFG(Cr),n.LFG(as))};static#t=this.\u0275prov=n.Yz7({token:Nt,factory:Nt.\u0275fac})}Z([Ee(fh)],Nt.prototype,"openMainScreenOnGameStart",null),Z([re(Zc.GamePreparationFinished)],Nt.prototype,"initializeGameMap",null),Z([Ee(Oc)],Nt.prototype,"initPlayersOnGameStart",null),Z([Ee(Rc)],Nt.prototype,"notifyBuildingsNewDayStarted",null),Z([re(Ci)],Nt.prototype,"pushEventFeedMessage",null),Z([re(nr)],Nt.prototype,"pushPlainEventFeedMessage",null),Z([re(jr)],Nt.prototype,"addActionCardsToPlayer",null),Z([re(gt)],Nt.prototype,"activateActionCard",null),Z([re(Ys)],Nt.prototype,"notifyBuildignsNewWeekStarted",null),Z([re(Lc)],Nt.prototype,"scheduleAction",null),Z([Ee(Gn)],Nt.prototype,"openMapScreenWhenPlayerLeavesTown",null),Z([re(yi)],Nt.prototype,"initFight",null),Z([re(zs)],Nt.prototype,"fightStartInitQueue",null),Z([re(Xo)],Nt.prototype,"onStructSelected",null);class wr extends(bt()){constructor(l){super(),this.itemsService=l}triggerEventsForItems(l){this.itemsService.triggerEventForAllItemsHandlers(Jh.NewRoundBegins({round:l.round}))}trigger(){this.itemsService.triggerEventForAllItemsHandlers(Jh.NewRoundBegins({round:0}))}static#e=this.\u0275fac=function(o){return new(o||wr)(n.LFG(hs))};static#t=this.\u0275prov=n.Yz7({token:wr,factory:wr.\u0275fac})}Z([re(Ko)],wr.prototype,"triggerEventsForItems",null),Z([Ee(go)],wr.prototype,"trigger",null);class oi extends(bt()){constructor(l,o,a){super(),this.curPlayerState=l,this.itemsService=o,this.state=a}resetCooldowns(){this.curPlayerState.resetSpellsCooldowns()}addItemToPlayer({item:l,player:o}){const a=o.hero;a.addItem(l),a.inventory.isSlotEquipped(l.baseType.slotType)||this.events.dispatch(vi({item:l,player:o}))}removeItemFromPlayer({item:l,player:o}){o.hero.removeItem(l)}equipItem({item:l,player:o}){o.hero.equipItem(l),this.itemsService.registerItemsEventHandlers(l,o)}unequipItem({player:l,item:o}){l.hero.unequipItem(o),this.state.eventHandlers.items.removeAllHandlersForRef(o)}static#e=this.\u0275fac=function(o){return new(o||oi)(n.LFG(Ut),n.LFG(hs),n.LFG(ft))};static#t=this.\u0275prov=n.Yz7({token:oi,factory:oi.\u0275fac})}Z([Ee(Ko),Ee(go)],oi.prototype,"resetCooldowns",null),Z([re(er)],oi.prototype,"addItemToPlayer",null),Z([re(qi)],oi.prototype,"removeItemFromPlayer",null),Z([re(vi)],oi.prototype,"equipItem",null),Z([re(dt)],oi.prototype,"unequipItem",null);class Uo extends(bt()){constructor(l,o,a){super(),this.structuresService=l,this.state=o,this.gameObjectsManager=a}removeActionPoints({points:l}){const o=this.state.currentGame;o.actionPoints-=l,o.actionPoints<=0&&(o.day+=1,o.globalDay+=1,o.actionPoints+=4,this.events.dispatch(Rc({day:o.day})),o.day%7==0&&(o.week+=1,o.day=1,this.events.dispatch(Ys({week:o.week}))))}handleCompletedStructure(l){const o=l.struct.id;this.structuresService.availableStructuresMap[o]=!0,this.gameObjectsManager.getObjectByFullId(o).visited=!0,this.structuresService.playerCurrentLocId=o,this.structuresService.updateAvailableStructures(),this.events.dispatch(yo({points:l.struct.actionPoints}))}panMapCamera(l){this.state.mapCamera.x=l.x,this.state.mapCamera.y=l.y}static#e=this.\u0275fac=function(o){return new(o||Uo)(n.LFG(_r),n.LFG(ft),n.LFG(an))};static#t=this.\u0275prov=n.Yz7({token:Uo,factory:Uo.\u0275fac})}Z([re(yo)],Uo.prototype,"removeActionPoints",null),Z([re(Gr)],Uo.prototype,"handleCompletedStructure",null),Z([re(_i)],Uo.prototype,"panMapCamera",null);class Re extends(bt()){constructor(l,o,a,u,h){super(),this.combatInteractor=l,this.actionHint=o,this.curPlayerState=a,this.cardsMapping=u,this.popupService=h}handleEnemyCardClick(l){const o=this.curPlayerState.playerCurrentState;o!==Ye.Normal?o===Ye.SpellTargeting&&(this.curPlayerState.onCurrentSpellCast(),this.events.dispatch(Tc({player:l.attackingPlayer,spell:this.curPlayerState.currentSpell,target:l.attackedGroup})),this.curPlayerState.setSpellsOnCooldown()):this.events.dispatch(kr({attackedGroup:l.attackedGroup,attackingGroup:l.attackingGroup}))}handleAllyGroupClick(l){if(this.curPlayerState.playerCurrentState===Ye.SpellTargeting){this.curPlayerState.onCurrentSpellCast();const o=l.unitGroup;this.events.dispatch(Tc({player:o.ownerPlayer,spell:this.curPlayerState.currentSpell,target:o})),this.curPlayerState.setSpellsOnCooldown()}}handlePlayerHover(l){switch(l.hoverType){case fn.EnemyCard:this.curPlayerState.playerCurrentState===Ye.Normal&&this.combatInteractor.setDamageHintMessageOnCardHover(l),this.curPlayerState.playerCurrentState===Ye.SpellTargeting&&this.actionHint.hintMessage$.next({type:x.wX.OnTargetSpell,spell:this.curPlayerState.currentSpell,target:l.hoveredCard});break;case fn.AllyCard:this.curPlayerState.playerCurrentState===Ye.SpellTargeting&&this.actionHint.hintMessage$.next({type:x.wX.OnTargetSpell,spell:this.curPlayerState.currentSpell,target:l.hoveredCard});break;case fn.Unhover:this.actionHint.hintMessage$.next(null)}}handleRightClick(l){this.events.dispatch(jc({unitGroup:l.unitGroup}))}displayUnitGroupInfo(l){console.log("show info for:",l),this.popupService.createBasicPopup({data:{unitGroup:l.unitGroup},component:ro,isCloseable:!0,class:"small-padding"})}disableActionHintOnEnemyTurn(l){this.actionHint.disableActionHint$.next(l.currentPlayer!==this.curPlayerState.currentPlayer)}enableActionHint(){this.actionHint.disableActionHint$.next(!1)}playerTargetsSpell(l){this.combatInteractor.triggerEventForSpellHandler(l.spell,ca.PlayerTargetsSpell({target:l.target})),this.curPlayerState.setPlayerState(Ye.Normal),this.curPlayerState.resetCurrentSpell()}playerUsesInstantSpell(l){this.combatInteractor.triggerEventForSpellHandler(l.spell,ca.PlayerCastsInstantSpell({player:l.player,spell:l.spell}))}static#e=this.\u0275fac=function(o){return new(o||Re)(n.LFG(ao),n.LFG(no),n.LFG(Ut),n.LFG(_g),n.LFG(Eo))};static#t=this.\u0275prov=n.Yz7({token:Re,factory:Re.\u0275fac})}Z([re(Bc)],Re.prototype,"handleEnemyCardClick",null),Z([re($r)],Re.prototype,"handleAllyGroupClick",null),Z([re(ni)],Re.prototype,"handlePlayerHover",null),Z([re(Ks)],Re.prototype,"handleRightClick",null),Z([re(jc)],Re.prototype,"displayUnitGroupInfo",null),Z([re(mi)],Re.prototype,"disableActionHintOnEnemyTurn",null),Z([Ee(Vi)],Re.prototype,"enableActionHint",null),Z([re(Tc)],Re.prototype,"playerTargetsSpell",null),Z([re(Xu)],Re.prototype,"playerUsesInstantSpell",null);class Yn extends(bt()){constructor(l,o,a,u,h,m,_,b,S,T,A,ee,X){super(),this.combatInteractor=l,this.vfxService=o,this.battleState=a,this.spellsService=u,this.units=h,this.battleLog=m,this.players=_,this.itemsService=b,this.apiProvider=S,this.state=T,this.gameObjectsManager=A,this.eventFeed=ee,this.structures=X}initPlayerItems(){const l=this.players.getCurrentPlayer();l.hero.base.initialState.items.forEach(o=>{this.events.dispatch(er({player:l,item:this.itemsService.createItem(o)}))})}initSpell({spell:l,player:o,ownerUnit:a}){const u=l.baseType;u.config.flags?.isAura||u.config.spellConfig.init({actions:this.createActionsApiRef(),events:{on:h=>{Object.entries(h).forEach(([m,_])=>{const b=aa.getEventByName(m);this.state.eventHandlers.spells.registerHandlerByRef(l,b,_)})}},vfx:{createEffectForUnitGroup:(h,m,_)=>{this.vfxService.createVfxForUnitGroup(h,{type:_o.VfxElement,animation:m},_)},createFloatingMessageForUnitGroup:(h,m,_)=>{this.vfxService.createFloatingMessageForUnitGroup(h,m,_)},createDroppingMessageForUnitGroup:(h,m,_)=>{this.vfxService.createDroppingMessageForContainer(h,m,_)}},thisSpell:l.baseType,ownerPlayer:o,spellInstance:l,ownerHero:o.hero,ownerUnit:a})}initItem({item:l,ownerPlayer:o}){l.baseType.config.init({actions:this.createActionsApiRef(),events:{on:a=>{Object.entries(a).forEach(([u,h])=>{const m=xd.getEventByName(u);this.state.eventHandlers.items.registerHandlerByRef(l,m,h)})}},ownerHero:o.hero,ownerPlayer:o,thisInstance:l})}initBuilding({building:l}){this.state.eventHandlers.buildings.removeAllHandlersForRef(l),l.currentBuilding.config?.init({players:this.apiProvider.getPlayerApi(),localEvents:{on:a=>{Object.entries(a).forEach(([u,h])=>{const m=rw.getEventByName(u);this.state.eventHandlers.buildings.registerHandlerByRef(l,m,h)})}},globalEvents:this.apiProvider.getGlobalEventsApi(),thisBuilding:l,gameObjects:this.gameObjectsManager})}initStructureGameObject({structure:l}){l.generator?.config?.init({structures:{updateAvailableLocations:()=>this.structures.updateAvailableStructures(),markLocationVisited:o=>{o.visited=!0,this.structures.updateAvailableStructures()}},players:this.apiProvider.getPlayerApi(),thisStruct:l,localEvents:{on:o=>{Object.entries(o).forEach(([a,u])=>{const h=Ro.getEventByName(a);this.state.eventHandlers.structures.registerHandlerByRef(l,h,u)})}},eventFeed:{postEventFeedMessage:o=>this.eventFeed.pushEventFeedMessage(o),pushPlainMessage:o=>this.eventFeed.pushPlainMessage(o)},spells:this.apiProvider.getSpellsApi()})}initializeGameObjectApi(l){l.gameObject.api={spells:this.apiProvider.getSpellsApi(),events:{on:a=>this.events.onEvent(a),dispatch:a=>this.events.dispatch(a)},gameObjects:this.gameObjectsManager,eventFeed:{postEventFeedMessage:a=>{this.eventFeed.pushEventFeedMessage(a)},pushPlainMessage:a=>this.eventFeed.pushPlainMessage(a)}}}createActionsApiRef(){return{getUnitsFromFightQueue:()=>this.battleState.getFightQueue(),removeTurnsFromUnitGroup:(l,o=l.turnsLeft)=>{l.turnsLeft-=o,l.turnsLeft<0&&(l.turnsLeft=0),this.battleState.removeUnitsWithoutTurnsFromFightQueue()},unitGroupAttack:(l,o)=>this.events.dispatch(kr({attackingGroup:l,attackedGroup:o})),getCurrentUnitGroup:()=>this.battleState.currentUnitGroup,summonUnitsForPlayer:(l,o,a)=>{const u=this.battleState.summonUnitForPlayer(l,o,a);return this.events.dispatch(Fr({unitGroup:u})),u},dealDamageTo:(l,o,a,u)=>{this.combatInteractor.dealDamageTo(l,o,a,u)},createSpellInstance:(l,o)=>this.spellsService.createSpellInstance(l,o),addModifiersToUnitGroup:(l,o)=>{this.units.addModifierToUnitGroup(l,o),o.unitGroupSpeedBonus&&this.events.dispatch(Nr({unitGroup:l})),this.events.dispatch(ed({unitGroup:l}))},createModifiers:l=>this.spellsService.createModifiers(l),removeModifiresFromUnitGroup:(l,o)=>{this.units.removeModifiers(l,o),this.events.dispatch(ed({unitGroup:l}))},addSpellToUnitGroup:(l,o,a)=>{this.combatInteractor.addSpellToUnitGroup(l,o,a)},removeSpellFromUnitGroup:(l,o)=>{this.combatInteractor.removeSpellFromUnitGroup(l,o)},getUnitGroupsOfPlayer:l=>this.battleState.heroesUnitGroupsMap.get(l),getAliveUnitGroupsOfPlayer:l=>this.battleState.getAliveUnitsOfPlayer(l),getRandomEnemyPlayerGroup:()=>this.combatInteractor.getRandomEnemyUnitGroup(),getEnemyOfPlayer:l=>this.battleState.getEnemyOfPlayer(l),historyLog:l=>{this.battleLog.logSimpleMessage(l)},healUnit:(l,o)=>{const a=this.units.healUnit(l,o);return this.events.dispatch(Ec({target:l,healedUnitsCount:a.revivedUnitsCount})),a}}}static#e=this.\u0275fac=function(o){return new(o||Yn)(n.LFG(ao),n.LFG(yr),n.LFG(to),n.LFG(wa),n.LFG(Dn),n.LFG(Ca),n.LFG(be),n.LFG(hs),n.LFG(Cr),n.LFG(ft),n.LFG(an),n.LFG(as),n.LFG(_r))};static#t=this.\u0275prov=n.Yz7({token:Yn,factory:Yn.\u0275fac})}Z([Ee(Ur)],Yn.prototype,"initPlayerItems",null),Z([re(mh)],Yn.prototype,"initSpell",null),Z([re(yh)],Yn.prototype,"initItem",null),Z([re(vh)],Yn.prototype,"initBuilding",null),Z([re(_h)],Yn.prototype,"initStructureGameObject",null),Z([re(gh)],Yn.prototype,"initializeGameObjectApi",null);var sw=M(117),aw=M(222);const vm=["mapCanvas"],cw=["underlay"];class br extends(bt()){constructor(l,o,a){super(),this.state=l,this.ngZone=o,this.renderer=a,this.hostElem=(0,Te.xf)(),this.mapDragEvent=new n.vpe,this.cellSize=0,this.windowWidth=0,this.windowHeight=0,this.windowWidthHalf=0,this.windowHeightHalf=0,this.mapTotalWidth=0,this.mapTotalHeight=0,this.offsetX=0,this.offsetY=0}ngOnInit(){this.canvasElem=this.mapCanvasRef.nativeElement,this.canvasCtx=this.canvasElem.getContext("2d"),this.underlayElem=this.underlayRef.nativeElement,this.currentMap=this.state.mapsState.currentMap,this.renderMapCellsGrid(),this.setupWindowResizingHandling(),this.setupMapDragging(),this.resetCanvasPosition()}onMapClick(l){(0,n.X6Q)()&&console.log({id:"new-id",x:l.clientX-this.offsetX,y:l.clientY-this.offsetY,icon:"sword"})}panCameraCenterTo(l){console.log("[Map View]: Pan camera center to",l);const o=-(l.x-this.windowWidthHalf),a=-(l.y-this.windowHeightHalf);this.setMapElementsPosition(o,a),this.mapDragEvent.emit({finalPosX:o,finalPosY:a})}setupMapDragging(){this.ngZone.runOutsideAngular(()=>{Ii(this.hostElem,"mousedown").pipe((0,aw.w)(l=>{const o=l,a=parseInt(this.canvasElem.style.left),u=parseInt(this.canvasElem.style.top);return Ii(window,"mousemove").pipe((0,rs.U)(h=>({xDragOffset:h.clientX-o.clientX,yDragOffset:h.clientY-o.clientY,mapPosX:a,mapPosY:u})),Xe((0,sw.T)(Ii(window,"mouseup"),Ii(window,"onfocusout")).pipe(Ip(1))))}),this.untilDestroyed).subscribe(l=>{const o=this.windowWidthHalf,a=this.windowHeightHalf,u=l.mapPosX+l.xDragOffset,h=l.mapPosY+l.yDragOffset;let m=u,_=h;u>o?m=o:u<-(this.mapTotalWidth-o)&&(m=-(this.mapTotalWidth-o)),h>a?_=a:h<-(this.mapTotalHeight-a)&&(_=-(this.mapTotalHeight-a)),this.state.mapCamera.x=-1*m+o,this.state.mapCamera.y=-1*_+a,this.setMapElementsPosition(m,_),this.mapDragEvent.emit({finalPosX:m,finalPosY:_})})})}setMapElementsPosition(l,o){this.offsetX=l,this.offsetY=o,this.renderer.setStyle(this.canvasElem,"left",`${l}px`),this.renderer.setStyle(this.canvasElem,"top",`${o}px`)}resetCanvasPosition(){this.offsetX=0,this.offsetY=0,this.renderer.setStyle(this.canvasElem,"left","0px"),this.renderer.setStyle(this.canvasElem,"top","0px")}renderMapCellsGrid(){const{heightInCells:l,widthInCells:o,cellSize:a}=this.currentMap.mapSize;this.cellSize=a;const u=o*a,h=l*a;this.mapTotalWidth=u,this.mapTotalHeight=h,this.canvasElem.width=u,this.canvasElem.height=h;const m=this.canvasCtx;for(let _=0;_<=l;_++)m.moveTo(0,_*a),m.lineTo(u,_*a);for(let _=0;_<=o;_++)m.moveTo(_*a,0),m.lineTo(_*a,h);m.setLineDash([5,8]),m.lineWidth=.5,m.strokeStyle="gray",m.stroke()}setupWindowResizingHandling(){this.updateWindowSizeData(),this.updateUnderlaySize(),this.ngZone.runOutsideAngular(()=>{Ii(window,"resize").pipe(this.untilDestroyed).subscribe(()=>{this.updateWindowSizeData(),this.updateUnderlaySize(),this.panCameraCenterTo(this.state.mapCamera)})})}updateWindowSizeData(){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,this.windowWidthHalf=this.windowWidth/2,this.windowHeightHalf=this.windowHeight/2}updateUnderlaySize(){this.renderer.setStyle(this.underlayElem,"width",`${this.windowWidth}px`),this.renderer.setStyle(this.underlayElem,"height",`${this.windowHeight}px`)}static#e=this.\u0275fac=function(o){return new(o||br)(n.Y36(ft),n.Y36(n.R0b),n.Y36(n.Qsj))};static#t=this.\u0275cmp=n.Xpm({type:br,selectors:[["mw-map-canvas"]],viewQuery:function(o,a){if(1&o&&(n.Gf(vm,7),n.Gf(cw,7)),2&o){let u;n.iGM(u=n.CRH())&&(a.mapCanvasRef=u.first),n.iGM(u=n.CRH())&&(a.underlayRef=u.first)}},outputs:{mapDragEvent:"mapDragEvent"},features:[n.qOj],decls:4,vars:0,consts:[[1,"underlay"],["underlay",""],[3,"click"],["mapCanvas",""]],template:function(o,a){1&o&&(n._UZ(0,"div",0,1),n.TgZ(2,"canvas",2,3),n.NdJ("click",function(h){return a.onMapClick(h)}),n.qZA())},styles:[".underlay[_ngcontent-%COMP%]{background-color:#e9e9e9;z-index:-3;position:absolute;-webkit-user-select:none;user-select:none}canvas[_ngcontent-%COMP%]{position:absolute;background:whitesmoke;z-index:-2;-webkit-user-select:none;user-select:none}"]})}Z([re(_i)],br.prototype,"panCameraCenterTo",null);let Ni=(()=>{class r{constructor(o){this.actionHint=o,this.mwActionHint=""}ngOnDestroy(){this.actionHint.hintMessage$.next(null)}showHint(){this.actionHint.hintMessage$.next({type:x.wX.CustomHtml,html:this.mwActionHint})}hideHint(){this.actionHint.hintMessage$.next(null)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(no))};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","mwActionHint",""]],hostBindings:function(a,u){1&a&&n.NdJ("mouseenter",function(){return u.showHint()})("mouseleave",function(){return u.hideHint()})},inputs:{mwActionHint:"mwActionHint"}})}return r})();function ys(r,l){if(1&r&&(n.TgZ(0,"div",2),n._uU(1),n.qZA()),2&r){const o=n.oxw();n.xp6(1),n.hij(" ",o.struct.actionPoints,"\n")}}let _m=(()=>{class r{constructor(){this.isAvailable=!1,this.isCurrentLoc=!1,this.activeLocColor="",this.structSelected=new n.vpe}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-map-structure"]],inputs:{struct:"struct",isAvailable:"isAvailable",isCurrentLoc:"isCurrentLoc",activeLocColor:"activeLocColor"},outputs:{structSelected:"structSelected"},decls:2,vars:13,consts:[[1,"struct-icon",3,"mwActionHint","icon","click"],["class","loc-action-points",4,"ngIf"],[1,"loc-action-points"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-ra-icon",0),n.NdJ("click",function(){return u.structSelected.emit(u.struct)}),n.qZA(),n.YNc(1,ys,2,1,"div",1)),2&a&&(n.Udp("border-color",u.isCurrentLoc?u.activeLocColor:"rgb(90, 90, 90)"),n.ekj("available",u.isAvailable&&!u.struct.visited)("completed",u.struct.visited)("disabled",!u.isAvailable)("guards",u.struct.guard&&!u.struct.visited&&u.isAvailable),n.Q6J("mwActionHint",(u.struct.guard&&u.isAvailable&&!u.struct.visited?"Attack the guard of ":"")+u.struct.name+(u.struct.visited?"<hr/>Visited":u.struct.actionPoints?"<hr/>Cost: "+u.struct.actionPoints+" action points":""))("icon",u.struct.icon),n.xp6(1),n.Q6J("ngIf",u.isAvailable&&!u.struct.visited&&u.struct.actionPoints))},dependencies:[rt,Ni,lt],styles:[".struct-icon[_ngcontent-%COMP%]{position:absolute;cursor:pointer;z-index:50;transform:translate(-50%,-50%) scale(1.2);text-align:center;font-size:20px;border:4px solid rgb(90,90,90);background-color:gray;color:#fff;border-radius:50%;width:20px;height:20px;display:block;filter:brightness(1)}.struct-icon[_ngcontent-%COMP%]:hover{filter:brightness(1);transition:.4s;transform:translate(-50%,-50%) scale(1.4)}.available[_ngcontent-%COMP%]{outline:4px solid rgba(151,133,27,.28)}.struct-icon.disabled[_ngcontent-%COMP%]{filter:brightness(.7)}.struct-icon[_ngcontent-%COMP%]:not(.disabled) ~ .path-line[_ngcontent-%COMP%]{opacity:1}.struct-icon[_ngcontent-%COMP%]:hover ~ .path-line[_ngcontent-%COMP%] > .line[_ngcontent-%COMP%]{stroke-width:7;animation:pathanim 2s linear infinite}.structure[_ngcontent-%COMP%]{width:100px;margin:10px;border-radius:6px;background:gray;color:#fff;padding:14px;cursor:pointer}.inactive[_ngcontent-%COMP%]{opacity:.5}.loc-action-points[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;z-index:50;position:relative;background:#4d4d4d;width:14px;height:14px;border-radius:50%;font-size:11px;text-align:center;color:#fff;border:2px solid;top:7px;left:5px}"]})}return r})();const lw=["locationsContainer"];function Cm(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"mw-map-canvas",6),n.NdJ("mapDragEvent",function(u){n.CHM(o);const h=n.oxw();return n.KtG(h.updateLocationsPosition(u))}),n.qZA()}}function uw(r,l){if(1&r&&(n.TgZ(0,"div",8)(1,"span",12),n._uU(2),n.qZA()()),2&r){const o=n.oxw().$implicit;n.Udp("left",o.x,"px")("top",o.y,"px"),n.xp6(2),n.hij(" ",o.id," ")}}function wm(r,l){if(1&r&&(n.O4$(),n.TgZ(0,"svg",13),n._UZ(1,"line",14),n.qZA()),2&r){const o=n.oxw().$implicit;n.Udp("left",o.svg.x,"px")("top",o.svg.y,"px"),n.uIk("width",o.svg.width)("height",o.svg.height),n.xp6(1),n.uIk("x1",o.svg.ox)("y1",o.svg.oy)("x2",o.svg.tx)("y2",o.svg.ty)}}function E1(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",7)(1,"div",8)(2,"mw-map-structure",9),n.NdJ("structSelected",function(u){n.CHM(o);const h=n.oxw();return n.KtG(h.onStructureSelected(u))}),n.qZA()(),n.YNc(3,uw,3,5,"div",10)(4,wm,2,10,"svg",11),n.qZA()}if(2&r){const o=l.$implicit,a=n.oxw();n.xp6(1),n.Udp("left",o.x,"px")("top",o.y,"px"),n.xp6(1),n.Q6J("struct",o)("isAvailable",a.structsService.availableStructuresMap[o.id])("isCurrentLoc",a.structsService.playerCurrentLocId===o.id)("activeLocColor",a.state.createdGame.selectedColor),n.xp6(1),n.Q6J("ngIf",a.isLocIdVisible),n.xp6(1),n.Q6J("ngIf",o.svg)}}let zl=(()=>{class r extends(bt()){constructor(o,a,u,h,m){super(),this.playersService=o,this.state=a,this.structsService=u,this.renderer=h,this.gameObjectsManager=m,this.isLocIdVisible=false,this.player=this.playersService.getCurrentPlayer(),hp(()=>{this.state.mainMenu.isOpen||this.events.dispatch(Yi())})}ngAfterViewInit(){if(this.state.mapCamera.cameraInitialized){const{x:u,y:h}=this.state.mapCamera;return void this.events.dispatch(_i({x:u,y:h}))}const o=this.state.mapsState.currentMap.startingLocId,a=this.gameObjectsManager.getObjectById(es,o);a?this.events.dispatch(_i({x:a.x,y:a.y})):console.warn(`[Map View]: Couldn't find location with id ${o} to pan camera center on game start`),this.state.mapCamera.cameraInitialized=!0}updateLocationsPosition(o){const a=this.locationsRef.nativeElement;this.renderer.setStyle(a,"left",`${o.finalPosX}px`),this.renderer.setStyle(a,"top",`${o.finalPosY}px`)}onStructureSelected(o){!this.structsService.availableStructuresMap[o.id]||!o.generator||o.isInactive||(o.guard&&this.playersService.getEnemyPlayer().hero.setUnitGroups(o.guard),this.events.dispatch(Xo({struct:o})))}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be),n.Y36(ft),n.Y36(_r),n.Y36(n.Qsj),n.Y36(an))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-structures-view"]],viewQuery:function(a,u){if(1&a&&n.Gf(lw,5),2&a){let h;n.iGM(h=n.CRH())&&(u.locationsRef=h.first)}},features:[n.qOj],decls:7,vars:2,consts:[[3,"mapDragEvent",4,"ngIf"],[1,"map-view"],["locationsContainer",""],["class","struct",4,"ngFor","ngForOf"],[1,"player-info-panel"],[1,"player-actions"],[3,"mapDragEvent"],[1,"struct"],[2,"position","absolute"],[3,"struct","isAvailable","isCurrentLoc","activeLocColor","structSelected"],["style","position: absolute;",3,"left","top",4,"ngIf"],["class","path-line","version","1.1","xmlns","http://www.w3.org/2000/svg",3,"left","top",4,"ngIf"],[1,"loc-name"],["version","1.1","xmlns","http://www.w3.org/2000/svg",1,"path-line"],["stroke-dasharray","10, 13",1,"line"]],template:function(a,u){1&a&&(n.YNc(0,Cm,1,0,"mw-map-canvas",0),n.TgZ(1,"div",1,2),n.YNc(3,E1,5,10,"div",3),n.qZA(),n._UZ(4,"mw-player-info-panel",4)(5,"mw-action-hint")(6,"mw-player-map-actions-panel",5)),2&a&&(n.Q6J("ngIf",u.state.settings.mapDebug),n.xp6(3),n.Q6J("ngForOf",u.structsService.viewStructures))},dependencies:[Ie,rt,_p,bp,Ll,_m,br],styles:[".map-view[_ngcontent-%COMP%]{height:0;width:0;position:absolute;left:0;top:0;z-index:-1}@keyframes _ngcontent-%COMP%_pathanim{0%{stroke-dashoffset:0}to{stroke-dashoffset:-23}}.path-line[_ngcontent-%COMP%]{position:absolute;opacity:.4;transition:.4s;overflow:visible;min-width:15px;pointer-events:none}.struct[_ngcontent-%COMP%]:hover   .path-line[_ngcontent-%COMP%]{opacity:.6}.struct[_ngcontent-%COMP%]:hover   .path-line[_ngcontent-%COMP%] > .line[_ngcontent-%COMP%]{stroke-width:7;animation:_ngcontent-%COMP%_pathanim 2s linear infinite}.line[_ngcontent-%COMP%]{stroke:#000;stroke-width:5;stroke-dashoffset:0;opacity:.6}.guards[_ngcontent-%COMP%]{font-size:13px}.player-info-panel[_ngcontent-%COMP%]{position:fixed;left:0;bottom:0}.player-actions[_ngcontent-%COMP%]{position:fixed;left:70px;top:50%;display:flex;flex-direction:column;transform:translateY(-50%)}mw-action-hint[_ngcontent-%COMP%]{position:fixed;top:90%;left:0;right:0;font-size:13px}.loc-name[_ngcontent-%COMP%]{position:relative;left:-50%;background:#525252;text-align:center;color:#fff;display:block;font-size:9px;padding:2px;border-radius:3px;top:12px;z-index:100000}"]})}return r})(),Ra=(()=>{class r{transform(o){return(0,pt.fH)(o)}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275pipe=n.Yjl({name:"entity",type:r,pure:!0})}return r})();function Ap(r,l){if(1&r&&(n.TgZ(0,"div",11)(1,"div"),n._uU(2),n.qZA(),n.TgZ(3,"div"),n._uU(4),n.qZA()()),2&r){const o=l.$implicit;n.xp6(2),n.Oqu(o.key),n.xp6(2),n.Oqu(o.value)}}function Op(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",7)(1,"div"),n._uU(2),n.ALo(3,"entity"),n.qZA(),n.TgZ(4,"div"),n._uU(5),n.qZA(),n.TgZ(6,"input",8),n.NdJ("input",function(u){const m=n.CHM(o).$implicit,_=n.oxw();return n.KtG(_.updateCountForGroup(m,u))}),n.qZA(),n.TgZ(7,"div"),n._uU(8,"Cost:"),n.qZA(),n.TgZ(9,"div",9),n.YNc(10,Ap,5,2,"div",10),n.ALo(11,"keyvalue"),n.qZA()()}if(2&r){const o=l.$implicit;n.xp6(2),n.Oqu(n.lcZ(3,6,o.hire.unitTypeId).name),n.xp6(3),n.Oqu(o.count),n.xp6(1),n.Q6J("min",0)("max",o.hire.maxCount)("value",0),n.xp6(4),n.Q6J("ngForOf",n.lcZ(11,8,o.currentCost))}}function ri(r,l){1&r&&(n.TgZ(0,"div"),n._uU(1,"You don't have enough free slots in army."),n.qZA())}let bm=(()=>{class r extends mt{constructor(o,a){super(),this.playersService=o,this.unitGroups=a,this.canConfirm=!0,this.playerHasFreeSlots=!0,this.playerHasFreeSlots=this.playersService.getCurrentPlayer().hero.hasFreeUnitSlots()}ngOnInit(){this.hiredGroups=this.data.struct.reward.units.map(o=>{const a={},u={},h=Di(o.unitTypeId).baseRequirements;return[Je.Gems,Je.Gold,Je.RedCrystals,Je.Wood].forEach(_=>{h[_]&&(a[_]=h[_],u[_]=0)}),{hire:o,count:0,baseCost:a,currentCost:u}})}updateCountForGroup(o,a){o.count=Number(a.target.value),this.canConfirm=!0,Object.entries(o.baseCost).forEach(([u,h])=>{o.currentCost[u]=h*o.count}),this.updateCanConfirm()}confirmHire(){const o=this.playersService.getCurrentPlayer(),a=this.calcTotalCosts();this.playersService.removeResourcesFromPlayer(o,a),this.hiredGroups.forEach(u=>{if(u.count){const h=this.unitGroups.createUnitGroup(u.hire.unitTypeId,{count:u.count},o.hero);this.playersService.addUnitGroupToTypeStack(o,h)}}),this.close()}calcTotalCosts(){return this.hiredGroups.reduce((o,a)=>(Object.entries(a.currentCost).forEach(([u,h])=>{const m=u;o[m]?o[m]+=a.currentCost[m]:o[m]=a.currentCost[m]}),o),{})}updateCanConfirm(){const o=this.calcTotalCosts();this.canConfirm=this.playersService.playerHasResources(this.playersService.getCurrentPlayer(),o)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be),n.Y36(Dn))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-hiring-reward-popup"]],features:[n.qOj],decls:10,vars:3,consts:[[2,"padding","10px"],["popupHeader",""],["popupContent",""],[1,"units"],["class","unit-column",4,"ngFor","ngForOf"],["popupButtons",""],[1,"button",3,"disabled","click"],[1,"unit-column"],["type","range",3,"min","max","value","input"],[1,"cost"],["class","resource",4,"ngFor","ngForOf"],[1,"resource"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content",0)(1,"div",1),n._uU(2," Hire units: "),n.qZA(),n.TgZ(3,"div",2)(4,"div",3),n.YNc(5,Op,12,10,"div",4),n.qZA(),n.YNc(6,ri,2,0,"div"),n.qZA(),n.TgZ(7,"div",5)(8,"button",6),n.NdJ("click",function(){return u.confirmHire()}),n._uU(9," Confirm "),n.qZA()()()),2&a&&(n.xp6(5),n.Q6J("ngForOf",u.hiredGroups),n.xp6(1),n.um2(6,u.playerHasFreeSlots?-1:6),n.xp6(2),n.Q6J("disabled",!u.canConfirm||!u.playerHasFreeSlots))},dependencies:[Ie,Ot,Fn,Ra],styles:[".units[_ngcontent-%COMP%]{display:flex;justify-content:center}.unit-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid gray;padding:10px;margin:6px;width:160px;align-items:center;font-size:13px}.cost[_ngcontent-%COMP%]{display:flex}.resource[_ngcontent-%COMP%]{border:1px solid gray;border-radius:4px;padding:7px}"]})}return r})();function Mm(r,l){if(1&r&&(n.TgZ(0,"div",9),n._UZ(1,"mw-item-icon",10),n.TgZ(2,"div",11),n._uU(3),n.qZA()()),2&r){const o=l.$implicit;n.xp6(1),n.Q6J("item",o)("hintPos","above"),n.xp6(2),n.hij(" ",o.baseType.name," ")}}function Fi(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",7),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw();return n.KtG(m.setSelectedGroup(h))}),n.YNc(1,Mm,4,3,"div",8),n.qZA()}if(2&r){const o=l.$implicit,a=n.oxw();n.ekj("selected",o===a.selectedGroup),n.xp6(1),n.Q6J("ngForOf",o)}}let Qn=(()=>{class r extends mt{constructor(o,a){super(),this.itemsService=o,this.playersService=a}ngOnInit(){this.itemGroups=this.data.struct.reward.itemGroups.map(a=>a.map(u=>this.itemsService.createItem(u)))}setSelectedGroup(o){this.selectedGroup=o}onSubmit(){this.selectedGroup.forEach(o=>{this.playersService.addItemToPlayer(this.playersService.getCurrentPlayer(),o)}),this.close()}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(hs),n.Y36(be))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-item-reward-popup"]],features:[n.qOj],decls:10,vars:2,consts:[["popupHeader",""],[2,"text-align","center","padding-bottom","20px"],["popupContent",""],[1,"reward-container"],["class","items-group",3,"selected","click",4,"ngFor","ngForOf"],["popupButtons","",2,"padding-top","18px"],["mw-main-button","",3,"disabled","click"],[1,"items-group",3,"click"],["style","display: flex; flex-direction: column; align-items: center;",4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","column","align-items","center"],[3,"item","hintPos"],[2,"font-size","11px","text-align","center"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0)(2,"div",1),n._uU(3," Select Item "),n.qZA()(),n.TgZ(4,"div",2)(5,"div",3),n.YNc(6,Fi,2,3,"div",4),n.qZA()(),n.TgZ(7,"div",5)(8,"button",6),n.NdJ("click",function(){return u.onSubmit()}),n._uU(9," Submit "),n.qZA()()()),2&a&&(n.xp6(6),n.Q6J("ngForOf",u.itemGroups),n.xp6(2),n.Q6J("disabled",!u.selectedGroup))},dependencies:[Ie,Ei,yt,Ot],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:space-between}.reward-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.items-group[_ngcontent-%COMP%]{margin:14px;padding:16px;border:1px solid gray;cursor:pointer}.selected[_ngcontent-%COMP%]{border-color:gold}"]})}return r})();function si(r,l){if(1&r&&(n.TgZ(0,"div",8)(1,"span"),n._uU(2),n.qZA(),n.TgZ(3,"span"),n._uU(4),n.qZA()()),2&r){const o=l.$implicit;n.xp6(2),n.Oqu(o.type.name),n.xp6(2),n.Oqu(o.count)}}function Dm(r,l){if(1&r&&(n.TgZ(0,"div",8)(1,"span"),n._uU(2),n.qZA(),n.TgZ(3,"span"),n._uU(4),n.qZA()()),2&r){const o=l.$implicit;n.xp6(2),n.Oqu(o.type.name),n.xp6(2),n.Oqu(o.count)}}let kp=(()=>{class r extends mt{constructor(o,a){super(),this.players=o,this.events=a,this.totalGoldReward=0,this.totalExperienceReward=0}ngOnInit(){this.data.enemyLosses.forEach(o=>{this.totalExperienceReward+=Math.round(o.count*o.type.neutralReward.experience)})}onContinue(o){if(!o.isWin)return this.close(),void this.events.dispatch(Fc());this.close(),this.players.addExperienceToPlayer(this.players.getCurrentPlayerId(),this.totalExperienceReward),this.players.getCurrentPlayer().resources[Je.Gold]+=this.totalGoldReward,this.events.dispatch(Gr({struct:o.struct}))}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be),n.Y36(Ze))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-post-fight-reward-popup"]],features:[n.qOj],decls:21,vars:4,consts:[["popupHeader",""],[1,"header"],["popupContent",""],[2,"text-align","center"],[1,"losses-container"],["class","loss-card",4,"ngFor","ngForOf"],["popupButtons",""],["mw-main-button","",2,"margin","auto","display","block",3,"click"],[1,"loss-card"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0)(2,"div",1),n._uU(3),n.qZA()(),n.TgZ(4,"div",2)(5,"div")(6,"div",3),n._uU(7,"Player's Losses"),n.qZA(),n.TgZ(8,"div",4),n.YNc(9,si,5,2,"div",5),n.qZA()(),n.TgZ(10,"div")(11,"div",3),n._uU(12,"Enemy's Losses"),n.qZA(),n.TgZ(13,"div",4),n.YNc(14,Dm,5,2,"div",5),n.qZA()(),n.TgZ(15,"div")(16,"div"),n._uU(17),n.qZA()()(),n.TgZ(18,"div",6)(19,"button",7),n.NdJ("click",function(){return u.onContinue(u.data)}),n._uU(20," Continue "),n.qZA()()()),2&a&&(n.xp6(3),n.Oqu(u.data.isWin?"Win!":"Defeat"),n.xp6(6),n.Q6J("ngForOf",u.data.playerLosses),n.xp6(5),n.Q6J("ngForOf",u.data.enemyLosses),n.xp6(3),n.hij("Experience: +",u.totalExperienceReward,""))},dependencies:[Ie,yt,Ot],styles:[".header[_ngcontent-%COMP%]{text-align:center;padding-bottom:16px}.losses-container[_ngcontent-%COMP%]{display:flex;justify-content:center}.loss-card[_ngcontent-%COMP%]{width:72px;height:72px;background-color:gray;border-radius:6px;color:#fff;margin:4px;text-align:center;padding:12px 0;font-size:13px;box-sizing:border-box;display:flex;flex-direction:column}"]})}return r})();const dw=r=>({thisStruct:r});function pw(r,l){if(1&r&&(n.TgZ(0,"div",7),n._UZ(1,"mw-description",8),n.qZA()),2&r){const o=n.oxw();let a;n.xp6(1),n.Q6J("descriptions",null==o.data.struct.generator||null==(a=o.data.struct.generator.description(n.VKq(1,dw,o.data.struct)))?null:a.descriptions)}}let Sm=(()=>{class r extends mt{constructor(o){super(),this.events=o,this.struct=this.data.struct,this.totalGoldReward=0,this.totalExpReward=0}ngOnInit(){this.data.struct.guard?.forEach(o=>{this.totalExpReward+=Math.round(o.count*o.type.neutralReward.experience)})}onBattleConfirmed(){this.close(),this.events.dispatch(yi({struct:this.popup.data.struct}))}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(Ze))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-pre-fight-popup"]],features:[n.qOj],decls:16,vars:4,consts:[["popupHeader",""],["popupContent",""],["class","description",4,"ngIf"],[3,"unitGroups"],["popupButtons",""],["mw-main-button","",3,"click"],["icon","crossed-swords"],[1,"description"],[3,"descriptions"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0),n._uU(2),n.qZA(),n.TgZ(3,"div",1),n.YNc(4,pw,2,3,"div",2),n.TgZ(5,"div"),n._UZ(6,"mw-unit-groups-list",3),n.qZA(),n.TgZ(7,"div")(8,"div"),n._uU(9),n.qZA()()(),n.TgZ(10,"div",4)(11,"button",5),n.NdJ("click",function(){return u.onBattleConfirmed()}),n._UZ(12,"mw-ra-icon",6),n._uU(13," Fight "),n.qZA(),n.TgZ(14,"button",5),n.NdJ("click",function(){return u.close()}),n._uU(15," Cancel "),n.qZA()()()),2&a&&(n.xp6(2),n.hij(" ",null==u.data.struct.generator?null:u.data.struct.generator.name," "),n.xp6(2),n.Q6J("ngIf",null==u.data.struct.generator?null:u.data.struct.generator.description),n.xp6(2),n.Q6J("unitGroups",u.data.struct.guard),n.xp6(3),n.hij("Experience: ",u.totalExpReward,""))},dependencies:[rt,Po,vt,lt,yt,Ot],styles:[".description[_ngcontent-%COMP%]{padding:10px;text-align:center}"]})}return r})();const fw=r=>({thisStruct:r});function Np(r,l){if(1&r&&n._UZ(0,"mw-description",3),2&r){const o=n.oxw();let a;n.Q6J("descriptions",null==o.struct.generator||null==(a=o.struct.generator.description(n.VKq(1,fw,o.struct)))?null:a.descriptions)}}let vs=(()=>{class r extends mt{constructor(o,a,u,h){super(),this.players=o,this.apiProvider=a,this.state=u,this.events=h,this.struct=this.data.struct,this.state.eventHandlers.structures.triggerRefEventHandlers(this.struct,ms.StructInspected())}closePopup(){this.close()}accept(){const o=this.players.getCurrentPlayer(),a=this.data.struct;a.generator?.onVisited?.({playersApi:this.apiProvider.getPlayerApi(),spellsApi:this.apiProvider.getSpellsApi(),visitingPlayer:o}),this.state.eventHandlers.structures.triggerRefEventHandlers(this.data.struct,ms.StructVisited({visitingPlayer:this.players.getCurrentPlayer()}));const u=this.data.struct.actionPoints;u&&this.events.dispatch(yo({points:u})),a.isInactive=!0,this.closePopup()}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be),n.Y36(Cr),n.Y36(ft),n.Y36(Ze))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-preview-popup"]],features:[n.qOj],decls:11,vars:3,consts:[["popupHeader",""],["popupContent",""],[2,"white-space","pre","padding","16px"],[3,"descriptions"],["popupButtons",""],["mw-main-button","",3,"disabled","click"],["mw-main-button","",3,"click"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0),n._uU(2),n.qZA(),n.TgZ(3,"div",1)(4,"div",2),n.YNc(5,Np,1,3,"mw-description",3),n.qZA()(),n.TgZ(6,"div",4)(7,"button",5),n.NdJ("click",function(){return u.accept()}),n._uU(8,"Accept"),n.qZA(),n.TgZ(9,"button",6),n.NdJ("click",function(){return u.closePopup()}),n._uU(10,"Cancel"),n.qZA()()()),2&a&&(n.xp6(2),n.hij(" ",u.data.struct.name," "),n.xp6(3),n.um2(5,null!=u.struct.generator&&u.struct.generator.description?5:-1),n.xp6(2),n.Q6J("disabled",!1===(null==u.struct.controls?null:u.struct.controls.accept)))},dependencies:[Po,yt,Ot],styles:["[_nghost-%COMP%]{text-align:center}"]})}return r})();function hw(r,l){if(1&r&&(n.TgZ(0,"div",8)(1,"div"),n._uU(2),n.qZA(),n.TgZ(3,"div"),n._uU(4),n.qZA()()),2&r){const o=l.$implicit;n.xp6(2),n.hij(" ",o.type," "),n.xp6(2),n.hij(" ",o.count," ")}}function Tm(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",6),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw();return n.KtG(m.setCurrentReward(m.data,h))}),n.YNc(1,hw,5,2,"div",7),n.qZA()}if(2&r){const o=l.$implicit,a=n.oxw();n.ekj("selected",a.data.selectedRewardGroup===o),n.xp6(1),n.Q6J("ngForOf",o)}}let xm=(()=>{class r extends mt{constructor(o){super(),this.playersService=o}ngOnInit(){this.resourceGroups=this.data.struct.reward.resourceGroups}setCurrentReward(o,a){o.selectedRewardGroup=a}confirmResources(o){this.close(),o.selectedRewardGroup&&o.selectedRewardGroup.forEach(a=>{this.playersService.addResourceToPlayer(this.playersService.getCurrentPlayer(),a.type,a.count)})}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-resources-reward-popup"]],features:[n.qOj],decls:9,vars:2,consts:[["popupHeader",""],["popupContent",""],[1,"reources-rewards"],["class","resource-column",3,"selected","click",4,"ngFor","ngForOf"],["popupButtons",""],["mw-main-button","",2,"margin","auto","display","block",3,"disabled","click"],[1,"resource-column",3,"click"],["class","resource-card",4,"ngFor","ngForOf"],[1,"resource-card"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0),n._uU(2," Select Reward: "),n.qZA(),n.TgZ(3,"div",1)(4,"div",2),n.YNc(5,Tm,2,3,"div",3),n.qZA()(),n.TgZ(6,"div",4)(7,"button",5),n.NdJ("click",function(){return u.confirmResources(u.data)}),n._uU(8," Confirm "),n.qZA()()()),2&a&&(n.xp6(5),n.Q6J("ngForOf",u.resourceGroups),n.xp6(2),n.Q6J("disabled",!u.data.selectedRewardGroup))},dependencies:[Ie,yt,Ot],styles:[".reources-rewards[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:20px 10px}.resource-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid gray;margin:0 20px;cursor:pointer;width:120px}.resource-column.selected[_ngcontent-%COMP%]{border:1px solid gold;margin:0 20px}.resource-card[_ngcontent-%COMP%]{text-align:center;margin:10px}"]})}return r})(),Im=(()=>{class r extends mt{constructor(o,a,u){super(),this.players=o,this.apiProvider=a,this.events=u}ngOnInit(){const a=this.data.struct.generator?.generateReward?.();a&&(this.reward=a,this.description=a.description)}closePopup(){this.reward.onAccept({playersApi:this.apiProvider.getPlayerApi(),spellsApi:this.apiProvider.getSpellsApi(),visitingPlayer:this.players.getCurrentPlayer()});const o=this.data.struct.actionPoints;o&&this.events.dispatch(yo({points:o})),this.close()}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be),n.Y36(Cr),n.Y36(Ze))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-scripted-reward-popup"]],features:[n.qOj],decls:9,vars:1,consts:[["popupHeader",""],["popupContent",""],[2,"padding","10px 8px"],["popupButtons",""],["mw-main-button","",3,"click"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0),n._uU(2," Victory! "),n.qZA(),n.TgZ(3,"div",1)(4,"div",2),n._uU(5),n.qZA()(),n.TgZ(6,"div",3)(7,"button",4),n.NdJ("click",function(){return u.closePopup()}),n._uU(8,"Continue"),n.qZA()()()),2&a&&(n.xp6(5),n.Oqu(u.description))},dependencies:[yt,Ot]})}return r})();const Em=r=>({thisStruct:r});function Pm(r,l){if(1&r&&(n.TgZ(0,"div",8),n._UZ(1,"mw-description",9),n.qZA()),2&r){const o=n.oxw();let a;n.xp6(1),n.Q6J("descriptions",null==o.data.struct.generator||null==(a=o.data.struct.generator.description(n.VKq(1,Em,o.data.struct)))?null:a.descriptions)}}function Yl(r,l){if(1&r&&(n.TgZ(0,"div",14)(1,"div"),n._uU(2),n.qZA(),n.TgZ(3,"div"),n._uU(4),n.qZA()()),2&r){const o=l.$implicit;n.xp6(2),n.Oqu(o.key),n.xp6(2),n.Oqu(o.value)}}function gw(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",10)(1,"div"),n._uU(2),n.qZA(),n.TgZ(3,"div"),n._uU(4,"to"),n.qZA(),n.TgZ(5,"div"),n._uU(6),n.ALo(7,"entity"),n.qZA(),n.TgZ(8,"input",11),n.NdJ("input",function(u){const m=n.CHM(o).$implicit,_=n.oxw();return n.KtG(_.updateCountForGroup(m,u))}),n.qZA(),n.TgZ(9,"div"),n._uU(10,"Cost:"),n.qZA(),n.TgZ(11,"div",12),n.YNc(12,Yl,5,2,"div",13),n.ALo(13,"keyvalue"),n.qZA()()}if(2&r){const o=l.$implicit;n.xp6(2),n.AsE("",o.originalGroup.count," ",o.originalGroup.type.name,""),n.xp6(4),n.AsE("",o.count," ",n.lcZ(7,8,o.hire.unitTypeId).name,""),n.xp6(2),n.Q6J("min",0)("max",o.hire.maxCount)("value",0),n.xp6(4),n.Q6J("ngForOf",n.lcZ(13,10,o.currentCost))}}let Fp=(()=>{class r extends mt{constructor(o,a,u){super(),this.apiProvider=o,this.playersService=a,this.unitGroups=u,this.canConfirm=!0}ngOnInit(){this.hiredGroups=this.data.struct.reward.getUnits(this.apiProvider.getPlayerApi()).map(o=>{const a={},u={},h=o.type.upgradeDetails?.upgradeCost;return[Je.Gems,Je.Gold,Je.RedCrystals,Je.Wood].forEach(_=>{h[_]&&(a[_]=h[_],u[_]=0)}),{hire:{maxCount:o.count,unitTypeId:o.type.upgradeDetails?.target},count:0,baseCost:a,currentCost:u,originalGroup:o}})}updateCountForGroup(o,a){o.count=Number(a.target.value),this.playersService.getCurrentPlayer(),this.canConfirm=!0,Object.entries(o.baseCost).forEach(([h,m])=>{o.currentCost[h]=m*o.count}),this.updateCanConfirm()}cancel(){this.close()}confirmHire(){const o=this.playersService.getCurrentPlayer(),a=o.resources,u=this.calcTotalCosts();Object.entries(u).forEach(([h,m])=>{a[h]-=m}),this.hiredGroups.forEach(h=>{if(h.count){this.playersService.removeNUnitsFromGroup(o,h.originalGroup,h.count);const m=this.unitGroups.createUnitGroup(h.hire.unitTypeId,{count:h.count},o.hero);this.playersService.addUnitGroupToTypeStack(o,m)}}),this.close()}calcTotalCosts(){return this.hiredGroups.reduce((o,a)=>(Object.entries(a.currentCost).forEach(([u,h])=>{const m=u;o[m]?o[m]+=a.currentCost[m]:o[m]=a.currentCost[m]}),o),{})}updateCanConfirm(){const o=this.playersService.getCurrentPlayer().resources,a=this.calcTotalCosts();this.canConfirm=Object.entries(a).every(([u,h])=>o[u]>=h)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(Cr),n.Y36(be),n.Y36(Dn))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-upgrade-reward-popup"]],features:[n.qOj],decls:12,vars:4,consts:[["popupHeader",""],["popupContent",""],["class","description",4,"ngIf"],[1,"units"],["class","unit-column",4,"ngFor","ngForOf"],["popupButtons",""],["mw-main-button","",3,"disabled","click"],["mw-main-button","",3,"click"],[1,"description"],[3,"descriptions"],[1,"unit-column"],["type","range",3,"min","max","value","input"],[1,"cost"],["class","resource",4,"ngFor","ngForOf"],[1,"resource"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0),n._uU(2),n.qZA(),n.TgZ(3,"div",1),n.YNc(4,Pm,2,3,"div",2),n.TgZ(5,"div",3),n.YNc(6,gw,14,12,"div",4),n.qZA()(),n.TgZ(7,"div",5)(8,"button",6),n.NdJ("click",function(){return u.confirmHire()}),n._uU(9," Confirm "),n.qZA(),n.TgZ(10,"button",7),n.NdJ("click",function(){return u.cancel()}),n._uU(11," Cancel "),n.qZA()()()),2&a&&(n.xp6(2),n.hij(" ",null==u.data.struct.generator?null:u.data.struct.generator.name," "),n.xp6(2),n.Q6J("ngIf",null==u.data.struct.generator?null:u.data.struct.generator.description),n.xp6(2),n.Q6J("ngForOf",u.hiredGroups),n.xp6(2),n.Q6J("disabled",!u.canConfirm))},dependencies:[Ie,rt,Po,yt,Ot,Fn,Ra],styles:[".units[_ngcontent-%COMP%]{display:flex;justify-content:center}.description[_ngcontent-%COMP%]{text-align:center;font-size:13px;padding:7px}.unit-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid gray;padding:10px;margin:6px;width:160px;align-items:center;font-size:13px}.cost[_ngcontent-%COMP%]{display:flex}.resource[_ngcontent-%COMP%]{border:1px solid gray;border-radius:4px;padding:7px}"]})}return r})(),Ql=(()=>{class r{constructor(o,a){this.hostElem=o,this.renderer=a,this.hideEmpty=!0,this.renderer.addClass(this.hostElem.nativeElement,"mod-text")}ngOnDestroy(){this.renderer.removeClass(this.hostElem.nativeElement,"mod-text")}ngOnChanges(){const o=this.hostElem.nativeElement;this.hideEmpty&&!this.value||"number"!=typeof this.value?o.innerHTML="":(o.innerHTML=(this.value>0?"+":"")+this.value,this.renderer.setStyle(o,"color",this.value<0?"red":"lime"))}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.SBq),n.Y36(n.Qsj))};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","mwNumberModifier",""]],inputs:{value:["mwNumberModifier","value"],hideEmpty:"hideEmpty"},features:[n.TTD]})}return r})();const Am=(r,l)=>({color:r,background:l});function mw(r,l){if(1&r&&(n.TgZ(0,"div",5)(1,"div",6)(2,"div",7),n._UZ(3,"mw-ra-icon",2),n.qZA(),n.TgZ(4,"div",8)(5,"div",9),n._uU(6),n.qZA(),n.TgZ(7,"div",10),n._uU(8),n.qZA(),n.TgZ(9,"div",10),n._uU(10),n.qZA()()(),n.TgZ(11,"div",11),n._UZ(12,"mw-spell-description",12),n.qZA()()),2&r){const o=n.oxw();n.xp6(2),n.Q6J("ngStyle",n.WLB(8,Am,o.spell.baseType.icon.iconClr,o.spell.baseType.icon.bgClr)),n.xp6(1),n.Q6J("icon",o.spell.baseType.icon.icon),n.xp6(3),n.Oqu(o.spell.name),n.xp6(2),n.hij("Level: ",o.spell.currentLevel,""),n.xp6(2),n.hij("Mana Cost: ",o.spell.currentManaCost,""),n.xp6(2),n.Q6J("spell",o.spell)("player",o.player)("hero",o.hero)}}let Wl=(()=>{class r{constructor(){this.onCooldown=!1,this.disabled=!1,this.isActive=!1,this.hintPos="above",this.clicked=new n.vpe,this.activationTypes=se}onClick(){this.clicked.emit(this.spell)}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-spell-button"]],inputs:{spell:"spell",onCooldown:"onCooldown",disabled:"disabled",isActive:"isActive",player:"player",hero:"hero",hintPos:"hintPos"},outputs:{clicked:"clicked"},decls:6,vars:13,consts:[[3,"hintBody","hintPos"],[1,"ability","spell-icon",3,"ngStyle","click"],[3,"icon"],[1,"ra","light"],["hint",""],[2,"min-width","170px","max-width","200px"],[2,"display","flex"],[1,"tooltip-icon",3,"ngStyle"],[2,"padding","4px"],[2,"font-size","14px"],[2,"font-size","12px"],[2,"font-size","12px","padding","4px"],[3,"spell","player","hero"]],template:function(a,u){if(1&a&&(n.TgZ(0,"mw-hover-hint",0)(1,"div",1),n.NdJ("click",function(){return u.onClick()}),n._UZ(2,"mw-ra-icon",2)(3,"i",3),n.qZA(),n.YNc(4,mw,13,11,"ng-template",null,4,n.W1O),n.qZA()),2&a){const h=n.MAs(5);n.Q6J("hintBody",h)("hintPos",u.hintPos),n.xp6(1),n.ekj("disabled",u.disabled)("current-ability",u.isActive&&u.spell.baseType.activationType===u.activationTypes.Target),n.Q6J("ngStyle",n.WLB(10,Am,u.spell.baseType.icon.iconClr,u.spell.baseType.icon.bgClr)),n.xp6(1),n.Q6J("icon",u.spell.baseType.icon.icon),n.xp6(1),n.Tol("ra-"+u.spell.baseType.icon.icon)}},styles:["[_nghost-%COMP%]{display:block;max-width:56px}.ability[_ngcontent-%COMP%]{width:48px;height:42px;border:1px solid gray;font-size:13px;display:flex;justify-content:center;align-items:center;border-radius:4px;margin:4px;cursor:pointer}.current-ability[_ngcontent-%COMP%]{border:1px solid gold}.disabled[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.5}.spell-icon[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;font-size:42px;overflow:hidden}.tooltip-icon[_ngcontent-%COMP%]{height:32px;width:32px;overflow:hidden;font-size:28px;display:flex;align-items:center;justify-content:center}.light[_ngcontent-%COMP%]{position:absolute;mix-blend-mode:hard-light;filter:blur(4px);display:none}.ability[_ngcontent-%COMP%]:not(.no-mana):not(.disabled):hover   .light[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]:active   .spell-icon[_ngcontent-%COMP%], .spell-icon.current-ability[_ngcontent-%COMP%]{filter:brightness(.65)}"]})}return r})();function yw(r,l){1&r&&n._UZ(0,"mw-item-slot",18),2&r&&n.Q6J("itemSlot",l.$implicit)}function vw(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",20),n.NdJ("mwNoContextMenu",function(){n.CHM(o);const u=n.oxw().$implicit,h=n.oxw(2);return n.KtG(h.splitGroup(u))})("click",function(){n.CHM(o);const u=n.oxw().$implicit,h=n.oxw(2);return n.KtG(h.clickOnSlot(u))}),n.TgZ(1,"span"),n._uU(2),n.qZA(),n.TgZ(3,"span"),n._uU(4),n.qZA()()}if(2&r){const o=n.oxw().$implicit,a=n.oxw(2);n.Udp("background",o.unitGroup.ownerPlayer.color),n.ekj("active",o===a.activeGroupSlot),n.xp6(2),n.Oqu(o.unitGroup.type.name),n.xp6(2),n.Oqu(o.unitGroup.count)}}function _w(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",20),n.NdJ("mwNoContextMenu",function(){n.CHM(o);const u=n.oxw().$implicit,h=n.oxw(2);return n.KtG(h.splitGroup(u))})("click",function(){n.CHM(o);const u=n.oxw().$implicit,h=n.oxw(2);return n.KtG(h.clickOnSlot(u))}),n.qZA()}}function Cw(r,l){1&r&&n.YNc(0,vw,5,6,"div",19)(1,_w,1,0),2&r&&n.um2(0,l.$implicit.unitGroup?0:1)}function ww(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",22),n.NdJ("mwNoContextMenu",function(){n.CHM(o);const u=n.oxw().$implicit,h=n.oxw(2);return n.KtG(h.splitGroup(u))})("click",function(){n.CHM(o);const u=n.oxw().$implicit,h=n.oxw(2);return n.KtG(h.clickOnSlot(u))}),n.TgZ(1,"span"),n._uU(2),n.qZA(),n.TgZ(3,"span"),n._uU(4),n.qZA()()}if(2&r){const o=n.oxw().$implicit,a=n.oxw(2);n.Udp("background",o.unitGroup.ownerPlayer.color),n.ekj("active",o===a.activeGroupSlot),n.xp6(2),n.Oqu(o.unitGroup.type.name),n.xp6(2),n.Oqu(o.unitGroup.count)}}function bw(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",22),n.NdJ("mwNoContextMenu",function(){n.CHM(o);const u=n.oxw().$implicit,h=n.oxw(2);return n.KtG(h.splitGroup(u))})("click",function(){n.CHM(o);const u=n.oxw().$implicit,h=n.oxw(2);return n.KtG(h.clickOnSlot(u))}),n.qZA()}}function Rp(r,l){1&r&&n.YNc(0,ww,5,6,"div",21)(1,bw,1,0),2&r&&n.um2(0,l.$implicit.unitGroup?0:1)}function Mw(r,l){if(1&r&&(n.TgZ(0,"div")(1,"div"),n._uU(2),n.qZA()()),2&r){const o=l.$implicit;n.xp6(2),n.Oqu(o)}}function P1(r,l){if(1&r&&(n.ynx(0),n.YNc(1,Mw,3,1,"div",25),n.BQk()),2&r){const o=n.oxw().ngIf;n.xp6(1),n.Q6J("ngForOf",o)}}function A1(r,l){1&r&&(n.TgZ(0,"div"),n._uU(1,"No specialties"),n.qZA())}function Dw(r,l){if(1&r&&(n.ynx(0),n.YNc(1,P1,2,1,"ng-container",23)(2,A1,2,0,"ng-template",null,24,n.W1O),n.BQk()),2&r){const o=l.ngIf,a=n.MAs(3);n.xp6(1),n.Q6J("ngIf",o.length)("ngIfElse",a)}}function Sw(r,l){if(1&r&&(n.TgZ(0,"div",15),n._UZ(1,"mw-spell-button",26),n.TgZ(2,"div",27),n._uU(3),n.qZA()()),2&r){const o=l.$implicit,a=n.oxw(2);n.xp6(1),n.Q6J("spell",o)("player",a.currentPlayer)("hero",a.currentPlayer.hero),n.xp6(2),n.hij(" ",o.baseType.name," ")}}function O1(r,l){if(1&r&&(n.ynx(0),n.TgZ(1,"div",4)(2,"div",5)(3,"div"),n._uU(4," Your items: "),n.qZA(),n.TgZ(5,"div",6),n.YNc(6,yw,1,1,"mw-item-slot",7),n.qZA()(),n.TgZ(7,"div",8)(8,"div"),n._uU(9),n.qZA(),n.TgZ(10,"div"),n._uU(11),n.qZA(),n._UZ(12,"mw-experience-bar",9),n.TgZ(13,"div",10),n.SjG(14,Cw,2,1,null,null,n.ikw),n.qZA(),n._uU(16," Reserve: "),n.TgZ(17,"div",10),n.SjG(18,Rp,2,1,null,null,n.ikw),n.qZA()()(),n.TgZ(20,"div",11)(21,"div"),n._uU(22,"Resistances:"),n.qZA(),n.TgZ(23,"div"),n._uU(24," Fire: "),n._UZ(25,"span",12),n.qZA(),n.TgZ(26,"div"),n._uU(27," Cold: "),n._UZ(28,"span",12),n.qZA(),n.TgZ(29,"div"),n._uU(30," Lightning: "),n._UZ(31,"span",12),n.qZA(),n.TgZ(32,"div"),n._uU(33," Poison: "),n._UZ(34,"span",12),n.qZA(),n._UZ(35,"hr"),n.TgZ(36,"div",13),n._uU(37," Specialties: "),n.YNc(38,Dw,4,2,"ng-container",1),n.ALo(39,"async"),n.qZA(),n._UZ(40,"hr"),n.TgZ(41,"div",14),n._uU(42,"Spells:"),n.qZA(),n.TgZ(43,"div",15)(44,"div",16),n.YNc(45,Sw,4,4,"div",17),n.qZA()()(),n.BQk()),2&r){const o=l.ngIf,a=n.oxw();n.xp6(6),n.Q6J("ngForOf",a.itemSlots),n.xp6(3),n.Oqu(a.hero.base.name),n.xp6(2),n.hij("Level ",a.hero.level,""),n.wJu(14,a.hero.mainUnitSlots),n.wJu(18,a.hero.reserveUnitSlots),n.xp6(14),n.Q6J("mwNumberModifier",o.fireResist)("hideEmpty",!1),n.xp6(3),n.Q6J("mwNumberModifier",o.coldResist)("hideEmpty",!1),n.xp6(3),n.Q6J("mwNumberModifier",o.lightningResist)("hideEmpty",!1),n.xp6(3),n.Q6J("mwNumberModifier",o.poisonResist)("hideEmpty",!1),n.xp6(4),n.Q6J("ngIf",n.lcZ(39,13,a.heroSpecialties$)),n.xp6(7),n.Q6J("ngForOf",a.currentPlayer.hero.spells)}}let Om=(()=>{class r extends mt{constructor(o,a,u,h){super(),this.playersService=o,this.state=a,this.curPlayerState=u,this.events=h,this.currentPlayer=this.playersService.getCurrentPlayer(),this.hero=this.currentPlayer.hero,this.heroStats$=this.hero.listenHeroStats(),this.itemSlots=wo.getSlotTypes(),this.heroSpecialties$=this.hero.specialtiesModGroup.onValueChanges().pipe((0,rs.U)(m=>(0,os.Cg)(m).filter(([,_])=>_).map(([_,b])=>`${ot.j$[_]}: ${b}`)))}splitGroup(o){this.activeGroupSlot=void 0,o.unitGroup&&1!==o.unitGroup.count&&this.hero.hasFreeUnitSlots()&&this.events.dispatch(Lr({unitGroup:o.unitGroup}))}clickOnSlot(o){if(this.activeGroupSlot){if(this.activeGroupSlot){if(this.activeGroupSlot===o)return void(this.activeGroupSlot=void 0);if(o.unitGroup){if(o.unitGroup.type===this.activeGroupSlot.unitGroup?.type)return void this.events.dispatch(qs({sourceSlot:this.activeGroupSlot,targetSlot:o,postAction:()=>{this.activeGroupSlot=void 0,this.hero.refreshUnitGroupsOrderBySlots()}}));Jg(this.activeGroupSlot,o),this.activeGroupSlot=void 0}else{const a=this.hero.mainUnitSlots.filter(u=>u.unitGroup).length;if(!this.activeGroupSlot.isReserve&&o.isReserve&&1===a)return void(this.activeGroupSlot=void 0);o.unitGroup=this.activeGroupSlot.unitGroup,this.activeGroupSlot.unitGroup=null,this.activeGroupSlot=void 0}this.hero.refreshUnitGroupsOrderBySlots()}}else o.unitGroup&&(this.activeGroupSlot=o)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be),n.Y36(ft),n.Y36(Ut),n.Y36(Ze))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-hero-popup"]],features:[n.qOj],decls:7,vars:3,consts:[["popupContent",""],[4,"ngIf"],["popupButtons","",2,"justify-content","end"],["mw-main-button","",3,"click"],[1,"hero-panel"],[1,"items"],[2,"display","flex","flex-direction","column"],[3,"itemSlot",4,"ngFor","ngForOf"],[1,"info"],[2,"width","270px"],[1,"unit-groups-slots"],[1,"stats-panel"],[3,"mwNumberModifier","hideEmpty"],[1,"specialties"],[2,"margin-bottom","5px","text-align","center"],[2,"display","flex","flex-direction","column","align-items","center"],[2,"display","flex","flex-wrap","wrap","justify-content","center","gap","4px"],["style","display: flex; flex-direction: column; align-items: center;",4,"ngFor","ngForOf"],[3,"itemSlot"],["class","unit-slot",3,"active","background"],[1,"unit-slot",3,"mwNoContextMenu","click"],["class","unit-slot reserve",3,"active","background"],[1,"unit-slot","reserve",3,"mwNoContextMenu","click"],[4,"ngIf","ngIfElse"],["noSpecialties",""],[4,"ngFor","ngForOf"],[3,"spell","player","hero"],[2,"font-size","10px","text-align","center"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0),n.YNc(2,O1,46,15,"ng-container",1),n.ALo(3,"async"),n.qZA(),n.TgZ(4,"div",2)(5,"button",3),n.NdJ("click",function(){return u.close()}),n._uU(6," Close "),n.qZA()()()),2&a&&(n.xp6(2),n.Q6J("ngIf",n.lcZ(3,1,u.heroStats$)))},dependencies:[Ql,ss,qn,yt,Ot,Cp,Ie,rt,Wl,Zo],styles:[".buttons[_ngcontent-%COMP%]{margin-top:16px;display:flex;justify-content:flex-end}[_nghost-%COMP%]{width:500px}.hero-panel[_ngcontent-%COMP%]{text-align:left;display:flex}.items[_ngcontent-%COMP%]{margin-right:16px;font-size:10px}.info[_ngcontent-%COMP%]{font-size:12px}.unit-groups-slots[_ngcontent-%COMP%]{display:flex;padding-top:6px;gap:4px;text-align:center}.unit-groups-slots[_ngcontent-%COMP%]   .unit-slot[_ngcontent-%COMP%]{display:flex;justify-content:center;color:#fff;flex-direction:column;cursor:pointer;width:52px;height:52px;border:1px solid gray;box-sizing:border-box;border-radius:4px;-webkit-user-select:none;user-select:none}.unit-groups-slots[_ngcontent-%COMP%]   .unit-slot.reserve[_ngcontent-%COMP%]{width:40px;height:40px;font-size:10px;filter:brightness(.8)}.unit-groups-slots[_ngcontent-%COMP%]   .unit-slot.active[_ngcontent-%COMP%]{border-color:gold;border-width:2px}.stats-panel[_ngcontent-%COMP%]{position:absolute;right:-160px;box-sizing:border-box;top:0;background:white;font-size:13px;padding:6px 8px;width:150px}"]})}return r})(),k1=(()=>{class r{constructor(o){this.events=o}openNewGameScreen(){this.events.dispatch(Gc())}openSettings(){this.events.dispatch(Br())}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(Ze))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-main-screen"]],decls:7,vars:0,consts:[[1,"block"],["mw-main-button","",3,"click"]],template:function(a,u){1&a&&(n.TgZ(0,"div",0),n._uU(1," Mirrorwalk "),n.TgZ(2,"div")(3,"button",1),n.NdJ("click",function(){return u.openNewGameScreen()}),n._uU(4," New Game "),n.qZA(),n.TgZ(5,"button",1),n.NdJ("click",function(){return u.openSettings()}),n._uU(6," Settings "),n.qZA()()())},dependencies:[yt],styles:["[_nghost-%COMP%]{display:block;position:relative}.block[_ngcontent-%COMP%]{position:fixed;right:0;bottom:0;width:250px;height:200px;padding:20px}[mw-main-button][_ngcontent-%COMP%]{width:100%}"]})}return r})();function Tw(r,l){if(1&r){const o=n.EpF();n.ynx(0),n.TgZ(1,"div")(2,"input",5),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw();return n.KtG(m.setOrientation(h.value))}),n.qZA(),n.TgZ(3,"label",6),n._uU(4),n.qZA()(),n.BQk()}if(2&r){const o=l.$implicit,a=n.oxw();n.xp6(2),n.Q6J("id","orient-"+o.value)("value",o.value)("checked",a.settings.orientation===o.value),n.xp6(1),n.Q6J("for","orient-"+o.value),n.xp6(1),n.Oqu(o.label)}}let xw=(()=>{class r extends mt{constructor(o){super(),this.state=o,this.orientation=x.hJ,this.orientationOptions=[{label:"Vertical",value:x.hJ.Vertical},{label:"Horizontal",value:x.hJ.Horizontal}],this.settings=this.state.settings}setOrientation(o){this.state.settings.orientation=o}loadScript(){M.e(697).then(M.bind(M,697)).then(o=>{console.log("loaded script successfully!",o)})}loadScriptByPath(){var o=document.createElement("input");o.type="file",o.multiple=!0,o.onchange=a=>{var u=a.target.files[0];console.log(u);var h=new FileReader;h.readAsText(u),h.onload=m=>{var _=m.target.result;console.log(_);var b=document.createElement("script");b.innerHTML=_,b.setAttribute("type","module"),document.head.appendChild(b)}},o.click()}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(ft))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-settings-popup"]],features:[n.qOj],decls:12,vars:1,consts:[["popupHeader",""],["popupContent",""],[4,"ngFor","ngForOf"],["mw-main-button","",3,"click"],["popupButtons",""],["type","radio","name","orientation",3,"id","value","checked","click"],[3,"for"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0),n._uU(2," Units Orientation "),n.qZA(),n.TgZ(3,"div",1),n.YNc(4,Tw,5,5,"ng-container",2),n.TgZ(5,"button",3),n.NdJ("click",function(){return u.loadScriptByPath()}),n._uU(6," Load Script By Path "),n.qZA(),n.TgZ(7,"button",3),n.NdJ("click",function(){return u.loadScript()}),n._uU(8," Load Mod "),n.qZA()(),n.TgZ(9,"div",4)(10,"button",3),n.NdJ("click",function(){return u.close()}),n._uU(11," Close "),n.qZA()()()),2&a&&(n.xp6(4),n.Q6J("ngForOf",u.orientationOptions))},dependencies:[Ie,yt,Ot]})}return r})();function Iw(r,l){if(1&r&&(n.TgZ(0,"span"),n._uU(1," ("),n.TgZ(2,"span",9),n._uU(3),n.qZA(),n._uU(4,") "),n.qZA()),2&r){const o=n.oxw().$implicit,a=n.oxw();n.xp6(3),n.hij("-",a.missingCostMap[o.type],"")}}function Up(r,l){if(1&r&&(n.TgZ(0,"div"),n._uU(1),n.YNc(2,Iw,5,1,"span",5),n.qZA()),2&r){const o=l.$implicit,a=n.oxw();n.xp6(1),n.AsE(" ",o.count," ",o.resName," "),n.xp6(1),n.Q6J("ngIf",a.missingCostMap[o.type])}}function Ua(r,l){1&r&&(n.TgZ(0,"div"),n._uU(1," You don't have enough resources. "),n.qZA())}let La=(()=>{class r extends mt{constructor(o,a,u){super(),this.players=o,this.events=a,this.state=u,this.buildingLevel=this.data.building.base.levels[this.data.targetLevel-1];const m=this.getBuildingCost();this.cost=bl(m),this.missingCostMap=this.players.getMissingResources(this.players.getCurrentPlayer(),m),this.canBuild=this.players.playerHasResources(this.players.getCurrentPlayer(),m)}build(){const o=this.data.building;1===this.data.targetLevel?o.built=!0:(o.currentLevel=this.data.targetLevel-1,o.currentBuilding=o.base.levels[this.data.targetLevel-1].building),this.events.dispatch(vh({building:o,player:this.players.getCurrentPlayer()})),this.players.removeResourcesFromPlayer(this.players.getCurrentPlayer(),this.getBuildingCost()),this.state.eventHandlers.buildings.triggerRefEventHandlers(this.data.building,ym.Built()),this.close()}getBuildingCost(){return this.buildingLevel.cost}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be),n.Y36(Ze),n.Y36(ft))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-build-popup"]],features:[n.qOj],decls:15,vars:7,consts:[["popupHeader",""],[2,"display","block","font-size","40px","margin","8px 0",3,"icon"],["popupContent",""],[2,"padding-bottom","8px"],[4,"ngFor","ngForOf"],[4,"ngIf"],["popupButtons",""],["mw-main-button","",3,"disabled","click"],["mw-main-button","",3,"click"],[2,"color","red"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0),n._uU(2),n._UZ(3,"mw-ra-icon",1),n.qZA(),n.TgZ(4,"div",2)(5,"div",3),n._uU(6),n.qZA(),n.TgZ(7,"div"),n.YNc(8,Up,3,3,"div",4),n.qZA(),n.YNc(9,Ua,2,0,"div",5),n.qZA(),n.TgZ(10,"div",6)(11,"button",7),n.NdJ("click",function(){return u.build()}),n._uU(12,"Build"),n.qZA(),n.TgZ(13,"button",8),n.NdJ("click",function(){return u.close()}),n._uU(14,"Close"),n.qZA()()()),2&a&&(n.xp6(2),n.AsE(" Build: ",u.data.building.currentBuilding.name,", level ",u.data.targetLevel," "),n.xp6(1),n.Q6J("icon",u.data.building.base.icon),n.xp6(3),n.hij(" ",u.buildingLevel.building.description," "),n.xp6(2),n.Q6J("ngForOf",u.cost),n.xp6(1),n.Q6J("ngIf",!u.canBuild),n.xp6(2),n.Q6J("disabled",!u.canBuild))},dependencies:[Ie,rt,lt,yt,Ot],styles:["[_nghost-%COMP%]{text-align:center;display:flex;flex-direction:column;font-size:14px;color:wheat}[popupButtons][_ngcontent-%COMP%]{padding-top:8px}"]})}return r})();function Jl(r,l){if(1&r&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&r){const o=l.$implicit;n.xp6(1),n.AsE("",o.key,": ",o.value,"")}}let Kl=(()=>{class r{constructor(){this.capitalize=!0}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-resources-cost"]],hostVars:2,hostBindings:function(a,u){2&a&&n.ekj("capitalize",u.capitalize)},inputs:{cost:"cost",capitalize:"capitalize"},decls:3,vars:2,template:function(a,u){1&a&&(n.SjG(0,Jl,2,2,"span",null,n.ikw),n.ALo(2,"keyvalue")),2&a&&n.wJu(0,n.lcZ(2,0,u.cost))},dependencies:[Fn],styles:[".capitalize[_nghost-%COMP%]{text-transform:capitalize}"]})}return r})();function Ga(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",11),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw().$implicit,_=n.oxw();return n.KtG(_.selectItem(h,m.value))}),n._UZ(1,"mw-unit-group-preview",12)(2,"hr")(3,"mw-resources-cost",13),n.qZA()}if(2&r){const o=l.$implicit,a=n.oxw(2);n.ekj("selected",a.selectedGroup===o),n.xp6(1),n.Q6J("unitType",o.type)("count",o.count),n.xp6(2),n.Q6J("cost",o.cost)}}function km(r,l){if(1&r&&(n.TgZ(0,"div",8)(1,"div",9),n._uU(2),n.qZA(),n.TgZ(3,"div",10),n.SjG(4,Ga,4,5,"div",14,n.ikw),n.qZA()()),2&r){const o=l.$implicit;n.xp6(2),n.Oqu(o.value.name),n.wJu(4,o.value.groups)}}function Ew(r,l){1&r&&(n.TgZ(0,"span"),n._uU(1,"You don't have enough resources"),n.qZA())}let _s=(()=>{class r extends mt{constructor(){super(...arguments),this.players=(0,n.f3M)(be),this.unitsService=(0,n.f3M)(Dn),this.events=(0,n.f3M)(Ze),this.currentPlayer=this.players.getCurrentPlayer(),this.canHire=!0}selectItem(o,a){this.selectedGroup=o,this.selectedGarrison=a,this.canHire=this.players.playerHasResources(this.currentPlayer,o.cost)}hire(){if(!this.selectedGroup||!this.selectedGarrison||!this.canHire)return;const o=this.selectedGroup;Te.DN.removeItem(this.selectedGarrison.groups,o),this.players.removeResourcesFromPlayer(this.currentPlayer,o.cost);const a=this.unitsService.createUnitGroup(o.type.id,{count:o.count},this.currentPlayer.hero);this.players.addUnitGroupToTypeStack(this.currentPlayer,a),this.events.dispatch(nr({message:`${o.count} ${o.type.name} joined your army for 3 days.`})),this.events.dispatch(Lc({action:()=>{const u=this.players.removeUnitTypeCountFromPlayer(this.currentPlayer,o.type.id,o.count);u&&this.events.dispatch(nr({message:`${u} ${o.type.name} have left your army.`}))},dayOffset:3})),this.selectedGarrison=void 0,this.selectedGroup=void 0}static#e=this.\u0275fac=(()=>{let o;return function(u){return(o||(o=n.n5z(r)))(u||r)}})();static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-garrison-popup"]],features:[n.qOj],decls:18,vars:5,consts:[["popupHeader",""],["popupContent",""],[1,"sub-info"],["class","hiring-section",4,"ngFor","ngForOf"],["popupButtons",""],["mw-main-button","",3,"disabled","click"],["icon","guarded-tower"],["mw-main-button","",3,"click"],[1,"hiring-section"],[1,"header"],[1,"groups"],[1,"group",3,"click"],[3,"unitType","count"],[3,"cost"],["class","group",3,"selected"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0),n._uU(2,"Garrison"),n.qZA(),n.TgZ(3,"div",1)(4,"div",2)(5,"p"),n._uU(6,"Hire units temporarily (3 days) for reduced cost."),n.qZA(),n.TgZ(7,"p"),n._uU(8,"Garrison is reset each week."),n.qZA()(),n.YNc(9,km,6,1,"div",3),n.ALo(10,"keyvalue"),n.YNc(11,Ew,2,0,"span"),n.qZA(),n.TgZ(12,"div",4)(13,"button",5),n.NdJ("click",function(){return u.hire()}),n._UZ(14,"mw-ra-icon",6),n._uU(15," Hire "),n.qZA(),n.TgZ(16,"button",7),n.NdJ("click",function(){return u.close()}),n._uU(17," Leave "),n.qZA()()()),2&a&&(n.xp6(9),n.Q6J("ngForOf",n.lcZ(10,3,u.currentPlayer.garrisons)),n.xp6(2),n.um2(11,u.canHire?-1:11),n.xp6(2),n.Q6J("disabled",!u.selectedGroup||!u.canHire))},dependencies:[Ie,Kl,vr,lt,yt,Ot,Fn],styles:[".hiring-section[_ngcontent-%COMP%]{padding-top:8px}.groups[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:8px}.groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{width:70px;font-size:13px;padding:3px 4px;-webkit-user-select:none;user-select:none;border:1px solid black;cursor:pointer}.groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]{padding-bottom:4px}.groups[_ngcontent-%COMP%]   .group.selected[_ngcontent-%COMP%]{border:1px solid gold}[popupButtons][_ngcontent-%COMP%]{padding-top:8px}"]})}return r})();function Nm(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",4),n.NdJ("click",function(){n.CHM(o);const u=n.oxw();return n.KtG(u.setMode("upgrade"))}),n._uU(1),n.qZA()}if(2&r){const o=n.oxw();n.ekj("active","upgrade"===o.currentMode),n.xp6(1),n.hij(" Upgrade: ",o.countToUpgrade-o.plannedToUpgrade," ")}}function Pw(r,l){if(1&r&&(n.TgZ(0,"div",16)(1,"div"),n._uU(2),n.qZA(),n.TgZ(3,"div"),n._uU(4),n.qZA()()),2&r){const o=l.$implicit;n.xp6(2),n.Oqu(o.key),n.xp6(2),n.Oqu(o.value)}}function Fm(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",12)(1,"div"),n._uU(2),n.qZA(),n.TgZ(3,"div"),n._uU(4),n.qZA(),n.TgZ(5,"input",13),n.NdJ("input",function(u){const m=n.CHM(o).$implicit,_=n.oxw();return n.KtG(_.updateCountForGroup(m,u))}),n.qZA(),n.TgZ(6,"div"),n._uU(7,"Cost:"),n.qZA(),n.TgZ(8,"div",14),n.YNc(9,Pw,5,2,"div",15),n.ALo(10,"keyvalue"),n.qZA()()}if(2&r){const o=l.$implicit;n.xp6(2),n.Oqu(o.hire.unitType.name),n.xp6(2),n.Oqu(o.count),n.xp6(1),n.Q6J("min",0)("max",o.hire.maxCount)("value",0),n.xp6(4),n.Q6J("ngForOf",n.lcZ(10,6,o.currentCost))}}function Xl(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"button",17),n.NdJ("click",function(){n.CHM(o);const u=n.oxw();return n.KtG(u.upgradeBuilding())}),n._uU(1," Upgrade Building "),n.qZA()}}let Rm=(()=>{class r extends mt{constructor(o,a,u,h){super(),this.playersService=o,this.unitsService=a,this.popupService=u,this.gameObjectsManager=h,this.hirableGroups=[],this.canConfirm=!0,this.plannedToHire=0,this.plannedToUpgrade=0,this.currentMode="hire",this.unitType=Di(this.data.hiringActivity.hiring.unitTypeId),this.activity=this.data.hiringActivity,this.currentBuilding=this.data.building.currentBuilding,this.canBeUpgraded=this.data.building.base.levels.length-1>this.data.building.currentLevel}ngOnInit(){console.log(this.data);const o=this.data.building.currentBuilding.activity;this.originalCountToHire=this.data.town.unitsAvailableMap[o.unitGrowthGroup],this.countToHire=this.originalCountToHire,this.activity.upgrade&&(this.countToUpgrade=this.playersService.getPlayerUnitsCountOfType(this.playersService.getCurrentPlayer(),this.activity.hiring.unitTypeId)),this.hirableGroups=this.getGroupsToHire().map(a=>{const u={},h={},m=Di(a.unitTypeId).baseRequirements;return[Je.Gems,Je.Gold,Je.RedCrystals,Je.Wood].forEach(b=>{m[b]&&(u[b]=m[b],h[b]=0)}),{hire:{maxCount:this.data.town.unitsAvailableMap[o.unitGrowthGroup],unitType:Di(a.unitTypeId)},count:0,baseCost:u,currentCost:h}})}setMode(o){if(this.currentMode===o)return;"hire"===o?this.plannedToUpgrade=0:this.plannedToHire=0,this.currentMode=o;const a=this.data.building.currentBuilding.activity;this.hirableGroups=this.getGroupsToHire().map(u=>{const h={},m={},_=Di(this.activity.hiring.unitTypeId),b="hire"===this.currentMode?Di(u.unitTypeId).baseRequirements:_.upgradeDetails.upgradeCost;return[Je.Gems,Je.Gold,Je.RedCrystals,Je.Wood].forEach(T=>{b[T]&&(h[T]=b[T],m[T]=0)}),{hire:{maxCount:"hire"===this.currentMode?this.data.town.unitsAvailableMap[a.unitGrowthGroup]:this.countToUpgrade,unitType:Di(u.unitTypeId)},count:0,baseCost:h,currentCost:m}})}getGroupsToHire(){const o=this.data.building.currentBuilding.activity,a=Di(o.hiring.unitTypeId);return"hire"===this.currentMode?o.upgrade?[o.hiring,...a.upgradeDetails?.target?[{growth:0,unitTypeId:Di(o.hiring?.unitTypeId).upgradeDetails?.target}]:[]]:[o.hiring]:[...a.upgradeDetails?.target?[{growth:0,unitTypeId:a.upgradeDetails.target}]:[]]}updateCountForGroup(o,a){o.count=Number(a.target.value),this.canConfirm=!0,Object.entries(o.baseCost).forEach(([u,h])=>{o.currentCost[u]=h*o.count}),"hire"===this.currentMode?this.plannedToHire=this.hirableGroups.reduce((u,h)=>u+h.count,0):this.plannedToUpgrade=this.hirableGroups.reduce((u,h)=>u+h.count,0),this.updateCanConfirm()}confirmHire(){const o=this.playersService.getCurrentPlayer(),a=this.calcTotalCosts();this.playersService.removeResourcesFromPlayer(o,a),this.hirableGroups.forEach("hire"===this.currentMode?u=>{if(u.count){const h=this.unitsService.createUnitGroup(u.hire.unitType.id,{count:u.count},o.hero);this.data.town.unitsAvailableMap[this.data.building.currentBuilding.activity.unitGrowthGroup]-=u.count,this.playersService.addUnitGroupToTypeStack(o,h)}}:u=>{if(u.count){this.playersService.removeUnitTypeCountFromPlayer(o,this.activity.hiring.unitTypeId,u.count);const h=this.unitsService.createUnitGroup(u.hire.unitType.id,{count:u.count},o.hero);this.playersService.addUnitGroupToTypeStack(o,h)}}),this.close()}upgradeBuilding(){this.close(),this.popupService.createBasicPopup({component:La,data:{building:this.data.building,targetLevel:2},class:"dark"})}calcTotalCosts(){return this.hirableGroups.reduce((o,a)=>(Object.entries(a.currentCost).forEach(([u,h])=>{const m=u;o[m]?o[m]+=a.currentCost[m]:o[m]=a.currentCost[m]}),o),{})}updateCanConfirm(){const o=this.calcTotalCosts();this.canConfirm=this.playersService.playerHasResources(this.playersService.getCurrentPlayer(),o)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be),n.Y36(Dn),n.Y36(Eo),n.Y36(an))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-hiring-popup"]],features:[n.qOj],decls:19,vars:9,consts:[["popupHeader",""],["popupContent",""],[1,"sub-info"],[2,"display","flex","justify-content","center"],[1,"type",3,"click"],["class","type",3,"active","click",4,"ngIf"],[1,"hiring-panel"],["class","unit-column",4,"ngFor","ngForOf"],["popupButtons",""],["mw-main-button","",3,"disabled","click"],["mw-main-button","","style","font-size: 12px;",3,"click",4,"ngIf"],["mw-main-button","",3,"click"],[1,"unit-column"],["type","range",3,"min","max","value","input"],[1,"cost"],["class","resource",4,"ngFor","ngForOf"],[1,"resource"],["mw-main-button","",2,"font-size","12px",3,"click"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0),n._uU(2),n.qZA(),n.TgZ(3,"div",1)(4,"div",2)(5,"p"),n._uU(6),n.qZA()(),n.TgZ(7,"div",3)(8,"div",4),n.NdJ("click",function(){return u.setMode("hire")}),n._uU(9),n.qZA(),n.YNc(10,Nm,2,3,"div",5),n.qZA(),n.TgZ(11,"div",6),n.YNc(12,Fm,11,8,"div",7),n.qZA()(),n.TgZ(13,"div",8)(14,"button",9),n.NdJ("click",function(){return u.confirmHire()}),n._uU(15," Hire "),n.qZA(),n.YNc(16,Xl,2,0,"button",10),n.TgZ(17,"button",11),n.NdJ("click",function(){return u.close()}),n._uU(18," Close "),n.qZA()()()),2&a&&(n.xp6(2),n.hij(" ",u.currentBuilding.name," "),n.xp6(4),n.hij(" Hire ",u.unitType.name," "),n.xp6(2),n.ekj("active","hire"===u.currentMode),n.xp6(1),n.hij(" Hire: ",u.countToHire-u.plannedToHire," "),n.xp6(1),n.Q6J("ngIf",u.activity.upgrade),n.xp6(2),n.Q6J("ngForOf",u.hirableGroups),n.xp6(2),n.Q6J("disabled",!u.canConfirm||u.countToHire-u.plannedToHire<0),n.xp6(2),n.Q6J("ngIf",u.canBeUpgraded))},dependencies:[Ie,rt,yt,Ot,Fn],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.type[_ngcontent-%COMP%]{padding:8px;margin:4px;font-size:12px;border:1px solid black;cursor:pointer}.type.active[_ngcontent-%COMP%]{border:1px solid gold}.hiring-panel[_ngcontent-%COMP%]{display:flex;justify-content:center}.unit-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid gray;padding:10px;margin:6px;width:160px;align-items:center;font-size:13px}.cost[_ngcontent-%COMP%]{display:flex}.resource[_ngcontent-%COMP%]{border:1px solid gray;border-radius:4px;padding:7px}"]})}return r})();function Aw(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",7),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw();return n.KtG(m.itemToBuy.set(h))}),n._UZ(1,"mw-item-icon",8),n._uU(2),n._UZ(3,"mw-resources-cost",9),n.qZA()}if(2&r){const o=l.$implicit,a=n.oxw();n.ekj("active",a.itemToBuy()===o),n.xp6(1),n.Q6J("itemBase",o),n.xp6(1),n.hij(" ",o.name," "),n.xp6(1),n.Q6J("cost",o.cost)}}function Ow(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",7),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw(2);return n.KtG(m.itemToSell.set(h))}),n._UZ(1,"mw-item-icon",8),n._uU(2),n._UZ(3,"mw-resources-cost",9),n.qZA()}if(2&r){const o=l.$implicit,a=n.oxw(2);n.ekj("active",a.itemToSell()===o),n.xp6(1),n.Q6J("itemBase",o.baseType),n.xp6(1),n.hij(" ",o.baseType.name," "),n.xp6(1),n.Q6J("cost",o.baseType.sellingCost)}}function kw(r,l){if(1&r&&(n.TgZ(0,"div"),n._uU(1,"Sell:"),n.qZA(),n.TgZ(2,"div",2),n.SjG(3,Ow,4,5,"div",10,n.ikw),n.qZA()),2&r){const o=n.oxw();n.wJu(3,o.hero.itemsBackpack)}}function Nw(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"button",3),n.NdJ("click",function(){n.CHM(o);const u=n.oxw();return n.KtG(u.sellItem())}),n._uU(1," Sell "),n.qZA()}if(2&r){const o=n.oxw();n.Q6J("disabled",!o.canSell())}}let eu=(()=>{class r extends mt{constructor(){super(...arguments),this.players=(0,n.f3M)(be),this.itemsService=(0,n.f3M)(hs),this.events=(0,n.f3M)(Ze),this.currentPlayer=this.players.getCurrentPlayer(),this.hero=this.currentPlayer.hero,this.sellingData=this.data.building.getCustomData(),this.items=(0,pt.Lx)(this.sellingData?.items),this.allowsSelling=this.sellingData?.selling,this.itemToBuy=(0,n.tdS)(null),this.itemToSell=(0,n.tdS)(null),this.canBuy=(0,n.Flj)(()=>{const o=this.itemToBuy();return this.itemToSell(),!!o&&this.players.playerHasResources(this.currentPlayer,o.cost)}),this.canSell=(0,n.Flj)(()=>!!this.itemToSell())}buyItem(){const o=this.itemToBuy(),a=this.itemsService.createItem(o);this.players.removeResourcesFromPlayer(this.currentPlayer,o.cost||{}),this.events.dispatch(er({item:a,player:this.currentPlayer})),Te.DN.removeItem(this.items,o),this.itemToBuy.set(null)}sellItem(){const o=this.itemToSell();this.players.addResourcesToPlayer(this.currentPlayer,o.baseType.sellingCost||{}),this.events.dispatch(qi({item:o,player:this.currentPlayer})),this.itemToSell.set(null)}static#e=this.\u0275fac=(()=>{let o;return function(u){return(o||(o=n.n5z(r)))(u||r)}})();static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-items-selling-popup"]],features:[n.qOj],decls:17,vars:3,consts:[["popupHeader",""],["popupContent",""],[1,"item-list"],["mw-main-button","",3,"disabled","click"],["popupButtons",""],["mw-main-button","",3,"disabled"],["mw-main-button","",3,"click"],[1,"item",3,"click"],[3,"itemBase"],[2,"display","flex","flex-direction","column",3,"cost"],["class","item",3,"active"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-popup-base-content")(1,"div",0)(2,"div"),n._uU(3,"Items Market"),n.qZA(),n.TgZ(4,"div"),n._uU(5,"Buy:"),n.qZA()(),n.TgZ(6,"div",1)(7,"div",2),n.SjG(8,Aw,4,5,"div",10,n.ikw),n.qZA(),n.TgZ(10,"button",3),n.NdJ("click",function(){return u.buyItem()}),n._uU(11," Buy "),n.qZA(),n.YNc(12,kw,5,0),n.qZA(),n.TgZ(13,"div",4),n.YNc(14,Nw,2,1,"button",5),n.TgZ(15,"button",6),n.NdJ("click",function(){return u.popup.close()}),n._uU(16," Close "),n.qZA()()()),2&a&&(n.wJu(8,u.items),n.xp6(10),n.Q6J("disabled",!u.canBuy()),n.xp6(2),n.um2(12,u.allowsSelling?12:-1),n.xp6(2),n.um2(14,u.allowsSelling?14:-1))},dependencies:[Kl,Ei,yt,Ot],styles:[".item-list[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:center}.item[_ngcontent-%COMP%]{border:1px solid gray;border-radius:4px;padding:4px;font-size:13px;cursor:pointer;max-width:94px;display:flex;flex-direction:column;align-items:center;text-align:center}.item.active[_ngcontent-%COMP%]{border-color:gold}"]})}return r})();function Ha(r){const l=(0,n.f3M)(Ze),o=(0,n.f3M)(Kd).escape$.subscribe(()=>l.dispatch(tr({view:r})));(0,n.f3M)(n.ktI).onDestroy(()=>o.unsubscribe())}function tu(r,l){if(1&r&&(n.TgZ(0,"div",13),n._uU(1),n.qZA()),2&r){const o=n.oxw().$implicit;n.xp6(1),n.AsE(" Level ",o.currentLevel+1,"/",o.base.levels.length," ")}}function N1(r,l){1&r&&(n.TgZ(0,"div",13),n._uU(1,"Not built"),n.qZA())}function Fw(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",7)(1,"div",8),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw(2);return n.KtG(m.handleBuildingClicked(h))}),n._UZ(2,"mw-ra-icon",9),n._uU(3),n.YNc(4,tu,2,2,"div",10)(5,N1,2,0,"ng-template",null,11,n.W1O),n._UZ(7,"hr",12),n.qZA()()}if(2&r){const o=l.$implicit,a=n.MAs(6),u=n.oxw(2);n.Q6J("mwActionHint","Inspect "+o.base.baseName),n.xp6(1),n.Udp("background-color",u.builtColor),n.ekj("not-built",!o.built),n.xp6(1),n.Q6J("icon",o.base.icon),n.xp6(1),n.hij(" ",o.currentBuilding.name," "),n.xp6(1),n.Q6J("ngIf",o.built)("ngIfElse",a)}}function Rw(r,l){if(1&r&&(n.TgZ(0,"div",4)(1,"div"),n._uU(2),n.qZA(),n.TgZ(3,"div",5),n.YNc(4,Fw,8,9,"div",6),n.qZA()()),2&r){const o=l.$implicit;n.xp6(2),n.hij("Tier ",o.key,""),n.xp6(2),n.Q6J("ngForOf",o.value)}}let nu=(()=>{class r{constructor(o,a,u){this.state=o,this.events=a,this.popupService=u,this.players=(0,n.f3M)(be),this.buildingsByTiers={},this.town=this.state.createdGame.town,this.builtColor=this.state.createdGame.selectedColor,Ha(Hn.Structures),this.buildingsByTiers=Object.entries(this.town.base.availableBuildings).reduce((h,[m,_])=>(h[_.tier]?h[_.tier].push(this.town.buildings[m]):h[_.tier]=[this.town.buildings[m]],h),{})}leaveTown(){this.events.dispatch(Gn({}))}handleBuildingClicked(o){if(!o.built)return void this.popupService.createBasicPopup({component:La,data:{building:o,targetLevel:1},class:"dark"});const a=o.currentBuilding.activity;if(a)switch(a.type){case Mn.Hiring:this.popupService.createBasicPopup({component:Rm,data:{building:o,town:this.town,hiringActivity:a}});break;case Mn.ItemsSelling:this.popupService.createBasicPopup({component:eu,data:{building:o}});break;case Mn.Garrison:this.players.getCurrentPlayer().garrisons&&this.events.dispatch(Ws())}}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(ft),n.Y36(Ze),n.Y36(Eo))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-town-view"]],decls:6,vars:3,consts:[["mwActionHint","Return to Map","icon","sideswipe",2,"padding","0px 10px","position","fixed","top","50%",3,"click"],[1,"buildings"],["class","building",4,"ngFor","ngForOf"],[2,"position","absolute","bottom","0","left","0"],[1,"building"],[1,"build"],[3,"mwActionHint",4,"ngFor","ngForOf"],[3,"mwActionHint"],[1,"header",3,"click"],[2,"font-size","28px",3,"icon"],["style","font-size: 10px;",4,"ngIf","ngIfElse"],["notBuilt",""],[2,"width","100%","border-top","0"],[2,"font-size","10px"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-icon-btn",0),n.NdJ("click",function(){return u.leaveTown()}),n.qZA(),n._UZ(1,"mw-action-hint"),n.TgZ(2,"div",1),n.YNc(3,Rw,5,2,"div",2),n.ALo(4,"keyvalue"),n.qZA(),n._UZ(5,"mw-player-info-panel",3)),2&a&&(n.xp6(3),n.Q6J("ngForOf",n.lcZ(4,1,u.buildingsByTiers)))},dependencies:[Ie,rt,Ni,_p,lt,io,Ll,Fn],styles:[".buildings[_ngcontent-%COMP%]{display:flex;flex-direction:row;position:fixed;left:50%;top:50%;transform:translate(-50%,-50%)}.building[_ngcontent-%COMP%]{display:flex;flex-direction:column;background-color:#41454e;color:#fff;text-align:center;margin:5px;border-radius:8px;font-size:14px}.building[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{padding:10px;cursor:pointer;margin:5px;color:#fff;border-radius:20px;display:flex;flex-direction:column}.building[_ngcontent-%COMP%]   .header.not-built[_ngcontent-%COMP%]{background:rgb(85,89,103)!important;color:#aeaeae}.build[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}mw-action-hint[_ngcontent-%COMP%]{position:fixed;top:90%;left:0;right:0;font-size:13px}"]})}return r})();class Lt extends(bt()){constructor(l,o,a){super(),this.popupService=l,this.battleState=o,this.playersService=a}displayPopup(l){this.popupService.createPopup(l)}openHeroInfo(){this.popupService.createPopup({component:Om,data:{},escape:!0})}openSettings(){this.popupService.createBasicPopup({component:xw,data:{},escape:!0})}openMainMenu(){this.popupService.createBasicPopup({component:xa,data:{}})}openGarrison(){this.popupService.createBasicPopup({component:_s,data:{}})}showGameOverPopup(){this.popupService.createBasicPopup({component:Og,data:{}})}displayPlayerRewardPopup(l){this.popupService.createBasicPopup({component:em,data:l})}openUnitGroupSplitPopup(l){this.popupService.createBasicPopup({component:im,data:l})}openUnitSlotsActionPopup(l){this.popupService.createBasicPopup({component:um,data:l})}displayActionCardsPopup(){this.popupService.createBasicPopup({component:ep,data:{},class:"transparent",isCloseable:!0})}playerSelectsStructure(l){if(l.struct.guard?.length)this.events.dispatch(Qs({component:Sm,data:{struct:l.struct}}));else if(!l.struct.guard?.length){if(l.struct.generator?.onVisited||l.struct.generator?.type===Do.Scripted)return void this.events.dispatch(Qs({component:vs,data:{struct:l.struct}}));this.events.dispatch(Qs({component:Fp,data:{struct:l.struct}}))}}fightEndsPopup(l){const o={isWin:l.win,playerLosses:this.getPlayerLosses(this.playersService.getCurrentPlayerId()),enemyLosses:this.getPlayerLosses(this.playersService.getEnemyPlayer().id),struct:l.struct};this.popupService.createPopup({data:o,component:kp})}displayRewardPopup(l){const o=l.struct,u=o.reward;if(u){const h={[on.Resources]:xm,[on.UnitsHire]:bm,[on.Item]:Qn,[on.Scripted]:Im},m=u.type;m in h&&this.popupService.createBasicPopup({data:{struct:o},component:h[m]})}}getPlayerLosses(l){return[...this.battleState.playerLosses[l]].map(a=>({type:a[0],count:a[1]}))}static#e=this.\u0275fac=function(o){return new(o||Lt)(n.LFG(Eo),n.LFG(to),n.LFG(be))};static#t=this.\u0275prov=n.Yz7({token:Lt,factory:Lt.\u0275fac})}Z([re(Qs)],Lt.prototype,"displayPopup",null),Z([Ee(kc)],Lt.prototype,"openHeroInfo",null),Z([Ee(Br)],Lt.prototype,"openSettings",null),Z([Ee(Yi)],Lt.prototype,"openMainMenu",null),Z([Ee(Ws)],Lt.prototype,"openGarrison",null),Z([Ee(Fc)],Lt.prototype,"showGameOverPopup",null),Z([re(hh)],Lt.prototype,"displayPlayerRewardPopup",null),Z([re(Lr)],Lt.prototype,"openUnitGroupSplitPopup",null),Z([re(qs)],Lt.prototype,"openUnitSlotsActionPopup",null),Z([Ee(Nc)],Lt.prototype,"displayActionCardsPopup",null),Z([re(Xo)],Lt.prototype,"playerSelectsStructure",null),Z([re(Vi)],Lt.prototype,"fightEndsPopup",null),Z([re(Hr)],Lt.prototype,"displayRewardPopup",null);const Um=bn({id:"#acard-loc-attack",title:"Attack",icon:"crossed-swords",type:nn.LocationAction,bgColor:"#f33b4e",description:"Attack the camp."}),Uw=bn({id:"#acard-init-attack",title:"Initiative Attack",icon:"groundbreaker",type:nn.LocationAction,bgColor:"red",description:"Attack the camp, allowing your hero to cast a spell at the beginning of the fight."}),Lw=bn({id:"#acard-visit",title:"Visit",icon:"trail",type:nn.LocationAction,bgColor:"#ffa446",description:"Visit the location. Takes 1 action point until location says otherwise."}),Lm=bn({id:"#acard-thunder",title:"Thunder",icon:"lightning-storm",type:nn.Event,description:"Your hero loses 1 action point."}),Gw=bn({id:"#acard-rainbow",title:"Rainbow",icon:"sunbeams",type:nn.Event,description:"Your hero gains +1 action point."}),Hw=bn({id:"#acard-snowfall",title:"Snowfall",icon:"frost-emblem",type:nn.Event,description:"Your army is slowed down by 25% during the combat."}),Cs=bn({id:"#acard-raiders",title:"Raiders",icon:"demolish",type:nn.Event,description:"Raiders are approaching. At the end of the day, you will lose a random building on the map."});let Gm=(()=>{class r{constructor(){this.hostElem=(0,Te.xf)(),this.renderer=(0,n.f3M)(n.Qsj),this.cursor=(0,n.f3M)(tp),this.ngZone=(0,n.f3M)(n.R0b),this.isHovered=!1,this.destroyed$=new Ft.xQ,this.setNativeCursorVisibility(!1),this.ngZone.runOutsideAngular(()=>{this.unlistenMouseMove=this.renderer.listen(this.hostElem,"mousemove",o=>{this.cursor.setCustomCursorPos(o.clientX,o.clientY)})})}ngOnDestroy(){this.cursor.clearCustomCursor(),this.isHovered=!1,this.destroyed$.next(),this.unlistenMouseMove()}onMouseOver(o){o.stopPropagation(),this.isHovered=!0;const a=this.getCursorToShow();a?(this.cursor.setCustomCursor(a.animation,a.options,a.data),this.setNativeCursorVisibility(!1)):(this.setNativeCursorVisibility(!0),this.cursor.clearCustomCursor())}onMouseOut(o){o.stopPropagation(),this.isHovered=!1,this.cursor.clearCustomCursor()}getCursorToShow(){return this.cursorAnimation}setCursorIcon(o){this.isHovered&&o&&(this.setNativeCursorVisibility(!1),this.cursor.setCustomCursor(o.animation,o.options,o.data)),o||(this.setNativeCursorVisibility(!0),this.cursor.clearCustomCursor())}recalcCursorIcon(){const o=this.getCursorToShow();this.isHovered&&o&&(this.setCursorIcon(o),this.setNativeCursorVisibility(!1)),o||(this.cursor.clearCustomCursor(),this.setNativeCursorVisibility(!0))}setNativeCursorVisibility(o){this.renderer.setStyle(this.hostElem,"cursor",o?"auto":"none")}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","mwCustomCursor",""]],hostBindings:function(a,u){1&a&&n.NdJ("mouseenter",function(m){return u.onMouseOver(m)})("mouseleave",function(m){return u.onMouseOut(m)})}})}return r})();const Ba=new n.OlP("UI element unit group provider");let Hm=(()=>{class r extends Gm{constructor(){super(...arguments),this.curPlayerState=(0,n.f3M)(Ut),this.spells=(0,n.f3M)(wa),this.players=(0,n.f3M)(be),this.unitGroupProvider=(0,n.f3M)(Ba)}ngOnInit(){this.unitGroup=this.unitGroupProvider.getUnitGroup(),this.curPlayerState.playerStateChanged$.pipe(Xe(this.destroyed$)).subscribe(()=>{this.recalcCursorIcon()})}getCursorToShow(){const o=this.players.isEnemyUnitGroup(this.unitGroup),a=this.curPlayerState.playerCurrentState;if(this.curPlayerState.playerCurrentState!==Ye.SpellTargeting&&!o)return null;if(a===Ye.Normal&&(!o||o&&!this.unitGroup.fightInfo.isAlive))return this.createStaticCursor("interdiction");const u=this.spells.canSpellBeCastOnUnit(this.curPlayerState.currentSpell,this.unitGroup,o);return a!==Ye.SpellTargeting||u?this.curPlayerState.playerCurrentState===Ye.SpellTargeting?{animation:Kv,options:{duration:2e3,iterations:1/0}}:this.createStaticCursor({[Ye.Normal]:"sword",[Ye.SpellTargeting]:"burning-book",[Ye.WaitsForTurn]:"hourglass"}[this.curPlayerState.playerCurrentState]):this.createStaticCursor("interdiction")}createStaticCursor(o){return"interdiction"===o?{animation:Dh,data:{custom:{parts:[{color:"white",icon:o,text:"",type:"plainPart"}]}}}:{animation:Wc,data:{custom:{parts:[{color:"white",icon:o,text:"",type:"plainPart"}]}}}}static#e=this.\u0275fac=(()=>{let o;return function(u){return(o||(o=n.n5z(r)))(u||r)}})();static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","mwUnitEventsCursor",""]],features:[n.qOj]})}return r})(),iu=(()=>{class r{constructor(o,a,u,h,m){this.curPlayerState=o,this.players=a,this.mwBattleStateService=u,this.events=h,this.unitGroupProvider=m,this.isEnemyCard=!1}ngOnInit(){this.actionTargetUnitGroup=this.unitGroupProvider.getUnitGroup(),this.isEnemyCard=this.players.isEnemyUnitGroup(this.actionTargetUnitGroup)}onContextMenu(o){return o.stopPropagation(),o.preventDefault(),!1}onMouseDown(o){2===o.button&&(o.preventDefault(),this.curPlayerState.isSpellBeingCasted()?(this.curPlayerState.cancelCurrentSpell(),this.dispatchUnitGroupHovered(this.isEnemyCard?fn.EnemyCard:fn.AllyCard)):this.events.dispatch(Ks({unitGroup:this.actionTargetUnitGroup})))}onClick(){if(this.canActivateCurrentSpell())if(this.isEnemyCard){if(!this.actionTargetUnitGroup.fightInfo.isAlive)return;this.events.dispatch(Bc({attackedGroup:this.actionTargetUnitGroup,attackingGroup:this.mwBattleStateService.currentUnitGroup,attackingPlayer:this.mwBattleStateService.currentPlayer})),this.dispatchUnitGroupHovered(fn.EnemyCard)}else this.events.dispatch($r({unitGroup:this.actionTargetUnitGroup})),this.dispatchUnitGroupHovered(fn.Unhover);else this.curPlayerState.cancelCurrentSpell()}canActivateCurrentSpell(){const a=this.curPlayerState.currentSpell.baseType.config.spellConfig.targetCastConfig?.canActivate;return!a||a({unitGroup:this.actionTargetUnitGroup,isEnemy:this.isEnemyCard})}dispatchUnitGroupHovered(o){this.events.dispatch(ni({hoverType:o,currentCard:this.mwBattleStateService.currentUnitGroup,hoveredCard:this.actionTargetUnitGroup}))}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(Ut),n.Y36(be),n.Y36(to),n.Y36(Ze),n.Y36(Ba))};static#t=this.\u0275dir=n.lG2({type:r,selectors:[["","mwUnitGroupCombatAction",""]],hostBindings:function(a,u){1&a&&n.NdJ("contextmenu",function(m){return u.onContextMenu(m)})("mousedown",function(m){return u.onMouseDown(m)})("click",function(m){return u.onClick(m)})},inputs:{actionTargetUnitGroup:"actionTargetUnitGroup"}})}return r})();function Bm(r,l){1&r&&n._UZ(0,"mw-ra-icon",20)}function jm(r,l){1&r&&n._UZ(0,"mw-ra-icon",21)}function $m(r,l){if(1&r&&(n.TgZ(0,"div"),n._UZ(1,"mw-ra-icon",22),n._uU(2),n.qZA()),2&r){const o=n.oxw().ngIf;n.xp6(2),n.hij(" ",o.totalHealth," ")}}function ja(r,l){if(1&r&&n._UZ(0,"mw-unit-group-spell",23),2&r){const o=l.$implicit,a=n.oxw(2);n.Q6J("hintPos",a.spellsHintsPosition)("spell",o)("owner",a.unitGroup)("onCooldown",a.unitGroup.fightInfo.spellsOnCooldown)("currentUnit",a.attackingUnitGroup)}}function Zm(r,l){if(1&r&&n._UZ(0,"mw-unit-group-buff",24),2&r){const o=l.$implicit,a=n.oxw(2);n.Q6J("hintPos",a.spellsHintsPosition)("buff",o)("ownerUnit",a.unitGroup)}}function ws(r,l){if(1&r&&n._UZ(0,"mw-value-bar",25),2&r){const o=n.oxw(2);n.Q6J("side",o.side)("showMax",!0)("currentValue",o.unitGroup.tailUnitHp)("maxValue",o.unitGroup.type.baseStats.health)("barHeight",14)}}function $a(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",2),n.NdJ("mouseenter",function(){n.CHM(o);const u=n.oxw();return n.KtG(u.onCardHover(!0))})("mouseleave",function(){n.CHM(o);const u=n.oxw();return n.KtG(u.onCardHover(!1))}),n.TgZ(1,"div",3)(2,"div",4)(3,"div",5),n._uU(4),n.qZA(),n.TgZ(5,"div",6)(6,"div"),n._UZ(7,"mw-ra-icon",7),n._uU(8),n.qZA(),n.TgZ(9,"div"),n.YNc(10,Bm,1,0,"mw-ra-icon",8)(11,jm,1,0,"ng-template",null,9,n.W1O),n._uU(13),n.qZA(),n.TgZ(14,"div"),n._UZ(15,"mw-ra-icon",10),n._uU(16),n._UZ(17,"span",11),n.qZA(),n.YNc(18,$m,3,1,"div",12),n.qZA()(),n.TgZ(19,"div",13)(20,"div",14),n.YNc(21,ja,1,5,"mw-unit-group-spell",15),n.qZA(),n.TgZ(22,"div",14),n.YNc(23,Zm,1,3,"mw-unit-group-buff",16),n.qZA()()(),n.TgZ(24,"div",17),n._UZ(25,"mw-unit-group-portrait",18),n.YNc(26,ws,1,5,"mw-value-bar",19),n.qZA()()}if(2&r){const o=l.ngIf,a=n.MAs(12),u=n.oxw();n.ekj("active",u.mwBattleStateService.currentPlayer===u.playerInfo&&u.attackingUnitGroup===u.unitGroup)("inactive",!u.unitGroup.turnsLeft&&u.unitGroup.fightInfo.isAlive)("defeated",!u.unitGroup.fightInfo.isAlive),n.Q6J("ngClass","left"===u.side?"card-left":"card-right"),n.xp6(2),n.Udp("background",u.playerInfo.color),n.ekj("current-group",u.mwBattleStateService.currentPlayer===u.playerInfo&&u.attackingUnitGroup===u.unitGroup)("hovered-enemy",u.isCardHovered&&u.isEnemyCard&&u.canCurrentPlayerAttack),n.xp6(2),n.AsE(" ",u.unitGroup.type.name," (",u.unitGroup.count,") "),n.xp6(4),n.AsE(" (",u.unitGroup.turnsLeft,"/",u.unitGroup.type.defaultTurnsPerRound,") "),n.xp6(2),n.Q6J("ngIf",u.isGroupMelee)("ngIfElse",a),n.xp6(3),n.hij(" ",o.avgTotalDamage," "),n.xp6(1),n.ekj("defence",o.defends),n.xp6(2),n.hij(" ",o.baseSpeed," "),n.xp6(1),n.Q6J("mwNumberModifier",o.speedBonus),n.xp6(1),n.Q6J("ngIf",!u.isBoss),n.xp6(1),n.Q6J("ngClass",u.side),n.xp6(2),n.Q6J("ngForOf",u.spells),n.xp6(2),n.Q6J("ngForOf",u.effects),n.xp6(2),n.Q6J("unitGroup",u.unitGroup)("toRight","left"===u.side),n.xp6(1),n.Q6J("ngIf",u.isBoss)}}let bs=(()=>{class r extends(bt()){constructor(o,a,u,h,m,_){super(),this.hostElem=o,this.mwBattleStateService=a,this.playersService=u,this.unitsService=h,this.units=m,this.renderer=_,this.side="left",this.cardReady=new n.vpe,this.groupDies=new n.vpe,this.isCardHovered=!1,this.canCurrentPlayerAttack=!1,this.isGroupMelee=!1,this.initialCount=0,this.spells=[],this.effects=[],this.isBoss=!1,this.destroy$=new Ft.xQ}ngOnInit(){this.spellsHintsPosition="above",this.isGroupMelee=!this.unitsService.isUnitGroupRanged(this.unitGroup),this.isEnemyCard=this.playersService.getCurrentPlayer()!==this.playerInfo,this.initialCount=this.unitGroup.count,this.isBoss=this.unitGroup.type.defaultModifiers?.isBoss,this.cardReady.next(this),this.unitStats$=this.unitGroup.listenStats(),this.unitGroup.modGroup.getModValue("isSummon")&&this.renderer.addClass(this.hostElem.nativeElement,"summoned"),this.updateSpellsAndEffects(),this.events.eventStream$.pipe(Xe(this.destroyed$)).subscribe(()=>{this.attackingUnitGroup=this.mwBattleStateService.currentUnitGroup,this.canCurrentPlayerAttack=this.mwBattleStateService.currentPlayer===this.playersService.getCurrentPlayer()}),this.events.onEvent(Un).pipe(Xe(this.destroyed$)).subscribe(a=>{a.unitGroup===this.unitGroup&&this.updateSpellsAndEffects()})}onDestroyed(){this.destroy$.next(),this.destroy$.complete(),this.events.dispatch(ni({hoverType:fn.Unhover})),this.groupDies.next()}onCardHover(o){if(this.isCardHovered=o,o){if(!this.unitGroup.fightInfo.isAlive)return void this.events.dispatch(ni({hoverType:fn.Unhover}));this.events.dispatch(ni({hoverType:this.isEnemyCard?fn.EnemyCard:fn.AllyCard,currentCard:this.mwBattleStateService.currentUnitGroup,hoveredCard:this.unitGroup}))}else this.events.dispatch(ni({hoverType:fn.Unhover}))}getUnitGroup(){return this.unitGroup}updateSpellsAndEffects(){const o=this.unitGroup.spells;this.effects=o.filter(a=>a.isEffect()),this.spells=o.filter(a=>!a.isEffect())}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(n.SBq),n.Y36(to),n.Y36(be),n.Y36(Pp),n.Y36(Dn),n.Y36(n.Qsj))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-unit-group-card"]],inputs:{unitGroup:"unitGroup",playerInfo:"playerInfo",side:"side"},outputs:{cardReady:"cardReady",groupDies:"groupDies"},features:[n._Bn([{provide:Ba,useExisting:(0,n.Gpc)(()=>r)}]),n.qOj],decls:3,vars:4,consts:[[3,"containerId"],["class","card-top",3,"active","ngClass","inactive","defeated","mouseenter","mouseleave",4,"ngIf"],[1,"card-top",3,"ngClass","mouseenter","mouseleave"],[1,"card-wrapper"],[1,"card"],[2,"padding-bottom","3px","font-weight","500","white-space","nowrap"],[2,"font-size","12px"],["icon","spinning-sword"],["icon","sword",4,"ngIf","ngIfElse"],["rangedIcon",""],["icon","feather-wing"],[3,"mwNumberModifier"],[4,"ngIf"],[1,"abilities",3,"ngClass"],[1,"column-data"],[3,"hintPos","spell","owner","onCooldown","currentUnit",4,"ngFor","ngForOf"],[3,"hintPos","buff","ownerUnit",4,"ngFor","ngForOf"],[1,"portrait-container"],[3,"unitGroup","toRight"],["class","health-bar","barStyle","normal","color","rgb(201, 45, 45)",3,"side","showMax","currentValue","maxValue","barHeight",4,"ngIf"],["icon","sword"],["icon","crossbow"],["icon","health"],[3,"hintPos","spell","owner","onCooldown","currentUnit"],[3,"hintPos","buff","ownerUnit"],["barStyle","normal","color","rgb(201, 45, 45)",1,"health-bar",3,"side","showMax","currentValue","maxValue","barHeight"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-vfx-container",0),n.YNc(1,$a,27,31,"div",1),n.ALo(2,"async"),n.qZA()),2&a&&(n.Q6J("containerId",u.unitGroup.id),n.xp6(1),n.Q6J("ngIf",n.lcZ(2,2,u.unitStats$)))},styles:["@keyframes _ngcontent-%COMP%_summonedAnimation{0%{opacity:0;height:0;width:0px}to{opacity:100%;height:100px;width:115px}}.summoned[_nghost-%COMP%]{animation:_ngcontent-%COMP%_summonedAnimation .6s ease-in-out}.card-top[_ngcontent-%COMP%]{display:flex;position:relative;transition:.5s;left:0;right:0}.portrait-container[_ngcontent-%COMP%]{position:absolute;top:-25px}.card-left[_ngcontent-%COMP%]   .portrait-frame[_ngcontent-%COMP%]{scale:-1 1}.vertical[_nghost-%COMP%]   .card-left[_ngcontent-%COMP%]   .portrait-container[_ngcontent-%COMP%], .vertical   [_nghost-%COMP%]   .card-left[_ngcontent-%COMP%]   .portrait-container[_ngcontent-%COMP%]{right:79%}.vertical[_nghost-%COMP%]   .card-right[_ngcontent-%COMP%]   .portrait-container[_ngcontent-%COMP%], .vertical   [_nghost-%COMP%]   .card-right[_ngcontent-%COMP%]   .portrait-container[_ngcontent-%COMP%]{left:79%}.horizontal[_nghost-%COMP%]   .portrait-container[_ngcontent-%COMP%], .horizontal   [_nghost-%COMP%]   .portrait-container[_ngcontent-%COMP%]{z-index:-1;right:0;top:-94px;left:-10px}.health-bar[_ngcontent-%COMP%]{position:relative;overflow:hidden;top:-42px;width:70px;border-radius:7px;border:1px solid gold}.card-left[_ngcontent-%COMP%]   .health-bar[_ngcontent-%COMP%]{left:24px}.card-right[_ngcontent-%COMP%]   .health-bar[_ngcontent-%COMP%]{right:-23px}.card-left[_ngcontent-%COMP%]{text-align:right}.card-right[_ngcontent-%COMP%]{text-align:left}.card-wrapper[_ngcontent-%COMP%]{position:relative}.abilities[_ngcontent-%COMP%]{position:absolute;font-size:12px;top:0;display:flex}.vertical[_nghost-%COMP%]   .abilities.left[_ngcontent-%COMP%], .vertical   [_nghost-%COMP%]   .abilities.left[_ngcontent-%COMP%]{right:185%;flex-direction:row-reverse}.vertical[_nghost-%COMP%]   .abilities.right[_ngcontent-%COMP%], .vertical   [_nghost-%COMP%]   .abilities.right[_ngcontent-%COMP%]{left:185%}.horizontal[_nghost-%COMP%]   .abilities[_ngcontent-%COMP%], .horizontal   [_nghost-%COMP%]   .abilities[_ngcontent-%COMP%]{top:-62%;left:-42px;flex-direction:column}.card[_ngcontent-%COMP%]{display:block;width:115px;height:100px;border-radius:6px;align-items:center;box-sizing:border-box;font-size:13px;padding:4px 15px 0;color:#fff;border:3px solid transparent;-webkit-user-select:none;user-select:none}.card.current-group[_ngcontent-%COMP%]{border:3px solid gold}.hovered-enemy[_ngcontent-%COMP%]{border:3px solid rgba(240,113,113,.906)}.column-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:0 4px}[_nghost-%COMP%]{position:relative}.card-top[_ngcontent-%COMP%]{transition:.5s;filter:brightness(100%) drop-shadow(0 0 0 rgba(0,0,0,.721))}.card-top.active[_ngcontent-%COMP%]{filter:brightness(100%) drop-shadow(2px 4px 6px rgba(0,0,0,.721))}.card-top.inactive[_ngcontent-%COMP%]{filter:brightness(85%) drop-shadow(0 0 0 rgba(0,0,0,.721))}.card-top.defeated[_ngcontent-%COMP%]{filter:brightness(55%) drop-shadow(0 0 0 rgba(0,0,0,.721))}.vertical[_nghost-%COMP%]   .card-top.active.card-left[_ngcontent-%COMP%], .vertical   [_nghost-%COMP%]   .card-top.active.card-left[_ngcontent-%COMP%]{left:32px}.vertical[_nghost-%COMP%]   .card-top.active.card-right[_ngcontent-%COMP%], .vertical   [_nghost-%COMP%]   .card-top.active.card-right[_ngcontent-%COMP%]{right:32px}.vertical[_nghost-%COMP%]   .card-top.inactive.card-left[_ngcontent-%COMP%], .vertical   [_nghost-%COMP%]   .card-top.inactive.card-left[_ngcontent-%COMP%]{left:-32px}.vertical[_nghost-%COMP%]   .card-top.inactive.card-right[_ngcontent-%COMP%], .vertical   [_nghost-%COMP%]   .card-top.inactive.card-right[_ngcontent-%COMP%]{right:-32px}.vertical[_nghost-%COMP%]   .card-top.defeated.card-left[_ngcontent-%COMP%], .vertical   [_nghost-%COMP%]   .card-top.defeated.card-left[_ngcontent-%COMP%]{left:-32px}.vertical[_nghost-%COMP%]   .card-top.defeated.card-right[_ngcontent-%COMP%], .vertical   [_nghost-%COMP%]   .card-top.defeated.card-right[_ngcontent-%COMP%]{right:32px}.horizontal[_nghost-%COMP%]   .card-top.active.card-left[_ngcontent-%COMP%], .horizontal   [_nghost-%COMP%]   .card-top.active.card-left[_ngcontent-%COMP%]{transform:translateY(-32px)}.horizontal[_nghost-%COMP%]   .card-top.active.card-right[_ngcontent-%COMP%], .horizontal   [_nghost-%COMP%]   .card-top.active.card-right[_ngcontent-%COMP%]{transform:translateY(32px)}.horizontal[_nghost-%COMP%]   .card-top.inactive.card-left[_ngcontent-%COMP%], .horizontal   [_nghost-%COMP%]   .card-top.inactive.card-left[_ngcontent-%COMP%]{transform:translateY(32px)}.horizontal[_nghost-%COMP%]   .card-top.inactive.card-right[_ngcontent-%COMP%], .horizontal   [_nghost-%COMP%]   .card-top.inactive.card-right[_ngcontent-%COMP%]{transform:translateY(-32px)}.horizontal[_nghost-%COMP%]   .card-top.defeated.card-left[_ngcontent-%COMP%], .horizontal   [_nghost-%COMP%]   .card-top.defeated.card-left[_ngcontent-%COMP%]{transform:translateY(32px)}.horizontal[_nghost-%COMP%]   .card-top.defeated.card-right[_ngcontent-%COMP%], .horizontal   [_nghost-%COMP%]   .card-top.defeated.card-right[_ngcontent-%COMP%]{transform:translateY(-32px)}.defence[_ngcontent-%COMP%]{font-weight:700;color:gold}"]})}return r})();function ou(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"mw-unit-group-card",12),n.NdJ("grupDies",function(){const h=n.CHM(o).$implicit,m=n.oxw();return n.KtG(m.onGroupDies(h))}),n.qZA()}if(2&r){const o=l.$implicit,a=n.oxw();n.Q6J("playerInfo",a.mainPlayerInfo)("unitGroup",o)}}function Bw(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"mw-unit-group-card",13),n.NdJ("groupDies",function(){const h=n.CHM(o).$implicit,m=n.oxw();return n.KtG(m.onGroupDies(h))}),n.qZA()}if(2&r){const o=l.$implicit,a=n.oxw();n.Q6J("playerInfo",a.enemyPlayerInfo)("unitGroup",o)}}function jw(r,l){if(1&r&&(n.TgZ(0,"div",14)(1,"div"),n._uU(2),n.qZA(),n.TgZ(3,"div"),n._uU(4),n.qZA(),n.TgZ(5,"div"),n._uU(6),n.qZA()()),2&r){const o=l.$implicit;n.Udp("background",o.ownerPlayer.color),n.xp6(2),n.Oqu(o.type.name),n.xp6(2),n.Oqu(o.count),n.xp6(2),n.hij("turns: ",o.turnsLeft,"")}}class co extends(bt()){constructor(l,o,a,u,h,m,_,b,S){super(),this.mwPlayerState=l,this.players=o,this.mwBattleState=a,this.mwNeutralPlayer=u,this.cardsMapping=h,this.combatInteractor=m,this.vfx=_,this.cd=b,this.state=S,this.settings=this.state.settings,this.orientation=x.hJ,this.currentUnitGroup$=this.mwBattleState.currentUnitGroup$,this.canDefend$=this.mwBattleState.currentUnitGroup$.pipe((0,rs.U)(T=>!(!T||T.getStats().defends||this.players.isEnemyUnitGroup(T)))),this.defendActionMessage$=this.mwBattleState.currentUnitGroup$.pipe((0,rs.U)(T=>!T||this.players.isEnemyUnitGroup(T)?"":T.getStats().defends?"Unit group is already defending":`Defend ${T.count} ${T.type.name}`))}ngOnInit(){this.mainPlayerUnitGroups=this.mwPlayerState.getUnitGroups(),this.neutralPlayerGroups=this.mwNeutralPlayer.getUnitGroups(),this.mainPlayerInfo=this.mwPlayerState.getPlayerInfo(),this.enemyPlayerInfo=this.mwNeutralPlayer.getPlayerInfo()}onGroupDies(l){this.cardsMapping.unregister(l)}ngAfterViewInit(){this.cards.forEach(l=>this.cardsMapping.register(l.unitGroup,l)),this.initInteractions(),this.cd.detectChanges()}initInteractions(){this.combatInteractor.onBattleBegins(),this.events.dispatch(zs({players:[this.mainPlayerInfo,this.enemyPlayerInfo],unitGroups:[...this.mainPlayerUnitGroups,...this.neutralPlayerGroups]})),this.updateFightQueue(),this.events.eventStream$.pipe(Xe(this.destroyed$)).subscribe(()=>{this.updatePlayersUnitGroupsToShow()})}defend(){this.events.dispatch(Zs())}displayDamageVfxOverAttackedGroup(l){const o=l.attackingGroup.type.defaultModifiers?.isRanged;l.lifeStolen&&(this.vfx.createDroppingMessageForContainer(l.attackingGroup.id,((r,l)=>({html:Wi(`\n      <div style="">${Vr({icon:"bat-sword",iconColor:"red"})} ${l}</div>\n      <div style="">${Vr({icon:"double-team",iconColor:"#91edb8"})}${Eh(r)}</div>\n    `,{width:50})}))(l.lifeStolenUnitsRestored,l.lifeStolen),{duration:1600}),this.vfx.createEffectAnimationForUnitGroup(l.attackingGroup,Xs,{duration:700,darkOverlay:!1})),this.vfx.createFloatingMessageForUnitGroup(l.attackedGroup,Zn(l.damage,l.loss,o,l.damageBlocked,l.isCritical),{duration:l.isCritical?1200:l.damageBlocked?1100:1e3})}registerSummonedUnit(l){this.updatePlayersUnitGroupsToShow(),this.cd.detectChanges(),this.cardsMapping.register(l.unitGroup,this.cards.find(o=>o.unitGroup===l.unitGroup))}updatePlayersUnitGroupsToShow(){this.mainPlayerUnitGroups=this.mwBattleState.heroesUnitGroupsMap.get(this.mainPlayerInfo),this.neutralPlayerGroups=this.mwBattleState.heroesUnitGroupsMap.get(this.enemyPlayerInfo),this.updateFightQueue()}updateFightQueue(){this.fightQueue=this.mwBattleState.getFightQueue()}static#e=this.\u0275fac=function(o){return new(o||co)(n.Y36(mm),n.Y36(be),n.Y36(to),n.Y36(gm),n.Y36(_g),n.Y36(ao),n.Y36(yr),n.Y36(n.sBO),n.Y36(ft))};static#t=this.\u0275cmp=n.Xpm({type:co,selectors:[["mw-gameboard"]],viewQuery:function(o,a){if(1&o&&n.Gf(bs,5),2&o){let u;n.iGM(u=n.CRH())&&(a.cards=u)}},features:[n.qOj],decls:19,vars:10,consts:[[1,"columns-wrapper",3,"ngClass"],[1,"columns"],[1,"column"],["class","card","mwUnitGroupCombatAction","","mwUnitEventsCursor","","side","left",3,"playerInfo","unitGroup","grupDies",4,"ngFor","ngForOf"],["class","card","mwUnitGroupCombatAction","","mwUnitEventsCursor","","side","right",3,"playerInfo","unitGroup","groupDies",4,"ngFor","ngForOf"],[1,"abilities-panel"],["icon","shield",2,"width","60px","text-align","center","color","#ffe5a0","background","#505263",3,"disabled","mwActionHint","click"],[1,"queue-panel"],["class","queue-card",3,"background",4,"ngFor","ngForOf"],[1,"hint-panel"],[1,"history-log-panel"],[1,"items-panel"],["mwUnitGroupCombatAction","","mwUnitEventsCursor","","side","left",1,"card",3,"playerInfo","unitGroup","grupDies"],["mwUnitGroupCombatAction","","mwUnitEventsCursor","","side","right",1,"card",3,"playerInfo","unitGroup","groupDies"],[1,"queue-card"]],template:function(o,a){1&o&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2),n.YNc(3,ou,1,2,"mw-unit-group-card",3),n.qZA(),n.TgZ(4,"div",2),n.YNc(5,Bw,1,2,"mw-unit-group-card",4),n.qZA()()(),n.TgZ(6,"div",5)(7,"mw-icon-btn",6),n.NdJ("click",function(){return a.defend()}),n.ALo(8,"async"),n.ALo(9,"async"),n.qZA(),n._UZ(10,"mw-battle-hero-abilities"),n.qZA(),n.TgZ(11,"div",7),n.YNc(12,jw,7,5,"div",8),n.qZA(),n._UZ(13,"mw-action-hint",9),n.TgZ(14,"div",10),n._UZ(15,"mw-history-log"),n.qZA(),n.TgZ(16,"div",11),n._uU(17," Items: "),n._UZ(18,"mw-items-panel"),n.qZA()),2&o&&(n.Q6J("ngClass",a.settings.orientation===a.orientation.Horizontal?"horizontal":"vertical"),n.xp6(3),n.Q6J("ngForOf",a.mainPlayerUnitGroups),n.xp6(2),n.Q6J("ngForOf",a.neutralPlayerGroups),n.xp6(2),n.Q6J("disabled",!1===n.lcZ(8,6,a.canDefend$))("mwActionHint",n.lcZ(9,8,a.defendActionMessage$)),n.xp6(5),n.Q6J("ngForOf",a.fightQueue))},styles:[".columns-wrapper[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:80%;width:100%;display:flex;align-items:center}.columns-wrapper.horizontal[_ngcontent-%COMP%]{top:90px;height:65%}.columns-wrapper.horizontal[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{flex-direction:column-reverse}.columns-wrapper.horizontal[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%] > .column[_ngcontent-%COMP%]{flex-direction:row;height:auto;justify-content:space-evenly;width:100%}.columns[_ngcontent-%COMP%]{display:flex;width:680px;height:100%;justify-content:space-between;margin:auto;align-items:center}.column[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;justify-content:center}.card[_ngcontent-%COMP%]{margin:6px}.queue-panel[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;position:absolute;bottom:0;left:0}.queue-card[_ngcontent-%COMP%]{height:64px;width:64px;border-radius:6px;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:12px;color:#fff;text-align:center;margin:8px}.abilities-panel[_ngcontent-%COMP%]{position:fixed;left:100px;top:35%}.hint-panel[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;position:absolute;bottom:81px;left:0;font-size:12px}.history-log-panel[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;width:370px}.items-panel[_ngcontent-%COMP%]{position:absolute;left:16px;bottom:75px}"]})}function Vm(r,l){if(1&r&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&r){const o=n.oxw().ngIf;n.xp6(1),n.hij(" (+",o.bonusAttack,") ")}}function Lp(r,l){if(1&r&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&r){const o=n.oxw().ngIf;n.xp6(1),n.hij(" (+",o.bonusDefence,") ")}}function qm(r,l){if(1&r&&(n.TgZ(0,"div")(1,"div",1)(2,"div"),n._uU(3),n.qZA(),n.TgZ(4,"div"),n._uU(5),n.qZA()(),n.TgZ(6,"div",1)(7,"div"),n._uU(8),n.qZA(),n.TgZ(9,"div"),n._uU(10),n.qZA()(),n.TgZ(11,"div",1)(12,"div"),n._uU(13),n.qZA(),n.TgZ(14,"div"),n._uU(15),n.qZA()(),n.TgZ(16,"div",1)(17,"div"),n._uU(18),n.qZA(),n.TgZ(19,"div"),n._uU(20),n.qZA()(),n.TgZ(21,"div",1)(22,"div"),n._uU(23,"Mana:"),n.qZA(),n.TgZ(24,"div"),n._uU(25),n.qZA()(),n.TgZ(26,"div",1)(27,"div"),n._uU(28,"Attack:"),n.qZA(),n.TgZ(29,"div"),n._uU(30),n.YNc(31,Vm,2,1,"span",0),n.qZA()(),n.TgZ(32,"div",1)(33,"div"),n._uU(34,"Defence:"),n.qZA(),n.TgZ(35,"div"),n._uU(36),n.YNc(37,Lp,2,1,"span",0),n.qZA()(),n.TgZ(38,"div",2)(39,"div")(40,"div"),n._uU(41),n.qZA()()()()),2&r){const o=l.ngIf,a=n.oxw();n.xp6(3),n.hij("",a.resourceNames.gold,":"),n.xp6(2),n.Oqu(a.currentPlayer.resources.gold),n.xp6(3),n.hij("",a.resourceNames.wood,":"),n.xp6(2),n.Oqu(a.currentPlayer.resources.wood),n.xp6(3),n.hij("",a.resourceNames.redCrystals,":"),n.xp6(2),n.Oqu(a.currentPlayer.resources.redCrystals),n.xp6(3),n.hij("",a.resourceNames.gems,":"),n.xp6(2),n.Oqu(a.currentPlayer.resources.gems),n.xp6(5),n.AsE("",o.currentMana,"/",o.maxMana,""),n.xp6(5),n.hij(" ",o.baseAttack," "),n.xp6(1),n.Q6J("ngIf",o.bonusAttack),n.xp6(5),n.hij(" ",o.baseDefence," "),n.xp6(1),n.Q6J("ngIf",o.bonusDefence),n.xp6(4),n.AsE(" Week: ",a.state.currentGame.week,", Day: ",a.state.currentGame.day," ")}}Z([re(Wo)],co.prototype,"displayDamageVfxOverAttackedGroup",null),Z([re(Fr)],co.prototype,"registerSummonedUnit",null);let zm=(()=>{class r{constructor(o,a){this.playersService=o,this.state=a,this.resourceNames=$d,this.currentPlayer=this.playersService.getCurrentPlayer(),this.heroStats$=this.currentPlayer.hero.listenHeroStats()}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be),n.Y36(ft))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-player-resources"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"resource-info-row"],[1,"sub-info"]],template:function(a,u){1&a&&(n.YNc(0,qm,42,16,"div",0),n.ALo(1,"async")),2&a&&n.Q6J("ngIf",n.lcZ(1,1,u.heroStats$))},dependencies:[rt,Zo],styles:[".resource-info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin:2px}[_nghost-%COMP%]{font-size:12px}.sub-info[_ngcontent-%COMP%]{margin-top:8px;font-size:13px}"]})}return r})();function Ym(r,l){if(1&r&&(n.TgZ(0,"div"),n._UZ(1,"mw-ra-icon",23),n.TgZ(2,"span",24),n._uU(3),n.qZA()()),2&r){const o=n.oxw();n.xp6(1),n.Q6J("icon",o.selectedFaction.icon),n.xp6(2),n.Oqu(o.selectedFaction.title)}}function Gp(r,l){1&r&&(n.TgZ(0,"div"),n._UZ(1,"mw-ra-icon",25),n.TgZ(2,"span",24),n._uU(3,"Random"),n.qZA()())}function Qm(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"mw-ra-icon",28),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw(2);return n.KtG(m.selectFaction(h))}),n.qZA()}2&r&&n.Q6J("icon",l.$implicit.icon)}function Wm(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"mw-ra-icon",26),n.NdJ("click",function(){n.CHM(o);const u=n.oxw();return n.KtG(u.selectFaction())}),n.qZA(),n.YNc(1,Qm,1,1,"mw-ra-icon",27)}if(2&r){const o=n.oxw();n.xp6(1),n.Q6J("ngForOf",o.playableFactions)}}function $w(r,l){if(1&r&&(n.TgZ(0,"div"),n._UZ(1,"div",29),n.TgZ(2,"span",24),n._uU(3),n.qZA()()),2&r){const o=n.oxw();n.xp6(1),n.Udp("background-image","url('assets/"+o.selectedHero.image+"')"),n.xp6(2),n.Oqu(o.selectedHero.name)}}function Zw(r,l){1&r&&(n.TgZ(0,"div"),n._UZ(1,"mw-ra-icon",25),n.TgZ(2,"span",24),n._uU(3,"Random"),n.qZA()())}function Vw(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",31),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw(2);return n.KtG(m.selectHero(h))}),n._UZ(1,"div",29),n.TgZ(2,"span",24),n._uU(3),n.qZA()()}if(2&r){const o=l.$implicit;n.xp6(1),n.Udp("background-image","url('assets/"+o.image+"')"),n.xp6(2),n.Oqu(o.name)}}function qw(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",30)(1,"div",31),n.NdJ("click",function(){n.CHM(o);const u=n.oxw();return n.KtG(u.selectHero(null))}),n._UZ(2,"mw-ra-icon",25),n.TgZ(3,"span",24),n._uU(4,"Random"),n.qZA()(),n.YNc(5,Vw,4,3,"div",32),n.qZA()}if(2&r){const o=n.oxw();n.xp6(5),n.Q6J("ngForOf",o.heroes)}}function Ms(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"div",34),n.NdJ("click",function(){const h=n.CHM(o).$implicit,m=n.oxw(2);return n.KtG(m.pickColor(h))}),n.qZA()}2&r&&n.Udp("background",l.$implicit)}function Jm(r,l){if(1&r&&n.YNc(0,Ms,1,2,"div",33),2&r){const o=n.oxw();n.Q6J("ngForOf",o.colors)}}const Km=r=>[r];function zw(r,l){if(1&r&&(n.TgZ(0,"div")(1,"div"),n._uU(2),n.qZA(),n._UZ(3,"mw-ra-icon",35),n.TgZ(4,"div",36)(5,"div",37)(6,"div"),n._UZ(7,"mw-ra-icon",38),n._uU(8),n.qZA(),n.TgZ(9,"div"),n._UZ(10,"mw-ra-icon",39),n._uU(11),n.qZA(),n.TgZ(12,"div"),n._UZ(13,"mw-ra-icon",40),n._uU(14),n.qZA()(),n.TgZ(15,"div",37)(16,"div",41)(17,"div"),n._uU(18),n.qZA(),n.TgZ(19,"div"),n._uU(20),n.qZA()()()(),n.TgZ(21,"div",42),n._UZ(22,"mw-description",43),n.qZA()()),2&r){const o=n.oxw();n.xp6(2),n.hij(" ",o.selectedHero.name," "),n.xp6(6),n.hij(" ",o.selectedHero.initialState.stats.baseAttack," "),n.xp6(3),n.hij(" ",o.selectedHero.initialState.stats.baseDefence," "),n.xp6(3),n.hij(" ",o.selectedHero.initialState.stats.mana," "),n.xp6(4),n.hij(" Gold: ",o.selectedHero.initialState.resources.gold," "),n.xp6(2),n.hij(" Wood: ",o.selectedHero.initialState.resources.wood," "),n.xp6(2),n.Q6J("descriptions",n.VKq(7,Km,o.selectedHero.generalDescription))}}function Yw(r,l){if(1&r&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&r){const o=n.oxw(2);n.xp6(1),n.hij(" Play as random hero of ",o.selectedFaction.title," faction. ")}}function Xm(r,l){1&r&&(n.TgZ(0,"span"),n._uU(1,"Play as random hero of any faction."),n.qZA())}function ey(r,l){if(1&r&&(n.TgZ(0,"div")(1,"div"),n._uU(2,"Random Hero"),n.qZA(),n._UZ(3,"mw-ra-icon",44),n.TgZ(4,"div",42),n.YNc(5,Yw,2,1,"span",9)(6,Xm,2,0,"ng-template",null,45,n.W1O),n.qZA()()),2&r){const o=n.MAs(7),a=n.oxw();n.xp6(5),n.Q6J("ngIf",a.selectedFaction)("ngIfElse",o)}}const Qw=[gn];let ty=(()=>{class r{constructor(o,a,u){this.events=o,this.state=a,this.gameObjectsManager=u,this.playableFactions=Rt.iz.getAllFactions().filter(h=>!Qw.includes(h)),this.heroes=null,this.selectedHero=null,this.pickedColor=ce.PS.BLUE,this.colors=[ce.PS.BLUE,ce.PS.RED,ce.PS.GREEN],this.selectFaction(Rt.Wr),Ha(Hn.MainScreen)}startGame(){const o=this.selectedFaction||Te.DN.randItem(this.playableFactions),a=o.getTownBase();this.state.createdGame={faction:o,selectedColor:this.pickedColor,selectedHero:this.selectedHero||Te.DN.randItem(o.heroes),town:this.gameObjectsManager.createNewGameObject(ow,{townBase:a})},console.log(this.state.createdGame),this.events.dispatch(Oc())}returnToMainScreen(){this.events.dispatch(zi())}selectFaction(o){this.selectedFaction=o,console.log(o),o?(this.heroes=o.getAllHeroes(),this.selectedHero=this.heroes[0]):(this.heroes=null,this.selectedHero=null)}selectHero(o){this.selectedHero=o}pickColor(o){this.pickedColor=o}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(Ze),n.Y36(ft),n.Y36(an))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-new-game-screen"]],decls:46,vars:13,consts:[[1,"main-container"],[1,"players"],[1,"players-row"],[1,"name"],[1,"faction"],[1,"hero"],[1,"color"],[1,"player","players-row"],[3,"menuBody","pos"],[4,"ngIf","ngIfElse"],["randomFaction",""],["factionsMenu",""],["randomHero",""],["heroesMenu",""],["pos","below",3,"menuBody"],[1,"color-item",2,"position","relative","top","-6px"],["colorsMenu",""],[1,"right-panel"],[1,"hero-description"],["randomHeroDescr",""],[1,"bottom-container"],[1,"buttons"],["mw-main-button","",3,"click"],[1,"item-icon",3,"icon"],[1,"icon-subtext"],["icon","perspective-dice-four",1,"item-icon"],["icon","perspective-dice-four",1,"item-icon",3,"click"],["class","item-icon",3,"icon","click",4,"ngFor","ngForOf"],[1,"item-icon",3,"icon","click"],[1,"item-icon","hero-icon"],[2,"display","flex","max-width","228px","padding","4px","justify-content","center","flex-wrap","wrap"],[1,"hero-option",3,"click"],["class","hero-option",3,"click",4,"ngFor","ngForOf"],["class","color-item",3,"background","click",4,"ngFor","ngForOf"],[1,"color-item",3,"click"],["icon","aura",1,"hero-icon"],[1,"hero-stats"],[1,"column"],["icon","sword"],["icon","shield"],["icon","crystal-ball"],[2,"margin-top","16px"],[1,"description"],[3,"descriptions"],["icon","perspective-dice-four",1,"hero-icon"],["allRandomHero",""]],template:function(a,u){if(1&a&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),n._uU(4," Player: "),n.qZA(),n.TgZ(5,"div",4),n._uU(6," Faction: "),n.qZA(),n.TgZ(7,"div",5),n._uU(8," Hero: "),n.qZA(),n.TgZ(9,"div",6),n._uU(10," Color: "),n.qZA()(),n.TgZ(11,"div",7)(12,"div",3),n._uU(13,"Player 1"),n.qZA(),n.TgZ(14,"div",4)(15,"mw-menu",8),n.YNc(16,Ym,4,2,"div",9)(17,Gp,4,0,"ng-template",null,10,n.W1O),n.qZA(),n.YNc(19,Wm,2,1,"ng-template",null,11,n.W1O),n.qZA(),n.TgZ(21,"div",5)(22,"mw-menu",8),n.YNc(23,$w,4,3,"div",9)(24,Zw,4,0,"ng-template",null,12,n.W1O),n.qZA(),n.YNc(26,qw,6,1,"ng-template",null,13,n.W1O),n.qZA(),n.TgZ(28,"div",6)(29,"mw-menu",14),n._UZ(30,"div",15),n.qZA(),n.YNc(31,Jm,1,1,"ng-template",null,16,n.W1O),n.qZA()()(),n.TgZ(33,"div",17)(34,"div",18)(35,"div",3),n._uU(36,"Hero"),n.qZA(),n.YNc(37,zw,23,9,"div",9),n.qZA(),n.YNc(38,ey,8,2,"ng-template",null,19,n.W1O),n.qZA()(),n.TgZ(40,"div",20)(41,"div",21)(42,"button",22),n.NdJ("click",function(){return u.startGame()}),n._uU(43," Start game "),n.qZA(),n.TgZ(44,"button",22),n.NdJ("click",function(){return u.returnToMainScreen()}),n._uU(45," Return "),n.qZA()()()),2&a){const h=n.MAs(18),m=n.MAs(20),_=n.MAs(27),b=n.MAs(32),S=n.MAs(39);n.xp6(15),n.Q6J("menuBody",m)("pos","below"),n.xp6(1),n.Q6J("ngIf",u.selectedFaction)("ngIfElse",h),n.xp6(6),n.Q6J("menuBody",_)("pos","below"),n.xp6(1),n.Q6J("ngIf",u.selectedHero)("ngIfElse",h),n.xp6(6),n.Q6J("menuBody",b),n.xp6(1),n.Udp("background",u.pickedColor),n.xp6(7),n.Q6J("ngIf",u.selectedHero)("ngIfElse",S)}},dependencies:[Ie,rt,Po,lt,us,yt],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;height:100vh}.main-container[_ngcontent-%COMP%]{margin:8px;display:flex;flex-grow:1}.bottom-container[_ngcontent-%COMP%]{display:flex}.players[_ngcontent-%COMP%]{width:100%;height:200px;padding:20px;display:flex;flex-direction:column}.players-row[_ngcontent-%COMP%]{display:flex;padding:4px 0;align-items:center;font-size:13px}.players-row[_ngcontent-%COMP%] > .name[_ngcontent-%COMP%]{flex:.1 0 140px}.players-row[_ngcontent-%COMP%] > .faction[_ngcontent-%COMP%]{flex:.1 0 140px;display:flex;justify-content:center}.players-row[_ngcontent-%COMP%] > .hero[_ngcontent-%COMP%]{flex:.1 0 140px;display:flex;justify-content:center}.players-row[_ngcontent-%COMP%] > .color[_ngcontent-%COMP%]{display:flex;justify-content:center;flex:.1 0 140px}.item-icon[_ngcontent-%COMP%]{width:72px;height:42px;background-color:#545459;color:#fff;display:flex;font-size:30px;align-items:center;justify-content:center;border-radius:3px;cursor:pointer}.item-icon.hero-icon[_ngcontent-%COMP%]{background-size:cover;background-position:center center}.hero-option[_ngcontent-%COMP%]{margin:2px;cursor:pointer}.color-item[_ngcontent-%COMP%]{width:64px;height:36px;cursor:pointer}.color-item[_ngcontent-%COMP%]:not(:last-of-type){margin-bottom:2px}.icon-subtext[_ngcontent-%COMP%]{font-size:9px;text-align:center;display:block}.buttons[_ngcontent-%COMP%]{padding:20px;display:flex;margin-left:auto}.player[_ngcontent-%COMP%]{display:flex}.right-panel[_ngcontent-%COMP%]{flex:.1 0 300px;padding:10px;font-size:14px;text-align:center}.right-panel[_ngcontent-%COMP%]   .hero-description[_ngcontent-%COMP%]{padding-top:16px}.right-panel[_ngcontent-%COMP%]   .hero-description[_ngcontent-%COMP%]   .hero-icon[_ngcontent-%COMP%]{font-size:20px}.right-panel[_ngcontent-%COMP%]   .hero-description[_ngcontent-%COMP%]   .hero-stats[_ngcontent-%COMP%]{display:flex}.right-panel[_ngcontent-%COMP%]   .hero-description[_ngcontent-%COMP%]   .hero-stats[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{font-size:13px;flex:1 0 100px;text-align:left;padding-left:53px}.right-panel[_ngcontent-%COMP%]   .hero-description[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:12px;margin-top:8px;padding:6px 20px;border-top:1px solid gainsboro}"]})}return r})();function ny(r,l){if(1&r){const o=n.EpF();n.ynx(0),n._UZ(1,"mw-player-resources",3)(2,"mw-event-feed"),n.TgZ(3,"div",4)(4,"mw-round-icon-btn",5),n.NdJ("click",function(){n.CHM(o);const u=n.oxw();return n.KtG(u.openMainMenu())}),n.qZA()(),n.BQk()}}function Ww(r,l){1&r&&n._UZ(0,"mw-main-screen")}function iy(r,l){1&r&&n._UZ(0,"mw-new-game-screen")}function Jw(r,l){1&r&&n._UZ(0,"mw-gameboard")}function oy(r,l){1&r&&n._UZ(0,"mw-structures-view")}function Hp(r,l){1&r&&n._UZ(0,"mw-town-view")}class Wn extends(bt()){constructor(l){super(),this.cdr=l,this.currentView=Hn.MainScreen,this.viewTypes=Hn}openMainMenu(){this.events.dispatch(Yi())}navigateToView({view:l}){this.currentView=l}initScreen(){this.events.dispatch(tr({view:Hn.MainScreen}))}openMewGameScreen(){this.events.dispatch(tr({view:Hn.NewGame}))}openMapStructuresScreen(){this.events.dispatch(tr({view:Hn.Structures}))}playerAcceptsFight(){this.events.dispatch(tr({view:Hn.Battleground})),this.cdr.detectChanges()}structIsCompleted(l){l.struct.isInactive=!0,this.events.dispatch(tr({view:Hn.Structures})),this.events.dispatch(Hr({struct:l.struct}))}displayTown(){this.currentView=Hn.Town}static#e=this.\u0275fac=function(o){return new(o||Wn)(n.Y36(n.sBO))};static#t=this.\u0275cmp=n.Xpm({type:Wn,selectors:[["mw-view-control"]],features:[n.qOj],decls:7,vars:7,consts:[[4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"resources-panel"],[1,"menu-panel"],["mwActionHint","Main Menu","icon","repair",3,"click"]],template:function(o,a){1&o&&(n.YNc(0,ny,5,0,"ng-container",0),n.ynx(1,1),n.YNc(2,Ww,1,0,"mw-main-screen",2)(3,iy,1,0,"mw-new-game-screen",2)(4,Jw,1,0,"mw-gameboard",2)(5,oy,1,0,"mw-structures-view",2)(6,Hp,1,0,"mw-town-view",2),n.BQk()),2&o&&(n.Q6J("ngIf",a.viewTypes.MainScreen!==a.currentView&&a.viewTypes.NewGame!==a.currentView),n.xp6(1),n.Q6J("ngSwitch",a.currentView),n.xp6(1),n.Q6J("ngSwitchCase",a.viewTypes.MainScreen),n.xp6(1),n.Q6J("ngSwitchCase",a.viewTypes.NewGame),n.xp6(1),n.Q6J("ngSwitchCase",a.viewTypes.Battleground),n.xp6(1),n.Q6J("ngSwitchCase",a.viewTypes.Structures),n.xp6(1),n.Q6J("ngSwitchCase",a.viewTypes.Town))},dependencies:[rt,uo,De,Ni,Da,Gl,co,zm,k1,ty,zl,nu],styles:[".resources-panel[_ngcontent-%COMP%]{position:fixed;left:0;top:0;display:flex;flex-direction:column;width:148px;padding:8px;z-index:1}mw-event-feed[_ngcontent-%COMP%]{position:fixed;right:50%;bottom:12%;max-width:400px;z-index:10000}.menu-panel[_ngcontent-%COMP%]{position:fixed;top:0;right:0;padding:7px}"]})}Z([re(tr)],Wn.prototype,"navigateToView",null),Z([Ee(zi)],Wn.prototype,"initScreen",null),Z([Ee(Gc)],Wn.prototype,"openMewGameScreen",null),Z([Ee(Hc)],Wn.prototype,"openMapStructuresScreen",null),Z([Ee(yi)],Wn.prototype,"playerAcceptsFight",null),Z([re(Gr)],Wn.prototype,"structIsCompleted",null),Z([Ee(id)],Wn.prototype,"displayTown",null);const Kw=["hintsContainer"];function Bp(r,l){1&r&&n._UZ(0,"mw-action-card",3),2&r&&n.Q6J("actionCard",l.$implicit)}const _t=[kt,Tn,oi,Uo,wr,jt,Re,Nt,Yn,Lt,ql];let ry=(()=>{class r{constructor(o,a){this.hintsService=o,this.events=a,this.actionCards=[Um,Uw,Lw,Cs,Gw,_l,Lm,Mo,Hw],this.injectGlobalServices()}ngOnInit(){this.hintsService.containerRef=this.hintsContainer}ngAfterViewInit(){this.events.dispatch(fh())}injectGlobalServices(){_t.forEach(o=>(0,n.f3M)(o))}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(op),n.Y36(Ze))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["app-root"]],viewQuery:function(a,u){if(1&a&&n.Gf(Kw,7),2&a){let h;n.iGM(h=n.CRH())&&(u.hintsContainer=h.first)}},features:[n._Bn(_t)],decls:9,vars:1,consts:[["hintsContainer",""],[1,"test",2,"display","none"],[3,"actionCard",4,"ngFor","ngForOf"],[3,"actionCard"]],template:function(a,u){1&a&&(n._UZ(0,"mw-view-control")(1,"mw-popup-container")(2,"mw-hints-container",null,0)(4,"mw-vfx-layer")(5,"mw-custom-cursor")(6,"mw-shared-templates"),n.TgZ(7,"div",1),n.YNc(8,Bp,1,1,"mw-action-card",2),n.qZA()),2&a&&(n.xp6(8),n.Q6J("ngForOf",u.actionCards))},dependencies:[Wn,Jd,Hl,so,Ol,cC,Xd,Ie],styles:[".test[_ngcontent-%COMP%]{position:absolute;left:100px;top:100px;display:flex;gap:12px;max-width:1000px;flex-wrap:wrap}"]})}return r})(),Dt=(()=>{class r{transform(o){return(0,os.$L)(o)}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275pipe=n.Yjl({name:"infNum",type:r,pure:!0})}return r})(),ai=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275mod=n.oAB({type:r});static#n=this.\u0275inj=n.cJS({imports:[Rn]})}return r})();function ru(r,l){1&r&&n._UZ(0,"mw-ra-icon",4)}function sy(r,l){if(1&r){const o=n.EpF();n.TgZ(0,"mw-spell-button",5),n.NdJ("clicked",function(){const h=n.CHM(o).$implicit,m=n.oxw();return n.KtG(m.onAbilityClick(h))}),n.qZA()}if(2&r){const o=l.$implicit,a=n.oxw();n.Q6J("spell",o)("player",a.currentPlayer)("hero",a.currentPlayer.hero)("disabled",a.currentPlayer.hero.stats.currentMana<o.currentManaCost||a.curPlayerState.spellsAreOnCooldown)("isActive",a.curPlayerState.currentSpell===o)}}n.B6R(ep,[Ie,Ni,Jd,lt],[Dt]),n.B6R(Hl,[Dp,Oa,lt],[]),n.B6R(rp,[Po],[]),n.B6R(Ei,[tt,rp,cs,ge,lt],[]),n.B6R(qn,[Ie,rt,cs,Ei,us],[]),n.B6R(ds,[Po],[]),n.B6R(ro,[Sp],[]),n.B6R(Sp,[Ie,rt,Ql,Po,Tp,Pa,lt],[Zo]),n.B6R(Pa,[xr,rt,tt,ds,ge,lt],[]),n.B6R(vt,[Ie,Ni,ss],[]),n.B6R(so,[Oa],[]),n.B6R(Ol,[rt,Oa],[]),n.B6R(Na,[Ie,Oa],[]),n.B6R(Da,[Ie,Pg],[]),n.B6R(bp,[Ni,lt,io],[]),n.B6R(Ll,[Ie,Ni,ss,qn,Cp],[]);let su=(()=>{class r{constructor(o,a){this.players=o,this.curPlayerState=a,this.currentPlayer=this.players.getCurrentPlayer()}onAbilityClick(o){o.currentManaCost>this.currentPlayer.hero.stats.currentMana||this.curPlayerState.spellsAreOnCooldown||this.curPlayerState.playerCurrentState!==Ye.WaitsForTurn&&this.curPlayerState.onSpellClick(o)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be),n.Y36(Ut))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-battle-hero-abilities"]],decls:6,vars:3,consts:[[1,"abilities-list"],[1,"cd-icon"],["icon","hourglass",4,"ngIf"],[3,"spell","player","hero","disabled","isActive","clicked",4,"ngFor","ngForOf"],["icon","hourglass"],[3,"spell","player","hero","disabled","isActive","clicked"]],template:function(a,u){1&a&&(n.TgZ(0,"div"),n._uU(1),n.qZA(),n.TgZ(2,"div",0)(3,"div",1),n.YNc(4,ru,1,0,"mw-ra-icon",2),n.qZA(),n.YNc(5,sy,1,5,"mw-spell-button",3),n.qZA()),2&a&&(n.xp6(1),n.hij(" ",u.curPlayerState.playerCurrentState,"\n"),n.xp6(3),n.Q6J("ngIf",u.curPlayerState.spellsAreOnCooldown),n.xp6(1),n.Q6J("ngForOf",u.currentPlayer.hero.spells))},styles:[".abilities-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative;width:56px}.cd-icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:-27px;margin-top:-25%;font-size:24px}"]})}return r})();const ay=["historyLog"];function au(r,l){1&r&&n.GkF(0)}const Ds=r=>({log:r});function cy(r,l){if(1&r&&n.YNc(0,au,1,0,"ng-container",8),2&r){const o=n.oxw().$implicit;n.oxw();const a=n.MAs(7);n.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",n.VKq(2,Ds,o))}}function cu(r,l){1&r&&n.GkF(0)}function Mr(r,l){if(1&r&&n.YNc(0,cu,1,0,"ng-container",8),2&r){const o=n.oxw().$implicit;n.oxw();const a=n.MAs(13);n.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",n.VKq(2,Ds,o))}}function eb(r,l){1&r&&n.GkF(0)}function Jn(r,l){if(1&r&&n.YNc(0,eb,1,0,"ng-container",8),2&r){const o=n.oxw().$implicit;n.oxw();const a=n.MAs(11);n.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",n.VKq(2,Ds,o))}}function tb(r,l){1&r&&n.GkF(0)}function nb(r,l){if(1&r&&n.YNc(0,tb,1,0,"ng-container",8),2&r){const o=n.oxw().$implicit;n.oxw();const a=n.MAs(9);n.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",n.VKq(2,Ds,o))}}function $p(r,l){if(1&r&&(n.TgZ(0,"div",7),n.YNc(1,cy,1,4)(2,Mr,1,4)(3,Jn,1,4)(4,nb,1,4),n.qZA()),2&r){const o=l.$implicit,a=n.oxw();let u;n.xp6(1),n.um2(1,(u=o.type)===a.types.SimpleMsg?1:u===a.types.RoundInfoMsg?2:u===a.types.DealtDamageMsg?3:u===a.types.Html?4:-1)}}function ly(r,l){1&r&&n._uU(0),2&r&&n.hij(" ",l.log.message,"\n")}function uy(r,l){1&r&&(n._UZ(0,"div",9),n.ALo(1,"safeHtml")),2&r&&n.Q6J("innerHTML",n.lcZ(1,1,l.log.message),n.oJD)}function ib(r,l){if(1&r&&(n.TgZ(0,"div"),n._uU(1),n.qZA()),2&r){const o=n.oxw().log;n.xp6(1),n.hij(" ",o.damageBlocked," damage was blocked ")}}function F1(r,l){if(1&r&&(n.TgZ(0,"div")(1,"span"),n._uU(2),n.qZA(),n._uU(3),n.qZA()),2&r){const o=n.oxw().log;n.xp6(1),n.Udp("color",o.attackingPlayer.color),n.xp6(1),n.AsE("",o.attackersNumber," ",o.attacker.name,""),n.xp6(1),n.AsE(" steal ",o.stolenLife," life, reviving ",o.stolenLifeUnitsRestored," units. ")}}function ob(r,l){if(1&r&&(n.TgZ(0,"div")(1,"span"),n._uU(2),n.qZA(),n._uU(3),n.TgZ(4,"span"),n._uU(5),n.qZA(),n._uU(6),n.YNc(7,ib,2,1,"div",10)(8,F1,4,6,"div",10),n.qZA()),2&r){const o=l.log;n.xp6(1),n.Udp("color",o.attackingPlayer.color),n.xp6(1),n.AsE("",o.attackersNumber," ",o.attacker.name,""),n.xp6(1),n.AsE(" deal ",o.damage," ",o.isCritical?"critical":""," damage to "),n.xp6(1),n.Udp("color",o.attackedPlayer.color),n.xp6(1),n.AsE("",o.attackedNumber," ",o.attacked.name,""),n.xp6(1),n.hij(" , killing ",o.losses," units "),n.xp6(1),n.Q6J("ngIf",o.damageBlocked),n.xp6(1),n.Q6J("ngIf",o.stolenLife)}}function lu(r,l){if(1&r&&(n.TgZ(0,"div",11),n._uU(1),n.qZA()),2&r){const o=l.log;n.xp6(1),n.hij(" ",o.message," ")}}let uu=(()=>{class r{constructor(o){this.battleLogService=o,this.types=x.m8,this.destroyed$=new Ft.xQ}ngOnInit(){this.battleLogService.historyEvent$.pipe(Xe(this.destroyed$)).subscribe(()=>{const o=this.historyLogElem.nativeElement;setTimeout(()=>{o.scrollTo({top:o.scrollHeight,behavior:"smooth"})},0)})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(Ca))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-history-log"]],viewQuery:function(a,u){if(1&a&&n.Gf(ay,7),2&a){let h;n.iGM(h=n.CRH())&&(u.historyLogElem=h.first)}},decls:14,vars:0,consts:[[1,"history-panel"],[1,"history-log"],["historyLog",""],["simple",""],["htmlLog",""],["dealtDamageLog",""],["roundInfoMsg",""],[1,"entry"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"innerHTML"],[4,"ngIf"],[2,"padding","8px","text-align","center"],["class","entry"]],template:function(a,u){1&a&&(n.TgZ(0,"div",0),n._uU(1," Battle Log: "),n.TgZ(2,"div",1,2),n.SjG(4,$p,5,1,"div",12,n.ikw),n.qZA()(),n.YNc(6,ly,1,1,"ng-template",null,3,n.W1O)(8,uy,2,3,"ng-template",null,4,n.W1O)(10,ob,9,13,"ng-template",null,5,n.W1O)(12,lu,2,1,"ng-template",null,6,n.W1O)),2&a&&n.wJu(4,u.battleLogService.history)},dependencies:[rt,$o,hr],styles:[".history-log[_ngcontent-%COMP%]{height:200px;overflow-y:scroll;font-size:13px}.history-panel[_ngcontent-%COMP%]{background-color:#fff}.entry[_ngcontent-%COMP%]{margin-bottom:8px}"]})}return r})();function Zp(r,l){1&r&&n._UZ(0,"mw-item-icon",2),2&r&&n.Q6J("item",l.$implicit)("hintPos","after")}let Lo=(()=>{class r{constructor(o){this.players=o}ngOnInit(){this.currentPlayer=this.players.getCurrentPlayer(),this.equippedItems=this.currentPlayer.hero.inventory.getEquippedItems()}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(be))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-items-panel"]],decls:2,vars:1,consts:[[1,"items-container"],[3,"item","hintPos",4,"ngFor","ngForOf"],[3,"item","hintPos"]],template:function(a,u){1&a&&(n.TgZ(0,"div",0),n.YNc(1,Zp,1,2,"mw-item-icon",1),n.qZA()),2&a&&(n.xp6(1),n.Q6J("ngForOf",u.equippedItems))},styles:[".items-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-size:12px}"]})}return r})();const Vp=(r,l)=>({color:r,background:l});function dy(r,l){if(1&r&&(n.TgZ(0,"div",3),n._UZ(1,"mw-ra-icon",4),n.TgZ(2,"div",5)(3,"div"),n._uU(4),n.qZA(),n.TgZ(5,"div"),n._uU(6),n.qZA()()(),n.TgZ(7,"div",6),n._UZ(8,"mw-spell-description",7),n.qZA()),2&r){const o=n.oxw();n.xp6(1),n.Q6J("icon",o.icon.icon)("ngStyle",n.WLB(8,Vp,o.icon.iconClr,o.icon.bgClr)),n.xp6(3),n.Oqu(o.baseType.name),n.xp6(2),n.hij("Level ",o.buff.currentLevel,""),n.xp6(2),n.Q6J("ownerUnit",o.ownerUnit)("hero",o.ownerUnit.ownerPlayer.hero)("player",o.ownerUnit.ownerPlayer)("spell",o.buff)}}let Go=(()=>{class r{constructor(){this.hintPos="above"}ngOnChanges(o){o.buff&&(this.baseType=this.buff.baseType,this.icon=this.baseType.icon)}static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-unit-group-buff"]],inputs:{buff:"buff",ownerUnit:"ownerUnit",hintPos:"hintPos"},features:[n.TTD],decls:4,vars:7,consts:[[3,"hintBody","hintPos"],[1,"buff-icon",3,"icon","ngStyle"],["buffHint",""],[2,"display","flex"],[1,"hint-icon",3,"icon","ngStyle"],[2,"padding","4px","font-size","14px"],[2,"padding","4px","font-size","13px","max-width","240px"],[3,"ownerUnit","hero","player","spell"]],template:function(a,u){if(1&a&&(n.TgZ(0,"mw-hover-hint",0),n._UZ(1,"mw-ra-icon",1),n.qZA(),n.YNc(2,dy,9,11,"ng-template",null,2,n.W1O)),2&a){const h=n.MAs(3);n.Q6J("hintBody",h)("hintPos",u.hintPos),n.xp6(1),n.Q6J("icon",u.icon.icon)("ngStyle",n.WLB(4,Vp,u.icon.iconClr,u.icon.bgClr))}},styles:[".buff-icon[_ngcontent-%COMP%]{display:block;font-size:24px;border-radius:50%;margin:4px;text-align:center;font-size:18px;width:20px;height:20px}.hint-icon[_ngcontent-%COMP%]{width:38px;font-size:30px;text-align:center;padding-top:5px}"]})}return r})(),qa=(()=>{class r{constructor(o){this.curPlayerState=o,this.onCooldown=!1,this.hintPos="above",this.isPassive=!1}ngOnChanges(o){this.isPassive=this.spell.baseType.activationType===se.Passive,o.spell&&(this.baseType=this.spell.baseType,this.icon=this.baseType.icon),o.currentUnit&&(this.disabled=this.currentUnit!==this.owner&&this.spell.baseType.activationType!==se.Passive)}onSpellClick(o){o.stopPropagation(),!this.onCooldown&&!this.disabled&&this.owner.fightInfo.isAlive&&this.baseType.activationType!==se.Passive&&this.curPlayerState.playerCurrentState!==Ye.WaitsForTurn&&this.curPlayerState.onSpellClick(this.spell,this.owner)}static#e=this.\u0275fac=function(a){return new(a||r)(n.Y36(Ut))};static#t=this.\u0275cmp=n.Xpm({type:r,selectors:[["mw-unit-group-spell"]],inputs:{currentUnit:"currentUnit",onCooldown:"onCooldown",hintPos:"hintPos",owner:"owner",spell:"spell",hero:"hero"},features:[n.TTD],decls:1,vars:6,consts:[[3,"disabled","owner","hintPos","hero","onCooldown","spell","click"]],template:function(a,u){1&a&&(n.TgZ(0,"mw-unit-group-spell-icon",0),n.NdJ("click",function(m){return u.onSpellClick(m)}),n.qZA()),2&a&&n.Q6J("disabled",u.disabled)("owner",u.owner)("hintPos",u.hintPos)("hero",u.hero)("onCooldown",u.onCooldown)("spell",u.spell)}})}return r})(),qp=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275mod=n.oAB({type:r});static#n=this.\u0275inj=n.cJS({imports:[ai,Rn]})}return r})();n.B6R(su,[lt,Ie,rt,Wl],[]),n.B6R(co,[iu,Hm,Ni,ss,_p,io,xr,Ie,su,uu,Lo,bs],[Zo]),n.B6R(Lo,[Ei,Ie],[]),n.B6R(Wl,[ds,ge,lt,tt],[]),n.B6R(bs,[Ql,Tp,Na,lt,dm,xr,Ie,rt,Go,qa],[Zo]),n.B6R(Go,[ds,ge,lt,tt],[]),n.B6R(qa,[Pa],[]);let fy=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275mod=n.oAB({type:r});static#n=this.\u0275inj=n.cJS({imports:[Rn,ai]})}return r})(),sb=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275mod=n.oAB({type:r});static#n=this.\u0275inj=n.cJS({imports:[Rn,ai]})}return r})(),ab=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275mod=n.oAB({type:r});static#n=this.\u0275inj=n.cJS({imports:[Rn,ai]})}return r})(),hy=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275mod=n.oAB({type:r});static#n=this.\u0275inj=n.cJS({imports:[Rn,ai]})}return r})(),cb=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275mod=n.oAB({type:r});static#n=this.\u0275inj=n.cJS({imports:[Rn,ai,qp,fy,ab,sb,hy]})}return r})();class lb extends n.qLn{constructor(){super(...arguments),this.feed=(0,n.f3M)(as)}handleError(l){console.error(l),!l.message.startsWith("NG")&&this.feed.pushSystemError(l)}}let gy=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275mod=n.oAB({type:r,bootstrap:[ry]});static#n=this.\u0275inj=n.cJS({providers:[{provide:n.qLn,useClass:lb}],imports:[qp,cb,ai,eh]})}return r})();(0,n.G48)(),Uv().bootstrapModule(gy).catch(r=>console.error(r))},125:(we,J,M)=>{M.d(J,{X:()=>q});var H=M(152),N=M(229);class q extends H.xQ{constructor(Q){super(),this._value=Q}get value(){return this.getValue()}_subscribe(Q){const k=super._subscribe(Q);return k&&!k.closed&&Q.next(this._value),k}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new N.N;return this._value}next(Q){super.next(this._value=Q)}}},46:(we,J,M)=>{M.d(J,{y:()=>L});var H=M(254),q=M(297),W=M(308),k=M(677),n=M(158);var I=M(213);let L=(()=>{class V{constructor(O){this._isScalar=!1,O&&(this._subscribe=O)}lift(O){const R=new V;return R.source=this,R.operator=O,R}subscribe(O,R,E){const{operator:z}=this,ne=function Q(V,te,O){if(V){if(V instanceof H.L)return V;if(V[q.b])return V[q.b]()}return V||te||O?new H.L(V,te,O):new H.L(W.c)}(O,R,E);if(ne.add(z?z.call(ne,this.source):this.source||I.config.useDeprecatedSynchronousErrorHandling&&!ne.syncErrorThrowable?this._subscribe(ne):this._trySubscribe(ne)),I.config.useDeprecatedSynchronousErrorHandling&&ne.syncErrorThrowable&&(ne.syncErrorThrowable=!1,ne.syncErrorThrown))throw ne.syncErrorValue;return ne}_trySubscribe(O){try{return this._subscribe(O)}catch(R){I.config.useDeprecatedSynchronousErrorHandling&&(O.syncErrorThrown=!0,O.syncErrorValue=R),function N(V){for(;V;){const{closed:te,destination:O,isStopped:R}=V;if(te||R)return!1;V=O&&O instanceof H.L?O:null}return!0}(O)?O.error(R):console.warn(R)}}forEach(O,R){return new(R=U(R))((E,z)=>{let ne;ne=this.subscribe(qe=>{try{O(qe)}catch(On){z(On),ne&&ne.unsubscribe()}},z,E)})}_subscribe(O){const{source:R}=this;return R&&R.subscribe(O)}[k.L](){return this}pipe(...O){return 0===O.length?this:function $(V){return 0===V.length?n.y:1===V.length?V[0]:function(O){return V.reduce((R,E)=>E(R),O)}}(O)(this)}toPromise(O){return new(O=U(O))((R,E)=>{let z;this.subscribe(ne=>z=ne,ne=>E(ne),()=>R(z))})}}return V.create=te=>new V(te),V})();function U(V){if(V||(V=I.config.Promise||Promise),!V)throw new Error("no Promise impl found");return V}},308:(we,J,M)=>{M.d(J,{c:()=>q});var H=M(213),N=M(510);const q={closed:!0,next(W){},error(W){if(H.config.useDeprecatedSynchronousErrorHandling)throw W;(0,N.z)(W)},complete(){}}},152:(we,J,M)=>{M.d(J,{xQ:()=>B,Yc:()=>n});var H=M(46),N=M(254),q=M(902),W=M(229);class Q extends q.w{constructor(L,U){super(),this.subject=L,this.subscriber=U,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const L=this.subject,U=L.observers;if(this.subject=null,!U||0===U.length||L.isStopped||L.closed)return;const V=U.indexOf(this.subscriber);-1!==V&&U.splice(V,1)}}var k=M(297);class n extends N.L{constructor(L){super(L),this.destination=L}}let B=(()=>{class I extends H.y{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[k.b](){return new n(this)}lift(U){const V=new $(this,this);return V.operator=U,V}next(U){if(this.closed)throw new W.N;if(!this.isStopped){const{observers:V}=this,te=V.length,O=V.slice();for(let R=0;R<te;R++)O[R].next(U)}}error(U){if(this.closed)throw new W.N;this.hasError=!0,this.thrownError=U,this.isStopped=!0;const{observers:V}=this,te=V.length,O=V.slice();for(let R=0;R<te;R++)O[R].error(U);this.observers.length=0}complete(){if(this.closed)throw new W.N;this.isStopped=!0;const{observers:U}=this,V=U.length,te=U.slice();for(let O=0;O<V;O++)te[O].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(U){if(this.closed)throw new W.N;return super._trySubscribe(U)}_subscribe(U){if(this.closed)throw new W.N;return this.hasError?(U.error(this.thrownError),q.w.EMPTY):this.isStopped?(U.complete(),q.w.EMPTY):(this.observers.push(U),new Q(this,U))}asObservable(){const U=new H.y;return U.source=this,U}}return I.create=(L,U)=>new $(L,U),I})();class $ extends B{constructor(L,U){super(),this.destination=L,this.source=U}next(L){const{destination:U}=this;U&&U.next&&U.next(L)}error(L){const{destination:U}=this;U&&U.error&&this.destination.error(L)}complete(){const{destination:L}=this;L&&L.complete&&this.destination.complete()}_subscribe(L){const{source:U}=this;return U?this.source.subscribe(L):q.w.EMPTY}}},254:(we,J,M)=>{M.d(J,{L:()=>n});var H=M(594),N=M(308),q=M(902),W=M(297),Q=M(213),k=M(510);class n extends q.w{constructor(I,L,U){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=N.c;break;case 1:if(!I){this.destination=N.c;break}if("object"==typeof I){I instanceof n?(this.syncErrorThrowable=I.syncErrorThrowable,this.destination=I,I.add(this)):(this.syncErrorThrowable=!0,this.destination=new B(this,I));break}default:this.syncErrorThrowable=!0,this.destination=new B(this,I,L,U)}}[W.b](){return this}static create(I,L,U){const V=new n(I,L,U);return V.syncErrorThrowable=!1,V}next(I){this.isStopped||this._next(I)}error(I){this.isStopped||(this.isStopped=!0,this._error(I))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(I){this.destination.next(I)}_error(I){this.destination.error(I),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:I}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=I,this}}class B extends n{constructor(I,L,U,V){super(),this._parentSubscriber=I;let te,O=this;(0,H.m)(L)?te=L:L&&(te=L.next,U=L.error,V=L.complete,L!==N.c&&(O=Object.create(L),(0,H.m)(O.unsubscribe)&&this.add(O.unsubscribe.bind(O)),O.unsubscribe=this.unsubscribe.bind(this))),this._context=O,this._next=te,this._error=U,this._complete=V}next(I){if(!this.isStopped&&this._next){const{_parentSubscriber:L}=this;Q.config.useDeprecatedSynchronousErrorHandling&&L.syncErrorThrowable?this.__tryOrSetError(L,this._next,I)&&this.unsubscribe():this.__tryOrUnsub(this._next,I)}}error(I){if(!this.isStopped){const{_parentSubscriber:L}=this,{useDeprecatedSynchronousErrorHandling:U}=Q.config;if(this._error)U&&L.syncErrorThrowable?(this.__tryOrSetError(L,this._error,I),this.unsubscribe()):(this.__tryOrUnsub(this._error,I),this.unsubscribe());else if(L.syncErrorThrowable)U?(L.syncErrorValue=I,L.syncErrorThrown=!0):(0,k.z)(I),this.unsubscribe();else{if(this.unsubscribe(),U)throw I;(0,k.z)(I)}}}complete(){if(!this.isStopped){const{_parentSubscriber:I}=this;if(this._complete){const L=()=>this._complete.call(this._context);Q.config.useDeprecatedSynchronousErrorHandling&&I.syncErrorThrowable?(this.__tryOrSetError(I,L),this.unsubscribe()):(this.__tryOrUnsub(L),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(I,L){try{I.call(this._context,L)}catch(U){if(this.unsubscribe(),Q.config.useDeprecatedSynchronousErrorHandling)throw U;(0,k.z)(U)}}__tryOrSetError(I,L,U){if(!Q.config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{L.call(this._context,U)}catch(V){return Q.config.useDeprecatedSynchronousErrorHandling?(I.syncErrorValue=V,I.syncErrorThrown=!0,!0):((0,k.z)(V),!0)}return!1}_unsubscribe(){const{_parentSubscriber:I}=this;this._context=null,this._parentSubscriber=null,I.unsubscribe()}}},902:(we,J,M)=>{M.d(J,{w:()=>k});var H=M(280),N=M(755),q=M(594);const Q=(()=>{function B($){return Error.call(this),this.message=$?`${$.length} errors occurred during unsubscription:\n${$.map((I,L)=>`${L+1}) ${I.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=$,this}return B.prototype=Object.create(Error.prototype),B})();class k{constructor($){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,$&&(this._ctorUnsubscribe=!0,this._unsubscribe=$)}unsubscribe(){let $;if(this.closed)return;let{_parentOrParents:I,_ctorUnsubscribe:L,_unsubscribe:U,_subscriptions:V}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,I instanceof k)I.remove(this);else if(null!==I)for(let te=0;te<I.length;++te)I[te].remove(this);if((0,q.m)(U)){L&&(this._unsubscribe=void 0);try{U.call(this)}catch(te){$=te instanceof Q?n(te.errors):[te]}}if((0,H.k)(V)){let te=-1,O=V.length;for(;++te<O;){const R=V[te];if((0,N.K)(R))try{R.unsubscribe()}catch(E){$=$||[],E instanceof Q?$=$.concat(n(E.errors)):$.push(E)}}}if($)throw new Q($)}add($){let I=$;if(!$)return k.EMPTY;switch(typeof $){case"function":I=new k($);case"object":if(I===this||I.closed||"function"!=typeof I.unsubscribe)return I;if(this.closed)return I.unsubscribe(),I;if(!(I instanceof k)){const V=I;I=new k,I._subscriptions=[V]}break;default:throw new Error("unrecognized teardown "+$+" added to Subscription.")}let{_parentOrParents:L}=I;if(null===L)I._parentOrParents=this;else if(L instanceof k){if(L===this)return I;I._parentOrParents=[L,this]}else{if(-1!==L.indexOf(this))return I;L.push(this)}const U=this._subscriptions;return null===U?this._subscriptions=[I]:U.push(I),I}remove($){const I=this._subscriptions;if(I){const L=I.indexOf($);-1!==L&&I.splice(L,1)}}}var B;function n(B){return B.reduce(($,I)=>$.concat(I instanceof Q?I.errors:I),[])}k.EMPTY=((B=new k).closed=!0,B)},213:(we,J,M)=>{M.d(J,{config:()=>N});let H=!1;const N={Promise:void 0,set useDeprecatedSynchronousErrorHandling(q){if(q){const W=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+W.stack)}else H&&console.log("RxJS: Back to a better error behavior. Thank you. <3");H=q},get useDeprecatedSynchronousErrorHandling(){return H}}},846:(we,J,M)=>{M.d(J,{Ds:()=>k,IY:()=>W,ft:()=>B});var H=M(254),N=M(46),q=M(372);class W extends H.L{constructor(I){super(),this.parent=I}_next(I){this.parent.notifyNext(I)}_error(I){this.parent.notifyError(I),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class k extends H.L{notifyNext(I){this.destination.next(I)}notifyError(I){this.destination.error(I)}notifyComplete(){this.destination.complete()}}function B($,I){if(I.closed)return;if($ instanceof N.y)return $.subscribe(I);let L;try{L=(0,q.s)($)(I)}catch(U){I.error(U)}return L}},253:(we,J,M)=>{M.d(J,{D:()=>O});var H=M(46),N=M(372),q=M(902),W=M(677),n=M(513),B=M(258),L=M(7),U=M(990);function O(R,E){return E?function te(R,E){if(null!=R){if(function I(R){return R&&"function"==typeof R[W.L]}(R))return function Q(R,E){return new H.y(z=>{const ne=new q.w;return ne.add(E.schedule(()=>{const qe=R[W.L]();ne.add(qe.subscribe({next(On){ne.add(E.schedule(()=>z.next(On)))},error(On){ne.add(E.schedule(()=>z.error(On)))},complete(){ne.add(E.schedule(()=>z.complete()))}}))})),ne})}(R,E);if((0,L.t)(R))return function k(R,E){return new H.y(z=>{const ne=new q.w;return ne.add(E.schedule(()=>R.then(qe=>{ne.add(E.schedule(()=>{z.next(qe),ne.add(E.schedule(()=>z.complete()))}))},qe=>{ne.add(E.schedule(()=>z.error(qe)))}))),ne})}(R,E);if((0,U.z)(R))return(0,n.r)(R,E);if(function V(R){return R&&"function"==typeof R[B.hZ]}(R)||"string"==typeof R)return function $(R,E){if(!R)throw new Error("Iterable cannot be null");return new H.y(z=>{const ne=new q.w;let qe;return ne.add(()=>{qe&&"function"==typeof qe.return&&qe.return()}),ne.add(E.schedule(()=>{qe=R[B.hZ](),ne.add(E.schedule(function(){if(z.closed)return;let On,Dr;try{const li=qe.next();On=li.value,Dr=li.done}catch(li){return void z.error(li)}Dr?z.complete():(z.next(On),this.schedule())}))})),ne})}(R,E)}throw new TypeError((null!==R&&typeof R||R)+" is not observable")}(R,E):R instanceof H.y?R:new H.y((0,N.s)(R))}},816:(we,J,M)=>{M.d(J,{n:()=>W});var H=M(46),N=M(947),q=M(513);function W(Q,k){return k?(0,q.r)(Q,k):new H.y((0,N.V)(Q))}},117:(we,J,M)=>{M.d(J,{T:()=>V});var H=M(46),N=M(759),q=M(124),W=M(253),Q=M(846);function k(te,O,R=Number.POSITIVE_INFINITY){return"function"==typeof O?E=>E.pipe(k((z,ne)=>(0,W.D)(te(z,ne)).pipe((0,q.U)((qe,On)=>O(z,qe,ne,On))),R)):("number"==typeof O&&(R=O),E=>E.lift(new n(te,R)))}class n{constructor(O,R=Number.POSITIVE_INFINITY){this.project=O,this.concurrent=R}call(O,R){return R.subscribe(new B(O,this.project,this.concurrent))}}class B extends Q.Ds{constructor(O,R,E=Number.POSITIVE_INFINITY){super(O),this.project=R,this.concurrent=E,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(O){this.active<this.concurrent?this._tryNext(O):this.buffer.push(O)}_tryNext(O){let R;const E=this.index++;try{R=this.project(O,E)}catch(z){return void this.destination.error(z)}this.active++,this._innerSub(R)}_innerSub(O){const R=new Q.IY(this),E=this.destination;E.add(R);const z=(0,Q.ft)(O,R);z!==R&&E.add(z)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(O){this.destination.next(O)}notifyComplete(){const O=this.buffer;this.active--,O.length>0?this._next(O.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}var I=M(158);function L(te=Number.POSITIVE_INFINITY){return k(I.y,te)}var U=M(816);function V(...te){let O=Number.POSITIVE_INFINITY,R=null,E=te[te.length-1];return(0,N.K)(E)?(R=te.pop(),te.length>1&&"number"==typeof te[te.length-1]&&(O=te.pop())):"number"==typeof E&&(O=te.pop()),null===R&&1===te.length&&te[0]instanceof H.y?te[0]:L(O)((0,U.n)(te,R))}},193:(we,J,M)=>{M.d(J,{of:()=>W});var H=M(759),N=M(816),q=M(513);function W(...Q){let k=Q[Q.length-1];return(0,H.K)(k)?(Q.pop(),(0,q.r)(Q,k)):(0,N.n)(Q)}},124:(we,J,M)=>{M.d(J,{U:()=>N});var H=M(254);function N(Q,k){return function(B){if("function"!=typeof Q)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return B.lift(new q(Q,k))}}class q{constructor(k,n){this.project=k,this.thisArg=n}call(k,n){return n.subscribe(new W(k,this.project,this.thisArg))}}class W extends H.L{constructor(k,n,B){super(k),this.project=n,this.count=0,this.thisArg=B||this}_next(k){let n;try{n=this.project.call(this.thisArg,k,this.count++)}catch(B){return void this.destination.error(B)}this.destination.next(n)}}},222:(we,J,M)=>{M.d(J,{w:()=>W});var H=M(124),N=M(253),q=M(846);function W(n,B){return"function"==typeof B?$=>$.pipe(W((I,L)=>(0,N.D)(n(I,L)).pipe((0,H.U)((U,V)=>B(I,U,L,V))))):$=>$.lift(new Q(n))}class Q{constructor(B){this.project=B}call(B,$){return $.subscribe(new k(B,this.project))}}class k extends q.Ds{constructor(B,$){super(B),this.project=$,this.index=0}_next(B){let $;const I=this.index++;try{$=this.project(B,I)}catch(L){return void this.destination.error(L)}this._innerSub($)}_innerSub(B){const $=this.innerSubscription;$&&$.unsubscribe();const I=new q.IY(this),L=this.destination;L.add(I),this.innerSubscription=(0,q.ft)(B,I),this.innerSubscription!==I&&L.add(this.innerSubscription)}_complete(){const{innerSubscription:B}=this;(!B||B.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(B){this.destination.next(B)}}},513:(we,J,M)=>{M.d(J,{r:()=>q});var H=M(46),N=M(902);function q(W,Q){return new H.y(k=>{const n=new N.w;let B=0;return n.add(Q.schedule(function(){B!==W.length?(k.next(W[B++]),k.closed||n.add(this.schedule())):k.complete()})),n})}},258:(we,J,M)=>{M.d(J,{hZ:()=>N});const N=function H(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},677:(we,J,M)=>{M.d(J,{L:()=>H});const H="function"==typeof Symbol&&Symbol.observable||"@@observable"},297:(we,J,M)=>{M.d(J,{b:()=>H});const H="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()},229:(we,J,M)=>{M.d(J,{N:()=>N});const N=(()=>{function q(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return q.prototype=Object.create(Error.prototype),q})()},510:(we,J,M)=>{function H(N){setTimeout(()=>{throw N},0)}M.d(J,{z:()=>H})},158:(we,J,M)=>{function H(N){return N}M.d(J,{y:()=>H})},280:(we,J,M)=>{M.d(J,{k:()=>H});const H=Array.isArray||(N=>N&&"number"==typeof N.length)},990:(we,J,M)=>{M.d(J,{z:()=>H});const H=N=>N&&"number"==typeof N.length&&"function"!=typeof N},594:(we,J,M)=>{function H(N){return"function"==typeof N}M.d(J,{m:()=>H})},755:(we,J,M)=>{function H(N){return null!==N&&"object"==typeof N}M.d(J,{K:()=>H})},7:(we,J,M)=>{function H(N){return!!N&&"function"!=typeof N.subscribe&&"function"==typeof N.then}M.d(J,{t:()=>H})},759:(we,J,M)=>{function H(N){return N&&"function"==typeof N.schedule}M.d(J,{K:()=>H})},372:(we,J,M)=>{M.d(J,{s:()=>L});var H=M(947),N=M(510),W=M(258),k=M(677),B=M(990),$=M(7),I=M(755);const L=U=>{if(U&&"function"==typeof U[k.L])return(U=>V=>{const te=U[k.L]();if("function"!=typeof te.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return te.subscribe(V)})(U);if((0,B.z)(U))return(0,H.V)(U);if((0,$.t)(U))return(U=>V=>(U.then(te=>{V.closed||(V.next(te),V.complete())},te=>V.error(te)).then(null,N.z),V))(U);if(U&&"function"==typeof U[W.hZ])return(U=>V=>{const te=U[W.hZ]();for(;;){let O;try{O=te.next()}catch(R){return V.error(R),V}if(O.done){V.complete();break}if(V.next(O.value),V.closed)break}return"function"==typeof te.return&&V.add(()=>{te.return&&te.return()}),V})(U);{const te=`You provided ${(0,I.K)(U)?"an invalid object":`'${U}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(te)}}},947:(we,J,M)=>{M.d(J,{V:()=>H});const H=N=>q=>{for(let W=0,Q=N.length;W<Q&&!q.closed;W++)q.next(N[W]);q.complete()}},729:(we,J,M)=>{function H(e,t){return Object.is(e,t)}M.d(J,{AFp:()=>Uh,hGG:()=>cE,Ojb:()=>Gh,sBO:()=>Wg,EJc:()=>pI,ktI:()=>Ea,SBq:()=>Io,qLn:()=>Ao,vpe:()=>Ai,OlP:()=>Ce,zs3:()=>Vn,ZZ4:()=>np,aQg:()=>ip,soG:()=>Oy,h0i:()=>Qa,R0b:()=>vt,Lbi:()=>_d,g9A:()=>rl,Qsj:()=>hr,FYo:()=>lt,JOm:()=>aa,q3G:()=>pr,Rgc:()=>nf,dDg:()=>$I,eoX:()=>YD,GfV:()=>mt,s_b:()=>ou,ifc:()=>Bi,Flj:()=>rs,Lck:()=>ix,eFA:()=>XD,G48:()=>nE,Gpc:()=>ec,f3M:()=>Ae,X6Q:()=>tE,_c5:()=>aE,tdS:()=>d1,rg0:()=>bg,zSh:()=>Wi,wAp:()=>gu,vHH:()=>ie,lri:()=>qD,rWj:()=>zD,JZr:()=>nc,EiD:()=>es,mCW:()=>Cl,qzn:()=>Xr,JVY:()=>U_,pB0:()=>B_,eBb:()=>G_,L6k:()=>L_,LAX:()=>H_,cg1:()=>fb,kuF:()=>ui,kL8:()=>$1,dqk:()=>tt,QGY:()=>mb,F4k:()=>mM,RDi:()=>vd,AaK:()=>St,z3N:()=>Xi,qOj:()=>Ep,Xq5:()=>yr,TTD:()=>Gs,_Bn:()=>KM,xp6:()=>Rg,uIk:()=>Na,Tol:()=>Mm,ekj:()=>Op,um2:()=>ey,Xpm:()=>Sv,lG2:()=>xv,Yz7:()=>et,cJS:()=>rc,oAB:()=>Uu,Yjl:()=>Iv,Y36:()=>io,_UZ:()=>db,GkF:()=>pb,BQk:()=>wy,ynx:()=>Cy,qZA:()=>_y,TgZ:()=>vy,EpF:()=>H1,n5z:()=>sd,LFG:()=>Zt,$8M:()=>Mt,NdJ:()=>yb,CRH:()=>wD,O4$:()=>bt,oxw:()=>wM,ALo:()=>gD,lcZ:()=>mD,Hsn:()=>MM,F$t:()=>bM,Q6J:()=>zl,MGl:()=>Ty,VKq:()=>cD,WLB:()=>lD,iGM:()=>_D,MAs:()=>kM,wJu:()=>oy,SjG:()=>iy,x6l:()=>ny,ikw:()=>ty,KtG:()=>oh,CHM:()=>Yu,oJD:()=>Je,LSH:()=>bl,B6R:()=>eD,Akn:()=>ri,Udp:()=>Ap,YNc:()=>Ms,W1O:()=>SD,_uU:()=>$M,Oqu:()=>vb,hij:()=>xy,AsE:()=>_b,lnq:()=>Cb,Gf:()=>CD});let N=null,q=!1,W=1;const Q=Symbol("SIGNAL");function k(e){const t=N;return N=e,t}const I={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function L(e){if(q)throw new Error("");if(null===N)return;N.consumerOnSignalRead(e);const t=N.nextProducerIndex++;xs(N),t<N.producerNode.length&&N.producerNode[t]!==e&&li(N)&&Dr(N.producerNode[t],N.producerIndexOfThis[t]),N.producerNode[t]!==e&&(N.producerNode[t]=e,N.producerIndexOfThis[t]=li(N)?On(e,N,t):0),N.producerLastReadVersion[t]=e.version}function V(e){if((!li(e)||e.dirty)&&(e.dirty||e.lastCleanEpoch!==W)){if(!e.producerMustRecompute(e)&&!ne(e))return e.dirty=!1,void(e.lastCleanEpoch=W);e.producerRecomputeValue(e),e.dirty=!1,e.lastCleanEpoch=W}}function te(e){if(void 0===e.liveConsumerNode)return;const t=q;q=!0;try{for(const i of e.liveConsumerNode)i.dirty||R(i)}finally{q=t}}function O(){return!1!==N?.consumerAllowSignalWrites}function R(e){e.dirty=!0,te(e),e.consumerMarkedDirty?.(e)}function E(e){return e&&(e.nextProducerIndex=0),k(e)}function z(e,t){if(k(t),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(li(e))for(let i=e.nextProducerIndex;i<e.producerNode.length;i++)Dr(e.producerNode[i],e.producerIndexOfThis[i]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function ne(e){xs(e);for(let t=0;t<e.producerNode.length;t++){const i=e.producerNode[t],s=e.producerLastReadVersion[t];if(s!==i.version||(V(i),s!==i.version))return!0}return!1}function On(e,t,i){if(jy(e),xs(e),0===e.liveConsumerNode.length)for(let s=0;s<e.producerNode.length;s++)e.producerIndexOfThis[s]=On(e.producerNode[s],e,s);return e.liveConsumerIndexOfThis.push(i),e.liveConsumerNode.push(t)-1}function Dr(e,t){if(jy(e),xs(e),1===e.liveConsumerNode.length)for(let s=0;s<e.producerNode.length;s++)Dr(e.producerNode[s],e.producerIndexOfThis[s]);const i=e.liveConsumerNode.length-1;if(e.liveConsumerNode[t]=e.liveConsumerNode[i],e.liveConsumerIndexOfThis[t]=e.liveConsumerIndexOfThis[i],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,t<e.liveConsumerNode.length){const s=e.liveConsumerIndexOfThis[t],c=e.liveConsumerNode[t];xs(c),c.producerIndexOfThis[s]=t}}function li(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function xs(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}function jy(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}const lf=Symbol("UNSET"),Ka=Symbol("COMPUTING"),Bo=Symbol("ERRORED"),Sr=(()=>({...I,value:lf,dirty:!0,error:null,equal:H,producerMustRecompute:e=>e.value===lf||e.value===Ka,producerRecomputeValue(e){if(e.value===Ka)throw new Error("Detected cycle in computations.");const t=e.value;e.value=Ka;const i=E(e);let s;try{s=e.computation()}catch(c){s=Bo,e.error=c}finally{z(e,i)}t!==lf&&t!==Bo&&s!==Bo&&e.equal(t,s)?e.value=t:(e.value=s,e.version++)}}))();let ze=function Qt(){throw new Error};function Wt(){ze()}let Cu=null;function uf(e,t){O()||Wt();const i=e.value;Object.is(i,t)||e.equal(i,t)||(e.value=t,function Is(e){e.version++,function U(){W++}(),te(e),Cu?.()}(e))}const n0=(()=>({...I,equal:H,value:void 0}))();var pf=M(152),ff=M(902),hf=M(46),Vy=M(117),qy=M(125),gf=M(193),mf=M(254);function yf(){return function(t){return t.lift(new o0(t))}}class o0{constructor(t){this.connectable=t}call(t,i){const{connectable:s}=this;s._refCount++;const c=new Nn(t,s),d=i.subscribe(c);return c.closed||(c.connection=s.connect()),d}}class Nn extends mf.L{constructor(t,i){super(t),this.connectable=i}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const i=t._refCount;if(i<=0)return void(this.connection=null);if(t._refCount=i-1,i>1)return void(this.connection=null);const{connection:s}=this,c=t._connection;this.connection=null,c&&(!s||c===s)&&c.unsubscribe()}}class bu extends hf.y{constructor(t,i){super(),this.source=t,this.subjectFactory=i,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new ff.w,t.add(this.source.subscribe(new Yy(this.getSubject(),this))),t.closed&&(this._connection=null,t=ff.w.EMPTY)),t}refCount(){return yf()(this)}}const zy=(()=>{const e=bu.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}})();class Yy extends pf.Yc{constructor(t,i){super(t),this.connectable=i}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const i=t._connection;t._refCount=0,t._subject=null,t._connection=null,i&&i.unsubscribe()}}}class Wy{constructor(t,i){this.subjectFactory=t,this.selector=i}call(t,i){const{selector:s}=this,c=this.subjectFactory(),d=s(c).subscribe(t);return d.add(i.subscribe(c)),d}}function Ui(){return new pf.xQ}function ke(){return e=>yf()(function Ps(e,t){return function(s){let c;if(c="function"==typeof e?e:function(){return e},"function"==typeof t)return s.lift(new Wy(c,t));const d=Object.create(s,zy);return d.source=s,d.subjectFactory=c,d}}(Ui)(e))}var Ue=M(222);class Xa{constructor(t,i){this.compare=t,this.keySelector=i}call(t,i){return i.subscribe(new Li(t,this.compare,this.keySelector))}}class Li extends mf.L{constructor(t,i,s){super(t),this.keySelector=s,this.hasKey=!1,"function"==typeof i&&(this.compare=i)}compare(t,i){return t===i}_next(t){let i;try{const{keySelector:c}=this;i=c?c(t):t}catch(c){return this.destination.error(c)}let s=!1;if(this.hasKey)try{const{compare:c}=this;s=c(this.key,i)}catch(c){return this.destination.error(c)}else this.hasKey=!0;s||(this.key=i,this.destination.next(t))}}function Ne(e){for(let t in e)if(e[t]===Ne)return t;throw Error("Could not find renamed property on target object.")}function cn(e,t){for(const i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i])}function St(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(St).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const i=t.indexOf("\n");return-1===i?t:t.substring(0,i)}function ht(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const Ke=Ne({__forward_ref__:Ne});function ec(e){return e.__forward_ref__=ec,e.toString=function(){return St(this())},e}function le(e){return tc(e)?e():e}function tc(e){return"function"==typeof e&&e.hasOwnProperty(Ke)&&e.__forward_ref__===ec}function Tr(e){return e&&!!e.\u0275providers}const nc="https://g.co/ng/security#xss";class ie extends Error{constructor(t,i){super(ui(t,i)),this.code=t}}function ui(e,t){return`NG0${Math.abs(e)}${t?": "+t:""}`}const jo=Ne({\u0275cmp:Ne}),Mu=Ne({\u0275dir:Ne}),ic=Ne({\u0275pipe:Ne}),vf=Ne({\u0275mod:Ne}),Gi=Ne({\u0275fac:Ne}),As=Ne({__NG_ELEMENT_ID__:Ne}),_f=Ne({__NG_ENV_ID__:Ne});function _e(e){return"string"==typeof e?e:null==e?"":String(e)}function ks(e,t){throw new ie(-201,!1)}function un(e,t){null==e&&function pe(e,t,i,s){throw new Error(`ASSERTION ERROR: ${e}`+(null==s?"":` [Expected=> ${i} ${s} ${t} <=Actual]`))}(t,e,null,"!=")}function et(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function rc(e){return{providers:e.providers||[],imports:e.imports||[]}}function Ie(e){return rv(e,Ns)||rv(e,ac)}function rv(e,t){return e.hasOwnProperty(t)?e[t]:null}function sc(e){return e&&(e.hasOwnProperty(Tu)||e.hasOwnProperty(uo))?e[Tu]:null}const Ns=Ne({\u0275prov:Ne}),Tu=Ne({\u0275inj:Ne}),ac=Ne({ngInjectableDef:Ne}),uo=Ne({ngInjectorDef:Ne});var De=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(De||{});let xu;function vn(e){const t=xu;return xu=e,t}function Iu(e,t,i){const s=Ie(e);return s&&"root"==s.providedIn?void 0===s.value?s.value=s.factory():s.value:i&De.Optional?null:void 0!==t?t:void ks(St(e))}const tt=globalThis;class Ce{constructor(t,i){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof i?this.__NG_ELEMENT_ID__=i:void 0!==i&&(this.\u0275prov=et({token:this,providedIn:i.providedIn||"root",factory:i.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Fs={},ku="__NG_DI_FLAG__",cc="ngTempTokenPath",cv=/\n/gm,Df="__source";let Fn;function po(e){const t=Fn;return Fn=e,t}function uv(e,t=De.Default){if(void 0===Fn)throw new ie(-203,!1);return null===Fn?Iu(e,void 0,t):Fn.get(e,t&De.Optional?null:void 0,t)}function Zt(e,t=De.Default){return(function sv(){return xu}()||uv)(le(e),t)}function Ae(e,t=De.Default){return Zt(e,Nu(t))}function Nu(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function Tf(e){const t=[];for(let i=0;i<e.length;i++){const s=le(e[i]);if(Array.isArray(s)){if(0===s.length)throw new ie(900,!1);let c,d=De.Default;for(let p=0;p<s.length;p++){const f=s[p],g=xf(f);"number"==typeof g?-1===g?c=f.token:d|=g:c=f}t.push(Zt(c,d))}else t.push(Zt(s))}return t}function Rn(e,t){return e[ku]=t,e.prototype[ku]=t,e}function xf(e){return e[ku]}function Hi(e){return{toString:e}.toString()}var Fu=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(Fu||{}),Bi=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(Bi||{});const ji={},Ge=[];function fv(e,t,i){let s=e.length;for(;;){const c=e.indexOf(t,i);if(-1===c)return c;if(0===c||e.charCodeAt(c-1)<=32){const d=t.length;if(c+d===s||e.charCodeAt(c+d)<=32)return c}i=c+1}}function If(e,t,i){let s=0;for(;s<i.length;){const c=i[s];if("number"==typeof c){if(0!==c)break;s++;const d=i[s++],p=i[s++],f=i[s++];e.setAttribute(t,p,f,d)}else{const d=c,p=i[++s];Ef(d)?e.setProperty(t,d,p):e.setAttribute(t,d,p),s++}}return s}function hv(e){return 3===e||4===e||6===e}function Ef(e){return 64===e.charCodeAt(0)}function uc(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let i=-1;for(let s=0;s<t.length;s++){const c=t[s];"number"==typeof c?i=c:0===i||Pf(e,i,c,null,-1===i||2===i?t[++s]:null)}}return e}function Pf(e,t,i,s,c){let d=0,p=e.length;if(-1===t)p=-1;else for(;d<e.length;){const f=e[d++];if("number"==typeof f){if(f===t){p=-1;break}if(f>t){p=d-1;break}}}for(;d<e.length;){const f=e[d];if("number"==typeof f)break;if(f===i){if(null===s)return void(null!==c&&(e[d+1]=c));if(s===e[d+1])return void(e[d+2]=c)}d++,null!==s&&d++,null!==c&&d++}-1!==p&&(e.splice(p,0,t),d=p+1),e.splice(d++,0,i),null!==s&&e.splice(d++,0,s),null!==c&&e.splice(d++,0,c)}const gv="ng-template";function Ru(e,t,i){let s=0,c=!0;for(;s<e.length;){let d=e[s++];if("string"==typeof d&&c){const p=e[s++];if(i&&"class"===d&&-1!==fv(p.toLowerCase(),t,0))return!0}else{if(1===d){for(;s<e.length&&"string"==typeof(d=e[s++]);)if(d.toLowerCase()===t)return!0;return!1}"number"==typeof d&&(c=!1)}}return!1}function mv(e){return 4===e.type&&e.value!==gv}function yv(e,t,i){return t===(4!==e.type||i?e.value:gv)}function vv(e,t,i){let s=4;const c=e.attrs||[],d=function _v(e){for(let t=0;t<e.length;t++)if(hv(e[t]))return t;return e.length}(c);let p=!1;for(let f=0;f<t.length;f++){const g=t[f];if("number"!=typeof g){if(!p)if(4&s){if(s=2|1&s,""!==g&&!yv(e,g,i)||""===g&&1===t.length){if(Xn(s))return!1;p=!0}}else{const y=8&s?g:t[++f];if(8&s&&null!==e.attrs){if(!Ru(e.attrs,y,i)){if(Xn(s))return!1;p=!0}continue}const C=dc(8&s?"class":g,c,mv(e),i);if(-1===C){if(Xn(s))return!1;p=!0;continue}if(""!==y){let w;w=C>d?"":c[C+1].toLowerCase();const D=8&s?w:null;if(D&&-1!==fv(D,y,0)||2&s&&y!==w){if(Xn(s))return!1;p=!0}}}}else{if(!p&&!Xn(s)&&!Xn(g))return!1;if(p&&Xn(g))continue;p=!1,s=g|1&s}}return Xn(s)||p}function Xn(e){return 0==(1&e)}function dc(e,t,i,s){if(null===t)return-1;let c=0;if(s||!i){let d=!1;for(;c<t.length;){const p=t[c];if(p===e)return c;if(3===p||6===p)d=!0;else{if(1===p||2===p){let f=t[++c];for(;"string"==typeof f;)f=t[++c];continue}if(4===p)break;if(0===p){c+=4;continue}}c+=d?1:2}return-1}return function Cv(e,t){let i=e.indexOf(4);if(i>-1)for(i++;i<e.length;){const s=e[i];if("number"==typeof s)return-1;if(s===t)return i;i++}return-1}(t,e)}function Af(e,t,i=!1){for(let s=0;s<t.length;s++)if(vv(e,t[s],i))return!0;return!1}function b0(e,t){e:for(let i=0;i<t.length;i++){const s=t[i];if(e.length===s.length){for(let c=0;c<e.length;c++)if(e[c]!==s[c])continue e;return!0}}return!1}function wv(e,t){return e?":not("+t.trim()+")":t}function bv(e){let t=e[0],i=1,s=2,c="",d=!1;for(;i<e.length;){let p=e[i];if("string"==typeof p)if(2&s){const f=e[++i];c+="["+p+(f.length>0?'="'+f+'"':"")+"]"}else 8&s?c+="."+p:4&s&&(c+=" "+p);else""!==c&&!Xn(p)&&(t+=wv(d,c),c=""),s=p,d=d||!Xn(s);i++}return""!==c&&(t+=wv(d,c)),t}function Sv(e){return Hi(()=>{const t=ut(e),i={...t,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===Fu.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||Bi.Emulated,styles:e.styles||Ge,_:null,schemas:e.schemas||null,tView:null,id:""};Ev(i);const s=e.dependencies;return i.directiveDefs=Lu(s,!1),i.pipeDefs=Lu(s,!0),i.id=function S0(e){let t=0;const i=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const c of i)t=Math.imul(31,t)+c.charCodeAt(0)<<0;return t+=2147483648,"c"+t}(i),i})}function M0(e){return Se(e)||Et(e)}function Tv(e){return null!==e}function Uu(e){return Hi(()=>({type:e.type,bootstrap:e.bootstrap||Ge,declarations:e.declarations||Ge,imports:e.imports||Ge,exports:e.exports||Ge,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function Of(e,t){if(null==e)return ji;const i={};for(const s in e)if(e.hasOwnProperty(s)){let c=e[s],d=c;Array.isArray(c)&&(d=c[1],c=c[0]),i[c]=s,t&&(t[c]=d)}return i}function xv(e){return Hi(()=>{const t=ut(e);return Ev(t),t})}function Iv(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,standalone:!0===e.standalone,onDestroy:e.type.prototype.ngOnDestroy||null}}function Se(e){return e[jo]||null}function Et(e){return e[Mu]||null}function Gt(e){return e[ic]||null}function ut(e){const t={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputTransforms:null,inputConfig:e.inputs||ji,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||Ge,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Of(e.inputs,t),outputs:Of(e.outputs),debugInfo:null}}function Ev(e){e.features?.forEach(t=>t(e))}function Lu(e,t){if(!e)return null;const i=t?Gt:M0;return()=>("function"==typeof e?e():e).map(s=>i(s)).filter(Tv)}const wt=0,Y=1,me=2,st=3,di=4,Kt=5,$i=6,Vo=7,We=8,Xt=9,fo=10,fe=11,pc=12,Pv=13,qo=14,at=15,fc=16,Rs=17,pi=18,hc=19,Av=20,zo=21,Gu=22,Er=23,ye=25,kf=1,Nf=2,Ff=6,fi=7,Us=9,Tt=11;function Vt(e){return Array.isArray(e)&&"object"==typeof e[kf]}function Ht(e){return Array.isArray(e)&&!0===e[kf]}function Rf(e){return 0!=(4&e.flags)}function Pr(e){return e.componentOffset>-1}function Hu(e){return 1==(1&e.flags)}function hi(e){return!!e.template}function Uf(e){return 0!=(512&e[me])}function ho(e,t){return e.hasOwnProperty(Gi)?e[Gi]:null}class Zf{constructor(t,i,s){this.previousValue=t,this.currentValue=i,this.firstChange=s}isFirstChange(){return this.firstChange}}function Gs(){return Vf}function Vf(e){return e.type.prototype.ngOnChanges&&(e.setInput=qf),N0}function N0(){const e=_c(this),t=e?.current;if(t){const i=e.previous;if(i===ji)e.previous=t;else for(let s in t)i[s]=t[s];e.current=null,this.ngOnChanges(t)}}function qf(e,t,i,s){const c=this.declaredInputs[i],d=_c(e)||function Yf(e,t){return e[zf]=t}(e,{previous:ji,current:null}),p=d.current||(d.current={}),f=d.previous,g=f[c];p[c]=new Zf(g&&g.currentValue,t,f===ji),e[s]=t}Gs.ngInherit=!0;const zf="__ngSimpleChanges__";function _c(e){return e[zf]||null}const gi=function(e,t,i){},Wf="svg";function nt(e){for(;Array.isArray(e);)e=e[wt];return e}function Ar(e,t){return nt(t[e])}function dn(e,t){return nt(t[e.index])}function Hs(e,t){return e.data[t]}function Or(e,t){return e[t]}function pn(e,t){const i=t[e];return Vt(i)?i:i[wt]}function Vu(e){return 128==(128&e[me])}function ei(e,t){return null==t?null:e[t]}function eh(e){e[Rs]=0}function F0(e){1024&e[me]||(e[me]|=1024,Vu(e)&&qu(e))}function Lv(e){9216&e[me]&&qu(e)}function qu(e){let t=e[st];for(;null!==t&&!(Ht(t)&&t[Ff]||Vt(t)&&8192&t[me]);){if(Ht(t))t[Ff]=!0;else if(t[me]|=8192,!Vu(t))break;t=t[st]}}function Cc(e,t){if(256==(256&e[me]))throw new ie(911,!1);null===e[zo]&&(e[zo]=[]),e[zo].push(t)}const ae={lFrame:Ee(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Gv(){return ae.bindingsEnabled}function Bs(){return null!==ae.skipHydrationRootTNode}function F(){return ae.lFrame.lView}function Pe(){return ae.lFrame.tView}function Yu(e){return ae.lFrame.contextLView=e,e[We]}function oh(e){return ae.lFrame.contextLView=null,e}function $e(){let e=Qu();for(;null!==e&&64===e.type;)e=e.parent;return e}function Qu(){return ae.lFrame.currentTNode}function Zi(e,t){const i=ae.lFrame;i.currentTNode=e,i.isParent=t}function rh(){return ae.lFrame.isParent}function sh(){ae.lFrame.isParent=!1}function qt(){const e=ae.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function ct(){return ae.lFrame.bindingIndex}function Ft(){return ae.lFrame.bindingIndex++}function _n(e){const t=ae.lFrame,i=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,i}function $v(e,t){const i=ae.lFrame;i.bindingIndex=i.bindingRootIndex=e,ch(t)}function ch(e){ae.lFrame.currentDirectiveIndex=e}function ti(){return ae.lFrame.currentQueryIndex}function js(e){ae.lFrame.currentQueryIndex=e}function lh(e){const t=e[Y];return 2===t.type?t.declTNode:1===t.type?e[Kt]:null}function Wu(e,t,i){if(i&De.SkipSelf){let c=t,d=e;for(;!(c=c.parent,null!==c||i&De.Host||(c=lh(d),null===c||(d=d[qo],10&c.type))););if(null===c)return!1;t=c,e=d}const s=ae.lFrame=Sc();return s.currentTNode=t,s.lView=e,!0}function uh(e){const t=Sc(),i=e[Y];ae.lFrame=t,t.currentTNode=i.firstChild,t.lView=e,t.tView=i,t.contextLView=e,t.bindingIndex=i.bindingStartIndex,t.inI18n=!1}function Sc(){const e=ae.lFrame,t=null===e?null:e.child;return null===t?Ee(e):t}function Ee(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function re(){const e=ae.lFrame;return ae.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const Zv=re;function Ju(){const e=re();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function Xe(){return ae.lFrame.selectedIndex}function Yo(e){ae.lFrame.selectedIndex=e}function it(){const e=ae.lFrame;return Hs(e.tView,e.selectedIndex)}function bt(){ae.lFrame.currentNamespace=Wf}let Qo=!0;function Nr(){return Qo}function Un(e){Qo=e}function Wo(e,t){for(let i=t.directiveStart,s=t.directiveEnd;i<s;i++){const d=e.data[i].type.prototype,{ngAfterContentInit:p,ngAfterContentChecked:f,ngAfterViewInit:g,ngAfterViewChecked:y,ngOnDestroy:v}=d;p&&(e.contentHooks??=[]).push(-i,p),f&&((e.contentHooks??=[]).push(i,f),(e.contentCheckHooks??=[]).push(i,f)),g&&(e.viewHooks??=[]).push(-i,g),y&&((e.viewHooks??=[]).push(i,y),(e.viewCheckHooks??=[]).push(i,y)),null!=v&&(e.destroyHooks??=[]).push(i,v)}}function $s(e,t,i){Rr(e,t,3,i)}function Fr(e,t,i,s){(3&e[me])===i&&Rr(e,t,i,s)}function xc(e,t){let i=e[me];(3&i)===t&&(i&=16383,i+=1,e[me]=i)}function Rr(e,t,i,s){const d=s??-1,p=t.length-1;let f=0;for(let g=void 0!==s?65535&e[Rs]:0;g<p;g++)if("number"==typeof t[g+1]){if(f=t[g],null!=s&&f>=s)break}else t[g]<0&&(e[Rs]+=65536),(f<d||-1==d)&&(td(e,i,t,g),e[Rs]=(4294901760&e[Rs])+g+2),g++}function Ic(e,t){gi(4,e,t);const i=k(null);try{t.call(e)}finally{k(i),gi(5,e,t)}}function td(e,t,i,s){const c=i[s]<0,d=i[s+1],f=e[c?-i[s]:i[s]];c?e[me]>>14<e[Rs]>>16&&(3&e[me])===t&&(e[me]+=16384,Ic(f,d)):Ic(f,d)}const mi=-1;class Jo{constructor(t,i,s){this.factory=t,this.resolving=!1,this.canSeeViewProviders=i,this.injectImpl=s}}function Zs(e){return e!==mi}function Vs(e){return 32767&e}function Ac(e,t){let i=function Vv(e){return e>>16}(e),s=t;for(;i>0;)s=s[qo],i--;return s}let Ln=!0;function Fe(e){const t=Ln;return Ln=e,t}const Oc=255,Ur=5;let id=0;const Gn={};function Lr(e,t){const i=Nc(e,t);if(-1!==i)return i;const s=t[Y];s.firstCreatePass&&(e.injectorIndex=t.length,qs(s.data,e),qs(t,null),qs(s.blueprint,null));const c=Xo(e,t),d=e.injectorIndex;if(Zs(c)){const p=Vs(c),f=Ac(c,t),g=f[Y].data;for(let y=0;y<8;y++)t[d+y]=f[p+y]|g[p+y]}return t[d+8]=c,d}function qs(e,t){e.push(0,0,0,0,0,0,0,0,t)}function Nc(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function Xo(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let i=0,s=null,c=t;for(;null!==c;){if(s=Hn(c),null===s)return mi;if(i++,c=c[qo],-1!==s.injectorIndex)return s.injectorIndex|i<<16}return mi}function zs(e,t,i){!function kc(e,t,i){let s;"string"==typeof i?s=i.charCodeAt(0)||0:i.hasOwnProperty(As)&&(s=i[As]),null==s&&(s=i[As]=id++);const c=s&Oc;t.data[e+(c>>Ur)]|=1<<c}(e,t,i)}function go(e,t,i){if(i&De.Optional||void 0!==e)return e;ks()}function Gr(e,t,i,s){if(i&De.Optional&&void 0===s&&(s=null),!(i&(De.Self|De.Host))){const c=e[Xt],d=vn(void 0);try{return c?c.get(t,s,i&De.Optional):Iu(t,s,i&De.Optional)}finally{vn(d)}}return go(s,0,i)}function Fc(e,t,i,s=De.Default,c){if(null!==e){if(2048&t[me]&&!(s&De.Self)){const p=function Lc(e,t,i,s,c){let d=e,p=t;for(;null!==d&&null!==p&&2048&p[me]&&!(512&p[me]);){const f=Rc(d,p,i,s|De.Self,Gn);if(f!==Gn)return f;let g=d.parent;if(!g){const y=p[Av];if(y){const v=y.get(i,Gn,s);if(v!==Gn)return v}g=Hn(p),p=p[qo]}d=g}return c}(e,t,i,s,Gn);if(p!==Gn)return p}const d=Rc(e,t,i,s,Gn);if(d!==Gn)return d}return Gr(t,i,s,c)}function Rc(e,t,i,s,c){const d=function Qs(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(As)?e[As]:void 0;return"number"==typeof t?t>=0?t&Oc:rd:t}(i);if("function"==typeof d){if(!Wu(t,e,s))return s&De.Host?go(c,0,s):Gr(t,i,s,c);try{let p;if(p=d(s),null!=p||s&De.Optional)return p;ks()}finally{Zv()}}else if("number"==typeof d){let p=null,f=Nc(e,t),g=mi,y=s&De.Host?t[at][Kt]:null;for((-1===f||s&De.SkipSelf)&&(g=-1===f?Xo(e,t):t[f+8],g!==mi&&er(s,!1)?(p=t[Y],f=Vs(g),t=Ac(g,t)):f=-1);-1!==f;){const v=t[Y];if(Ws(d,f,v.data)){const C=Ys(f,t,i,p,s,y);if(C!==Gn)return C}g=t[f+8],g!==mi&&er(s,t[Y].data[f+8]===y)&&Ws(d,f,t)?(p=v,f=Vs(g),t=Ac(g,t)):f=-1}}return c}function Ys(e,t,i,s,c,d){const p=t[Y],f=p.data[e+8],v=Hr(f,p,i,null==s?Pr(f)&&Ln:s!=p&&0!=(3&f.type),c&De.Host&&d===f);return null!==v?yi(t,p,v,f):Gn}function Hr(e,t,i,s,c){const d=e.providerIndexes,p=t.data,f=1048575&d,g=e.directiveStart,v=d>>20,w=c?f+v:e.directiveEnd;for(let D=s?f:f+v;D<w;D++){const P=p[D];if(D<g&&i===P||D>=g&&P.type===i)return D}if(c){const D=p[g];if(D&&hi(D)&&D.type===i)return g}return null}function yi(e,t,i,s){let c=e[i];const d=t.data;if(function Ko(e){return e instanceof Jo}(c)){const p=c;p.resolving&&function Os(e,t){const i=t?`. Dependency path: ${t.join(" > ")} > ${e}`:"";throw new ie(-200,`Circular dependency in DI detected for ${e}${i}`)}(function Le(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():_e(e)}(d[i]));const f=Fe(p.canSeeViewProviders);p.resolving=!0;const y=p.injectImpl?vn(p.injectImpl):null;Wu(e,s,De.Default);try{c=e[i]=p.factory(void 0,d,e,s),t.firstCreatePass&&i>=s.directiveStart&&function ed(e,t,i){const{ngOnChanges:s,ngOnInit:c,ngDoCheck:d}=t.type.prototype;if(s){const p=Vf(t);(i.preOrderHooks??=[]).push(e,p),(i.preOrderCheckHooks??=[]).push(e,p)}c&&(i.preOrderHooks??=[]).push(0-e,c),d&&((i.preOrderHooks??=[]).push(e,d),(i.preOrderCheckHooks??=[]).push(e,d))}(i,d[i],t)}finally{null!==y&&vn(y),Fe(f),p.resolving=!1,Zv()}}return c}function Ws(e,t,i){return!!(i[t+(e>>Ur)]&1<<e)}function er(e,t){return!(e&De.Self||e&De.Host&&t)}class dt{constructor(t,i){this._tNode=t,this._lView=i}get(t,i,s){return Fc(this._tNode,this._lView,t,Nu(s),i)}}function rd(){return new dt($e(),F())}function sd(e){return Hi(()=>{const t=e.prototype.constructor,i=t[Gi]||Uc(t),s=Object.prototype;let c=Object.getPrototypeOf(e.prototype).constructor;for(;c&&c!==s;){const d=c[Gi]||Uc(c);if(d&&d!==i)return d;c=Object.getPrototypeOf(c)}return d=>new d})}function Uc(e){return tc(e)?()=>{const t=Uc(le(e));return t&&t()}:ho(e)}function Hn(e){const t=e[Y],i=t.type;return 2===i?t.declTNode:1===i?e[Kt]:null}function Mt(e){return function od(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const i=e.attrs;if(i){const s=i.length;let c=0;for(;c<s;){const d=i[c];if(hv(d))break;if(0===d)c+=2;else if("number"==typeof d)for(c++;c<s&&"string"==typeof i[c];)c++;else{if(d===t)return i[c+1];c+=2}}}return null}($e(),e)}const _i="__parameters__";function Yi(e,t,i){return Hi(()=>{const s=function Br(e){return function(...i){if(e){const s=e(...i);for(const c in s)this[c]=s[c]}}}(t);function c(...d){if(this instanceof c)return s.apply(this,d),this;const p=new c(...d);return f.annotation=p,f;function f(g,y,v){const C=g.hasOwnProperty(_i)?g[_i]:Object.defineProperty(g,_i,{value:[]})[_i];for(;C.length<=v;)C.push(null);return(C[v]=C[v]||[]).push(p),g}}return i&&(c.prototype=Object.create(i.prototype)),c.prototype.ngMetadataName=e,c.annotationCls=c,c})}function wi(e,t){e.forEach(i=>Array.isArray(i)?wi(i,t):t(i))}function Bc(e,t,i){t>=e.length?e.push(i):e.splice(t,0,i)}function $r(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function ni(e,t){const i=[];for(let s=0;s<e;s++)i.push(t);return i}function Bn(e,t,i){let s=Zr(e,t);return s>=0?e[1|s]=i:(s=~s,function fn(e,t,i,s){let c=e.length;if(c==t)e.push(i,s);else if(1===c)e.push(s,e[0]),e[0]=i;else{for(c--,e.push(e[c-1],e[c]);c>t;)e[c]=e[c-2],c--;e[t]=i,e[t+1]=s}}(e,s,t,i)),s}function $c(e,t){const i=Zr(e,t);if(i>=0)return e[1|i]}function Zr(e,t){return function zv(e,t,i){let s=0,c=e.length>>i;for(;c!==s;){const d=s+(c-s>>1),p=e[d<<i];if(t===p)return d<<i;p>t?c=d:s=d+1}return~(c<<i)}(e,t,1)}const Ch=Rn(Yi("Optional"),8),qc=Rn(Yi("SkipSelf"),4),Xs=new Ce("ENVIRONMENT_INITIALIZER"),Mh=new Ce("INJECTOR",-1),ea=new Ce("INJECTOR_DEF_TYPES");class Wc{get(t,i=Fs){if(i===Fs){const s=new Error(`NullInjectorError: No provider for ${St(t)}!`);throw s.name="NullInjectorError",s}return i}}function Kv(...e){return{\u0275providers:Sh(0,e),\u0275fromNgModule:!0}}function Sh(e,...t){const i=[],s=new Set;let c;const d=p=>{i.push(p)};return wi(t,p=>{const f=p;Vr(f,d,[],s)&&(c||=[],c.push(f))}),void 0!==c&&Th(c,d),i}function Th(e,t){for(let i=0;i<e.length;i++){const{ngModule:s,providers:c}=e[i];or(c,d=>{t(d,s)})}}function Vr(e,t,i,s){if(!(e=le(e)))return!1;let c=null,d=sc(e);const p=!d&&Se(e);if(d||p){if(p&&!p.standalone)return!1;c=e}else{const g=e.ngModule;if(d=sc(g),!d)return!1;c=g}const f=s.has(c);if(p){if(f)return!1;if(s.add(c),p.dependencies){const g="function"==typeof p.dependencies?p.dependencies():p.dependencies;for(const y of g)Vr(y,t,i,s)}}else{if(!d)return!1;{if(null!=d.imports&&!f){let y;s.add(c);try{wi(d.imports,v=>{Vr(v,t,i,s)&&(y||=[],y.push(v))})}finally{}void 0!==y&&Th(y,t)}if(!f){const y=ho(c)||(()=>new c);t({provide:c,useFactory:y,deps:Ge},c),t({provide:ea,useValue:c,multi:!0},c),t({provide:Xs,useValue:()=>Zt(c),multi:!0},c)}const g=d.providers;if(null!=g&&!f){const y=e;or(g,v=>{t(v,y)})}}}return c!==e&&void 0!==e.providers}function or(e,t){for(let i of e)Tr(i)&&(i=i.\u0275providers),Array.isArray(i)?or(i,t):t(i)}const xh=Ne({provide:String,useValue:Ne});function Jc(e){return null!==e&&"object"==typeof e&&xh in e}function Zn(e){return"function"==typeof e}const Wi=new Ce("Set Injector scope."),Kc={},Ah={};let ld;function ud(){return void 0===ld&&(ld=new Wc),ld}class ve{}class en extends ve{get destroyed(){return this._destroyed}constructor(t,i,s,c){super(),this.parent=i,this.source=s,this.scopes=c,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,el(t,p=>this.processProvider(p)),this.records.set(Mh,ta(void 0,this)),c.has("environment")&&this.records.set(ve,ta(void 0,this));const d=this.records.get(Wi);null!=d&&"string"==typeof d.value&&this.scopes.add(d.value),this.injectorDefTypes=new Set(this.get(ea,Ge,De.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(t){return this.assertNotDestroyed(),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){this.assertNotDestroyed();const i=po(this),s=vn(void 0);try{return t()}finally{po(i),vn(s)}}get(t,i=Fs,s=De.Default){if(this.assertNotDestroyed(),t.hasOwnProperty(_f))return t[_f](this);s=Nu(s);const d=po(this),p=vn(void 0);try{if(!(s&De.SkipSelf)){let g=this.records.get(t);if(void 0===g){const y=function pd(e){return"function"==typeof e||"object"==typeof e&&e instanceof Ce}(t)&&Ie(t);g=y&&this.injectableDefInScope(y)?ta(Oh(t),Kc):null,this.records.set(t,g)}if(null!=g)return this.hydrate(t,g)}return(s&De.Self?ud():this.parent).get(t,i=s&De.Optional&&i===Fs?null:i)}catch(f){if("NullInjectorError"===f.name){if((f[cc]=f[cc]||[]).unshift(St(t)),d)throw f;return function dv(e,t,i,s){const c=e[cc];throw t[Df]&&c.unshift(t[Df]),e.message=function pv(e,t,i,s=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let c=St(t);if(Array.isArray(t))c=t.map(St).join(" -> ");else if("object"==typeof t){let d=[];for(let p in t)if(t.hasOwnProperty(p)){let f=t[p];d.push(p+":"+("string"==typeof f?JSON.stringify(f):St(f)))}c=`{${d.join(", ")}}`}return`${i}${s?"("+s+")":""}[${c}]: ${e.replace(cv,"\n  ")}`}("\n"+e.message,c,i,s),e.ngTokenPath=c,e[cc]=null,e}(f,t,"R3InjectorError",this.source)}throw f}finally{vn(p),po(d)}}resolveInjectorInitializers(){const t=po(this),i=vn(void 0);try{const c=this.get(Xs,Ge,De.Self);for(const d of c)d()}finally{po(t),vn(i)}}toString(){const t=[],i=this.records;for(const s of i.keys())t.push(St(s));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ie(205,!1)}processProvider(t){let i=Zn(t=le(t))?t:le(t&&t.provide);const s=function qr(e){return Jc(e)?ta(void 0,e.useValue):ta(dd(e),Kc)}(t);if(Zn(t)||!0!==t.multi)this.records.get(i);else{let c=this.records.get(i);c||(c=ta(void 0,Kc,!0),c.factory=()=>Tf(c.multi),this.records.set(i,c)),i=t,c.multi.push(t)}this.records.set(i,s)}hydrate(t,i){return i.value===Kc&&(i.value=Ah,i.value=i.factory()),"object"==typeof i.value&&i.value&&function V0(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(i.value)&&this._ngOnDestroyHooks.add(i.value),i.value}injectableDefInScope(t){if(!t.providedIn)return!1;const i=le(t.providedIn);return"string"==typeof i?"any"===i||this.scopes.has(i):this.injectorDefTypes.has(i)}removeOnDestroy(t){const i=this._onDestroyHooks.indexOf(t);-1!==i&&this._onDestroyHooks.splice(i,1)}}function Oh(e){const t=Ie(e),i=null!==t?t.factory:ho(e);if(null!==i)return i;if(e instanceof Ce)throw new ie(204,!1);if(e instanceof Function)return function Xc(e){const t=e.length;if(t>0)throw ni(t,"?"),new ie(204,!1);const i=function rt(e){return e&&(e[Ns]||e[ac])||null}(e);return null!==i?()=>i.factory(e):()=>new e}(e);throw new ie(204,!1)}function dd(e,t,i){let s;if(Zn(e)){const c=le(e);return ho(c)||Oh(c)}if(Jc(e))s=()=>le(e.useValue);else if(function Eh(e){return!(!e||!e.useFactory)}(e))s=()=>e.useFactory(...Tf(e.deps||[]));else if(function Ih(e){return!(!e||!e.useExisting)}(e))s=()=>Zt(le(e.useExisting));else{const c=le(e&&(e.useClass||e.provide));if(!function Xv(e){return!!e.deps}(e))return ho(c)||Oh(c);s=()=>new c(...Tf(e.deps))}return s}function ta(e,t,i=!1){return{factory:e,value:t,multi:i?[]:void 0}}function el(e,t){for(const i of e)Array.isArray(i)?el(i,t):i&&Tr(i)?el(i.\u0275providers,t):t(i)}function na(e,t=null,i=null,s){const c=nl(e,t,i,s);return c.resolveInjectorInitializers(),c}function nl(e,t=null,i=null,s,c=new Set){const d=[i||Ge,Kv(e)];return s=s||("object"==typeof e?void 0:St(e)),new en(d,t||ud(),s||null,c)}let yd,Vn=(()=>{class e{static#e=this.THROW_IF_NOT_FOUND=Fs;static#t=this.NULL=new Wc;static create(i,s){if(Array.isArray(i))return na({name:""},s,i,"");{const c=i.name??"";return na({name:c},i.parent,i.providers,c)}}static#n=this.\u0275prov=et({token:e,providedIn:"any",factory:()=>Zt(Mh)});static#i=this.__NG_ELEMENT_ID__=-1}return e})();function vd(e){yd=e}function Co(){if(void 0!==yd)return yd;if(typeof document<"u")return document;throw new ie(210,!1)}const Uh=new Ce("AppId",{providedIn:"root",factory:()=>ol}),ol="ng",rl=new Ce("Platform Initializer"),_d=new Ce("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Gh=new Ce("CSP nonce",{providedIn:"root",factory:()=>Co().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function sa(e){return 128==(128&e.flags)}var aa=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(aa||{});const ca=/^>|^->|<!--|-->|--!>|<!-$/g,Vh=/(<|>)/g,qh="\u200b$1\u200b";const ul=new Map;let Ki=0;const xe="__ngContext__";function Be(e,t){Vt(t)?(e[xe]=t[hc],function f_(e){ul.set(e[hc],e)}(t)):e[xe]=t}let Ed;function ua(e,t){return Ed(e,t)}function Wr(e){const t=e[st];return Ht(t)?t[st]:t}function Xh(e){return __(e[pc])}function v_(e){return __(e[di])}function __(e){for(;null!==e&&!Ht(e);)e=e[di];return e}function da(e,t,i,s,c){if(null!=s){let d,p=!1;Ht(s)?d=s:Vt(s)&&(p=!0,s=s[wt]);const f=nt(s);0===e&&null!==i?null==c?kd(t,i,f):bo(t,i,f,c||null,!0):1===e&&null!==i?bo(t,i,f,c||null,!0):2===e?function ml(e,t,i){const s=Kr(e,t);s&&function eg(e,t,i,s){e.removeChild(t,i,s)}(e,s,t,i)}(t,f,p):3===e&&t.destroyNode(f),null!=d&&function E_(e,t,i,s,c){const d=i[fi];d!==nt(i)&&da(t,e,s,d,c);for(let f=Tt;f<i.length;f++){const g=i[f];ga(g[Y],g,e,t,s,d)}}(t,e,d,i,c)}}function pl(e,t){return e.createComment(function la(e){return e.replace(ca,t=>t.replace(Vh,qh))}(t))}function pa(e,t,i){return e.createElement(t,i)}function Od(e,t){const i=e[Us],s=i.indexOf(t);i.splice(s,1)}function Jr(e,t){if(e.length<=Tt)return;const i=Tt+t,s=e[i];if(s){const c=s[fc];null!==c&&c!==e&&Od(c,s),t>0&&(e[i-1][di]=s[di]);const d=$r(e,Tt+t);!function fa(e,t){ga(e,t,t[fe],2,null,null),t[wt]=null,t[Kt]=null}(s[Y],s);const p=d[pi];null!==p&&p.detachView(d[Y]),s[st]=null,s[di]=null,s[me]&=-129}return s}function fl(e,t){if(!(256&t[me])){const i=t[fe];t[Er]&&function qe(e){if(xs(e),li(e))for(let t=0;t<e.producerNode.length;t++)Dr(e.producerNode[t],e.producerIndexOfThis[t]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}(t[Er]),i.destroyNode&&ga(e,t,i,3,null,null),function X0(e){let t=e[pc];if(!t)return lr(e[Y],e);for(;t;){let i=null;if(Vt(t))i=t[pc];else{const s=t[Tt];s&&(i=s)}if(!i){for(;t&&!t[di]&&t!==e;)Vt(t)&&lr(t[Y],t),t=t[st];null===t&&(t=e),Vt(t)&&lr(t[Y],t),i=t&&t[di]}t=i}}(t)}}function lr(e,t){if(!(256&t[me])){t[me]&=-129,t[me]|=256,function D_(e,t){let i;if(null!=e&&null!=(i=e.destroyHooks))for(let s=0;s<i.length;s+=2){const c=t[i[s]];if(!(c instanceof Jo)){const d=i[s+1];if(Array.isArray(d))for(let p=0;p<d.length;p+=2){const f=c[d[p]],g=d[p+1];gi(4,f,g);try{g.call(f)}finally{gi(5,f,g)}}else{gi(4,c,d);try{d.call(c)}finally{gi(5,c,d)}}}}}(e,t),function M_(e,t){const i=e.cleanup,s=t[Vo];if(null!==i)for(let d=0;d<i.length-1;d+=2)if("string"==typeof i[d]){const p=i[d+3];p>=0?s[p]():s[-p].unsubscribe(),d+=2}else i[d].call(s[i[d+1]]);null!==s&&(t[Vo]=null);const c=t[zo];if(null!==c){t[zo]=null;for(let d=0;d<c.length;d++)(0,c[d])()}}(e,t),1===t[Y].type&&t[fe].destroy();const i=t[fc];if(null!==i&&Ht(t[st])){i!==t[st]&&Od(i,t);const s=t[pi];null!==s&&s.detachView(e)}!function Q0(e){ul.delete(e[hc])}(t)}}function hl(e,t,i){return function S_(e,t,i){let s=t;for(;null!==s&&40&s.type;)s=(t=s).parent;if(null===s)return i[wt];{const{componentOffset:c}=s;if(c>-1){const{encapsulation:d}=e.data[s.directiveStart+c];if(d===Bi.None||d===Bi.Emulated)return null}return dn(s,i)}}(e,t.parent,i)}function bo(e,t,i,s,c){e.insertBefore(t,i,s,c)}function kd(e,t,i){e.appendChild(t,i)}function gl(e,t,i,s,c){null!==s?bo(e,t,i,s,c):kd(e,t,i)}function Kr(e,t){return e.parentNode(t)}function ng(e,t,i){return x_(e,t,i)}let Nd,Mo,ur,x_=function ig(e,t,i){return 40&e.type?dn(e,i):null};function Fd(e,t,i,s){const c=hl(e,s,t),d=t[fe],f=ng(s.parent||t[Kt],s,t);if(null!=c)if(Array.isArray(i))for(let g=0;g<i.length;g++)gl(d,c,i[g],f,!1);else gl(d,c,i,f,!1);void 0!==Nd&&Nd(d,s,t,i,c)}function ha(e,t){if(null!==t){const i=t.type;if(3&i)return dn(t,e);if(4&i)return sg(-1,e[t.index]);if(8&i){const s=t.child;if(null!==s)return ha(e,s);{const c=e[t.index];return Ht(c)?sg(-1,c):nt(c)}}if(32&i)return ua(t,e)()||nt(e[t.index]);{const s=rg(e,t);return null!==s?Array.isArray(s)?s[0]:ha(Wr(e[at]),s):ha(e,t.next)}}return null}function rg(e,t){return null!==t?e[at][Kt].projection[t.projection]:null}function sg(e,t){const i=Tt+e+1;if(i<t.length){const s=t[i],c=s[Y].firstChild;if(null!==c)return ha(s,c)}return t[fi]}function yl(e,t,i,s,c,d,p){for(;null!=i;){const f=s[i.index],g=i.type;if(p&&0===t&&(f&&Be(nt(f),s),i.flags|=2),32!=(32&i.flags))if(8&g)yl(e,t,i.child,s,c,d,!1),da(t,e,c,f,d);else if(32&g){const y=ua(i,s);let v;for(;v=y();)da(t,e,c,v,d);da(t,e,c,f,d)}else 16&g?Rd(e,t,s,i,c,d):da(t,e,c,f,d);i=p?i.projectionNext:i.next}}function ga(e,t,i,s,c,d){yl(i,s,e.firstChild,t,c,d,!1)}function Rd(e,t,i,s,c,d){const p=i[at],g=p[Kt].projection[s.projection];if(Array.isArray(g))for(let y=0;y<g.length;y++)da(t,e,c,g[y],d);else{let y=g;const v=p[st];sa(s)&&(y.flags|=128),yl(e,t,y,v,c,d,!0)}}function Ud(e,t,i){""===i?e.removeAttribute(t,"class"):e.setAttribute(t,"class",i)}function _l(e,t,i){const{mergedAttrs:s,classes:c,styles:d}=i;null!==s&&If(e,t,s),null!==c&&Ud(e,t,c),null!==d&&function bn(e,t,i){e.setAttribute(t,"style",i)}(e,t,d)}function ma(e){return function Ld(){if(void 0===Mo&&(Mo=null,tt.trustedTypes))try{Mo=tt.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Mo}()?.createHTML(e)||e}function ag(e){return function Si(){if(void 0===ur&&(ur=null,tt.trustedTypes))try{ur=tt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return ur}()?.createHTML(e)||e}class dr{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${nc})`}}class A_ extends dr{getTypeName(){return"HTML"}}class O_ extends dr{getTypeName(){return"Style"}}class k_ extends dr{getTypeName(){return"Script"}}class N_ extends dr{getTypeName(){return"URL"}}class F_ extends dr{getTypeName(){return"ResourceURL"}}function Xi(e){return e instanceof dr?e.changingThisBreaksApplicationSecurity:e}function Xr(e,t){const i=function R_(e){return e instanceof dr&&e.getTypeName()||null}(e);if(null!=i&&i!==t){if("ResourceURL"===i&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${i} (see ${nc})`)}return i===t}function U_(e){return new A_(e)}function L_(e){return new O_(e)}function G_(e){return new k_(e)}function H_(e){return new N_(e)}function B_(e){return new F_(e)}class j_{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const i=(new window.DOMParser).parseFromString(ma(t),"text/html").body;return null===i?this.inertDocumentHelper.getInertBodyElement(t):(i.removeChild(i.firstChild),i)}catch{return null}}}class $_{constructor(t){this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(t){const i=this.inertDocument.createElement("template");return i.innerHTML=ma(t),i}}const V_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Cl(e){return(e=String(e)).match(V_)?e:"unsafe:"+e}function eo(e){const t={};for(const i of e.split(","))t[i]=!0;return t}function ya(...e){const t={};for(const i of e)for(const s in i)i.hasOwnProperty(s)&&(t[s]=!0);return t}const Gd=eo("area,br,col,hr,img,wbr"),dg=eo("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),pg=eo("rp,rt"),Hd=ya(Gd,ya(dg,eo("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ya(pg,eo("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ya(pg,dg)),Bd=eo("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),fg=ya(Bd,eo("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),eo("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Bt=eo("script,style,template");class Do{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let i=t.firstChild,s=!0;for(;i;)if(i.nodeType===Node.ELEMENT_NODE?s=this.startElement(i):i.nodeType===Node.TEXT_NODE?this.chars(i.nodeValue):this.sanitizedSomething=!0,s&&i.firstChild)i=i.firstChild;else for(;i;){i.nodeType===Node.ELEMENT_NODE&&this.endElement(i);let c=this.checkClobberedElement(i,i.nextSibling);if(c){i=c;break}i=this.checkClobberedElement(i,i.parentNode)}return this.buf.join("")}startElement(t){const i=t.nodeName.toLowerCase();if(!Hd.hasOwnProperty(i))return this.sanitizedSomething=!0,!Bt.hasOwnProperty(i);this.buf.push("<"),this.buf.push(i);const s=t.attributes;for(let c=0;c<s.length;c++){const d=s.item(c),p=d.name,f=p.toLowerCase();if(!fg.hasOwnProperty(f)){this.sanitizedSomething=!0;continue}let g=d.value;Bd[f]&&(g=Cl(g)),this.buf.push(" ",p,'="',jd(g),'"')}return this.buf.push(">"),!0}endElement(t){const i=t.nodeName.toLowerCase();Hd.hasOwnProperty(i)&&!Gd.hasOwnProperty(i)&&(this.buf.push("</"),this.buf.push(i),this.buf.push(">"))}chars(t){this.buf.push(jd(t))}checkClobberedElement(t,i){if(i&&(t.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return i}}const on=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rn=/([^\#-~ |!])/g;function jd(e){return e.replace(/&/g,"&amp;").replace(on,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(rn,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Ti;function es(e,t){let i=null;try{Ti=Ti||function ug(e){const t=new $_(e);return function Z_(){try{return!!(new window.DOMParser).parseFromString(ma(""),"text/html")}catch{return!1}}()?new j_(t):t}(e);let s=t?String(t):"";i=Ti.getInertBodyElement(s);let c=5,d=s;do{if(0===c)throw new Error("Failed to sanitize html because the input is unstable");c--,s=d,d=i.innerHTML,i=Ti.getInertBodyElement(s)}while(s!==d);return ma((new Do).sanitizeChildren(wl(i)||i))}finally{if(i){const s=wl(i)||i;for(;s.firstChild;)s.removeChild(s.firstChild)}}}function wl(e){return"content"in e&&function s1(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var pr=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(pr||{});function Je(e){const t=va();return t?ag(t.sanitize(pr.HTML,e)||""):Xr(e,"HTML")?ag(Xi(e)):es(Co(),_e(e))}function bl(e){const t=va();return t?t.sanitize(pr.URL,e)||"":Xr(e,"URL")?Xi(e):Cl(_e(e))}function va(){const e=F();return e&&e[fo].sanitizer}let mg=(e,t,i)=>null;function Wd(e,t,i=!1){return mg(e,t,i)}class an{}class wa{}class Cg{resolveComponentFactory(t){throw function Dn(e){const t=Error(`No component factory found for ${St(e)}.`);return t.ngComponent=e,t}(t)}}let ba=(()=>{class e{static#e=this.NULL=new Cg}return e})();function os(){return no($e(),F())}function no(e,t){return new Io(dn(e,t))}let Io=(()=>{class e{constructor(i){this.nativeElement=i}static#e=this.__NG_ELEMENT_ID__=os}return e})();function ft(e){return e instanceof Io?e.nativeElement:e}class lt{}let hr=(()=>{class e{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function Jd(){const e=F(),i=pn($e().index,e);return(Vt(i)?i:e)[fe]}()}return e})(),wg=(()=>{class e{static#e=this.\u0275prov=et({token:e,providedIn:"root",factory:()=>null})}return e})();class mt{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const El=new mt("17.0.0"),Pl={};function rs(e,t){const i=function Xb(e){const t=Object.create(Sr);t.computation=e;const i=()=>{if(V(t),L(t),t.value===Bo)throw t.error;return t.value};return i[Q]=t,i}(e);return t?.equal&&(i[Q].equal=t.equal),i}function d1(e,t){const i=function $y(e){const t=Object.create(n0);t.value=e;const i=()=>(L(t),t.value);return i[Q]=t,i}(e),s=i[Q];return t?.equal&&(s.equal=t.equal),i.set=c=>uf(s,c),i.update=c=>function Zy(e,t){O()||Wt(),uf(e,t(e.value))}(s,c),i.asReadonly=Ii.bind(i),i}function Ii(){const e=this[Q];if(void 0===e.readonlyFn){const t=()=>this();t[Q]=e,e.readonlyFn=t}return e.readonlyFn}function bg(e){const t=k(null);try{return e()}finally{k(t)}}function Al(e){return!!Eo(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function Eo(e){return null!==e&&("function"==typeof e||"object"==typeof e)}class Mg{constructor(){}supports(t){return Al(t)}create(t){return new Dg(t)}}const tC=(e,t)=>t;class Dg{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||tC}forEachItem(t){let i;for(i=this._itHead;null!==i;i=i._next)t(i)}forEachOperation(t){let i=this._itHead,s=this._removalsHead,c=0,d=null;for(;i||s;){const p=!s||i&&i.currentIndex<Tg(s,c,d)?i:s,f=Tg(p,c,d),g=p.currentIndex;if(p===s)c--,s=s._nextRemoved;else if(i=i._next,null==p.previousIndex)c++;else{d||(d=[]);const y=f-c,v=g-c;if(y!=v){for(let w=0;w<y;w++){const D=w<d.length?d[w]:d[w]=0,P=D+w;v<=P&&P<y&&(d[w]=D+1)}d[p.previousIndex]=v-y}}f!==g&&t(p,f,g)}}forEachPreviousItem(t){let i;for(i=this._previousItHead;null!==i;i=i._nextPrevious)t(i)}forEachAddedItem(t){let i;for(i=this._additionsHead;null!==i;i=i._nextAdded)t(i)}forEachMovedItem(t){let i;for(i=this._movesHead;null!==i;i=i._nextMoved)t(i)}forEachRemovedItem(t){let i;for(i=this._removalsHead;null!==i;i=i._nextRemoved)t(i)}forEachIdentityChange(t){let i;for(i=this._identityChangesHead;null!==i;i=i._nextIdentityChange)t(i)}diff(t){if(null==t&&(t=[]),!Al(t))throw new ie(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let c,d,p,i=this._itHead,s=!1;if(Array.isArray(t)){this.length=t.length;for(let f=0;f<this.length;f++)d=t[f],p=this._trackByFn(f,d),null!==i&&Object.is(i.trackById,p)?(s&&(i=this._verifyReinsertion(i,d,p,f)),Object.is(i.item,d)||this._addIdentityChange(i,d)):(i=this._mismatch(i,d,p,f),s=!0),i=i._next}else c=0,function Kd(e,t){if(Array.isArray(e))for(let i=0;i<e.length;i++)t(e[i]);else{const i=e[Symbol.iterator]();let s;for(;!(s=i.next()).done;)t(s.value)}}(t,f=>{p=this._trackByFn(c,f),null!==i&&Object.is(i.trackById,p)?(s&&(i=this._verifyReinsertion(i,f,p,c)),Object.is(i.item,f)||this._addIdentityChange(i,f)):(i=this._mismatch(i,f,p,c),s=!0),i=i._next,c++}),this.length=c;return this._truncate(i),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,i,s,c){let d;return null===t?d=this._itTail:(d=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(s,null))?(Object.is(t.item,i)||this._addIdentityChange(t,i),this._reinsertAfter(t,d,c)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(s,c))?(Object.is(t.item,i)||this._addIdentityChange(t,i),this._moveAfter(t,d,c)):t=this._addAfter(new ss(i,s),d,c),t}_verifyReinsertion(t,i,s,c){let d=null===this._unlinkedRecords?null:this._unlinkedRecords.get(s,null);return null!==d?t=this._reinsertAfter(d,t._prev,c):t.currentIndex!=c&&(t.currentIndex=c,this._addToMoves(t,c)),t}_truncate(t){for(;null!==t;){const i=t._next;this._addToRemovals(this._unlink(t)),t=i}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,i,s){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const c=t._prevRemoved,d=t._nextRemoved;return null===c?this._removalsHead=d:c._nextRemoved=d,null===d?this._removalsTail=c:d._prevRemoved=c,this._insertAfter(t,i,s),this._addToMoves(t,s),t}_moveAfter(t,i,s){return this._unlink(t),this._insertAfter(t,i,s),this._addToMoves(t,s),t}_addAfter(t,i,s){return this._insertAfter(t,i,s),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,i,s){const c=null===i?this._itHead:i._next;return t._next=c,t._prev=i,null===c?this._itTail=t:c._prev=t,null===i?this._itHead=t:i._next=t,null===this._linkedRecords&&(this._linkedRecords=new Sg),this._linkedRecords.put(t),t.currentIndex=s,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const i=t._prev,s=t._next;return null===i?this._itHead=s:i._next=s,null===s?this._itTail=i:s._prev=i,t}_addToMoves(t,i){return t.previousIndex===i||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Sg),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,i){return t.item=i,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class ss{constructor(t,i){this.item=t,this.trackById=i,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class nC{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,i){let s;for(s=this._head;null!==s;s=s._nextDup)if((null===i||i<=s.currentIndex)&&Object.is(s.trackById,t))return s;return null}remove(t){const i=t._prevDup,s=t._nextDup;return null===i?this._head=s:i._nextDup=s,null===s?this._tail=i:s._prevDup=i,null===this._head}}class Sg{constructor(){this.map=new Map}put(t){const i=t.trackById;let s=this.map.get(i);s||(s=new nC,this.map.set(i,s)),s.add(t)}get(t,i){const c=this.map.get(t);return c?c.get(t,i):null}remove(t){const i=t.trackById;return this.map.get(i).remove(t)&&this.map.delete(i),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Tg(e,t,i){const s=e.previousIndex;if(null===s)return s;let c=0;return i&&s<i.length&&(c=i[s]),s+t+c}class Xd{constructor(){}supports(t){return t instanceof Map||Eo(t)}create(){return new iC}}class iC{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let i;for(i=this._mapHead;null!==i;i=i._next)t(i)}forEachPreviousItem(t){let i;for(i=this._previousMapHead;null!==i;i=i._nextPrevious)t(i)}forEachChangedItem(t){let i;for(i=this._changesHead;null!==i;i=i._nextChanged)t(i)}forEachAddedItem(t){let i;for(i=this._additionsHead;null!==i;i=i._nextAdded)t(i)}forEachRemovedItem(t){let i;for(i=this._removalsHead;null!==i;i=i._nextRemoved)t(i)}diff(t){if(t){if(!(t instanceof Map||Eo(t)))throw new ie(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let i=this._mapHead;if(this._appendAfter=null,this._forEach(t,(s,c)=>{if(i&&i.key===c)this._maybeAddToChanges(i,s),this._appendAfter=i,i=i._next;else{const d=this._getOrCreateRecordForKey(c,s);i=this._insertBeforeOrAppend(i,d)}}),i){i._prev&&(i._prev._next=null),this._removalsHead=i;for(let s=i;null!==s;s=s._nextRemoved)s===this._mapHead&&(this._mapHead=null),this._records.delete(s.key),s._nextRemoved=s._next,s.previousValue=s.currentValue,s.currentValue=null,s._prev=null,s._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,i){if(t){const s=t._prev;return i._next=t,i._prev=s,t._prev=i,s&&(s._next=i),t===this._mapHead&&(this._mapHead=i),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=i,i._prev=this._appendAfter):this._mapHead=i,this._appendAfter=i,null}_getOrCreateRecordForKey(t,i){if(this._records.has(t)){const c=this._records.get(t);this._maybeAddToChanges(c,i);const d=c._prev,p=c._next;return d&&(d._next=p),p&&(p._prev=d),c._next=null,c._prev=null,c}const s=new ep(t);return this._records.set(t,s),s.currentValue=i,this._addToAdditions(s),s}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,i){Object.is(i,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=i,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,i){t instanceof Map?t.forEach(i):Object.keys(t).forEach(s=>i(t[s],s))}}class ep{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function tp(){return new np([new Mg])}let np=(()=>{class e{static#e=this.\u0275prov=et({token:e,providedIn:"root",factory:tp});constructor(i){this.factories=i}static create(i,s){if(null!=s){const c=s.factories.slice();i=i.concat(c)}return new e(i)}static extend(i){return{provide:e,useFactory:s=>e.create(i,s||tp()),deps:[[e,new qc,new Ch]]}}find(i){const s=this.factories.find(c=>c.supports(i));if(null!=s)return s;throw new ie(901,!1)}}return e})();function Ol(){return new ip([new Xd])}let ip=(()=>{class e{static#e=this.\u0275prov=et({token:e,providedIn:"root",factory:Ol});constructor(i){this.factories=i}static create(i,s){if(s){const c=s.factories.slice();i=i.concat(c)}return new e(i)}static extend(i){return{provide:e,useFactory:s=>e.create(i,s||Ol()),deps:[[e,new qc,new Ch]]}}find(i){const s=this.factories.find(c=>c.supports(i));if(s)return s;throw new ie(901,!1)}}return e})();function Ma(e,t,i,s,c=!1){for(;null!==i;){const d=t[i.index];null!==d&&s.push(nt(d)),Ht(d)&&xg(d,s);const p=i.type;if(8&p)Ma(e,t,i.child,s);else if(32&p){const f=ua(i,t);let g;for(;g=f();)s.push(g)}else if(16&p){const f=rg(t,i);if(Array.isArray(f))s.push(...f);else{const g=Wr(t[at]);Ma(g[Y],g,f,s,!0)}}i=c?i.projectionNext:i.next}return s}function xg(e,t){for(let i=Tt;i<e.length;i++){const s=e[i],c=s[Y].firstChild;null!==c&&Ma(s[Y],s,c,t)}e[fi]!==e[wt]&&t.push(e[fi])}let Ig=[];const Pg={...I,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{qu(e.lView)},consumerOnSignalRead(){this.lView[Er]=this}};function Da(e){return e.ngOriginalError}class Ao{constructor(){this._console=console}handleError(t){const i=this._findOriginalError(t);this._console.error("ERROR",t),i&&this._console.error("ORIGINAL ERROR",i)}_findOriginalError(t){let i=t&&Da(t);for(;i&&Da(i);)i=Da(i);return i||null}}const Ag=new Ce("",{providedIn:"root",factory:()=>!1}),ge={};function Rg(e){Ug(Pe(),F(),Xe()+e,!1)}function Ug(e,t,i,s){if(!s)if(3==(3&t[me])){const d=e.preOrderCheckHooks;null!==d&&$s(t,d,i)}else{const d=e.preOrderHooks;null!==d&&Fr(t,d,0,i)}Yo(i)}function io(e,t=De.Default){const i=F();return null===i?Zt(e,t):Fc($e(),i,le(e),t)}function cs(e,t,i,s,c,d,p,f,g,y,v){const C=t.blueprint.slice();return C[wt]=c,C[me]=140|s,(null!==y||e&&2048&e[me])&&(C[me]|=2048),eh(C),C[st]=C[qo]=e,C[We]=i,C[fo]=p||e&&e[fo],C[fe]=f||e&&e[fe],C[Xt]=g||e&&e[Xt]||null,C[Kt]=d,C[hc]=function p_(){return Ki++}(),C[$i]=v,C[Av]=y,C[at]=2==t.type?e[at]:C,C}function ls(e,t,i,s,c){let d=e.data[t];if(null===d)d=function sp(e,t,i,s,c){const d=Qu(),p=rh(),g=e.data[t]=function up(e,t,i,s,c,d){let p=t?t.injectorIndex:-1,f=0;return Bs()&&(f|=128),{type:i,index:s,insertBeforeIndex:null,injectorIndex:p,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:f,providerIndexes:0,value:c,attrs:d,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,p?d:d&&d.parent,i,t,s,c);return null===e.firstChild&&(e.firstChild=g),null!==d&&(p?null==d.child&&null!==g.parent&&(d.child=g):null===d.next&&(d.next=g,g.prev=d)),g}(e,t,i,s,c),function Mc(){return ae.lFrame.inI18n}()&&(d.flags|=32);else if(64&d.type){d.type=i,d.value=s,d.attrs=c;const p=function bc(){const e=ae.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();d.injectorIndex=null===p?-1:p.injectorIndex}return Zi(d,!0),d}function Ei(e,t,i,s){if(0===i)return-1;const c=t.length;for(let d=0;d<i;d++)t.push(s),e.blueprint.push(s),e.data.push(null);return c}function Nl(e,t,i,s,c){const d=Xe(),p=2&s;try{Yo(-1),p&&t.length>ye&&Ug(e,t,ye,!1),gi(p?2:0,c),i(s,c)}finally{Yo(d),gi(p?3:1,c)}}function ap(e,t,i){if(Rf(t)){const s=k(null);try{const d=t.directiveEnd;for(let p=t.directiveStart;p<d;p++){const f=e.data[p];f.contentQueries&&f.contentQueries(1,i[p],p)}}finally{k(s)}}}function Sa(e,t,i){Gv()&&(function vC(e,t,i,s){const c=i.directiveStart,d=i.directiveEnd;Pr(i)&&function DC(e,t,i){const s=dn(t,e),c=Z(i);let p=16;i.signals?p=4096:i.onPush&&(p=64);const f=xa(e,cs(e,c,null,p,s,t,null,e[fo].rendererFactory.createRenderer(s,i),null,null,null));e[t.index]=f}(t,i,e.data[c+i.componentOffset]),e.firstCreatePass||Lr(i,t),Be(s,t);const p=i.initialInputs;for(let f=c;f<d;f++){const g=e.data[f],y=yi(t,e,f,i);Be(y,t),null!==p&&SC(0,f-c,y,g,0,p),hi(g)&&(pn(i.index,t)[We]=yi(t,e,f,i))}}(e,t,i,dn(i,t)),64==(64&i.flags)&&Bg(e,t,i))}function cp(e,t,i=dn){const s=t.localNames;if(null!==s){let c=t.index+1;for(let d=0;d<s.length;d+=2){const p=s[d+1],f=-1===p?i(t,e):e[p];e[c++]=f}}}function Z(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=lp(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):t}function lp(e,t,i,s,c,d,p,f,g,y,v){const C=ye+s,w=C+c,D=function v1(e,t){const i=[];for(let s=0;s<t;s++)i.push(s<e?null:ge);return i}(C,w),P="function"==typeof y?y():y;return D[Y]={type:e,blueprint:D,template:i,queries:null,viewQuery:f,declTNode:t,data:D.slice().fill(null,C),bindingStartIndex:C,expandoStartIndex:w,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof d?d():d,pipeRegistry:"function"==typeof p?p():p,firstChild:null,schemas:g,consts:P,incompleteFirstPass:!1,ssrId:v}}let uC=e=>null;function Lg(e,t,i,s){for(let c in e)if(e.hasOwnProperty(c)){i=null===i?{}:i;const d=e[c];null===s?Fl(i,t,c,d):s.hasOwnProperty(c)&&Fl(i,t,s[c],d)}return i}function Fl(e,t,i,s){e.hasOwnProperty(i)?e[i].push(t,s):e[i]=[t,s]}function Sn(e,t,i,s,c,d,p,f){const g=dn(t,i);let v,y=t.inputs;!f&&null!=y&&(v=y[s])?(mp(e,i,v,s,c),Pr(t)&&function gC(e,t){const i=pn(t,e);16&i[me]||(i[me]|=64)}(i,t.index)):3&t.type&&(s=function hC(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(s),c=null!=p?p(c,t.value||"",s):c,d.setProperty(g,s,c))}function dp(e,t,i,s){if(Gv()){const c=null===s?null:{"":-1},d=function CC(e,t){const i=e.directiveRegistry;let s=null,c=null;if(i)for(let d=0;d<i.length;d++){const p=i[d];if(Af(t,p.selectors,!1))if(s||(s=[]),hi(p))if(null!==p.findHostDirectiveDefs){const f=[];c=c||new Map,p.findHostDirectiveDefs(p,f,c),s.unshift(...f,p),pp(e,t,f.length)}else s.unshift(p),pp(e,t,0);else c=c||new Map,p.findHostDirectiveDefs?.(p,s,c),s.push(p)}return null===s?null:[s,c]}(e,i);let p,f;null===d?p=f=null:[p,f]=d,null!==p&&Hg(e,t,i,p,c,f),c&&function wC(e,t,i){if(t){const s=e.localNames=[];for(let c=0;c<t.length;c+=2){const d=i[t[c+1]];if(null==d)throw new ie(-301,!1);s.push(t[c],d)}}}(i,s,c)}i.mergedAttrs=uc(i.mergedAttrs,i.attrs)}function Hg(e,t,i,s,c,d){for(let y=0;y<s.length;y++)zs(Lr(i,t),e,s[y].type);!function MC(e,t,i){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+i,e.providerIndexes=t}(i,e.data.length,s.length);for(let y=0;y<s.length;y++){const v=s[y];v.providersResolver&&v.providersResolver(v)}let p=!1,f=!1,g=Ei(e,t,s.length,null);for(let y=0;y<s.length;y++){const v=s[y];i.mergedAttrs=uc(i.mergedAttrs,v.hostAttrs),b1(e,i,t,g,v),bC(g,v,c),null!==v.contentQueries&&(i.flags|=4),(null!==v.hostBindings||null!==v.hostAttrs||0!==v.hostVars)&&(i.flags|=64);const C=v.type.prototype;!p&&(C.ngOnChanges||C.ngOnInit||C.ngDoCheck)&&((e.preOrderHooks??=[]).push(i.index),p=!0),!f&&(C.ngOnChanges||C.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(i.index),f=!0),g++}!function Gg(e,t,i){const c=t.directiveEnd,d=e.data,p=t.attrs,f=[];let g=null,y=null;for(let v=t.directiveStart;v<c;v++){const C=d[v],w=i?i.get(C):null,P=w?w.outputs:null;g=Lg(C.inputs,v,g,w?w.inputs:null),y=Lg(C.outputs,v,y,P);const j=null===g||null===p||mv(t)?null:TC(g,v,p);f.push(j)}null!==g&&(g.hasOwnProperty("class")&&(t.flags|=8),g.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=f,t.inputs=g,t.outputs=y}(e,i,d)}function Bg(e,t,i){const s=i.directiveStart,c=i.directiveEnd,d=i.index,p=function Dc(){return ae.lFrame.currentDirectiveIndex}();try{Yo(d);for(let f=s;f<c;f++){const g=e.data[f],y=t[f];ch(f),(null!==g.hostBindings||0!==g.hostVars||null!==g.hostAttrs)&&_C(g,y)}}finally{Yo(-1),ch(p)}}function _C(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function pp(e,t,i){t.componentOffset=i,(e.components??=[]).push(t.index)}function bC(e,t,i){if(i){if(t.exportAs)for(let s=0;s<t.exportAs.length;s++)i[t.exportAs[s]]=e;hi(t)&&(i[""]=e)}}function b1(e,t,i,s,c){e.data[s]=c;const d=c.factory||(c.factory=ho(c.type)),p=new Jo(d,hi(c),io);e.blueprint[s]=p,i[s]=p,function mC(e,t,i,s,c){const d=c.hostBindings;if(d){let p=e.hostBindingOpCodes;null===p&&(p=e.hostBindingOpCodes=[]);const f=~t.index;(function yC(e){let t=e.length;for(;t>0;){const i=e[--t];if("number"==typeof i&&i<0)return i}return 0})(p)!=f&&p.push(f),p.push(i,s,d)}}(e,t,s,Ei(e,i,c.hostVars,ge),c)}function Pi(e,t,i,s,c,d){const p=dn(e,t);!function fp(e,t,i,s,c,d,p){if(null==d)e.removeAttribute(t,c,i);else{const f=null==p?_e(d):p(d,s||"",c);e.setAttribute(t,c,f,i)}}(t[fe],p,d,e.value,i,s,c)}function SC(e,t,i,s,c,d){const p=d[t];if(null!==p)for(let f=0;f<p.length;)jg(s,i,p[f++],p[f++],p[f++])}function jg(e,t,i,s,c){const d=k(null);try{const p=e.inputTransforms;null!==p&&p.hasOwnProperty(s)&&(c=p[s].call(t,c)),null!==e.setInput?e.setInput(t,c,i,s):t[s]=c}finally{k(d)}}function TC(e,t,i){let s=null,c=0;for(;c<i.length;){const d=i[c];if(0!==d)if(5!==d){if("number"==typeof d)break;if(e.hasOwnProperty(d)){null===s&&(s=[]);const p=e[d];for(let f=0;f<p.length;f+=2)if(p[f]===t){s.push(d,p[f+1],i[c+1]);break}}c+=2}else c+=2;else c+=4}return s}function qn(e,t,i,s){return[e,!0,!1,t,null,s,!1,i,null,null,null]}function hp(e,t){const i=e.contentQueries;if(null!==i){const s=k(null);try{for(let c=0;c<i.length;c+=2){const p=i[c+1];if(-1!==p){const f=e.data[p];js(i[c]),f.contentQueries(2,t[p],p)}}}finally{k(s)}}}function xa(e,t){return e[pc]?e[Pv][di]=t:e[pc]=t,e[Pv]=t,t}function gp(e,t,i){js(0);const s=k(null);try{t(e,i)}finally{k(s)}}function $g(e){return e[Vo]||(e[Vo]=[])}function Zg(e){return e.cleanup||(e.cleanup=[])}function us(e,t){const i=e[Xt],s=i?i.get(Ao,null):null;s&&s.handleError(t)}function mp(e,t,i,s,c){for(let d=0;d<i.length;){const p=i[d++],f=i[d++];jg(e.data[p],t[p],s,f,c)}}function oo(e,t,i){const s=Ar(t,e);!function dl(e,t,i){e.setValue(t,i)}(e[fe],s,i)}function Rl(e,t,i,s=!0){const c=t[fo],d=c.rendererFactory,p=c.afterRenderEventManager;d.begin?.(),p?.begin();try{yp(e,t,e.template,i);let g=0;for(;9216&t[me]||t[Er]?.dirty;){if(100===g)throw new ie(103,!1);g++,Yg(t,1)}}catch(g){throw s&&us(t,g),g}finally{d.end?.(),c.inlineEffectRunner?.flush(),p?.end()}}function yp(e,t,i,s){const c=t[me];if(256==(256&c))return;t[fo].inlineEffectRunner?.flush(),uh(t);let p=null,f=null;(function vp(e){return 2!==e.type})(e)&&(f=function Po(e){return e[Er]??function rC(e){const t=Ig.pop()??Object.create(Pg);return t.lView=e,t}(e)}(t),p=E(f));try{eh(t),function jv(e){return ae.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==i&&Nl(e,t,i,2,s);const g=3==(3&c);if(g){const C=e.preOrderCheckHooks;null!==C&&$s(t,C,null)}else{const C=e.preOrderHooks;null!==C&&Fr(t,C,0,null),xc(t,0)}if(function EC(e){for(let t=Xh(e);null!==t;t=v_(t)){if(!t[Nf])continue;const i=t[Us];for(let s=0;s<i.length;s++){F0(i[s])}}}(t),qg(t,0),null!==e.contentQueries&&hp(e,t),g){const C=e.contentCheckHooks;null!==C&&$s(t,C)}else{const C=e.contentHooks;null!==C&&Fr(t,C,1),xc(t,1)}!function lC(e,t){const i=e.hostBindingOpCodes;if(null!==i)try{for(let s=0;s<i.length;s++){const c=i[s];if(c<0)Yo(~c);else{const d=c,p=i[++s],f=i[++s];$v(p,d),f(2,t[d])}}}finally{Yo(-1)}}(e,t);const y=e.components;null!==y&&Qg(t,y,0);const v=e.viewQuery;if(null!==v&&gp(2,v,s),g){const C=e.viewCheckHooks;null!==C&&$s(t,C)}else{const C=e.viewHooks;null!==C&&Fr(t,C,2),xc(t,2)}if(!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),t[Gu]){for(const C of t[Gu])C();t[Gu]=null}t[me]&=-73}catch(g){throw qu(t),g}finally{null!==f&&(z(f,p),function Eg(e){e.lView[Er]!==e&&(e.lView=null,Ig.push(e))}(f)),Ju()}}function qg(e,t){for(let i=Xh(e);null!==i;i=v_(i)){i[Ff]=!1;for(let s=Tt;s<i.length;s++)zg(i[s],t)}}function Oo(e,t,i){zg(pn(t,e),i)}function zg(e,t){Vu(e)&&Yg(e,t)}function Yg(e,t){const s=e[Y],c=e[me],d=e[Er];let p=!!(0===t&&16&c);if(p||=!!(64&c&&0===t),p||=!!(1024&c),p||=!(!d?.dirty||!ne(d)),d&&(d.dirty=!1),e[me]&=-9217,p)yp(s,e,s.template,e[We]);else if(8192&c){qg(e,1);const f=s.components;null!==f&&Qg(e,f,1)}}function Qg(e,t,i){for(let s=0;s<t.length;s++)Oo(e,t[s],i)}function Ia(e){for(;e;){e[me]|=64;const t=Wr(e);if(Uf(e)&&!t)return e;e=t}return null}class gr{get rootNodes(){const t=this._lView,i=t[Y];return Ma(i,t,i.firstChild,[])}constructor(t,i){this._lView=t,this._cdRefInjectingView=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[We]}set context(t){this._lView[We]=t}get destroyed(){return 256==(256&this._lView[me])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[st];if(Ht(t)){const i=t[8],s=i?i.indexOf(this):-1;s>-1&&(Jr(t,s),$r(i,s))}this._attachedToViewContainer=!1}fl(this._lView[Y],this._lView)}onDestroy(t){Cc(this._lView,t)}markForCheck(){Ia(this._cdRefInjectingView||this._lView)}detach(){this._lView[me]&=-129}reattach(){Lv(this._lView),this._lView[me]|=128}detectChanges(){Rl(this._lView[Y],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ie(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function C_(e,t){ga(e,t,t[fe],2,null,null)}(this._lView[Y],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new ie(902,!1);this._appRef=t}}class PC extends gr{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;Rl(t[Y],t,t[We],!1)}checkNoChanges(){}get context(){return null}}let Wg=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=AC}return e})();function AC(e){return function OC(e,t,i){if(Pr(e)&&!i){const s=pn(e.index,t);return new gr(s,s)}return 47&e.type?new gr(t[at],t):null}($e(),F(),16==(16&e))}let Ea=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=RC;static#t=this.__NG_ENV_ID__=i=>i}return e})();class FC extends Ea{constructor(t){super(),this._lView=t}onDestroy(t){return Cc(this._lView,t),()=>function wc(e,t){if(null===e[zo])return;const i=e[zo].indexOf(t);-1!==i&&e[zo].splice(i,1)}(this._lView,t)}}function RC(){return new FC(F())}function mr(e,t){return performance?.mark?.(e,t)}function wp(e){return t=>{setTimeout(e,void 0,t)}}const Ai=class LC extends pf.xQ{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,i,s){let c=t,d=i||(()=>null),p=s;if(t&&"object"==typeof t){const g=t;c=g.next?.bind(g),d=g.error?.bind(g),p=g.complete?.bind(g)}this.__isAsync&&(d=wp(d),c&&(c=wp(c)),p&&(p=wp(p)));const f=super.subscribe({next:c,error:d,complete:p});return t instanceof ff.w&&t.add(f),f}};function Xg(...e){}class vt{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:s=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ai(!1),this.onMicrotaskEmpty=new Ai(!1),this.onStable=new Ai(!1),this.onError=new Ai(!1),typeof Zone>"u")throw new ie(908,!1);Zone.assertZonePatched();const c=this;c._nesting=0,c._outer=c._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(c._inner=c._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(c._inner=c._inner.fork(Zone.longStackTraceZoneSpec)),c.shouldCoalesceEventChangeDetection=!s&&i,c.shouldCoalesceRunChangeDetection=s,c.lastRequestAnimationFrameId=-1,c.nativeRequestAnimationFrame=function Ll(){const e="function"==typeof tt.requestAnimationFrame;let t=tt[e?"requestAnimationFrame":"setTimeout"],i=tt[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&t&&i){const s=t[Zone.__symbol__("OriginalDelegate")];s&&(t=s);const c=i[Zone.__symbol__("OriginalDelegate")];c&&(i=c)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:i}}().nativeRequestAnimationFrame,function tm(e){const t=()=>{!function em(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(tt,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Gl(e),e.isCheckStableRunning=!0,Mp(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Gl(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(i,s,c,d,p,f)=>{if(function im(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(f))return i.invokeTask(c,d,p,f);try{return Dp(e),i.invokeTask(c,d,p,f)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===d.type||e.shouldCoalesceRunChangeDetection)&&t(),nm(e)}},onInvoke:(i,s,c,d,p,f,g)=>{try{return Dp(e),i.invoke(c,d,p,f,g)}finally{e.shouldCoalesceRunChangeDetection&&t(),nm(e)}},onHasTask:(i,s,c,d)=>{i.hasTask(c,d),s===c&&("microTask"==d.change?(e._hasPendingMicrotasks=d.microTask,Gl(e),Mp(e)):"macroTask"==d.change&&(e.hasPendingMacrotasks=d.macroTask))},onHandleError:(i,s,c,d)=>(i.handleError(c,d),e.runOutsideAngular(()=>e.onError.emit(d)),!1)})}(c)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!vt.isInAngularZone())throw new ie(909,!1)}static assertNotInAngularZone(){if(vt.isInAngularZone())throw new ie(909,!1)}run(t,i,s){return this._inner.run(t,i,s)}runTask(t,i,s,c){const d=this._inner,p=d.scheduleEventTask("NgZoneEvent: "+c,t,bp,Xg,Xg);try{return d.runTask(p,i,s)}finally{d.cancelTask(p)}}runGuarded(t,i,s){return this._inner.runGuarded(t,i,s)}runOutsideAngular(t){return this._outer.run(t)}}const bp={};function Mp(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Gl(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function Dp(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function nm(e){e._nesting--,Mp(e)}class GC{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ai,this.onMicrotaskEmpty=new Ai,this.onStable=new Ai,this.onError=new Ai}run(t,i,s){return t.apply(i,s)}runGuarded(t,i,s){return t.apply(i,s)}runOutsideAngular(t){return t()}runTask(t,i,s,c){return t.apply(i,s)}}const Hl=new Ce("",{providedIn:"root",factory:ds});function ds(){const e=Ae(vt);let t=!0;const i=new hf.y(c=>{t=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{c.next(t),c.complete()})}),s=new hf.y(c=>{let d;e.runOutsideAngular(()=>{d=e.onStable.subscribe(()=>{vt.assertNotInAngularZone(),queueMicrotask(()=>{!t&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(t=!0,c.next(!0))})})});const p=e.onUnstable.subscribe(()=>{vt.assertInAngularZone(),t&&(t=!1,e.runOutsideAngular(()=>{c.next(!1)}))});return()=>{d.unsubscribe(),p.unsubscribe()}});return(0,Vy.T)(i,s.pipe(ke()))}let Bl=(()=>{class e{constructor(){this.renderDepth=0,this.handler=null,this.internalCallbacks=[]}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth){for(const i of this.internalCallbacks)i();this.internalCallbacks.length=0,this.handler?.execute()}}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=et({token:e,providedIn:"root",factory:()=>new e})}return e})();function Sp(e,t){const i=pn(t,e),s=i[Y];!function Tp(e,t){for(let i=t.length;i<e.blueprint.length;i++)t.push(e.blueprint[i])}(s,i);const c=i[wt];null!==c&&null===i[$i]&&(i[$i]=Wd(c,i[Xt])),xp(s,i,i[We])}function xp(e,t,i){uh(t);try{const s=e.viewQuery;null!==s&&gp(1,s,i);const c=e.template;null!==c&&Nl(e,t,c,1,i),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&hp(e,t),e.staticViewQueries&&gp(2,e.viewQuery,i);const d=e.components;null!==d&&function cm(e,t){for(let i=0;i<t.length;i++)Sp(e,t[i])}(t,d)}catch(s){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),s}finally{t[me]&=-5,Ju()}}function jl(e,t,i){let s=i?e.styles:null,c=i?e.classes:null,d=0;if(null!==t)for(let p=0;p<t.length;p++){const f=t[p];"number"==typeof f?d=f:1==d?c=ht(c,f):2==d&&(s=ht(s,f+": "+t[++p]+";"))}i?e.styles=s:e.stylesWithoutHost=s,i?e.classes=c:e.classesWithoutHost=c}class lm extends ba{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const i=Se(t);return new Aa(i,this.ngModule)}}function Pa(e){const t=[];for(let i in e)e.hasOwnProperty(i)&&t.push({propName:e[i],templateName:i});return t}class jC{constructor(t,i){this.injector=t,this.parentInjector=i}get(t,i,s){s=Nu(s);const c=this.injector.get(t,Pl,s);return c!==Pl||i===Pl?c:this.parentInjector.get(t,i,s)}}class Aa extends wa{get inputs(){const t=this.componentDef,i=t.inputTransforms,s=Pa(t.inputs);if(null!==i)for(const c of s)i.hasOwnProperty(c.propName)&&(c.transform=i[c.propName]);return s}get outputs(){return Pa(this.componentDef.outputs)}constructor(t,i){super(),this.componentDef=t,this.ngModule=i,this.componentType=t.type,this.selector=function Mv(e){return e.map(bv).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!i}create(t,i,s,c){let d=(c=c||this.ngModule)instanceof ve?c:c?.injector;d&&null!==this.componentDef.getStandaloneInjector&&(d=this.componentDef.getStandaloneInjector(d)||d);const p=d?new jC(t,d):t,f=p.get(lt,null);if(null===f)throw new ie(407,!1);const v={rendererFactory:f,sanitizer:p.get(wg,null),inlineEffectRunner:null,afterRenderEventManager:p.get(Bl,null)},C=f.createRenderer(null,this.componentDef),w=this.componentDef.selectors[0][0]||"div",D=s?function _1(e,t,i,s){const d=s.get(Ag,!1)||i===Bi.ShadowDom,p=e.selectRootElement(t,d);return function C1(e){uC(e)}(p),p}(C,s,this.componentDef.encapsulation,p):pa(C,w,function um(e){const t=e.toLowerCase();return"svg"===t?Wf:"math"===t?"math":null}(w)),K=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let oe=null;null!==D&&(oe=Wd(D,p,!0));const G=lp(0,null,null,1,0,null,null,null,null,null,null),he=cs(null,G,null,K,null,null,v,C,p,null,oe);let Oe,Ve;uh(he);try{const Yt=this.componentDef;let Ja,Kb=null;Yt.findHostDirectiveDefs?(Ja=[],Kb=new Map,Yt.findHostDirectiveDefs(Yt,Ja,Kb),Ja.push(Yt)):Ja=[Yt];const PE=function dm(e,t){const i=e[Y],s=ye;return e[s]=t,ls(i,s,2,"#host",null)}(he,D),AE=function I1(e,t,i,s,c,d,p){const f=c[Y];!function ZC(e,t,i,s){for(const c of e)t.mergedAttrs=uc(t.mergedAttrs,c.hostAttrs);null!==t.mergedAttrs&&(jl(t,t.mergedAttrs,!0),null!==i&&_l(s,i,t))}(s,e,t,p);let g=null;null!==t&&(g=Wd(t,c[Xt]));const y=d.rendererFactory.createRenderer(t,i);let v=16;i.signals?v=4096:i.onPush&&(v=64);const C=cs(c,Z(i),null,v,c[e.index],e,d,y,null,null,g);return f.firstCreatePass&&pp(f,e,s.length-1),xa(c,C),c[e.index]=C}(PE,D,Yt,Ja,he,v,C);Ve=Hs(G,ye),D&&function qC(e,t,i,s){if(s)If(e,i,["ng-version",El.full]);else{const{attrs:c,classes:d}=function Dv(e){const t=[],i=[];let s=1,c=2;for(;s<e.length;){let d=e[s];if("string"==typeof d)2===c?""!==d&&t.push(d,e[++s]):8===c&&i.push(d);else{if(!Xn(c))break;c=d}s++}return{attrs:t,classes:i}}(t.selectors[0]);c&&If(e,i,c),d&&d.length>0&&Ud(e,i,d.join(" "))}}(C,Yt,D,s),void 0!==i&&function zC(e,t,i){const s=e.projection=[];for(let c=0;c<t.length;c++){const d=i[c];s.push(null!=d?Array.from(d):null)}}(Ve,this.ngContentSelectors,i),Oe=function VC(e,t,i,s,c,d){const p=$e(),f=c[Y],g=dn(p,c);Hg(f,c,p,i,null,s);for(let v=0;v<i.length;v++)Be(yi(c,f,p.directiveStart+v,p),c);Bg(f,c,p),g&&Be(g,c);const y=yi(c,f,p.directiveStart+p.componentOffset,p);if(e[We]=c[We]=y,null!==d)for(const v of d)v(y,t);return ap(f,p,e),y}(AE,Yt,Ja,Kb,he,[Ip]),xp(G,he,null)}finally{Ju()}return new $C(this.componentType,Oe,no(Ve,he),he,Ve)}}class $C extends an{constructor(t,i,s,c,d){super(),this.location=s,this._rootLView=c,this._tNode=d,this.previousInputValues=null,this.instance=i,this.hostView=this.changeDetectorRef=new PC(c),this.componentType=t}setInput(t,i){const s=this._tNode.inputs;let c;if(null!==s&&(c=s[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),i))return;const d=this._rootLView;mp(d[Y],d,c,t,i),this.previousInputValues.set(t,i),Ia(pn(this._tNode.index,d))}}get injector(){return new dt(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function Ip(){const e=$e();Wo(F()[Y],e)}function Ep(e){let t=function pm(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),i=!0;const s=[e];for(;t;){let c;if(hi(e))c=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new ie(903,!1);c=t.\u0275dir}if(c){if(i){s.push(c);const p=e;p.inputs=$l(e.inputs),p.inputTransforms=$l(e.inputTransforms),p.declaredInputs=$l(e.declaredInputs),p.outputs=$l(e.outputs);const f=c.hostBindings;f&&JC(e,f);const g=c.viewQuery,y=c.contentQueries;if(g&&QC(e,g),y&&WC(e,y),cn(e.inputs,c.inputs),cn(e.declaredInputs,c.declaredInputs),cn(e.outputs,c.outputs),null!==c.inputTransforms&&(null===p.inputTransforms&&(p.inputTransforms={}),cn(p.inputTransforms,c.inputTransforms)),hi(c)&&c.data.animation){const v=e.data;v.animation=(v.animation||[]).concat(c.data.animation)}}const d=c.features;if(d)for(let p=0;p<d.length;p++){const f=d[p];f&&f.ngInherit&&f(e),f===Ep&&(i=!1)}}t=Object.getPrototypeOf(t)}!function YC(e){let t=0,i=null;for(let s=e.length-1;s>=0;s--){const c=e[s];c.hostVars=t+=c.hostVars,c.hostAttrs=uc(c.hostAttrs,i=uc(i,c.hostAttrs))}}(s)}function $l(e){return e===ji?{}:e===Ge?[]:e}function QC(e,t){const i=e.viewQuery;e.viewQuery=i?(s,c)=>{t(s,c),i(s,c)}:t}function WC(e,t){const i=e.contentQueries;e.contentQueries=i?(s,c,d)=>{t(s,c,d),i(s,c,d)}:t}function JC(e,t){const i=e.hostBindings;e.hostBindings=i?(s,c)=>{t(s,c),i(s,c)}:t}function yr(e){const t=e.inputConfig,i={};for(const s in t)if(t.hasOwnProperty(s)){const c=t[s];Array.isArray(c)&&c[2]&&(i[s]=c[2])}e.inputTransforms=i}function Oi(e,t,i){return e[t]=i}function It(e,t,i){return!Object.is(e[t],i)&&(e[t]=i,!0)}function so(e,t,i,s){const c=It(e,t,i);return It(e,t+1,s)||c}function Na(e,t,i,s){const c=F();return It(c,Ft(),t)&&(Pe(),Pi(it(),c,e,t,i,s)),Na}function ao(e,t,i,s){return It(e,Ft(),i)?t+_e(i)+s:ge}function Ye(e,t,i,s,c,d,p,f){const y=function Vl(e,t,i,s,c){const d=so(e,t,i,s);return It(e,t+2,c)||d}(e,ct(),i,c,p);return _n(3),y?t+_e(i)+s+_e(c)+d+_e(p)+f:ge}function ql(e,t){return e<<17|t<<2}function jt(e){return e>>17&32767}function gs(e){return 2|e}function Ro(e){return(131068&e)>>2}function ms(e,t){return-131069&e|t<<2}function Fa(e){return 1|e}function oi(e,t,i,s,c){const d=e[i+1],p=null===t;let f=s?jt(d):Ro(d),g=!1;for(;0!==f&&(!1===g||p);){const v=e[f+1];Uo(e[f],t)&&(g=!0,e[f+1]=s?Fa(v):gs(v)),f=s?jt(v):Ro(v)}g&&(e[i+1]=s?gs(d):Fa(d))}function Uo(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Zr(e,t)>=0}const Re={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Yn(e){return e.substring(Re.key,Re.keyEnd)}function sw(e){return e.substring(Re.value,Re.valueEnd)}function vm(e,t){const i=Re.textEnd;return i===t?-1:(t=Re.keyEnd=function _m(e,t,i){for(;t<i&&e.charCodeAt(t)>32;)t++;return t}(e,Re.key=t,i),ys(e,t,i))}function br(e,t){const i=Re.textEnd;let s=Re.key=ys(e,t,i);return i===s?-1:(s=Re.keyEnd=function lw(e,t,i){let s;for(;t<i&&(45===(s=e.charCodeAt(t))||95===s||(-33&s)>=65&&(-33&s)<=90||s>=48&&s<=57);)t++;return t}(e,s,i),s=Cm(e,s,i),s=Re.value=ys(e,s,i),s=Re.valueEnd=function uw(e,t,i){let s=-1,c=-1,d=-1,p=t,f=p;for(;p<i;){const g=e.charCodeAt(p++);if(59===g)return f;34===g||39===g?f=p=wm(e,g,p,i):t===p-4&&85===d&&82===c&&76===s&&40===g?f=p=wm(e,41,p,i):g>32&&(f=p),d=c,c=s,s=-33&g}return f}(e,s,i),Cm(e,s,i))}function Ni(e){Re.key=0,Re.keyEnd=0,Re.value=0,Re.valueEnd=0,Re.textEnd=e.length}function ys(e,t,i){for(;t<i&&e.charCodeAt(t)<=32;)t++;return t}function Cm(e,t,i,s){return(t=ys(e,t,i))<i&&t++,t}function wm(e,t,i,s){let c=-1,d=i;for(;d<s;){const p=e.charCodeAt(d++);if(p==t&&92!==c)return d;c=92==p&&92===c?0:p}throw new Error}function zl(e,t,i){const s=F();return It(s,Ft(),t)&&Sn(Pe(),it(),s,e,t,s[fe],i,!1),zl}function Ra(e,t,i,s,c){const p=c?"class":"style";mp(e,i,t.inputs[p],p,s)}function Ap(e,t,i){return Qn(e,t,i,!1),Ap}function Op(e,t){return Qn(e,t,null,!0),Op}function ri(e){si(Tm,bm,e,!1)}function bm(e,t){for(let i=function cw(e){return Ni(e),br(e,ys(e,0,Re.textEnd))}(t);i>=0;i=br(t,i))Tm(e,Yn(t),sw(t))}function Mm(e){si(xm,Fi,e,!0)}function Fi(e,t){for(let i=function aw(e){return Ni(e),vm(e,ys(e,0,Re.textEnd))}(t);i>=0;i=vm(t,i))Bn(e,Yn(t),!0)}function Qn(e,t,i,s){const c=F(),d=Pe(),p=_n(2);d.firstUpdatePass&&kp(d,e,p,s),t!==ge&&It(c,p,t)&&Em(d,d.data[Xe()],c,c[fe],e,c[p+1]=function gw(e,t){return null==e||""===e||("string"==typeof t?e+=t:"object"==typeof e&&(e=St(Xi(e)))),e}(t,i),s,p)}function si(e,t,i,s){const c=Pe(),d=_n(2);c.firstUpdatePass&&kp(c,null,d,s);const p=F();if(i!==ge&&It(p,d,i)){const f=c.data[Xe()];if(Fp(f,s)&&!Dm(c,d)){let g=s?f.classesWithoutHost:f.stylesWithoutHost;null!==g&&(i=ht(g,i||"")),Ra(c,f,p,i,s)}else!function Im(e,t,i,s,c,d,p,f){c===ge&&(c=Ge);let g=0,y=0,v=0<c.length?c[0]:null,C=0<d.length?d[0]:null;for(;null!==v||null!==C;){const w=g<c.length?c[g+1]:void 0,D=y<d.length?d[y+1]:void 0;let j,P=null;v===C?(g+=2,y+=2,w!==D&&(P=C,j=D)):null===C||null!==v&&v<C?(g+=2,P=v):(y+=2,P=C,j=D),null!==P&&Em(e,t,i,s,P,j,p,f),v=g<c.length?c[g]:null,C=y<d.length?d[y]:null}}(c,f,p,p[fe],p[d+1],p[d+1]=function hw(e,t,i){if(null==i||""===i)return Ge;const s=[],c=Xi(i);if(Array.isArray(c))for(let d=0;d<c.length;d++)e(s,c[d],!0);else if("object"==typeof c)for(const d in c)c.hasOwnProperty(d)&&e(s,d,c[d]);else"string"==typeof c&&t(s,c);return s}(e,t,i),s,d)}}function Dm(e,t){return t>=e.expandoStartIndex}function kp(e,t,i,s){const c=e.data;if(null===c[i+1]){const d=c[Xe()],p=Dm(e,i);Fp(d,s)&&null===t&&!p&&(t=!1),t=function dw(e,t,i,s){const c=function Ze(e){const t=ae.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let d=s?t.residualClasses:t.residualStyles;if(null===c)0===(s?t.classBindings:t.styleBindings)&&(i=vs(i=Np(null,e,t,i,s),t.attrs,s),d=null);else{const p=t.directiveStylingLast;if(-1===p||e[p]!==c)if(i=Np(c,e,t,i,s),null===d){let g=function pw(e,t,i){const s=i?t.classBindings:t.styleBindings;if(0!==Ro(s))return e[jt(s)]}(e,t,s);void 0!==g&&Array.isArray(g)&&(g=Np(null,e,t,g[1],s),g=vs(g,t.attrs,s),function Sm(e,t,i,s){e[jt(i?t.classBindings:t.styleBindings)]=s}(e,t,s,g))}else d=function fw(e,t,i){let s;const c=t.directiveEnd;for(let d=1+t.directiveStylingLast;d<c;d++)s=vs(s,e[d].hostAttrs,i);return vs(s,t.attrs,i)}(e,t,s)}return void 0!==d&&(s?t.residualClasses=d:t.residualStyles=d),i}(c,d,t,s),function Nt(e,t,i,s,c,d){let p=d?t.classBindings:t.styleBindings,f=jt(p),g=Ro(p);e[s]=i;let v,y=!1;if(Array.isArray(i)?(v=i[1],(null===v||Zr(i,v)>0)&&(y=!0)):v=i,c)if(0!==g){const w=jt(e[f+1]);e[s+1]=ql(w,f),0!==w&&(e[w+1]=ms(e[w+1],s)),e[f+1]=function Tn(e,t){return 131071&e|t<<17}(e[f+1],s)}else e[s+1]=ql(f,0),0!==f&&(e[f+1]=ms(e[f+1],s)),f=s;else e[s+1]=ql(g,0),0===f?f=s:e[g+1]=ms(e[g+1],s),g=s;y&&(e[s+1]=gs(e[s+1])),oi(e,v,s,!0),oi(e,v,s,!1),function wr(e,t,i,s,c){const d=c?e.residualClasses:e.residualStyles;null!=d&&"string"==typeof t&&Zr(d,t)>=0&&(i[s+1]=Fa(i[s+1]))}(t,v,e,s,d),p=ql(f,g),d?t.classBindings=p:t.styleBindings=p}(c,d,t,i,p,s)}}function Np(e,t,i,s,c){let d=null;const p=i.directiveEnd;let f=i.directiveStylingLast;for(-1===f?f=i.directiveStart:f++;f<p&&(d=t[f],s=vs(s,d.hostAttrs,c),d!==e);)f++;return null!==e&&(i.directiveStylingLast=f),s}function vs(e,t,i){const s=i?1:2;let c=-1;if(null!==t)for(let d=0;d<t.length;d++){const p=t[d];"number"==typeof p?c=p:c===s&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Bn(e,p,!!i||t[++d]))}return void 0===e?null:e}function Tm(e,t,i){Bn(e,t,Xi(i))}function xm(e,t,i){const s=String(t);""!==s&&!s.includes(" ")&&Bn(e,s,i)}function Em(e,t,i,s,c,d,p,f){if(!(3&t.type))return;const g=e.data,y=g[f+1],v=function ow(e){return 1==(1&e)}(y)?Pm(g,t,i,c,Ro(y),p):void 0;Yl(v)||(Yl(d)||function kt(e){return 2==(2&e)}(y)&&(d=Pm(g,null,i,c,f,p)),function vl(e,t,i,s,c){if(t)c?e.addClass(i,s):e.removeClass(i,s);else{let d=-1===s.indexOf("-")?void 0:aa.DashCase;null==c?e.removeStyle(i,s,d):("string"==typeof c&&c.endsWith("!important")&&(c=c.slice(0,-10),d|=aa.Important),e.setStyle(i,s,c,d))}}(s,p,Ar(Xe(),i),c,d))}function Pm(e,t,i,s,c,d){const p=null===t;let f;for(;c>0;){const g=e[c],y=Array.isArray(g),v=y?g[1]:g,C=null===v;let w=i[c+1];w===ge&&(w=C?Ge:void 0);let D=C?$c(w,s):v===s?w:void 0;if(y&&!Yl(D)&&(D=$c(g,s)),Yl(D)&&(f=D,p))return f;const P=e[c+1];c=p?jt(P):Ro(P)}if(null!==t){let g=d?t.residualClasses:t.residualStyles;null!=g&&(f=$c(g,s))}return f}function Yl(e){return void 0!==e}function Fp(e,t){return 0!=(e.flags&(t?8:16))}let Lm=(e,t)=>null;function Cs(e,t){return Lm(e,t)}class Gm{destroy(t){}updateValue(t,i){}swap(t,i){const s=Math.min(t,i),c=Math.max(t,i),d=this.detach(c);if(c-s>1){const p=this.detach(s);this.attach(s,d),this.attach(c,p)}else this.attach(s,d)}move(t,i){this.attach(i,this.detach(t))}}function Ba(e,t,i,s,c){return e===i&&Object.is(t,s)?1:Object.is(c(e,t),c(i,s))?-1:0}function iu(e,t,i,s){return!(void 0===t||!t.has(s)||(e.attach(i,t.get(s)),t.delete(s),0))}function Bm(e,t,i,s,c){if(iu(e,t,s,i(s,c)))e.updateValue(s,c);else{const d=e.create(s,c);e.attach(s,d)}}function jm(e,t,i,s){const c=new Set;for(let d=t;d<=i;d++)c.add(s(d,e.at(d)));return c}class $m{constructor(){this.map=new Map}has(t){const i=this.map.get(t);return void 0!==i&&i.length>0}delete(t){const i=this.map.get(t);return void 0!==i&&(i.pop(),!0)}get(t){const i=this.map.get(t);return void 0!==i&&i.length>0?i[0]:void 0}set(t,i){this.map.has(t)?this.map.get(t)?.push(i):this.map.set(t,[i])}forEach(t){for(const[i,s]of this.map)for(const c of s)t(c,i)}}function ja(e,t,i,s){const c=t.tView,f=cs(e,c,i,4096&e[me]?4096:16,null,t,null,null,null,s?.injector??null,s?.dehydratedView??null);f[fc]=e[t.index];const y=e[pi];return null!==y&&(f[pi]=y.createEmbeddedView(c)),xp(c,f,i),f}function Zm(e,t){const i=Tt+t;if(i<e.length)return e[i]}function ws(e,t){return!t||sa(e)}function $a(e,t,i,s=!0){const c=t[Y];if(function w_(e,t,i,s){const c=Tt+s,d=i.length;s>0&&(i[c-1][di]=t),s<d-Tt?(t[di]=i[c],Bc(i,Tt+s,t)):(i.push(t),t[di]=null),t[st]=i;const p=t[fc];null!==p&&i!==p&&function b_(e,t){const i=e[Us];t[at]!==t[st][st][at]&&(e[Nf]=!0),null===i?e[Us]=[t]:i.push(t)}(p,t);const f=t[pi];null!==f&&f.insertView(e),Lv(t),t[me]|=128}(c,t,e,i),s){const d=sg(i,e),p=t[fe],f=Kr(p,e[fi]);null!==f&&function Ad(e,t,i,s,c,d){s[wt]=c,s[Kt]=t,ga(e,s,i,1,c,d)}(c,e[Kt],p,t,f,d)}}function bs(e,t){const i=Jr(e,t);return void 0!==i&&fl(i[Y],i),i}let ou=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=Bw}return e})();function Bw(){return qm($e(),F())}const jw=ou,co=class extends jw{constructor(t,i,s){super(),this._lContainer=t,this._hostTNode=i,this._hostLView=s}get element(){return no(this._hostTNode,this._hostLView)}get injector(){return new dt(this._hostTNode,this._hostLView)}get parentInjector(){const t=Xo(this._hostTNode,this._hostLView);if(Zs(t)){const i=Ac(t,this._hostLView),s=Vs(t);return new dt(i[Y].data[s+8],i)}return new dt(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const i=Vm(this._lContainer);return null!==i&&i[t]||null}get length(){return this._lContainer.length-Tt}createEmbeddedView(t,i,s){let c,d;"number"==typeof s?c=s:null!=s&&(c=s.index,d=s.injector);const p=Cs(this._lContainer,t.ssrId),f=t.createEmbeddedViewImpl(i||{},d,p);return this.insertImpl(f,c,ws(this._hostTNode,p)),f}createComponent(t,i,s,c,d){const p=t&&!function Js(e){return"function"==typeof e}(t);let f;if(p)f=i;else{const P=i||{};f=P.index,s=P.injector,c=P.projectableNodes,d=P.environmentInjector||P.ngModuleRef}const g=p?t:new Aa(Se(t)),y=s||this.parentInjector;if(!d&&null==g.ngModule){const j=(p?y:this.parentInjector).get(ve,null);j&&(d=j)}const v=Se(g.componentType??{}),C=Cs(this._lContainer,v?.id??null),D=g.create(y,c,C?.firstChild??null,d);return this.insertImpl(D.hostView,f,ws(this._hostTNode,C)),D}insert(t,i){return this.insertImpl(t,i,!0)}insertImpl(t,i,s){const c=t._lView;if(function Xf(e){return Ht(e[st])}(c)){const f=this.indexOf(t);if(-1!==f)this.detach(f);else{const g=c[st],y=new co(g,g[Kt],g[st]);y.detach(y.indexOf(t))}}const d=this._adjustIndex(i),p=this._lContainer;return $a(p,c,d,s),t.attachToViewContainerRef(),Bc(Lp(p),d,t),t}move(t,i){return this.insert(t,i)}indexOf(t){const i=Vm(this._lContainer);return null!==i?i.indexOf(t):-1}remove(t){const i=this._adjustIndex(t,-1),s=Jr(this._lContainer,i);s&&($r(Lp(this._lContainer),i),fl(s[Y],s))}detach(t){const i=this._adjustIndex(t,-1),s=Jr(this._lContainer,i);return s&&null!=$r(Lp(this._lContainer),i)?new gr(s):null}_adjustIndex(t,i=0){return t??this.length+i}};function Vm(e){return e[8]}function Lp(e){return e[8]||(e[8]=[])}function qm(e,t){let i;const s=t[e.index];return Ht(s)?i=s:(i=qn(s,t,null,e),t[e.index]=i,xa(t,i)),Ym(i,t,e,s),new co(i,e,t)}let Ym=function Wm(e,t,i,s){if(e[fi])return;let c;c=8&i.type?nt(s):function zm(e,t){const i=e[fe],s=i.createComment(""),c=dn(t,e);return bo(i,Kr(i,c),s,function T_(e,t){return e.nextSibling(t)}(i,c),!1),s}(t,i),e[fi]=c},Gp=(e,t,i)=>!1;function Ms(e,t,i,s,c,d,p,f){const g=F(),y=Pe(),v=e+ye,C=y.firstCreatePass?function qw(e,t,i,s,c,d,p,f,g){const y=t.consts,v=ls(t,e,4,p||null,ei(y,f));dp(t,i,v,ei(y,g)),Wo(t,v);const C=v.tView=lp(2,v,s,c,d,t.directiveRegistry,t.pipeRegistry,null,t.schemas,y,null);return null!==t.queries&&(t.queries.template(t,v),C.queries=t.queries.embeddedTView(v)),v}(v,y,g,t,i,s,c,d,p):y.data[v];Zi(C,!1);const w=Jm(y,g,C,e);Nr()&&Fd(y,g,w,C),Be(w,g);const D=qn(w,g,w,C);return g[v]=D,xa(g,D),function Qm(e,t,i){return Gp(e,t,i)}(D,C,g),Hu(C)&&Sa(y,g,C),null!=p&&cp(g,C,f),Ms}let Jm=function Km(e,t,i,s){return Un(!0),t[fe].createComment("")};const Xm={detail:{feature:"NgControlFlow"}};function ey(e,t,i){mr("mark_use_counter",Xm);const s=F(),c=Ft(),d=Hp(s,ye+e);if(It(s,c,t)){const f=k(null);try{if(bs(d,0),-1!==t){const g=Bp(s[Y],t),y=Cs(d,g.tView.ssrId);$a(d,ja(s,g,i,{dehydratedView:y}),0,ws(g,y))}}finally{k(f)}}else{const f=Zm(d,0);void 0!==f&&(f[We]=i)}}class Qw{constructor(t,i,s){this.lContainer=t,this.$implicit=i,this.$index=s}get $count(){return this.lContainer.length-Tt}}function ty(e){return e}function ny(e,t){return t}class Ww{constructor(t,i,s){this.hasEmptyBlock=t,this.trackByFn=i,this.liveCollection=s}}function iy(e,t,i,s,c,d,p,f,g,y,v){mr("mark_use_counter",Xm);const C=void 0!==g,w=F(),D=f?p.bind(w[at][We]):p,P=new Ww(C,D);w[ye+e]=P,Ms(e+1,t,i,s,c,d),C&&Ms(e+2,g,y,v)}class Jw extends Gm{constructor(t,i,s){super(),this.lContainer=t,this.hostLView=i,this.templateTNode=s,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-Tt}at(t){return this.getLView(t)[We].$implicit}attach(t,i){const s=i[$i];this.needsIndexUpdate||=t!==this.length,$a(this.lContainer,i,t,ws(this.templateTNode,s))}detach(t){return this.needsIndexUpdate||=t!==this.length-1,function Wn(e,t){return Jr(e,t)}(this.lContainer,t)}create(t,i){const s=Cs(this.lContainer,this.templateTNode.tView.ssrId);return ja(this.hostLView,this.templateTNode,new Qw(this.lContainer,i,t),{dehydratedView:s})}destroy(t){fl(t[Y],t)}updateValue(t,i){this.getLView(t)[We].$implicit=i}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let t=0;t<this.length;t++)this.getLView(t)[We].$index=t}getLView(t){return function Kw(e,t){return Zm(e,t)}(this.lContainer,t)}}function oy(e,t){const i=k(null);try{const s=F(),c=s[Y],d=s[ye+e];if(void 0===d.liveCollection){const f=e+1,g=Hp(s,ye+f),y=Bp(c,f);d.liveCollection=new Jw(g,s,y)}else d.liveCollection.reset();const p=d.liveCollection;if(function Hm(e,t,i){let s,c,d=0,p=e.length-1;if(Array.isArray(t)){let f=t.length-1;for(;d<=p&&d<=f;){const g=e.at(d),y=t[d],v=Ba(d,g,d,y,i);if(0!==v){v<0&&e.updateValue(d,y),d++;continue}const C=e.at(p),w=t[f],D=Ba(p,C,f,w,i);if(0!==D){D<0&&e.updateValue(p,w),p--,f--;continue}const P=i(d,g),j=i(p,C),K=i(d,y);if(Object.is(K,j)){const oe=i(f,w);Object.is(oe,P)?(e.swap(d,p),e.updateValue(p,w),f--,p--):e.move(p,d),e.updateValue(d,y),d++}else if(s??=new $m,c??=jm(e,d,p,i),iu(e,s,d,K))e.updateValue(d,y),d++,p++;else if(c.has(K))s.set(P,e.detach(d)),p--;else{const oe=e.create(d,t[d]);e.attach(d,oe),d++,p++}}for(;d<=f;)Bm(e,s,i,d,t[d]),d++}else if(null!=t){const f=t[Symbol.iterator]();let g=f.next();for(;!g.done&&d<=p;){const y=e.at(d),v=g.value,C=Ba(d,y,d,v,i);if(0!==C)C<0&&e.updateValue(d,v),d++,g=f.next();else{s??=new $m,c??=jm(e,d,p,i);const w=i(d,v);if(iu(e,s,d,w))e.updateValue(d,v),d++,p++,g=f.next();else if(c.has(w)){const D=i(d,y);s.set(D,e.detach(d)),p--}else e.attach(d,e.create(d,v)),d++,p++,g=f.next()}}for(;!g.done;)Bm(e,s,i,e.length,g.value),g=f.next()}for(;d<=p;)e.destroy(e.detach(p--));s?.forEach(f=>e.destroy(f))}(p,t,d.trackByFn),p.updateIndexes(),d.hasEmptyBlock){const f=Ft(),g=0===p.length;if(It(s,f,g)){const y=e+2,v=Hp(s,ye+y);if(g){const C=Bp(c,y),w=Cs(v,C.tView.ssrId);$a(v,ja(s,C,void 0,{dehydratedView:w}),0,ws(C,w))}else bs(v,0)}}}finally{k(i)}}function Hp(e,t){return e[t]}function Bp(e,t){return Hs(e,t+ye)}function vy(e,t,i,s){const c=F(),d=Pe(),p=ye+e,f=c[fe],g=d.firstCreatePass?function RS(e,t,i,s,c,d){const p=t.consts,g=ls(t,e,2,s,ei(p,c));return dp(t,i,g,ei(p,d)),null!==g.attrs&&jl(g,g.attrs,!1),null!==g.mergedAttrs&&jl(g,g.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,g),g}(p,d,c,t,i,s):d.data[p],y=L1(d,c,g,f,t,e);c[p]=y;const v=Hu(g);return Zi(g,!0),_l(f,y,g),32!=(32&g.flags)&&Nr()&&Fd(d,c,y,g),0===function zu(){return ae.lFrame.elementDepthCount}()&&Be(y,c),function ih(){ae.lFrame.elementDepthCount++}(),v&&(Sa(d,c,g),ap(d,g,c)),null!==s&&cp(c,g),vy}function _y(){let e=$e();rh()?sh():(e=e.parent,Zi(e,!1));const t=e;(function Hv(e){return ae.skipHydrationRootTNode===e})(t)&&function B0(){ae.skipHydrationRootTNode=null}(),function U0(){ae.lFrame.elementDepthCount--}();const i=Pe();return i.firstCreatePass&&(Wo(i,e),Rf(e)&&i.queries.elementEnd(e)),null!=t.classesWithoutHost&&function Pc(e){return 0!=(8&e.flags)}(t)&&Ra(i,t,F(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function nd(e){return 0!=(16&e.flags)}(t)&&Ra(i,t,F(),t.stylesWithoutHost,!1),_y}function db(e,t,i,s){return vy(e,t,i,s),_y(),db}let L1=(e,t,i,s,c,d)=>(Un(!0),pa(s,c,function kr(){return ae.lFrame.currentNamespace}()));function Cy(e,t,i){const s=F(),c=Pe(),d=e+ye,p=c.firstCreatePass?function GS(e,t,i,s,c){const d=t.consts,p=ei(d,s),f=ls(t,e,8,"ng-container",p);return null!==p&&jl(f,p,!0),dp(t,i,f,ei(d,c)),null!==t.queries&&t.queries.elementStart(t,f),f}(d,c,s,t,i):c.data[d];Zi(p,!0);const f=G1(c,s,p,e);return s[d]=f,Nr()&&Fd(c,s,f,p),Be(f,s),Hu(p)&&(Sa(c,s,p),ap(c,p,s)),null!=i&&cp(s,p),Cy}function wy(){let e=$e();const t=Pe();return rh()?sh():(e=e.parent,Zi(e,!1)),t.firstCreatePass&&(Wo(t,e),Rf(e)&&t.queries.elementEnd(e)),wy}function pb(e,t,i){return Cy(e,t,i),wy(),pb}let G1=(e,t,i,s)=>(Un(!0),pl(t[fe],""));function H1(){return F()}const Ya=void 0;var $S=["en",[["a","p"],["AM","PM"],Ya],[["AM","PM"],Ya,Ya],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Ya,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Ya,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Ya,"{1} 'at' {0}",Ya],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function jS(e){const i=Math.floor(Math.abs(e)),s=e.toString().replace(/^[^.]*\.?/,"").length;return 1===i&&0===s?1:5}];let hu={};function fb(e){const t=function ZS(e){return e.toLowerCase().replace(/_/g,"-")}(e);let i=Z1(t);if(i)return i;const s=t.split("-")[0];if(i=Z1(s),i)return i;if("en"===s)return $S;throw new ie(701,!1)}function $1(e){return fb(e)[gu.PluralCase]}function Z1(e){return e in hu||(hu[e]=tt.ng&&tt.ng.common&&tt.ng.common.locales&&tt.ng.common.locales[e]),hu[e]}var gu=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}(gu||{});const mu="en-US";let V1=mu;function mb(e){return!!e&&"function"==typeof e.then}function mM(e){return!!e&&"function"==typeof e.subscribe}function yb(e,t,i,s){const c=F(),d=Pe(),p=$e();return function vM(e,t,i,s,c,d,p){const f=Hu(s),y=e.firstCreatePass&&Zg(e),v=t[We],C=$g(t);let w=!0;if(3&s.type||p){const j=dn(s,t),K=p?p(j):j,oe=C.length,G=p?Oe=>p(nt(Oe[s.index])):s.index;let he=null;if(!p&&f&&(he=function LT(e,t,i,s){const c=e.cleanup;if(null!=c)for(let d=0;d<c.length-1;d+=2){const p=c[d];if(p===i&&c[d+1]===s){const f=t[Vo],g=c[d+2];return f.length>g?f[g]:null}"string"==typeof p&&(d+=2)}return null}(e,t,c,s.index)),null!==he)(he.__ngLastListenerFn__||he).__ngNextListenerFn__=d,he.__ngLastListenerFn__=d,w=!1;else{d=CM(s,t,v,d,!1);const Oe=i.listen(K,c,d);C.push(d,Oe),y&&y.push(c,G,oe,oe+1)}}else d=CM(s,t,v,d,!1);const D=s.outputs;let P;if(w&&null!==D&&(P=D[c])){const j=P.length;if(j)for(let K=0;K<j;K+=2){const Ve=t[P[K]][P[K+1]].subscribe(d),Yt=C.length;C.push(d,Ve),y&&y.push(c,s.index,Yt,-(Yt+1))}}}(d,c,c[fe],p,e,t,s),yb}function _M(e,t,i,s){try{return gi(6,t,i),!1!==i(s)}catch(c){return us(e,c),!1}finally{gi(7,t,i)}}function CM(e,t,i,s,c){return function d(p){if(p===Function)return s;Ia(e.componentOffset>-1?pn(e.index,t):t);let g=_M(t,i,s,p),y=d.__ngNextListenerFn__;for(;y;)g=_M(t,i,y,p)&&g,y=y.__ngNextListenerFn__;return c&&!1===g&&p.preventDefault(),g}}function wM(e=1){return function Ku(e){return(ae.lFrame.contextLView=function th(e,t){for(;e>0;)t=t[qo],e--;return t}(e,ae.lFrame.contextLView))[We]}(e)}function GT(e,t){let i=null;const s=function w0(e){const t=e.attrs;if(null!=t){const i=t.indexOf(5);if(!(1&i))return t[i+1]}return null}(e);for(let c=0;c<t.length;c++){const d=t[c];if("*"!==d){if(null===s?Af(e,d,!0):b0(s,d))return c}else i=c}return i}function bM(e){const t=F()[at][Kt];if(!t.projection){const s=t.projection=ni(e?e.length:1,null),c=s.slice();let d=t.child;for(;null!==d;){const p=e?GT(d,e):0;null!==p&&(c[p]?c[p].projectionNext=d:s[p]=d,c[p]=d),d=d.next}}}function MM(e,t=0,i){const s=F(),c=Pe(),d=ls(c,ye+e,16,null,i||null);null===d.projection&&(d.projection=t),sh(),(!s[$i]||Bs())&&32!=(32&d.flags)&&function nn(e,t,i){Rd(t[fe],0,t,i,hl(e,i,t),ng(i.parent||t[Kt],i,t))}(c,s,d)}function Ty(e,t,i,s,c){const d=F(),p=ao(d,t,i,s);return p!==ge&&Sn(Pe(),it(),d,e,p,d[fe],c,!1),Ty}function kM(e){return Or(function j0(){return ae.lFrame.contextLView}(),ye+e)}function $M(e,t=""){const i=F(),s=Pe(),c=e+ye,d=s.firstCreatePass?ls(s,c,1,t,null):s.data[c],p=ZM(s,i,d,t,e);i[c]=p,Nr()&&Fd(s,i,p,d),Zi(d,!1)}let ZM=(e,t,i,s,c)=>(Un(!0),function Pd(e,t){return e.createText(t)}(t[fe],s));function vb(e){return xy("",e,""),vb}function xy(e,t,i){const s=F(),c=ao(s,e,t,i);return c!==ge&&oo(s,Xe(),c),xy}function _b(e,t,i,s,c){const d=F(),p=function ii(e,t,i,s,c,d){const f=so(e,ct(),i,c);return _n(2),f?t+_e(i)+s+_e(c)+d:ge}(d,e,t,i,s,c);return p!==ge&&oo(d,Xe(),p),_b}function Cb(e,t,i,s,c,d,p){const f=F(),g=Ye(f,e,t,i,s,c,d,p);return g!==ge&&oo(f,Xe(),g),Cb}function wb(e,t,i,s,c){if(e=le(e),Array.isArray(e))for(let d=0;d<e.length;d++)wb(e[d],t,i,s,c);else{const d=Pe(),p=F(),f=$e();let g=Zn(e)?e:le(e.provide);const y=dd(e),v=1048575&f.providerIndexes,C=f.directiveStart,w=f.providerIndexes>>20;if(Zn(e)||!e.multi){const D=new Jo(y,c,io),P=Mb(g,t,c?v:v+w,C);-1===P?(zs(Lr(f,p),d,g),bb(d,e,t.length),t.push(g),f.directiveStart++,f.directiveEnd++,c&&(f.providerIndexes+=1048576),i.push(D),p.push(D)):(i[P]=D,p[P]=D)}else{const D=Mb(g,t,v+w,C),P=Mb(g,t,v,v+w),K=P>=0&&i[P];if(c&&!K||!c&&!(D>=0&&i[D])){zs(Lr(f,p),d,g);const oe=function tx(e,t,i,s,c){const d=new Jo(e,i,io);return d.multi=[],d.index=t,d.componentProviders=0,JM(d,c,s&&!i),d}(c?ex:XT,i.length,c,s,y);!c&&K&&(i[P].providerFactory=oe),bb(d,e,t.length,0),t.push(g),f.directiveStart++,f.directiveEnd++,c&&(f.providerIndexes+=1048576),i.push(oe),p.push(oe)}else bb(d,e,D>-1?D:P,JM(i[c?P:D],y,!c&&s));!c&&s&&K&&i[P].componentProviders++}}}function bb(e,t,i,s){const c=Zn(t),d=function Ph(e){return!!e.useClass}(t);if(c||d){const g=(d?le(t.useClass):t).prototype.ngOnDestroy;if(g){const y=e.destroyHooks||(e.destroyHooks=[]);if(!c&&t.multi){const v=y.indexOf(i);-1===v?y.push(i,[s,g]):y[v+1].push(s,g)}else y.push(i,g)}}}function JM(e,t,i){return i&&e.componentProviders++,e.multi.push(t)-1}function Mb(e,t,i,s){for(let c=i;c<s;c++)if(t[c]===e)return c;return-1}function XT(e,t,i,s){return Db(this.multi,[])}function ex(e,t,i,s){const c=this.multi;let d;if(this.providerFactory){const p=this.providerFactory.componentProviders,f=yi(i,i[Y],this.providerFactory.index,s);d=f.slice(0,p),Db(c,d);for(let g=p;g<f.length;g++)d.push(f[g])}else d=[],Db(c,d);return d}function Db(e,t){for(let i=0;i<e.length;i++)t.push((0,e[i])());return t}function KM(e,t=[]){return i=>{i.providersResolver=(s,c)=>function KT(e,t,i){const s=Pe();if(s.firstCreatePass){const c=hi(e);wb(i,s.data,s.blueprint,c,!0),wb(t,s.data,s.blueprint,c,!1)}}(s,c?c(e):e,t)}}class Qa{}class nx{}function ix(e,t){return new Sb(e,t??null,[])}class Sb extends Qa{constructor(t,i,s){super(),this._parent=i,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new lm(this);const c=function Jt(e,t){const i=e[vf]||null;if(!i&&!0===t)throw new Error(`Type ${St(e)} does not have '\u0275mod' property.`);return i}(t);this._bootstrapComponents=function hn(e){return e instanceof Function?e():e}(c.bootstrap),this._r3Injector=nl(t,i,[{provide:Qa,useValue:this},{provide:ba,useValue:this.componentFactoryResolver},...s],St(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(i=>i()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Tb extends nx{constructor(t){super(),this.moduleType=t}create(t){return new Sb(this.moduleType,t,[])}}function eD(e,t,i){const s=e.\u0275cmp;s.directiveDefs=Lu(t,!1),s.pipeDefs=Lu(i,!0)}function cD(e,t,i,s){return uD(F(),qt(),e,t,i,s)}function lD(e,t,i,s,c){return function dD(e,t,i,s,c,d,p){const f=t+i;return so(e,f,c,d)?Oi(e,f+2,p?s.call(p,c,d):s(c,d)):ef(e,f+2)}(F(),qt(),e,t,i,s,c)}function ef(e,t){const i=e[t];return i===ge?void 0:i}function uD(e,t,i,s,c,d){const p=t+i;return It(e,p,c)?Oi(e,p+1,d?s.call(d,c):s(c)):ef(e,p+1)}function gD(e,t){const i=Pe();let s;const c=e+ye;i.firstCreatePass?(s=function Tx(e,t){if(t)for(let i=t.length-1;i>=0;i--){const s=t[i];if(e===s.name)return s}}(t,i.pipeRegistry),i.data[c]=s,s.onDestroy&&(i.destroyHooks??=[]).push(c,s.onDestroy)):s=i.data[c];const d=s.factory||(s.factory=ho(s.type)),f=vn(io);try{const g=Fe(!1),y=d();return Fe(g),function HT(e,t,i,s){i>=e.data.length&&(e.data[i]=null,e.blueprint[i]=null),t[i]=s}(i,F(),c,y),y}finally{vn(f)}}function mD(e,t,i){const s=e+ye,c=F(),d=Or(c,s);return function tf(e,t){return e[Y].data[t].pure}(c,s)?uD(c,qt(),t,d.transform,i,d):d.transform(i)}function Ax(){return this._results[Symbol.iterator]()}class Ib{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new Ai)}constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const i=Ib.prototype;i[Symbol.iterator]||(i[Symbol.iterator]=Ax)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,i){return this._results.reduce(t,i)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,i){this.dirty=!1;const s=function Cn(e){return e.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function qv(e,t,i){if(e.length!==t.length)return!1;for(let s=0;s<e.length;s++){let c=e[s],d=t[s];if(i&&(c=i(c),d=i(d)),d!==c)return!1}return!0}(this._results,s,i))&&(this._results=s,this.length=s.length,this.last=s[this.length-1],this.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let nf=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=Nx}return e})();const Ox=nf,kx=class extends Ox{constructor(t,i,s){super(),this._declarationLView=t,this._declarationTContainer=i,this.elementRef=s}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,s){const c=ja(this._declarationLView,this._declarationTContainer,t,{injector:i,dehydratedView:s});return new gr(c)}};function Nx(){return Py($e(),F())}function Py(e,t){return 4&e.type?new kx(t,e,no(e,t)):null}class Eb{constructor(t){this.queryList=t,this.matches=null}clone(){return new Eb(this.queryList)}setDirty(){this.queryList.setDirty()}}class Pb{constructor(t=[]){this.queries=t}createEmbeddedView(t){const i=t.queries;if(null!==i){const s=null!==t.contentQueries?t.contentQueries[0]:i.length,c=[];for(let d=0;d<s;d++){const p=i.getByIndex(d);c.push(this.queries[p.indexInDeclarationView].clone())}return new Pb(c)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let i=0;i<this.queries.length;i++)null!==DD(t,i).matches&&this.queries[i].setDirty()}}class yD{constructor(t,i,s=null){this.predicate=t,this.flags=i,this.read=s}}class Ab{constructor(t=[]){this.queries=t}elementStart(t,i){for(let s=0;s<this.queries.length;s++)this.queries[s].elementStart(t,i)}elementEnd(t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementEnd(t)}embeddedTView(t){let i=null;for(let s=0;s<this.length;s++){const c=null!==i?i.length:0,d=this.getByIndex(s).embeddedTView(t,c);d&&(d.indexInDeclarationView=s,null!==i?i.push(d):i=[d])}return null!==i?new Ab(i):null}template(t,i){for(let s=0;s<this.queries.length;s++)this.queries[s].template(t,i)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Ob{constructor(t,i=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=i}elementStart(t,i){this.isApplyingToNode(i)&&this.matchTNode(t,i)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,i){this.elementStart(t,i)}embeddedTView(t,i){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,i),new Ob(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const i=this._declarationNodeIndex;let s=t.parent;for(;null!==s&&8&s.type&&s.index!==i;)s=s.parent;return i===(null!==s?s.index:-1)}return this._appliesToNextNode}matchTNode(t,i){const s=this.metadata.predicate;if(Array.isArray(s))for(let c=0;c<s.length;c++){const d=s[c];this.matchTNodeWithReadOption(t,i,Fx(i,d)),this.matchTNodeWithReadOption(t,i,Hr(i,t,d,!1,!1))}else s===nf?4&i.type&&this.matchTNodeWithReadOption(t,i,-1):this.matchTNodeWithReadOption(t,i,Hr(i,t,s,!1,!1))}matchTNodeWithReadOption(t,i,s){if(null!==s){const c=this.metadata.read;if(null!==c)if(c===Io||c===ou||c===nf&&4&i.type)this.addMatch(i.index,-2);else{const d=Hr(i,t,c,!1,!1);null!==d&&this.addMatch(i.index,d)}else this.addMatch(i.index,s)}}addMatch(t,i){null===this.matches?this.matches=[t,i]:this.matches.push(t,i)}}function Fx(e,t){const i=e.localNames;if(null!==i)for(let s=0;s<i.length;s+=2)if(i[s]===t)return i[s+1];return null}function Ux(e,t,i,s){return-1===i?function Rx(e,t){return 11&e.type?no(e,t):4&e.type?Py(e,t):null}(t,e):-2===i?function Lx(e,t,i){return i===Io?no(t,e):i===nf?Py(t,e):i===ou?qm(t,e):void 0}(e,t,s):yi(e,e[Y],i,t)}function vD(e,t,i,s){const c=t[pi].queries[s];if(null===c.matches){const d=e.data,p=i.matches,f=[];for(let g=0;g<p.length;g+=2){const y=p[g];f.push(y<0?null:Ux(t,d[y],p[g+1],i.metadata.read))}c.matches=f}return c.matches}function kb(e,t,i,s){const c=e.queries.getByIndex(i),d=c.matches;if(null!==d){const p=vD(e,t,c,i);for(let f=0;f<d.length;f+=2){const g=d[f];if(g>0)s.push(p[f/2]);else{const y=d[f+1],v=t[-g];for(let C=Tt;C<v.length;C++){const w=v[C];w[fc]===w[st]&&kb(w[Y],w,y,s)}if(null!==v[Us]){const C=v[Us];for(let w=0;w<C.length;w++){const D=C[w];kb(D[Y],D,y,s)}}}}}return s}function _D(e){const t=F(),i=Pe(),s=ti();js(s+1);const c=DD(i,s);if(e.dirty&&function Uv(e){return 4==(4&e[me])}(t)===(2==(2&c.metadata.flags))){if(null===c.matches)e.reset([]);else{const d=c.crossesNgTemplate?kb(i,t,s,[]):vD(i,t,c,s);e.reset(d,ft),e.notifyOnChanges()}return!0}return!1}function CD(e,t,i){const s=Pe();s.firstCreatePass&&(function MD(e,t,i){null===e.queries&&(e.queries=new Ab),e.queries.track(new Ob(t,i))}(s,new yD(e,t,i),-1),2==(2&t)&&(s.staticViewQueries=!0)),function bD(e,t,i){const s=new Ib(4==(4&i));(function fC(e,t,i,s){const c=$g(t);c.push(i),e.firstCreatePass&&Zg(e).push(s,c.length-1)})(e,t,s,s.destroy),null===t[pi]&&(t[pi]=new Pb),t[pi].queries.push(new Eb(s))}(s,F(),t)}function wD(){return function Hx(e,t){return e[pi].queries[t].queryList}(F(),ti())}function DD(e,t){return e.queries.getByIndex(t)}function SD(e,t){return Py(e,t)}const lI=new Ce("Application Initializer");let Lb=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,s)=>{this.resolve=i,this.reject=s}),this.appInits=Ae(lI,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const i=[];for(const c of this.appInits){const d=c();if(mb(d))i.push(d);else if(mM(d)){const p=new Promise((f,g)=>{d.subscribe({complete:f,error:g})});i.push(p)}}const s=()=>{this.done=!0,this.resolve()};Promise.all(i).then(()=>{s()}).catch(c=>{this.reject(c)}),0===i.length&&s(),this.initialized=!0}static#e=this.\u0275fac=function(s){return new(s||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Oy=new Ce("LocaleId",{providedIn:"root",factory:()=>Ae(Oy,De.Optional|De.SkipSelf)||function dI(){return typeof $localize<"u"&&$localize.locale||mu}()}),pI=new Ce("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});let yI=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new qy.X(!1)}add(){this.hasPendingTasks.next(!0);const i=this.taskId++;return this.pendingTasks.add(i),i}remove(i){this.pendingTasks.delete(i),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(s){return new(s||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const qD=new Ce(""),zD=new Ce("");let Hb,$I=(()=>{class e{constructor(i,s,c){this._ngZone=i,this.registry=s,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Hb||(function ZI(e){Hb=e}(c),c.addToWindow(s)),this._watchAngularEvents(),i.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{vt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let i=this._callbacks.pop();clearTimeout(i.timeoutId),i.doneCb(this._didWork)}this._didWork=!1});else{let i=this.getPendingTasks();this._callbacks=this._callbacks.filter(s=>!s.updateCb||!s.updateCb(i)||(clearTimeout(s.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(i=>({source:i.source,creationLocation:i.creationLocation,data:i.data})):[]}addCallback(i,s,c){let d=-1;s&&s>0&&(d=setTimeout(()=>{this._callbacks=this._callbacks.filter(p=>p.timeoutId!==d),i(this._didWork,this.getPendingTasks())},s)),this._callbacks.push({doneCb:i,timeoutId:d,updateCb:c})}whenStable(i,s,c){if(c&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(i,s,c),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(i){this.registry.registerApplication(i,this)}unregisterApplication(i){this.registry.unregisterApplication(i)}findProviders(i,s,c){return[]}static#e=this.\u0275fac=function(s){return new(s||e)(Zt(vt),Zt(YD),Zt(zD))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})(),YD=(()=>{class e{constructor(){this._applications=new Map}registerApplication(i,s){this._applications.set(i,s)}unregisterApplication(i){this._applications.delete(i)}unregisterAllApplications(){this._applications.clear()}getTestability(i){return this._applications.get(i)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(i,s=!0){return Hb?.findTestabilityInTree(this,i,s)??null}static#e=this.\u0275fac=function(s){return new(s||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})(),Ts=null;const QD=new Ce("AllowMultipleToken"),Bb=new Ce("PlatformDestroyListeners"),WD=new Ce("appBootstrapListener");function XD(e,t,i=[]){const s=`Platform: ${t}`,c=new Ce(s);return(d=[])=>{let p=jb();if(!p||p.injector.get(QD,!1)){const f=[...i,...d,{provide:c,useValue:!0}];e?e(f):function zI(e){if(Ts&&!Ts.get(QD,!1))throw new ie(400,!1);(function JD(){!function Ct(e){ze=e}(()=>{throw new ie(600,!1)})})(),Ts=e;const t=e.get(tS);(function KD(e){e.get(rl,null)?.forEach(i=>i())})(e)}(function eS(e=[],t){return Vn.create({name:t,providers:[{provide:Wi,useValue:"platform"},{provide:Bb,useValue:new Set([()=>Ts=null])},...e]})}(f,s))}return function QI(e){const t=jb();if(!t)throw new ie(401,!1);return t}()}}function jb(){return Ts?.get(tS)??null}let tS=(()=>{class e{constructor(i){this._injector=i,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(i,s){const c=function WI(e="zone.js",t){return"noop"===e?new GC:"zone.js"===e?new vt(t):e}(s?.ngZone,function nS(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:s?.ngZoneEventCoalescing,runCoalescing:s?.ngZoneRunCoalescing}));return c.run(()=>{const d=function ox(e,t,i){return new Sb(e,t,i)}(i.moduleType,this.injector,function aS(e){return[{provide:vt,useFactory:e},{provide:Xs,multi:!0,useFactory:()=>{const t=Ae(KI,{optional:!0});return()=>t.initialize()}},{provide:sS,useFactory:JI},{provide:Hl,useFactory:ds}]}(()=>c)),p=d.injector.get(Ao,null);return c.runOutsideAngular(()=>{const f=c.onError.subscribe({next:g=>{p.handleError(g)}});d.onDestroy(()=>{Ny(this._modules,d),f.unsubscribe()})}),function iS(e,t,i){try{const s=i();return mb(s)?s.catch(c=>{throw t.runOutsideAngular(()=>e.handleError(c)),c}):s}catch(s){throw t.runOutsideAngular(()=>e.handleError(s)),s}}(p,c,()=>{const f=d.injector.get(Lb);return f.runInitializers(),f.donePromise.then(()=>(function q1(e){un(e,"Expected localeId to be defined"),"string"==typeof e&&(V1=e.toLowerCase().replace(/_/g,"-"))}(d.injector.get(Oy,mu)||mu),this._moduleDoBootstrap(d),d))})})}bootstrapModule(i,s=[]){const c=oS({},s);return function VI(e,t,i){const s=new Tb(i);return Promise.resolve(s)}(0,0,i).then(d=>this.bootstrapModuleFactory(d,c))}_moduleDoBootstrap(i){const s=i.injector.get(sf);if(i._bootstrapComponents.length>0)i._bootstrapComponents.forEach(c=>s.bootstrap(c));else{if(!i.instance.ngDoBootstrap)throw new ie(-403,!1);i.instance.ngDoBootstrap(s)}this._modules.push(i)}onDestroy(i){this._destroyListeners.push(i)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ie(404,!1);this._modules.slice().forEach(s=>s.destroy()),this._destroyListeners.forEach(s=>s());const i=this._injector.get(Bb,null);i&&(i.forEach(s=>s()),i.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(s){return new(s||e)(Zt(Vn))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function oS(e,t){return Array.isArray(t)?t.reduce(oS,e):{...e,...t}}let sf=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Ae(sS),this.zoneIsStable=Ae(Hl),this.componentTypes=[],this.components=[],this.isStable=Ae(yI).hasPendingTasks.pipe((0,Ue.w)(i=>i?(0,gf.of)(!1):this.zoneIsStable),function Jy(e,t){return i=>i.lift(new Xa(e,t))}(),ke()),this._injector=Ae(ve)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(i,s){const c=i instanceof wa;if(!this._injector.get(Lb).done)throw!c&&function Ir(e){const t=Se(e)||Et(e)||Gt(e);return null!==t&&t.standalone}(i),new ie(405,!1);let p;p=c?i:this._injector.get(ba).resolveComponentFactory(i),this.componentTypes.push(p.componentType);const f=function qI(e){return e.isBoundToModule}(p)?void 0:this._injector.get(Qa),y=p.create(Vn.NULL,[],s||p.selector,f),v=y.location.nativeElement,C=y.injector.get(qD,null);return C?.registerApplication(v),y.onDestroy(()=>{this.detachView(y.hostView),Ny(this.components,y),C?.unregisterApplication(v)}),this._loadComponent(y),y}tick(){if(this._runningTick)throw new ie(101,!1);try{this._runningTick=!0;for(let i of this._views)i.detectChanges()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1}}attachView(i){const s=i;this._views.push(s),s.attachToAppRef(this)}detachView(i){const s=i;Ny(this._views,s),s.detachFromAppRef()}_loadComponent(i){this.attachView(i.hostView),this.tick(),this.components.push(i);const s=this._injector.get(WD,[]);[...this._bootstrapListeners,...s].forEach(c=>c(i))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(i=>i()),this._views.slice().forEach(i=>i.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(i){return this._destroyListeners.push(i),()=>Ny(this._destroyListeners,i)}destroy(){if(this._destroyed)throw new ie(406,!1);const i=this._injector;i.destroy&&!i.destroyed&&i.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(s){return new(s||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Ny(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}const sS=new Ce("",{providedIn:"root",factory:()=>Ae(Ao).handleError.bind(void 0)});function JI(){const e=Ae(vt),t=Ae(Ao);return i=>e.runOutsideAngular(()=>t.handleError(i))}let KI=(()=>{class e{constructor(){this.zone=Ae(vt),this.applicationRef=Ae(sf)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(s){return new(s||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function tE(){return!1}function nE(){}const aE=XD(null,"core",[]);let cE=(()=>{class e{constructor(i){}static#e=this.\u0275fac=function(s){return new(s||e)(Zt(sf))};static#t=this.\u0275mod=Uu({type:e});static#n=this.\u0275inj=rc({})}return e})()}},we=>{we(we.s=843)}]);